/*! Discount Ninja e-Commerce Price Rule Engine | COPYRIGHT (c) 2017-2022 ALL RIGHTS RESERVED | See terms and conditions at https://terms.discountninja.io/legal */
/*! jQuery v3.5.1 | (c) JS Foundation and other contributors | jquery.org/license */
/*! Ouibounce by Carl Sednaoui - https://github.com/carlsednaoui/ouibounce | Licensed under MIT License (https://github.com/carlsednaoui/ouibounce/blob/master/license.md) */
/*! day.js | version : 1.10.7 | authors : iamkun | license : MIT | day.js.org */
var discountNinja_Script_Polyfill={CustomEvent:function(){try{if("function"==typeof window.CustomEvent)return!1;function t(t,i){i=i||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,i.bubbles,i.cancelable,i.detail),n}t.prototype=window.Event.prototype,window.CustomEvent=t}catch(i){discountNinja.Logging.LogError("Polyfill.CustomEvent",i)}},EndsWith:function(){try{"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)})}catch(t){discountNinja.Logging.LogError("Polyfill.EndsWith",t)}},RegisterAll:function(){var t=discountNinja_Script_Polyfill;t.CustomEvent(),t.EndsWith()}};if("undefined"!=typeof Shopify&&!0===Shopify.designMode)throw new Error("Limoni Apps DiscountNinja has detected it is running in the Shopify Admin theme editor. Aborting script.");var discountNinjaScriptStarted=!1,LimoniAppsJQuery=void 0!==LimoniAppsJQuery?LimoniAppsJQuery:null;function LimoniAppsLoadJQuery(t,i){function n(){try{var t="function"==typeof LimoniAppsJQuery?LimoniAppsJQuery.fn.jquery.split("."):"function"==typeof jQuery?jQuery.fn.jquery.split("."):$.fn.jquery.split("."),i=parseInt(t[0]),n=parseInt(t[1]);return i>1||1===i&&n>=8}catch(t){return console.error("LimoniAppsLoadJQuery - VersionIsCompatible failed",t),!1}}function e(){try{"function"==typeof jQuery&&"function"!=typeof LimoniAppsJQuery&&(LimoniAppsJQuery=jQuery)}catch(t){console.error("LimoniAppsLoadJQuery - jQueryLoaded failed",t)}t&&t()}var o="function"==typeof LimoniAppsJQuery||"function"==typeof jQuery;if(!o||!n()){var r="object"==typeof discountNinjaContext&&null!==discountNinjaContext&&"object"==typeof discountNinjaContext.Flags&&null!==discountNinjaContext.Flags&&!0===discountNinjaContext.Flags.SkipWaitForJQuery;if((i=i||1)<20&&!0!==r)setTimeout((function(){LimoniAppsLoadJQuery(t,i+1)}),50);else{var a=o&&!n()&&"object"==typeof discountNinjaContext&&null!==discountNinjaContext&&"object"==typeof discountNinjaContext.Flags&&null!==discountNinjaContext.Flags&&!1===discountNinjaContext.Flags.LoadJQueryIfMissing,c="3.5.1";try{a?console.info("Discount Ninja - Detected incompatible version of jQuery (v"+jQuery.fn.jquery+"). Not loading more recent version (disabled in flags)."):o?console.info("Discount Ninja - Detected incompatible version of jQuery (v"+jQuery.fn.jquery+"). Loading version v"+c+"."):console.debug("Discount Ninja - jQuery unavailable. "+(r?"":"Performance can be optimized by setting the SkipWaitForJQuery flag to true in the limoniapps-discountninja-context-flags.liquid asset of your theme. ")+"Loading version "+c+".")}catch(t){console.error("LimoniAppsLoadJQuery - Loading jQuery failed",t)}if(!0===a)e();else try{!function(t,i,n){try{if(null===document.getElementById(t)){var e=document.createElement("script");return e.type="text/javascript",e.onload=n,e.onerror=function(){console.error("Could not load script from: "+i)},e.src=i,e.id=t,document.head.appendChild(e)}}catch(t){console.error("Discount Ninja cannot load dependency from "+i,t)}}("limoniapps-discountninja-dependency-jquery","//ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js",e)}catch(t){console.error("Discount Ninja - Loading jQuery script failed",t),e()}}}else e()}function LimoniAppsLoadOuiBounce(t){try{"function"!=typeof ouibounce&&(i=this,n=function(t,i,n){return function(t,i){function n(t,i){return void 0===t?i:t}function e(t){var i=24*t*60*60*1e3,n=new Date;return n.setTime(n.getTime()+i),"; expires="+n.toUTCString()}function o(t){t.clientY>f||(_=setTimeout(s,N))}function r(){_&&(clearTimeout(_),_=null)}function a(t){v||t.metaKey&&76===t.keyCode&&(v=!0,_=setTimeout(s,N))}function c(t,i){return function(){for(var t=document.cookie.split("; "),i={},n=t.length-1;n>=0;n--){var e=t[n].split("=");i[e[0]]=e[1]}return i}()[t]===i}function u(){return c(S,"true")&&!g}function s(){u()||(t&&(t.style.display="block"),j(),d())}function d(t){var i=t||{};void 0!==i.cookieExpire&&(C=e(i.cookieExpire)),!0===i.sitewide&&(h=";path=/"),void 0!==i.cookieDomain&&(m=";domain="+i.cookieDomain),void 0!==i.cookieName&&(S=i.cookieName),document.cookie=S+"=true"+C+m+h,y.removeEventListener("mouseleave",o),y.removeEventListener("mouseenter",r),y.removeEventListener("keydown",a)}var l=i||{},g=l.aggressive||!1,f=n(l.sensitivity,20),p=n(l.timer,1e3),N=n(l.delay,0),j=l.callback||function(){},C=e(l.cookieExpire)||"",m=l.cookieDomain?";domain="+l.cookieDomain:"",S=l.cookieName?l.cookieName:"viewedOuibounceModal",h=!0===l.sitewide?";path=/":"",_=null,y=document.documentElement;setTimeout((function(){u()||(y.addEventListener("mouseleave",o),y.addEventListener("mouseenter",r),y.addEventListener("keydown",a))}),p);var v=!1;return{fire:s,disable:d,isDisabled:u}}},"function"==typeof define&&define.amd?define(n):"object"==typeof exports?module.exports=n(require,exports,module):i.ouibounce=n())}catch(i){console.error("LimoniAppsLoadOuiBounce failed",i)}var i,n;t&&t()}function LimoniAppsLoadDayJs(t){try{"function"!=typeof dayjs&&(i=this,n=function(){var t=6e4,i=36e5,n="millisecond",e="second",o="minute",r="hour",a="day",c="week",u="month",s="quarter",d="year",l="date",g="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,N={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},j=function(t,i,n){var e=String(t);return!e||e.length>=i?t:""+Array(i+1-e.length).join(n)+t},C={s:j,z:function(t){var i=-t.utcOffset(),n=Math.abs(i),e=Math.floor(n/60),o=n%60;return(i<=0?"+":"-")+j(e,2,"0")+":"+j(o,2,"0")},m:function t(i,n){if(i.date()<n.date())return-t(n,i);var e=12*(n.year()-i.year())+(n.month()-i.month()),o=i.clone().add(e,u),r=n-o<0,a=i.clone().add(e+(r?-1:1),u);return+(-(e+(n-o)/(r?o-a:a-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:u,y:d,w:c,d:a,D:l,h:r,m:o,s:e,ms:n,Q:s}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},m="en",S={};S[m]=N;var h=function(t){return t instanceof P},_=function(t,i,n){var e;if(!t)return m;if("string"==typeof t)S[t]&&(e=t),i&&(S[t]=i,e=t);else{var o=t.name;S[o]=t,e=o}return!n&&e&&(m=e),e||!n&&m},y=function(t,i){if(h(t))return t.clone();var n="object"==typeof i?i:{};return n.date=t,n.args=arguments,new P(n)},v=C;v.l=_,v.i=h,v.w=function(t,i){return y(t,{locale:i.$L,utc:i.$u,x:i.$x,$offset:i.$offset})};var P=function(){function N(t){this.$L=_(t.locale,null,!0),this.parse(t)}var j=N.prototype;return j.parse=function(t){this.$d=function(t){var i=t.date,n=t.utc;if(null===i)return new Date(NaN);if(v.u(i))return new Date;if(i instanceof Date)return new Date(i);if("string"==typeof i&&!/Z$/i.test(i)){var e=i.match(f);if(e){var o=e[2]-1||0,r=(e[7]||"0").substring(0,3);return n?new Date(Date.UTC(e[1],o,e[3]||1,e[4]||0,e[5]||0,e[6]||0,r)):new Date(e[1],o,e[3]||1,e[4]||0,e[5]||0,e[6]||0,r)}}return new Date(i)}(t),this.$x=t.x||{},this.init()},j.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},j.$utils=function(){return v},j.isValid=function(){return!(this.$d.toString()===g)},j.isSame=function(t,i){var n=y(t);return this.startOf(i)<=n&&n<=this.endOf(i)},j.isAfter=function(t,i){return y(t)<this.startOf(i)},j.isBefore=function(t,i){return this.endOf(i)<y(t)},j.$g=function(t,i,n){return v.u(t)?this[i]:this.set(n,t)},j.unix=function(){return Math.floor(this.valueOf()/1e3)},j.valueOf=function(){return this.$d.getTime()},j.startOf=function(t,i){var n=this,s=!!v.u(i)||i,g=v.p(t),f=function(t,i){var e=v.w(n.$u?Date.UTC(n.$y,i,t):new Date(n.$y,i,t),n);return s?e:e.endOf(a)},p=function(t,i){return v.w(n.toDate()[t].apply(n.toDate("s"),(s?[0,0,0,0]:[23,59,59,999]).slice(i)),n)},N=this.$W,j=this.$M,C=this.$D,m="set"+(this.$u?"UTC":"");switch(g){case d:return s?f(1,0):f(31,11);case u:return s?f(1,j):f(0,j+1);case c:var S=this.$locale().weekStart||0,h=(N<S?N+7:N)-S;return f(s?C-h:C+(6-h),j);case a:case l:return p(m+"Hours",0);case r:return p(m+"Minutes",1);case o:return p(m+"Seconds",2);case e:return p(m+"Milliseconds",3);default:return this.clone()}},j.endOf=function(t){return this.startOf(t,!1)},j.$set=function(t,i){var c,s=v.p(t),g="set"+(this.$u?"UTC":""),f=(c={},c[a]=g+"Date",c[l]=g+"Date",c[u]=g+"Month",c[d]=g+"FullYear",c[r]=g+"Hours",c[o]=g+"Minutes",c[e]=g+"Seconds",c[n]=g+"Milliseconds",c)[s],p=s===a?this.$D+(i-this.$W):i;if(s===u||s===d){var N=this.clone().set(l,1);N.$d[f](p),N.init(),this.$d=N.set(l,Math.min(this.$D,N.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},j.set=function(t,i){return this.clone().$set(t,i)},j.get=function(t){return this[v.p(t)]()},j.add=function(n,s){var l,g=this;n=Number(n);var f=v.p(s),p=function(t){var i=y(g);return v.w(i.date(i.date()+Math.round(t*n)),g)};if(f===u)return this.set(u,this.$M+n);if(f===d)return this.set(d,this.$y+n);if(f===a)return p(1);if(f===c)return p(7);var N=(l={},l[o]=t,l[r]=i,l[e]=1e3,l)[f]||1,j=this.$d.getTime()+n*N;return v.w(j,this)},j.subtract=function(t,i){return this.add(-1*t,i)},j.format=function(t){var i=this,n=this.$locale();if(!this.isValid())return n.invalidDate||g;var e=t||"YYYY-MM-DDTHH:mm:ssZ",o=v.z(this),r=this.$H,a=this.$m,c=this.$M,u=n.weekdays,s=n.months,d=function(t,n,o,r){return t&&(t[n]||t(i,e))||o[n].substr(0,r)},l=function(t){return v.s(r%12||12,t,"0")},f=n.meridiem||function(t,i,n){var e=t<12?"AM":"PM";return n?e.toLowerCase():e},N={YY:String(this.$y).slice(-2),YYYY:this.$y,M:c+1,MM:v.s(c+1,2,"0"),MMM:d(n.monthsShort,c,s,3),MMMM:d(s,c),D:this.$D,DD:v.s(this.$D,2,"0"),d:String(this.$W),dd:d(n.weekdaysMin,this.$W,u,2),ddd:d(n.weekdaysShort,this.$W,u,3),dddd:u[this.$W],H:String(r),HH:v.s(r,2,"0"),h:l(1),hh:l(2),a:f(r,a,!0),A:f(r,a,!1),m:String(a),mm:v.s(a,2,"0"),s:String(this.$s),ss:v.s(this.$s,2,"0"),SSS:v.s(this.$ms,3,"0"),Z:o};return e.replace(p,(function(t,i){return i||N[t]||o.replace(":","")}))},j.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},j.diff=function(n,l,g){var f,p=v.p(l),N=y(n),j=(N.utcOffset()-this.utcOffset())*t,C=this-N,m=v.m(this,N);return m=(f={},f[d]=m/12,f[u]=m,f[s]=m/3,f[c]=(C-j)/6048e5,f[a]=(C-j)/864e5,f[r]=C/i,f[o]=C/t,f[e]=C/1e3,f)[p]||C,g?m:v.a(m)},j.daysInMonth=function(){return this.endOf(u).$D},j.$locale=function(){return S[this.$L]},j.locale=function(t,i){if(!t)return this.$L;var n=this.clone(),e=_(t,i,!0);return e&&(n.$L=e),n},j.clone=function(){return v.w(this.$d,this)},j.toDate=function(){return new Date(this.valueOf())},j.toJSON=function(){return this.isValid()?this.toISOString():null},j.toISOString=function(){return this.$d.toISOString()},j.toString=function(){return this.$d.toUTCString()},N}(),T=P.prototype;return y.prototype=T,[["$ms",n],["$s",e],["$m",o],["$H",r],["$W",a],["$M",u],["$y",d],["$D",l]].forEach((function(t){T[t[1]]=function(i){return this.$g(i,t[0],t[1])}})),y.extend=function(t,i){return t.$i||(t(i,P,y),t.$i=!0),y},y.locale=_,y.isDayjs=h,y.unix=function(t){return y(1e3*t)},y.en=S[m],y.Ls=S,y.p={},y},"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(i="undefined"!=typeof globalThis?globalThis:i||self).dayjs=n()),function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.dayjs_plugin_utc=i()}(this,(function(){return function(t,i,n){var e=(new Date).getTimezoneOffset(),o=i.prototype;n.utc=function(t){return new i({date:t,utc:!0,args:arguments})},o.utc=function(){return n(this.toDate(),{locale:this.$L,utc:!0})},o.local=function(){return n(this.toDate(),{locale:this.$L,utc:!1})};var r=o.parse;o.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),r.call(this,t)};var a=o.init;o.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else a.call(this)};var c=o.utcOffset;o.utcOffset=function(t){var i=this.$utils().u;if(i(t))return this.$u?0:i(this.$offset)?c.call(this):this.$offset;var n,o=Math.abs(t)<=16?60*t:t;return 0!==t?(n=this.local().add(o+e,"minute")).$offset=o:n=this.utc(),n};var u=o.format;o.format=function(t){var i=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,i)},o.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+e;return this.$d.valueOf()-6e4*t},o.isUTC=function(){return!!this.$u},o.toISOString=function(){return this.toDate().toISOString()},o.toString=function(){return this.toDate().toUTCString()};var s=o.toDate;o.toDate=function(t){return"s"===t&&this.$offset?n(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():s.call(this)}}})),dayjs.extend(window.dayjs_plugin_utc)}catch(n){console.error("LimoniAppsLoadDayJs failed",n)}var i,n;t&&t()}try{window.discountNinjaStopLoading=void 0!==window.discountNinja||void 0!==window.discountNinja_Script_Loading}catch(t){}if(window.discountNinjaStopLoading)console.warn("Discount Ninja - Aborting load of script because it is already loaded");else{try{if("undefined"!=typeof EventTarget){function addEventListener_hook(t,i,n,e){this.limoniAppsDiscountNinjaAllHandlers=this.limoniAppsDiscountNinjaAllHandlers||[],this.limoniAppsDiscountNinjaAllHandlers.push({typ:t,fn:i,opt:n,dn:e}),this.original_limoniAppsDiscountNinja_addEventListener(t,i,n)}null==EventTarget.prototype.original_limoniAppsDiscountNinja_addEventListener&&(EventTarget.prototype.original_limoniAppsDiscountNinja_addEventListener=EventTarget.prototype.addEventListener),EventTarget.prototype.addEventListener=addEventListener_hook}}catch(i){console.error("InterceptAddEventListener failed",i)}discountNinja_Script_Polyfill.RegisterAll(),window.discountNinja_Script_Loading=!0;var discountNinja_Script_Core={Shop:"",Environment:"prod",Release:"latest",RegistrationMethod:"appembed",Version:"7.8.19.55.1",ApiVersion:"5",SubscribedToDrawerCartOpened:!1,SubscribedToCustomDrawerCartEvents:!1,SubscribedToCollectionProductsAdded:!1,SubscribedToQuickViewProductDisplayed:!1,SubscribedToCartDirtyEvent:!1,Navigating:!1,TriggerPromotion:function(t){try{var i=discountNinja.Utilities.jQuery()(t).attr("data-limoniapps-discountninja-token");discountNinja_Script_Core.TriggerPromotionViaToken(i)}catch(t){discountNinja.Logging.LogError("Core.Exception in TriggerPromotion",t)}},TriggerPromotionViaToken:function(t){try{null!=t&&""!==t&&(discountNinja.Token.SetTokenInLocalStorage(t),discountNinja.Token.SetNonAutomaticTokenToCache(t),discountNinja_Script_Core.Start())}catch(t){discountNinja.Logging.LogError("Core.Exception in TriggerPromotion",t)}},ExecuteOnLoadCallback:function(){try{var callback=discountNinja.Cache.SessionGet("CallbackAfterReloadPageAddingFreeGift");callback&&""!==callback&&(discountNinja.Cache.SessionSet("CallbackAfterReloadPageAddingFreeGift",""),setTimeout((function(){try{eval(callback)}catch(t){discountNinja.Logging.LogError("PromotionFlow.ExecuteCallback.Eval",t)}}),500))}catch(t){discountNinja.Logging.LogError("PromotionFlow.ExecuteCallback",t)}},Start:function(t){function i(){try{var t=discountNinja_Script_Core;discountNinja.LogSession.PrintPerformance("StartInternal"),void 0===discountNinjaContext.AccessToken&&(discountNinjaContext.AccessToken=discountNinja.Settings.GetFlag("AccessToken")),void 0!==discountNinjaContext.ApiVersion&&(t.ApiVersion=discountNinjaContext.ApiVersion),function(){try{discountNinja.TestMode.HandleQueryParameter(),discountNinja.Logging.HandleQueryParameter()}catch(t){discountNinja.Logging.LogError("Core.HandleDiscountNinjaQueryParameters",t)}}(),discountNinja.LeakyBucket.Initialize(discountNinja.LeakyBucket.Buckets.ProductLiquid,5e3,30),discountNinja.LeakyBucket.Initialize(discountNinja.LeakyBucket.Buckets.ProductApi,5e3,100),t.Shop=discountNinja.Environment.Shopify.MyShopifyDomain(),!0===discountNinja.Settings.GetFlag("ForceDevelopmentEnvironment")&&"dev"!==discountNinja_Script_Core.Environment&&(discountNinja.Logging.LogWarning("Changing environment to dev"),discountNinja_Script_Core.Environment="dev"),function(){function t(t){return t.replace(/\\{/g,"{").replace(/\\}/g,"}")}function i(i){return i&&(i.Format&&(i.Format=t(i.Format)),i.PrefixText&&(i.PrefixText=t(i.PrefixText)),i.SuffixText&&(i.SuffixText=t(i.SuffixText))),i}discountNinja.Settings.Settings=window.discountNinjaContext.Settings;var n=discountNinja.Settings.Settings;if(n.Currency){n.Currency.MoneyFormat&&(n.Currency.MoneyFormat=n.Currency.MoneyFormat.replace(/\\{/g,"{").replace(/\\}/g,"}"));var e=n.PriceUpdate;e.ProductPagePriceFormat&&(e.ProductPagePriceFormat=i(e.ProductPagePriceFormat)),e.OtherPagePriceFormat&&(e.OtherPagePriceFormat=i(e.OtherPagePriceFormat)),e.CartProductPriceFormat&&(e.CartProductPriceFormat=i(e.CartProductPriceFormat)),e.CartLinePriceFormat&&(e.CartLinePriceFormat=i(e.CartLinePriceFormat)),e.CartSubtotalPriceFormat&&(e.CartSubtotalPriceFormat=i(e.CartSubtotalPriceFormat)),e.DrawerCartProductPriceFormat&&(e.DrawerCartProductPriceFormat=i(e.DrawerCartProductPriceFormat)),e.DrawerCartLinePriceFormat&&(e.DrawerCartLinePriceFormat=i(e.DrawerCartLinePriceFormat)),e.DrawerCartSubtotalPriceFormat&&(e.DrawerCartSubtotalPriceFormat=i(e.DrawerCartSubtotalPriceFormat))}}();var i=discountNinja.Settings.Settings;if(!i||!i.Currency||!i.Currency.BaseCurrency)return void discountNinja.Logging.LogErrorMessage("Core.LoadSettings","No settings available");if("undefined"!==window.discountNinjaContextAdditionalProduct&&window.discountNinjaContextAdditionalProduct&&"object"==typeof window.discountNinjaContextAdditionalProduct.CollectionProducts)for(var n=0;n<window.discountNinjaContextAdditionalProduct.CollectionProducts.length;n++)window.discountNinjaContext.CollectionProducts.push(window.discountNinjaContextAdditionalProduct.CollectionProducts[n]);discountNinja.Checkout.Shopify.RegisterEventHandlerForCheckout(),discountNinja.Cart.Shopify.RegisterEventHandlerForAddToCart(),!0===discountNinja.Settings.Settings.Checkout.BlockCheckoutButton&&discountNinja.DynamicPricing.BlockCheckoutButtons();var e=discountNinja.DiscountCode;e.EnableDiscountCodeField(),e.LockDiscountCodeFieldIfRequired(),t.SubscribedToDrawerCartOpened||(discountNinja.Cart.Shopify.SubscribeDrawerCartOpened(),t.SubscribedToDrawerCartOpened=!0),!0===discountNinja.Settings.GetFlag("TestCustomDrawerCart")&&(discountNinja.Settings.Settings.CustomDrawerCart={Enabled:!0}),discountNinja.Settings.Settings.CustomDrawerCart&&!0===discountNinja.Settings.Settings.CustomDrawerCart.Enabled&&!t.SubscribedToCustomDrawerCartEvents&&(discountNinja.Events.Publish("drawercart:registerafterrefresh"),discountNinja.DrawerCart.Inject(),discountNinja.DrawerCart.SubscribeToEvents(),t.SubscribedToCustomDrawerCartEvents=!0),t.SubscribedToCollectionProductsAdded||(discountNinja.Events.Subscribe("CollectionProductsAdded",discountNinja.DynamicPricing.OnCollectionPageProductsAdded),discountNinja.Events.Subscribe("collection:productsadded",discountNinja.DynamicPricing.OnCollectionPageProductsAdded),discountNinja.Events.Subscribe("search:productsadded",discountNinja.DynamicPricing.OnSearchPageProductsAdded),t.SubscribedToCollectionProductsAdded=!0),t.SubscribedToQuickViewProductDisplayed||(discountNinja.Events.Subscribe("QuickViewProductDisplayed",discountNinja.DynamicPricing.OnQuickViewProductDisplayed),discountNinja.Events.Subscribe("quickview:productdisplayed",discountNinja.DynamicPricing.OnQuickViewProductDisplayed),t.SubscribedToQuickViewProductDisplayed=!0),t.SubscribedToCartDirtyEvent||(discountNinja.Events.Subscribe("cart:dirty",(function(){discountNinja.ServerCartItemsUpdatedEvent.Handle()})),t.SubscribedToCartDirtyEvent=!0),window.addEventListener("beforeunload",(function(){t.Navigating=!0,discountNinja.Cache.SessionSet(discountNinja_Script_CartAdjustments.StatusKey,"aborted")})),discountNinja.Events.Subscribe("dynamicpricing:update",(function(){discountNinja.Offer.ReEvaluate()})),discountNinja.Trigger.IntializeTimeOnPageCounter(),discountNinja.Trigger.TrackScrollPercentage(),discountNinja.Offer.PrimaryOffer=null,t.RegisterDiscountButtonClickEvents(),discountNinja.Events.Subscribe("app:disable",(function(){!function(){try{discountNinja.Cache.SessionSet("AppIsDisabled",!0),discountNinja.Logging.LogWarning("Discount Ninja was manually disabled for the remainder of this session",!0),discountNinja.Offer.ReEvaluate()}catch(t){discountNinja.Logging.LogError("Core.DisableApp",t)}}()})),discountNinja.Events.Subscribe("app:enable",(function(){!function(){try{discountNinja.Cache.SessionRemove("AppIsDisabled"),discountNinja.Offer.ReEvaluate()}catch(t){discountNinja.Logging.LogError("Core.EnableApp",t)}}()})),t.ResetObsoleteStorage(),null==discountNinja.Cache.SessionGet("OriginalReferrer")&&discountNinja.Cache.SessionSet("OriginalReferrer",document.referrer),discountNinja.LogSession.Start(),discountNinja.ProductData.Save(),discountNinja.Offer.LoadApplicableOffers((function(){discountNinja.LogSession.PrintPerformance("Applicable offers loaded"),discountNinja.Cart.Shopify.UpdateCart((function(){discountNinja.LogSession.PrintPerformance("Cart available"),discountNinja.Trigger.EnsureInitialPromotionsTriggered((function(){discountNinja.LogSession.PrintPerformance("Initial promotions triggered"),discountNinja.DiscountedCart.BuildDiscountedCart((function(){discountNinja.LogSession.PrintPerformance("DiscountedCart built"),function(t){try{var i=0,n=null,e=function(){i++,void 0!==discountNinja.Utilities.jQuery()&&"boolean"==typeof discountNinja.Utilities.jQuery().isReady&&(discountNinja_Script_Core.DOMHasLoaded=discountNinja_Script_Core.DOMHasLoaded||discountNinja.Utilities.jQuery().isReady),discountNinja_Script_Core.DOMHasLoaded||100===i?(null!==n&&clearTimeout(n),100===i&&discountNinja.Logging.LogErrorMessage("Core.Start.WaitForDom","Timed out"),"function"==typeof t&&null!==t&&t()):n=setTimeout((function(){try{e()}catch(t){discountNinja.Logging.LogError("Core.WaitForDom",t)}}),50)};e()}catch(t){discountNinja.Logging.LogError("Core.WaitForDom",t)}}((function(){discountNinja.LogSession.PrintPerformance("WaitForDom complete"),discountNinja.Checkout.Shopify.InjectLoadingCheckoutPopUp(),discountNinja.PromotionFlow.StartFlow()}))}))}))}))}),discountNinja.PromotionFlow.StopFlow),discountNinja.PromotionEvent.ProcessQueue()}catch(t){discountNinja.Logging.LogError("Core.StartInternal",t)}}function n(){discountNinja.Events.Publish("internal:start")}try{var e=discountNinja_Script_Core;if(discountNinja.LogSession.RegisterTimeToLoad(),e.CurrentLocation=discountNinja.QueryParameter.RemoveFromUrl(window.location.href,"discountninjatestmode",1),e.CurrentLocation=discountNinja.QueryParameter.RemoveFromUrl(e.CurrentLocation,"discountninjalog",1),e.Shop=discountNinja.Environment.Shopify.MyShopifyDomain(!0),t){var o="HideConsoleWelcomeMessage";!0===discountNinja.Settings.GetFlag(o)||"true"===discountNinja.Cache.SessionGet(o)||(!function(){try{var t=discountNinja_Script_Core;console.groupCollapsed("%cDiscounts, cross-selling, stacking, Dynamic Pricing and special deals. Powered by Discount Ninja.","display:inline-block;font-size:12px;background:#169E53;color:white;padding:4px;border-radius:4px;");var i="\n\n📈 Increased conversion rates\n🛒 Increased average order value\n💰 Increased customer lifetime value\n\n\nRunning version v"+t.Version+" on "+t.Environment+" - "+t.Release+"\nLearn more at: https://discountninja.io/\n\n";console.log("%c"+i,"font-size: 12px;"),console.groupEnd()}catch(t){discountNinja.Logging.LogError("Core.ShowConsoleWelcomeMessage",t)}}(),discountNinja.Cache.SessionSet(o,!0))}LimoniAppsLoadJQuery((function(){!function(){try{discountNinja.XmlHttpRequest.CreateSendInterceptor(),discountNinja.XmlHttpRequest.CreateFetchInterceptor()}catch(t){discountNinja.Logging.LogError("Core.InterceptNetworkTraffic",t)}}(),discountNinja.Events.Subscribe("internal:start",(function(){i()})),discountNinja.Utilities.jQuery()(document).ready((function(){discountNinja.DOMHasLoaded=!0,discountNinja.XmlHttpRequest.RegisterToAjaxEvents()})),LimoniAppsLoadOuiBounce((function(){LimoniAppsLoadDayJs((function(){discountNinja.LiquidData.WaitForLiquidAsset(n)}))}))}))}catch(t){discountNinja.Logging.LogError("Core.Start",t)}},ResetObsoleteStorage:function(){function t(t){try{var i=t.split(".");return i[0]+"."+i[1]}catch(i){return t}}try{var i=t(discountNinja.Cache.LocalGet("version")),n=t(discountNinja_Script_Core.Version);i!==n&&(discountNinja.Cache.LocalClear(),discountNinja.Cache.LocalSet("version",n))}catch(t){discountNinja.Logging.LogError("Core.Start",t)}},RegisterDiscountButtonClickEvents:function(){try{!function(){try{discountNinja.Utilities.jQuery()("body").find(".limoniapps-discountninja-discountbutton").each((function(){discountNinja.Utilities.jQuery()(this).off("click")}))}catch(t){discountNinja.Logging.LogError("Core.UnRegisterDiscountButtonClickEvents",t)}}(),discountNinja.Utilities.jQuery()("body").find(".limoniapps-discountninja-discountbutton").each((function(){discountNinja.Utilities.jQuery()(this).on("click",(function(t){discountNinja_Script_Core.TriggerPromotion(t.currentTarget)}))}))}catch(t){discountNinja.Logging.LogError("Core.RegisterDiscountButtonClickEvents",t)}}},discountNinja_Script_Api={IsDevelopment:function(){return"dev"==discountNinja.Core.Environment},UseProxy:function(){return!0===discountNinja.Settings.GetFlag("UseProxy")&&!1===discountNinja.Environment.Shopify.IsThemePreview()},Endpoint:function(t,i){return discountNinja_Script_Api.UseProxy()?"/apps/discountninja/"+t+"/v"+i:"https://api"+(discountNinja_Script_Api.IsDevelopment()?"-dev":"")+".discountninja.io/"+t+"/v"+i},CDN:function(){return discountNinja_Script_Api.UseProxy()?"/apps/discountninja/cdn/promotion":"https://cdn-promotion"+(discountNinja_Script_Api.IsDevelopment()?"-dev":"")+".discountninja.io/cache"}},discountNinja_Script_Badge={WrapperClass:"limoniapps-discountninja-badge-wrapper",BadgeClass:"limoniapps-discountninja-badge",Add:function(t,i,n,e){try{if(t.Badge){var o=function(t,i,n){try{if(!t)return"";var e=t.Badge,o=discountNinja.ShortCode.ReplaceAllPlaceHolders(t,discountNinja.TextSettings.GetText(!0===n?e.PrerequisiteText:e.Text,t),i);if(""===o||null===o)return null;var r="",a="limoniapps-dash";"small"==e.Stitch&&(r=a+" "+a+"-thin"),"large"==e.Stitch&&(r=a);var c=discountNinja.Utilities.jQuery()("#limoniapps-discountninja-badge-template").html();return c=discountNinja.TemplateParameter.Replace(c,"TEXT",o),c=discountNinja.TemplateParameter.Replace(c,"TOKEN",t.Token),c=discountNinja.TemplateParameter.Replace(c,"STYLE",e.Style),c=discountNinja.TemplateParameter.Replace(c,"POSITION",e.Position),c=discountNinja.TemplateParameter.Replace(c,"SIZE",e.Size),c=discountNinja.TemplateParameter.Replace(c,"DASH",r)}catch(t){return discountNinja.Logging.LogError("Badge.GetHtml",t),""}}(t,i,e);if(null===o)return;var r=discountNinja.Utilities.jQuery()(n).find("."+discountNinja_Script_Badge.BadgeClass+"[data-token="+t.Token+"]");if(r.length>0)discountNinja.Utilities.jQuery()(r).parent().html(o);else{var a='<div class="'+discountNinja_Script_Badge.WrapperClass+'">'+o+"</div>";discountNinja.Utilities.jQuery()(n).append(a)}}}catch(t){return discountNinja.Logging.LogError("Badge.Add",t),""}}},discountNinja_Script_Notification={AnimateOnReminderIntervalHandle:-1,DelayIntervalHandle:-1,Template:null,GetTemplate:function(){return null===discountNinja_Script_Notification.Template&&(discountNinja_Script_Notification.Template=discountNinja.Utilities.jQuery()("#limoniapps-discountninja-notification-template").html()),discountNinja_Script_Notification.Template},GetClass:function(){return"limoniapps-notification.active"},GetStyle:function(t){try{return t?t.Notification.Style:""}catch(t){return discountNinja.Logging.LogError("Notification.GetStyle",t),""}},GetText:function(t,i,n){try{return discountNinja.ShortCode.ReplaceAllPlaceHolders(i,discountNinja.TextSettings.GetText(t,i),n)}catch(t){return discountNinja.Logging.LogError("Notification.GetText",t),""}},GetTextForOffer:function(t){var i=discountNinja.DiscountTier.GetCurrentDiscountTier(t),n=discountNinja.DiscountTier.GetPercentageAmountFromDiscountTier(i),e=t.Notification;return{Header:discountNinja.TextSettings.WrapInColor(e.HeaderTextColor,discountNinja_Script_Notification.GetText(e.Header,t,n)),Footer:discountNinja.TextSettings.WrapInColor(e.FooterTextColor,discountNinja_Script_Notification.GetText(e.Footer,t,n)),TimerFooter:discountNinja.TextSettings.WrapInColor(e.TimerFooterTextColor,discountNinja.Timer.IsTimerStarted()?discountNinja_Script_Notification.GetText(e.TimerFooter,t,n):""),MinimizedText:discountNinja.TextSettings.WrapInColor(e.MinimizedTextColor,discountNinja_Script_Notification.GetText(e.MinimizedText,t,n))}},GetHtml:function(t,i){function n(t,i){""!==t&&i.push(t)}try{var e=i.Notification,o=discountNinja_Script_Notification.AppSettings(),r=discountNinja_Script_Notification.GetTextForOffer(i),a=discountNinja.Utilities.IsMobilePhone(),c=a&&e.PlacementVerticalMobile?e.PlacementVerticalMobile:e.PlacementVertical,u=[];n(o.MinimizeButton?"limoniapps-minimizable maximized":"",u),n(o.CloseButton?"closeable":"",u),n(o.OfferCounter?"limoniapps-hasoffercount":"",u),n("active",u),a&&n("limoniapps-mobile",u),n(c+"-"+e.PlacementHorizontal,u),n(e.HasImage?"":"limoniapps-noimage",u),n(e.HasImagePerItem?"limoniapps-imageperitem":"",u);var s=u.join(" "),d=discountNinja_Script_Notification.GetTemplate();return d=discountNinja.TemplateParameter.Replace(d,"HEADER",r.Header),d=discountNinja.TemplateParameter.Replace(d,"MINIMIZED",r.MinimizedText),d=discountNinja.TemplateParameter.Replace(d,"BODY",t),d=discountNinja.TemplateParameter.Replace(d,"FOOTER",r.Footer),d=discountNinja.TemplateParameter.Replace(d,"TIMER_FOOTER",r.TimerFooter),d=discountNinja.TemplateParameter.Replace(d,"TOKEN",i.Token),d=discountNinja.TemplateParameter.Replace(d,"FLAGS",s),d=discountNinja.TemplateParameter.Replace(d,"OFFERCOUNT_FLAGS","active")}catch(t){return discountNinja.Logging.LogError("Notification.GetHtml",t),""}},Hiding:!1,Hide:function(t){try{var i=discountNinja.Utilities.jQuery()("."+discountNinja_Script_Notification.GetClass());i&&(discountNinja_Script_Notification.Hiding=!0,discountNinja_Script_Notification.ApplyAnimation(i,discountNinja_Script_Notification.AppSettings().AnimationExit),setTimeout((function(){try{discountNinja_Script_Notification.Hiding&&i.hide()}catch(t){discountNinja.Logging.LogError("Notification.Hide",t)}}),800)),t&&discountNinja_Script_Notification.SetHiddenInSession(!0)}catch(t){discountNinja.Logging.LogError("Notification.Hide",t)}},ToggleMinMaximize:function(){try{discountNinja_Script_Notification.IsMinimized()?discountNinja_Script_Notification.Maximize():discountNinja_Script_Notification.Minimize()}catch(t){discountNinja.Logging.LogError("Notification.ToggleMinMaximize",t)}},Minimize:function(){try{if("minimized"===discountNinja_Script_Notification.IsMinimized())return;discountNinja.Utilities.jQuery()("."+discountNinja_Script_Notification.GetClass()).removeClass("maximized").addClass("minimized"),discountNinja.Utilities.jQuery()(".limoniapps-offercount-minimized.active").removeClass("maximized").addClass("minimized"),discountNinja.Events.Publish("notification:minimized")}catch(t){discountNinja.Logging.LogError("Notification.Minimize",t)}},AppSettings:function(){try{return null===discountNinja.Settings.Settings?null:discountNinja.Settings.Settings.Notification}catch(t){discountNinja.Logging.LogError("Notification.AppSettings",t)}},DefaultOffer:function(){try{if(null===discountNinja.Offer.Offers||0===discountNinja.Offer.Offers.length)return null;if(discountNinja.Offer.PrimaryOffer&&discountNinja.Offer.PrimaryOffer.Notification&&discountNinja.Offer.PrimaryOffer.Notification.PlacementVertical)return discountNinja.Offer.PrimaryOffer;for(var t=0;t<discountNinja.Offer.Offers.length;t++){var i=discountNinja.Offer.Offers[t];if(discountNinja.Offer.IsOfferAccepted(i.Token,i.Frequency)&&i.Notification&&i.Notification.PlacementVertical)return i}return null}catch(t){discountNinja.Logging.LogError("Notification.DefaultOffer",t)}},Maximize:function(){try{if(!discountNinja_Script_Notification.IsMinimized())return;var t=discountNinja.Utilities.jQuery()("."+discountNinja_Script_Notification.GetClass());t&&(discountNinja_Script_Notification.ActAfterDelay(),t.css("transition","unset"),t.removeClass("minimized").addClass("maximized"),discountNinja.Utilities.jQuery()(".limoniapps-offercount-minimized.active").removeClass("minimized").addClass("maximized"),t.css("transition","all 0.5s ease -in -out 0s"),discountNinja.Events.Publish("notification:maximized"))}catch(t){discountNinja.Logging.LogError("Notification.Maximize",t)}},Clear:function(){discountNinja.Cache.SessionRemove("notificationinfo-data")},Remove:function(t){try{for(var i=discountNinja_Script_Notification.GetFromCache(),n=[],e=0;e<i.length;e++)i[e].Token!==t&&n.push(i[e]);0===n.length&&discountNinja_Script_Notification.Hide(),discountNinja_Script_Notification.SaveToCache(n),discountNinja_Script_Notification.UpdateOfferCounter(n.length)}catch(t){discountNinja.Logging.LogError("Notification.Remove",t)}},GetOfferCounterElement:function(){try{return discountNinja.Utilities.jQuery()("."+discountNinja_Script_Notification.GetClass()+" .limoniapps-offercount,.limoniapps-offercount-minimized.active")}catch(t){discountNinja.Logging.LogError("Notification.UpdateOfferCounter",t)}},UpdateOfferCounter:function(t){try{discountNinja_Script_Notification.GetOfferCounterElement().text(t.length)}catch(t){discountNinja.Logging.LogError("Notification.UpdateOfferCounter",t)}},GetFromCache:function(){try{var t=discountNinja.Cache.SessionGet("notificationinfo-data");return null===(t="undefined"===t?[]:JSON.parse(t))?[]:t}catch(t){return discountNinja.Logging.LogError("Notification.GetFromCache",t),[]}},SaveToCache:function(t){try{discountNinja.Cache.SessionSet("notificationinfo-data",JSON.stringify(t))}catch(t){discountNinja.Logging.LogError("Notification.SaveToCache",t)}},Add:function(t){try{t||discountNinja.Logging.LogErrorMessage("Notification.Add","Expected token");for(var i=discountNinja_Script_Notification.GetFromCache(),n=0;n<i.length;n++)if(i[n]&&i[n].Token===t)return;i.push({Token:t,Animated:!1}),discountNinja_Script_Notification.SaveToCache(i),discountNinja_Script_Notification.UpdateOfferCounter(i)}catch(t){discountNinja.Logging.LogError("Notification.Add",t)}},ClearAnimation:function(t){try{var i=discountNinja_Script_Notification.AppSettings();t.removeClass(i.AnimationEnter),t.removeClass(i.AnimationEnterMobile),t.removeClass(i.AnimationOnReminder),t.removeClass(i.AnimationExit),t.removeClass("animated shake flash bounce rotateIn")}catch(t){discountNinja.Logging.LogError("Notification.ClearAnimation",t)}},ApplyAnimation:function(t,i,n){try{discountNinja_Script_Notification.ClearAnimation(t),t.addClass(i),n&&t.css("animation-iteration-count",n)}catch(t){discountNinja.Logging.LogError("Notification.ApplyAnimation",t)}},ActAfterDelay:function(){try{var t=discountNinja_Script_Notification.AppSettings();t.Delay&&t.Delay>0&&(clearInterval(discountNinja_Script_Notification.DelayIntervalHandle),discountNinja_Script_Notification.DelayIntervalHandle=setTimeout((function(){try{discountNinja_Script_Notification.GetUserToggledMinMaximize()||("hide"===t.HideMode?discountNinja_Script_Notification.Hide(!0):"minimize"===t.HideMode&&discountNinja_Script_Notification.Minimize())}catch(t){discountNinja.Logging.LogError("Notification.ActAfterDelay",t)}}),t.Delay))}catch(t){discountNinja.Logging.LogError("Notification.ActAfterDelay",t)}},HighlightNewOffers:function(t){try{setTimeout((function(){try{!function(t){try{if(!discountNinja_Script_Notification.AppSettings().AnimationOnReminder)return;setTimeout((function(){try{for(var i=0;i<t.length;i++){var n=discountNinja.Utilities.jQuery()("."+discountNinja_Script_Notification.GetClass()+' span[data-offer-token="'+t[i]+'"]');discountNinja_Script_Notification.ApplyAnimation(n,"animated shake",1)}}catch(t){discountNinja.Logging.LogError("Notification.AnimateNewPromotionNotifications",t)}}),500),setTimeout((function(){try{for(var i=0;i<t.length;i++){var n=discountNinja.Utilities.jQuery()("."+discountNinja_Script_Notification.GetClass()+' span[data-offer-token="'+t[i]+'"]');discountNinja_Script_Notification.ApplyAnimation(n,"animated flash",3)}}catch(t){discountNinja.Logging.LogError("Notification.AnimateNewPromotionNotifications",t)}}),1500)}catch(t){discountNinja.Logging.LogError("Notification.HighlightNewOffers.HighlightNewOffers",t)}}(t),function(t){try{var i=discountNinja_Script_Notification.AppSettings();if(!i)return;i.OfferCounterAnimate&&t.length>0&&(discountNinja_Script_Notification.GetShownInSession()||discountNinja_Script_Notification.Maximize(),setTimeout((function(){try{discountNinja_Script_Notification.ApplyAnimation(discountNinja_Script_Notification.GetOfferCounterElement(),"animated bounce",2)}catch(t){discountNinja.Logging.LogError("Notification.HighlightNewOffers.AnimateCounter",t)}}),500))}catch(t){discountNinja.Logging.LogError("Notification.HighlightNewOffers.AnimateCounter",t)}}(t)}catch(t){discountNinja.Logging.LogError("Notification.HighlightNewOffers",t)}}),500)}catch(t){discountNinja.Logging.LogError("Notification.HighlightNewOffers",t)}},Show:function(){function t(i,n){discountNinja_Script_Notification.AnimateOnReminderIntervalHandle=setTimeout((function(){try{!function(){var t=discountNinja.Utilities.jQuery()("."+discountNinja_Script_Notification.GetClass());discountNinja_Script_Notification.ApplyAnimation(t,i)}(),t(i,n)}catch(t){discountNinja.Logging.LogError("Notification.AnimateOnReminder",t)}}),n)}function i(i,n,e,o){try{if(null==i||"<ul></ul>"===i)return;if(discountNinja_Script_Notification.GetDismissedInSession())return;if(discountNinja.Utilities.jQuery()("."+discountNinja_Script_Notification.GetClass()).length>0){discountNinja.Utilities.jQuery()(".limoniapps-notification .limoniapps-message-body .text-wrapper").html(n);var r=discountNinja.Utilities.jQuery()("."+discountNinja_Script_Notification.GetClass());discountNinja.Utilities.jQuery()(r).find("[data-offer-token]").each((function(){var t=discountNinja.Utilities.jQuery()(this).attr("data-offer-token"),i=discountNinja.Offer.GetOfferByToken(t),n=discountNinja.DiscountTier.GetCurrentDiscountTier(i),e=discountNinja.DiscountTier.GetPercentageAmountFromDiscountTier(n);discountNinja.ShortCode.RefreshResolvedPlaceholders(this,i,e)})),r.attr("data-token",o.Token);var a=discountNinja_Script_Notification.GetTextForOffer(o);r.find(".limoniapps-title.maximized .text-wrapper").html(a.Header),r.find(".limoniapps-title.minimized .text-wrapper").html(a.MinimizedText),r.find(".limoniapps-message-footer").html(a.Footer),r.find(".limoniapps-message-timerfooter").html(a.TimerFooter),discountNinja_Script_Timer.Update(),discountNinja_Script_Notification.ClearAnimation(r),discountNinja_Script_Notification.Hiding=!1,discountNinja.Utilities.jQuery()(r).show(),discountNinja_Script_Notification.IsMinimized()||discountNinja_Script_Notification.Maximize(),discountNinja_Script_Notification.HighlightNewOffers(e)}else!function(i,n,e){try{if(!e)return;var o=discountNinja_Script_Notification.AppSettings(),r=e.Notification,a=discountNinja_Script_Notification.GetShownInSession(),c=i.trim().replace(/'/g,"&#39;"),u=discountNinja.Utilities.jQuery()(c),s=u.filter(".limoniapps-offercount-minimized.active"),d=u.filter("."+discountNinja_Script_Notification.GetClass()),l=discountNinja.Utilities.IsMobilePhone(),g=l&&o.AnimationEnterMobile?o.AnimationEnterMobile:o.AnimationEnter,f=a||!g?null:g;f&&d.addClass(f);var p=((l&&r.PlacementVerticalMobile?r.PlacementVerticalMobile:r.PlacementVertical)||"bottom")+"-"+(r.PlacementHorizontal||"left");d.attr("data-notify-position",p),s.attr("data-notify-position",p),e&&d.attr("data-token",e.Token);var N=discountNinja.Utilities.jQuery()("body");N.prepend(s),N.prepend(d),discountNinja_Script_Timer.Update();var j=discountNinja.Utilities.jQuery()("."+discountNinja_Script_Notification.GetClass()+",.limoniapps-offercount-minimized.active");discountNinja.Utilities.jQuery()(j).click((function(){discountNinja_Script_Notification.SetUserToggledMinMaximize(!0),discountNinja_Script_Notification.ToggleMinMaximize()})),discountNinja.Utilities.jQuery()(j).find(".limoniapps-close").click((function(){discountNinja_Script_Notification.SetUserToggledMinMaximize(!0),discountNinja.Utilities.jQuery()(j).hide(),discountNinja.Events.Publish("notification:closed")}));var C=discountNinja.Utilities.jQuery()(j).html();if(C){var m='"',S=new RegExp("'\"","g"),h=new RegExp("\"'","g"),_=C.replace(S,m).replace(h,m);_!==C&&discountNinja.Utilities.jQuery()(j).html(_)}a&&o.MinimizeAfterFirstView&&discountNinja_Script_Notification.Minimize(),discountNinja_Script_Notification.ActAfterDelay(),discountNinja_Script_Notification.SetShownInSession(!0),o.AnimationOnReminder&&(clearInterval(discountNinja_Script_Notification.AnimateOnReminderIntervalHandle),t(o.AnimationOnReminder,o.ReminderDuration)),discountNinja.Utilities.jQuery()(j).find("svg").show(),discountNinja_Script_Notification.HighlightNewOffers(n)}catch(t){return discountNinja.Logging.LogError("Notification.ShowInternalAfterEnsuringDependencies",t),!1}}(i,e,o)}catch(t){return discountNinja.Logging.LogError("Notification.ShowInternal",t),!1}}try{if(discountNinja_Script_Notification.GetHiddenInSession())return;var n=discountNinja_Script_Notification.GetFromCache();if(!n||0===n.length)return;for(var e=null,o=n.length>1?"<ul>":"",r=[],a=[],c=null,u=0;u<n.length;u++){e=n[u];var s=discountNinja.Offer.GetOfferByToken(e.Token);if(s){var d=discountNinja.DiscountTier.GetCurrentDiscountTier(s),l=!!d&&d.IsMaxTier,g=discountNinja.DiscountTier.GetPercentageAmountFromDiscountTier(d),f='data-offer-token="'+e.Token+'"',p='style="order:'+(s.Notification.Order||0)+'"',N=discountNinja_Script_Notification.GetText(s.Notification.Body,s,g);if(discountNinja.TextSettings.IsEmpty(N))continue;for(var j=!1,C=0;C<a.length;C++)if(a[C]===N){j=!0;break}if(j)continue;a.push(o),o=n.length>1?o+"<li "+f+" "+p+">"+N+"</li>":o+'<span style="display:block;" '+f+">"+N+"</span>",null===c&&(c=s),!1===e.Animated&&l&&r.push(e.Token)}}if(n.length>1&&(o+="</ul>"),a.length<1)return void discountNinja_Script_Notification.Hide(!1);setTimeout((function(){i(discountNinja_Script_Notification.GetHtml(o,c),o,r,c),function(t){try{for(var i=discountNinja_Script_Notification.GetFromCache(),n=0;n<i.length;n++){var e=i[n];e.Animated=!1;for(var o=0;o<t.length;o++)if(e.Token===t[o]){e.Animated=!0;break}}discountNinja_Script_Notification.SaveToCache(i)}catch(t){discountNinja.Logging.LogError("Notification.MarkNotificationsAsAnimated",t)}}(r),discountNinja_Script_Notification.UpdateOfferCounter(a)}),500)}catch(t){discountNinja.Logging.LogError("Notification.Show",t)}},GetUserToggledMinMaximize:function(){var t=discountNinja.Cache.SessionGet("notification-usertoggled");return"true"===t||!0===t},SetUserToggledMinMaximize:function(t){discountNinja.Cache.SessionSet("notification-usertoggled",t)},IsMinimized:function(){return discountNinja.Utilities.jQuery()(".limoniapps-notification.active").hasClass("minimized")},GetShownInSession:function(){var t=discountNinja.Cache.SessionGet("notification-displayed-insession");return"true"===t||!0===t},SetShownInSession:function(t){discountNinja.Cache.SessionSet("notification-displayed-insession",t)},GetDismissedInSession:function(){var t=discountNinja.Cache.SessionGet("notification-dismissed-insession");return"true"===t||!0===t},SetDismissedInSession:function(t){discountNinja.Cache.SessionSet("notification-dismissed",t)},GetHiddenInSession:function(){var t=discountNinja.Cache.SessionGet("notification-hidden-insession");return"true"===t||!0===t},SetHiddenInSession:function(t){discountNinja.Cache.SessionSet("notification-hidden-insession",t)}},discountNinja_Script_PopUp={GetElement:function(t){return discountNinja.Utilities.jQuery()(".limoniapps-popup[data-token='"+t+"']")},Hide:function(t){try{discountNinja_Script_PopUp.GetElement(t).hide()}catch(t){discountNinja.Logging.LogError("PopUp.Hide",t)}},InjectHtml:function(t,i){try{if(discountNinja_Script_PopUp.GetElement(t.Token).length>0)return void discountNinja.ShortCode.RefreshResolvedPlaceholders(discountNinja_Script_PopUp.GetElement(t.Token),t,i);var n=discountNinja.Utilities.IsMobilePhone()?t.PopUp.MobileSize:t.PopUp.Size,e=discountNinja.Utilities.jQuery()("#limoniapps-discountninja-popup-template").html();e=discountNinja.TemplateParameter.Replace(e,"HEADER",discountNinja.TextSettings.GetText(t.PopUp.Header,t)),e=discountNinja.TemplateParameter.Replace(e,"BODY",discountNinja.TextSettings.GetText(t.PopUp.Body,t)),e=discountNinja.TemplateParameter.Replace(e,"FOOTER",discountNinja.TextSettings.GetText(t.PopUp.Footer,t)),e=discountNinja.TemplateParameter.Replace(e,"NOTHANKSBUTTONLABEL",t.PopUp.NoThanksButtonLabel),e=discountNinja.TemplateParameter.Replace(e,"SIZE",n),e=discountNinja.TemplateParameter.Replace(e,"ACTIONBUTTON1LABEL",t.PopUp.ActionButton1Label),e=discountNinja.TemplateParameter.Replace(e,"ACTIONBUTTON1STYLE",t.PopUp.ActionButton1Style),e=discountNinja.TemplateParameter.Replace(e,"ACTIONBUTTON1SIZE",t.PopUp.ActionButton1Size),e=discountNinja.TemplateParameter.Replace(e,"ACTIONBUTTON2LABEL",t.PopUp.ActionButton2Label),e=discountNinja.TemplateParameter.Replace(e,"ACTIONBUTTON2STYLE",t.PopUp.ActionButton2Style),e=discountNinja.TemplateParameter.Replace(e,"ACTIONBUTTON2SIZE",t.PopUp.ActionButton2Size),e=discountNinja.TemplateParameter.Replace(e,"BUTTONPLACEMENT","fullscreen"===n?"inside":t.PopUp.ButtonPlacement),e=discountNinja.TemplateParameter.Replace(e,"BACKGROUNDOVERLAY",t.PopUp.BackgroundOverlay),e=discountNinja.TemplateParameter.Replace(e,"SHAPE",t.PopUp.Shape),e=discountNinja.TemplateParameter.Replace(e,"CONTENTALIGNMENTHORIZONTAL",t.PopUp.ContentAlignmentHorizontal),e=discountNinja.TemplateParameter.Replace(e,"CONTENTALIGNMENTVERTICAL",t.PopUp.ContentAlignmentVertical),e=discountNinja.TemplateParameter.Replace(e,"BACKGROUNDTOPCOLORHEIGHT",t.PopUp.ContentAlignmentVertical),e=discountNinja.TemplateParameter.Replace(e,"BACKGROUNDTOPCOLORRADIUS",t.PopUp.BackgroundColorTopHeight),e=discountNinja.TemplateParameter.Replace(e,"BACKGROUNDTOPCOLORRADIUS",t.PopUp.BackgroundColorTopRadius),e=discountNinja.TemplateParameter.Replace(e,"TOKEN",t.Token);var o=function(t){var i=document.createDocumentFragment(),n=document.createElement("div");for(n.innerHTML=t;n.firstChild;)i.appendChild(n.firstChild);return i}(e=discountNinja.ShortCode.ReplaceAllPlaceHolders(t,e,i));document.body.insertBefore(o,document.body.childNodes[0])}catch(t){discountNinja.Logging.LogError("PopUp.InjectPopUpHtml",t)}},Show:function(t,i){function n(t,i){try{discountNinja.Offer.SetPromotionAccepted(t.Token,t.Frequency,"false"),discountNinja_Script_PopUp.Hide(t.Token),discountNinja.Offer.Stop()}catch(t){discountNinja.Logging.LogError("PopUp.Cancel",t)}}function e(t,i){discountNinja.Cache.LocalSet("popup-displayed-"+t,i)}try{discountNinja_Script_PopUp.InjectHtml(t,i);var o=t.Token;discountNinja.DiscountCode.RemoveFromCacheByToken(o),discountNinja.Offer.RemoveFromCache(t);var r=discountNinja_Script_PopUp.GetElement(o);r.find('.limoniapps-close[data-notify="dismiss"]').click((function(){n(t)})),r.find(".limoniapps-lnk-dismiss").click((function(){n(t)})),r.find('.limoniapps-action-btn[data-action="apply"]').click((function(){!function(t,i){try{discountNinja_Script_PopUp.Hide(t.Token),discountNinja.PromotionFlow.AcceptPromotion(t,i),discountNinja.PromotionFlow.StopFlow()}catch(t){discountNinja.Logging.LogError("PopUp.Accept",t)}}(t,i)})),a=r.find(".limoniapps-content"),c=t.PopUp.Animation,u=t.PopUp,discountNinja.Utilities.jQuery()(a).removeClass(u.Animation),discountNinja.Utilities.jQuery()(a).addClass(c),r.show(),function(t){"onceperdevice"===t.PopUp.Frequency?e(t.Token,"shown"):(e(t.Token,""),function(t,i){discountNinja.Cache.SessionSet("popup-displayed-"+t,i)}(t.Token,"shown"))}(t),discountNinja_Script_PopUp.PopUpDisplayed=!0}catch(t){discountNinja.Logging.LogError("PopUp.Show",t)}var a,c,u}},discountNinja_Script_StickyBar={AnimateOnReminderIntervalHandle:-1,CycleIntervalHandle:-1,CurrentLevelForPromotion:[],TemplateId:"limoniapps-discountninja-stickybar-template",WrapperId:"limoniapps-discountninja-stickybar-wrapper",PusherId:"limoniapps-discountninja-stickybar-pusher",TopMarginClass:"limoniapps-discountninja-stickybar-topmargin",TopMarginClass2:"limoniapps-discountninja-topmargin",HeaderSectionClass:"limoniapps-discountninja-headersection",TopMarginApplied:-1,Template:null,GetTemplate:function(){var t=discountNinja_Script_StickyBar;return null===t.Template&&(t.Template=discountNinja.Utilities.jQuery()("#"+t.TemplateId).html()),t.Template},GetPusherElement:function(){return discountNinja.Utilities.jQuery()("#"+discountNinja_Script_StickyBar.PusherId)},GetWrapperElement:function(){return discountNinja.Utilities.jQuery()("#"+discountNinja_Script_StickyBar.WrapperId)},AppSettings:function(){try{return null===discountNinja.Settings.Settings?null:discountNinja.Settings.Settings.StickyBar}catch(t){return discountNinja.Logging.LogError("StickyBar.AppSettings",t),null}},ActiveStickyBar:function(){try{var t=discountNinja_Script_StickyBar,i=t.GetFromCache();t.CurrentMessageIndex>=i.length&&(t.CurrentMessageIndex=0);var n=t.CurrentMessageIndex||0,e=i[n];return e||(discountNinja.Logging.LogErrorMessage("StickyBar.ActiveStickyBar","Sticky bar "+n+" not found"),null)}catch(t){return discountNinja.Logging.LogError("StickyBar.ActiveStickyBar",t),null}},DefaultOffer:function(){try{if(null===discountNinja.Offer.Offers||0===discountNinja.Offer.Offers.length)return null;if(discountNinja.Offer.PrimaryOffer&&discountNinja.Offer.PrimaryOffer.StickyBar&&discountNinja.Offer.PrimaryOffer.StickyBar.PlacementVertical)return discountNinja.Offer.PrimaryOffer;for(var t=0;t<discountNinja.Offer.Offers.length;t++){var i=discountNinja.Offer.Offers[t];if(i.StickyBar&&i.StickyBar.PlacementVertical&&(discountNinja.Offer.IsOfferAccepted(i.Token,i.Frequency)||i.StickyBar.ActionButton1&&"applydiscount"===i.StickyBar.ActionButton1.Action||i.StickyBar.ActionButton2&&"applydiscount"===i.StickyBar.ActionButton2.Action))return i}return null}catch(t){discountNinja.Logging.LogError("StickyBar.DefaultOffer",t)}},ShouldRequestNotification:function(){try{return!!pushowl&&!pushowl.browserHandler.isPermissionGranted}catch(t){return discountNinja.Logging.LogError("StickyBar.ShouldRequestNotification",t),!1}},RequestNotification:function(){try{if(!pushowl)return!1;pushowl.subscribeIfNotAlready()}catch(t){discountNinja.Logging.LogError("StickyBar.RequestNotification",t)}},SlideBodyDownLastExecuted:null,SlideBodyDown:function(){function t(t,i){try{var n=[],e=discountNinjaContext.Flags[t];if(e&&""!==e)n.push(e);else if(discountNinja.Settings&&discountNinja.Settings.Settings){var o=discountNinja.Settings.Settings.PriceUpdate.Mode[i];o&&""!==o&&n.push(o)}return n}catch(t){return discountNinja.Logging.LogError("StickyBar.TopMarginElementsInner",t),[]}}function i(i,n){return function(t,i){for(var n=[],e=0;e<i.length;e++)for(var o=i[e].split(","),r=0;r<o.length;r++)n.push(t.replace("[[SELECTOR]]",o[r]));return n.join(",")}(n+" [[SELECTOR]]",function(i){try{var n=[],e=discountNinja.Utilities.IsMobilePhone()?"Mobile":"Desktop";return(n=n.concat(t(i,i))).concat(t(i+e,i+e))}catch(t){return discountNinja.Logging.LogError("StickyBar.TopMarginElements",t),[]}}(i))}function n(t,n,e){var o=i(t,n);return""===o?"":" "+o+" "+e}try{if(a=discountNinja_Script_StickyBar.SlideBodyDownLastExecuted,c=!0,null!==a&&new Date-a<50&&(c=!1),discountNinja_Script_StickyBar.SlideBodyDownLastExecuted=new Date,!c)return;if(discountNinja_Script_StickyBar.GetHiddenInSession())return;var e=discountNinja_Script_StickyBar.DefaultOffer(),o=e?e.StickyBar:null;if(null===o)return;if("top_page_sticky"===o.PlacementVertical||"top_page"===o.PlacementVertical){var r=discountNinja.Settings.GetFlag("StickyBarRenderingDelay")||0;r<50&&(r=50),setTimeout((function(){var t=discountNinja_Script_StickyBar.GetWrapperElement().outerHeight()||50;discountNinja_Script_StickyBar.GetPusherElement().height(t),function(t){try{var i="limoniapps-stickybar-topmargin";if(discountNinja.Utilities.jQuery()("#"+i).attr("data-config")===t.toString())return;discountNinja_Script_StickyBar.TopMarginApplied=t;var e=discountNinja_Script_StickyBar.TopMarginClass;document.body.classList.add(e);var o="{ margin-top: "+t.toString()+"px !important;background-position: 0% "+t.toString()+"px !important; }",r="{ transform: translateY("+t.toString()+"px) !important; }",a="limoniapps-discountninja-topmargin",c="."+e+":not(."+a+"-ignore)"+","+("."+e+" ."+a+":not(."+a+"-ignore)")+",."+e+" ."+a+"-"+(discountNinja.Utilities.IsMobilePhone()?"mobile":"desktop")+":not(."+a+"-ignore),.limoniapps-discountninja-header, .limoniapps-discounturl-header"+o;c+=n("StickyBarShouldPushSelectors","."+e,o);var u=n("StickyBarShouldPushSelectorsTransform","."+e,r);discountNinja.Utilities.AddInlineCssToDocument(u+" "+c,i,t)}catch(t){discountNinja.Logging.LogError("StickyBar.AddTopMarginToElements",t)}}(t)}),r)}}catch(t){discountNinja.Logging.LogError("StickyBar.SlideBodyDown",t)}var a,c},RemoveStickyBarClasses:function(){function t(t){try{document.querySelectorAll("."+t).forEach((function(i){i.classList.remove(t),i.classList.add(t+"-hidden")}))}catch(t){discountNinja.Logging.LogError("StickyBar.RemoveCssClass",t)}}t(discountNinja_Script_StickyBar.TopMarginClass),t(discountNinja_Script_StickyBar.TopMarginClass+"-transform"),t(discountNinja_Script_StickyBar.TopMarginClass2),t(discountNinja_Script_StickyBar.TopMarginClass2+"-transform")},ReactivateStickyBarClasses:function(){function t(t){try{document.querySelectorAll("."+t+"-hidden").forEach((function(i){i.classList.remove(t+"-hidden"),i.classList.add(t.replace("-hidden",""))}))}catch(t){discountNinja.Logging.LogError("StickyBar.RemoveCssClass",t)}}t(discountNinja_Script_StickyBar.TopMarginClass),t(discountNinja_Script_StickyBar.TopMarginClass+"-transform"),t(discountNinja_Script_StickyBar.TopMarginClass2),t(discountNinja_Script_StickyBar.TopMarginClass2+"-transform")},OnAction:function(t,i,n){try{var e=1===t?i.StickyBar.ActionButton1:i.StickyBar.ActionButton2;discountNinja.ActionButton.HandleAction(e,i,n)}catch(t){discountNinja.Logging.LogError("StickyBar.OnAction",t)}},Hide:function(t){function i(t){try{discountNinja_Script_StickyBar.GetWrapperElement().hide();var i=discountNinja_Script_StickyBar.DefaultOffer();i&&i.StickyBar;discountNinja_Script_StickyBar.RemoveStickyBarClasses(),t&&discountNinja_Script_StickyBar.SetHiddenInSession(!0),discountNinja.Events.Publish("stickybar:closed")}catch(t){discountNinja.Logging.LogError("StickyBar.HideInner",t)}}try{var n=discountNinja_Script_StickyBar.AppSettings();n.AnimationExit?(discountNinja_Script_StickyBar.ApplyAnimation(discountNinja_Script_StickyBar.GetWrapperElement(),n.AnimationExit),i(t)):i(t)}catch(t){discountNinja.Logging.LogError("StickyBar.Hide",t)}},Remove:function(t){try{for(var i=discountNinja_Script_StickyBar.GetFromCache(),n=[],e=0;e<i.length;e++)i[e].Token!==t&&n.push(i[e]);discountNinja_Script_StickyBar.MessageCount=n.length,discountNinja_Script_StickyBar.SaveToCache(n),setTimeout((function(){try{discountNinja_Script_StickyBar.Show()}catch(t){discountNinja.Logging.LogError("StickyBar.Remove",t)}}),500)}catch(t){discountNinja.Logging.LogError("StickyBar.Remove",t)}},Clear:function(){discountNinja_Script_StickyBar.MessageCount=0,discountNinja.Cache.SessionRemove("stickybar-data")},GetFromCache:function(){try{var t=discountNinja.Cache.SessionGet("stickybar-data"),i=null===(t="undefined"===t?[]:JSON.parse(t))?[]:t;return discountNinja_Script_StickyBar.MessageCount=i.length,i}catch(t){return discountNinja.Logging.LogError("StickyBar.GetFromCache",t),[]}},SaveToCache:function(t){try{discountNinja.Cache.SessionSet("stickybar-data",JSON.stringify(t))}catch(t){discountNinja.Logging.LogError("StickyBar.SaveToCache",t)}},Add:function(t,i,n){try{t||discountNinja.Logging.LogErrorMessage("StickyBar.Add","Expected token");for(var e=discountNinja_Script_StickyBar.GetFromCache(),o=0;o<e.length;o++)if(e[o]&&e[o].Token===t)return;e.push({Token:t,PlacementVertical:i,Order:n}),discountNinja_Script_StickyBar.MessageCount=e.length,discountNinja_Script_StickyBar.AllCyclesFailed=!1,discountNinja_Script_StickyBar.FirstFailedCycle=null,e=e.sort((function(t,i){return t.Order-i.Order})),discountNinja_Script_StickyBar.SaveToCache(e)}catch(t){discountNinja.Logging.LogError("StickyBar.Add",t)}},CurrentMessageIndex:0,MessageCount:0,FirstFailedCycle:null,AllCyclesFailed:!1,CycleMessage:function(t){function i(t,n){try{if(discountNinja_Script_StickyBar.MessageCount<=1||discountNinja_Script_StickyBar.AllCyclesFailed)return;if(discountNinja_Script_StickyBar.CurrentMessageIndex=discountNinja_Script_StickyBar.CurrentMessageIndex+1,n&&discountNinja_Script_StickyBar.CurrentMessageIndex===discountNinja_Script_StickyBar.FirstFailedCycle)return discountNinja_Script_StickyBar.AllCyclesFailed=!0,void discountNinja_Script_StickyBar.Hide(!1);if(!discountNinja_Script_StickyBar.ShowMessage(t))return null===discountNinja_Script_StickyBar.FirstFailedCycle&&(discountNinja_Script_StickyBar.FirstFailedCycle=discountNinja_Script_StickyBar.CurrentMessageIndex),i(t,!0);discountNinja_Script_StickyBar.FirstFailedCycle=null,discountNinja_Script_StickyBar.AllCyclesFailed=!1,t=!0}catch(t){discountNinja.Logging.LogError("StickyBar.CycleMessage.CycleMessageInner",t)}}try{var n=discountNinja_Script_StickyBar.AppSettings(),e=n.Cycle.DurationMilliseconds>0?n.Cycle.DurationMilliseconds:6e3;discountNinja_Script_StickyBar.CycleIntervalHandle>0&&clearInterval(discountNinja_Script_StickyBar.CycleIntervalHandle),i(t),discountNinja_Script_StickyBar.CycleIntervalHandle=setInterval((function(){i(t)}),e)}catch(t){discountNinja.Logging.LogError("StickyBar.CycleMessage",t)}},ClearAnimation:function(t){try{var i=discountNinja_Script_StickyBar.AppSettings();discountNinja.Utilities.jQuery()(t).removeClass(i.AnimationEnter),discountNinja.Utilities.jQuery()(t).removeClass(i.AnimationOnGoal),discountNinja.Utilities.jQuery()(t).removeClass(i.AnimationOnReminder),discountNinja.Utilities.jQuery()(t).removeClass(i.AnimationExit),discountNinja.Utilities.jQuery()(t).removeClass(i.Cycle.AnimationOnCyle)}catch(t){discountNinja.Logging.LogError("StickyBar.ClearAnimation",t)}},ApplyAnimation:function(t,i){try{if(!i)return;discountNinja_Script_StickyBar.ClearAnimation(t),discountNinja.Utilities.jQuery()(t).addClass(i)}catch(t){discountNinja.Logging.LogError("StickyBar.ApplyAnimation",t)}},ShowMessage:function(t){function i(t,i){try{return discountNinja.Timer.IsTimerStarted()?discountNinja.TextSettings.WrapInColor(t.StickyBar.TimerFooterTextColor,discountNinja.ShortCode.ReplaceAllPlaceHolders(t,discountNinja.TextSettings.GetText(t.StickyBar.TimerFooter,t),i)):""}catch(t){return discountNinja.Logging.LogError("StickyBar.GetTimerFooterMessage",t),""}}function n(t){if(t.StickyBar.AnimationOnGoal){var i=discountNinja.DiscountTier.GetCurrentDiscountTier(t),n=discountNinja_Script_StickyBar.CurrentLevelForPromotion[t.Token];(void 0!==n?n<i:i>0)&&(discountNinja_Script_StickyBar.CurrentLevelForPromotion[t.Token]=i,e=discountNinja_Script_StickyBar.AppSettings.AnimationOnGoal,o=discountNinja.Utilities.jQuery()(".limoniapps-sticky-bar .limoniapps-content"),discountNinja_Script_StickyBar.ApplyAnimation(o,e))}var e,o}function e(t,i,n){if(discountNinja.TextSettings.IsEmpty(i)&&discountNinja.TextSettings.IsEmpty(n))return!1;var e=discountNinja_Script_StickyBar.GetHtml(t);return discountNinja_Script_StickyBar.Render(e,t),!0}try{var o=discountNinja_Script_StickyBar.ActiveStickyBar();if(null===o)return;var r=discountNinja.Offer.GetOfferByToken(o.Token);if(!r)return;var a=function(t,i){try{return discountNinja.TextSettings.WrapInColor(t.StickyBar.BodyTextColor,discountNinja.ShortCode.ReplaceAllPlaceHolders(t,discountNinja.TextSettings.GetText(t.StickyBar.Body,t),i))}catch(t){return discountNinja.Logging.LogError("StickyBar.GetBodyMessage",t),""}}(r,s),c=i(r,s);if(discountNinja.TextSettings.IsEmpty(a))return;var u=discountNinja.DiscountTier.GetCurrentDiscountTier(r),s=discountNinja.DiscountTier.GetPercentageAmountFromDiscountTier(u),d=r.StickyBar,l=discountNinja_Script_StickyBar.AppSettings(),g=discountNinja_Script_StickyBar.GetWrapperElement(),f=discountNinja.Utilities.jQuery()(g).find(".limoniapps-col-info"),p=l.Cycle.AnimationOnCyle;if(t&&p&&discountNinja_Script_StickyBar.MessageCount>0){var N=function(t){var i=t.split(" ");return 3===i.length?i[0]+" "+i[2]:i[0]+" "+i[1]}(p),j=function(t){var i=t.split(" ");return i[0]+" "+i[1]}(p);if(j!==N)discountNinja_Script_StickyBar.ApplyAnimation(f,j),setTimeout((function(){try{if(c=i(r),!e(r,a,c))return!1;discountNinja.Utilities.jQuery()(f).hide(),setTimeout((function(){try{discountNinja.Utilities.jQuery()(f).show(),discountNinja_Script_StickyBar.ApplyAnimation(f,N)}catch(t){discountNinja.Logging.LogError("StickyBar.Show",t)}}),50),n(r)}catch(t){discountNinja.Logging.LogError("StickyBar.Show",t)}}),500);else{if(!e(r,a,c))return!1;discountNinja_Script_StickyBar.ApplyAnimation(f,N)}}else if(!e(r,a,c))return!1;return d.ActionButton1&&(discountNinja.ActionButton.HideIfNecessary(d.ActionButton1,r,1),g.find(".limoniapps-action.button1 .limoniapps-action-btn").click((function(){try{discountNinja_Script_StickyBar.OnAction(1,r,s)}catch(t){return discountNinja.Logging.LogError("StickyBar.Show.ActionButton1Click",t),!1}}))),d.ActionButton2&&(discountNinja.ActionButton.HideIfNecessary(d.ActionButton2,r,2),g.find(".limoniapps-action.button2 .limoniapps-action-btn").click((function(){try{discountNinja_Script_StickyBar.OnAction(2,r,s)}catch(t){return discountNinja.Logging.LogError("StickyBar.Show.ActionButton2Click",t),!1}}))),discountNinja_Script_Timer.Update(),setTimeout((function(){discountNinja_Script_StickyBar.SlideBodyDown()}),50),n(r),!0}catch(t){return discountNinja.Logging.LogError("StickyBar.ShowMessage",t),!1}},GetHtml:function(t){function i(t,i){""!==t&&i.push(t)}try{var n=t.StickyBar,e=discountNinja_Script_StickyBar.GetTemplate(),o=discountNinja.DiscountTier.GetCurrentDiscountTier(t),r=discountNinja.DiscountTier.GetPercentageAmountFromDiscountTier(o),a=discountNinja_Script_Notification.GetText(n.Body,t,r),c=discountNinja.TextSettings.WrapInColor(n.BodyTextColor,a),u=discountNinja.TextSettings.WrapInColor(n.TimerFooterTextColor,discountNinja.Timer.IsTimerStarted()?discountNinja_Script_Notification.GetText(n.TimerFooter,t,r):""),s=[];i(n.CloseButton?"closeable":"",s),i(n.ActionButton1?"hasaction1":"",s),i(n.ActionButton2?"hasaction2":"",s),i(n.HasImage?"hasimage":"",s);var d=s.join(" "),l=function(t,i){return i?(!0===t?"onclick=\"javascript: window.open('[[LINK]]', '_blank')\"":"onclick=\"javascript: window.location = '[[LINK]]'\"").replace("[[LINK]]",i)+' style="cursor:pointer"':""}(n.LinkInNewTab,n.Link);return e=discountNinja.TemplateParameter.Replace(e,"BODY",c),e=discountNinja.TemplateParameter.Replace(e,"TIMERFOOTER",u),e=discountNinja.TemplateParameter.Replace(e,"TIMER_FOOTER",u),e=discountNinja.TemplateParameter.Replace(e,"HEIGHT",discountNinja.Utilities.IsMobilePhone()?n.MobileHeight:n.Height),e=discountNinja.TemplateParameter.Replace(e,"FLAGS",d),e=discountNinja.TemplateParameter.Replace(e,'LINK=""',l),e=discountNinja.TemplateParameter.Replace(e,"LINK",l),e=discountNinja.TemplateParameter.Replace(e,"TOKEN",t.Token),e=discountNinja.TemplateParameter.Replace(e,"WIDTH",n.Width?n.Width:""),e=discountNinja.ActionButton.ReplacePlaceHoldersForButton(e,t,r,1,n.ActionButton1),e=discountNinja.ActionButton.ReplacePlaceHoldersForButton(e,t,r,2,n.ActionButton2)}catch(t){return discountNinja.Logging.LogError("StickyBar.GetHtml",t),null}},Render:function(t,i){var n=discountNinja_Script_StickyBar.GetWrapperElement();n.html(t);var e=i.StickyBar;e&&(e.CloseButton&&n.find('.limoniapps-close[data-notify="dismiss"]').click((function(){try{discountNinja_Script_StickyBar.Hide(!0)}catch(t){return discountNinja.Logging.LogError("StickyBar.Show.Dismiss",t),!1}})),n.css("background-color",e.BackgroundColor))},Show:function(){try{var t=discountNinja_Script_StickyBar;if(t.GetHiddenInSession())return;if(t.ReactivateStickyBarClasses(),t.MessageCount<=0)return void t.Hide();var i=t.ActiveStickyBar(),n=t.DefaultOffer(),e=null===i?n:discountNinja.Offer.GetOfferByToken(i.Token);if(!e)return;var o=e.StickyBar,r=n.StickyBar,a=t.AppSettings(),c=t.GetWrapperElement(),u=discountNinja.Utilities.jQuery()(c).is(":visible"),s="true"===discountNinja.Cache.SessionGet("stickybar-displayed-insession");if(!u){var d="limoniapps-stick-to-"+r.PlacementVertical;S=!0,discountNinja.Cache.SessionSet("stickybar-displayed-insession",S);var l=t.GetHtml(e);if(null===l)return;var g=(0===t.GetPusherElement().length?'<div id="limoniapps-discountninja-stickybar-pusher" class="limoniapps-sticky-bar-pusher"></div>':"")+'<div id="'+t.WrapperId+'" class="'+d+'" style="display:none;">'+l+"</div>";if("top_header"===o.PlacementVertical){var f=t.HeaderSectionClass,p=discountNinja.Utilities.jQuery()("."+f);if(0===p.length){var N=discountNinja.Utilities.IsMobilePhone()?"mobile":"desktop";p=discountNinja.Utilities.jQuery()("."+f+"-"+N)}0===p.length&&(p=discountNinja.Utilities.jQuery()("#shopify-section-header")),0===p.length?(discountNinja.Logging.LogWarning("Sticky bar could not be positioned under header. Header not found. Mark it with the CSS class: "+t.HeaderSectionClass,!0),o.PlacementVertical="top_page",discountNinja.Utilities.jQuery()("body").prepend(g)):(p.addClass(f+"-active"),p.append(g))}else discountNinja.Utilities.jQuery()("body").prepend(g);c=t.GetWrapperElement(),t.Render(l,e)}var j=a.Delay;if(j&&j>0&&setTimeout((function(){t.Hide(!0)}),j),t.CurrentMessageIndex=0,"cycle"===a.Cycle.Mode&&t.MessageCount>1)clearInterval(t.CycleIntervalHandle),t.CycleMessage(!1);else if(!t.ShowMessage(!1))return void t.Hide(!1);setTimeout((function(){t.AllCyclesFailed||t.SlideBodyDown()}),50),a.AnimationOnReminder&&(clearInterval(t.AnimateOnReminderIntervalHandle),function i(n,e){setTimeout((function(){try{t.ApplyAnimation(discountNinja.Utilities.jQuery()(".limoniapps-sticky-bar .limoniapps-col-info"),n),i(n,e)}catch(t){discountNinja.Logging.LogError("StickyBar.AnimateOnReminder",t)}}),e)}(a.AnimationOnReminder,a.ReminderDuration)),discountNinja.Utilities.jQuery()(window).on("resize",(function(){t.SlideBodyDown()}));var C=discountNinja.Utilities.IsMobilePhone()&&a.AnimationEnterMobile?a.AnimationEnterMobile:a.AnimationEnter,m=u||s||!C?"":C;""!==m&&t.ApplyAnimation("#"+t.WrapperId,m),c.show()}catch(t){return discountNinja.Logging.LogError("StickyBar.Show",t),!1}var S},GetHiddenInSession:function(){var t=discountNinja.Cache.SessionGet("stickybar-hidden-insession");return"true"===t||!0===t},SetHiddenInSession:function(t){discountNinja.Cache.SessionSet("stickybar-hidden-insession",t)}},discountNinja_Script_Timer={TimeZone:null,TimerIntervalId:null,EndsAt:null,Start:function(t){try{if(discountNinja_Script_Timer.EndsAt=t?t.TriggeredByTrigger.CountdownClock.EndsAt:null,!discountNinja_Script_Timer.EndsAt)return;if(discountNinja_Script_Timer.TimerExpiresIn()<=0)return;var i=discountNinja.Settings.Settings;if(!i||!i.CountdownClock)return;!function(t){function i(t){try{return t&&""!==t?[t,t,t]:null}catch(t){return discountNinja.Logging.LogError("Timer.ProcessCustomTimeLabels",t),null}}try{var n=i(t.CustomDaysLabel)||["days","days","d"],e=i(t.CustomHoursLabel)||["hours","hrs","h"],o=i(t.CustomMinutesLabel)||["minutes","min","m"],r=i(t.CustomSecondsLabel)||["seconds","sec","s"],a=i(t.CustomAndLabel)||["and","&","&"];discountNinja_Script_Timer.TimerLabels=[n,e,o,r,a]}catch(t){discountNinja.Logging.LogError("Timer.ProcessCountdownClock",t)}}(i.CountdownClock),null!==discountNinja_Script_Timer.TimerIntervalId&&0!==discountNinja_Script_Timer.TimerIntervalId&&clearInterval(discountNinja_Script_Timer.TimerIntervalId),discountNinja_Script_Timer.TimerIntervalId=window.setInterval((function(){discountNinja_Script_Timer.Update()}),1e3),discountNinja_Script_Timer.Update(),discountNinja_Script_Timer.SetTimerStarted(!0)}catch(t){discountNinja.Logging.LogError("Timer.Start",t)}},TimerExpiresIn:function(){if(null===discountNinja_Script_Timer.EndsAt)return null;var t=discountNinja.DateTime,i=t.GetUtc(discountNinja_Script_Timer.EndsAt);return t.DiffInSeconds(i,t.UtcNow())},Update:function(){function t(t,i){try{return discountNinja_Script_Timer.TimerLabels[t][i]}catch(t){return discountNinja.Logging.LogError("Timer.GetTimeLabel",t),""}}function i(i,n,e){try{var o=discountNinja.DateTime,r=o.GetDuration(o.GetUtc(n),o.UtcNow()),a=function(t,i){try{return 1===i?t.CountdownClock.FormattingTemplateIn_Style1:2===i?t.CountdownClock.FormattingTemplateIn_Style2:3===i?t.CountdownClock.FormattingTemplateIn_Style3:4===i?t.CountdownClock.FormattingTemplateIn_Style4:5===i?t.CountdownClock.FormattingTemplateIn_Style5:t.CountdownClock.FormattingTemplateIn_Style1}catch(t){return discountNinja.Logging.LogError("Timer.GetFormattingForStyle",t),""}}(i,e);if(null===a)return"";for(var c=a,u="d,h,m,s".split(","),s=0;s<u.length;s++){if(r[l=u[s]]>0)c=c.replace("{"+l+"}","").replace("{\\"+l+"}","");else{var d="{"+l+"}(.)*{\\\\"+l+"}";c=c.replace(new RegExp(d),"")}}for(s=0;s<u.length;s++){var l=u[s];c=c.replace("["+l+"]",r[l])}for(s=0;s<5;s++)for(var g=0;g<2;g++)c=c.replace("["+s+","+g+"]",t(s,g));return c}catch(t){return discountNinja.Logging.LogError("Timer.TimeFormattingInternal",t),""}}try{var n=discountNinja.Settings.Settings;if(!n||!n.CountdownClock||null===discountNinja_Script_Timer.EndsAt)return;if(discountNinja_Script_Timer.TimerExpiresIn()>0){if("function"!=typeof dayjs)return void LimoniAppsLoadDayJs((function(){}));discountNinja.Utilities.jQuery()(".limoniapps-discountninja-timer").each((function(){var t=discountNinja.Utilities.jQuery()(this).attr("data-style"),e=i(n,discountNinja_Script_Timer.EndsAt,t);e=e.replace(/(\d)/g,'<div class="limoniapps-discountninja-countdownclock-digit-wrapper"><div class="limoniapps-discountninja-countdownclock-digit">$1</div></div>'),discountNinja.Utilities.jQuery()(this).html('<div class="limoniapps-discountninja-countdownclock-container style'+t+'">'+e+"</div>")}))}else!function(){try{discountNinja_Script_Timer.IsTimerStarted()&&(discountNinja_Script_Timer.SetTimerStarted(!1),null!==discountNinja_Script_Timer.TimerIntervalId&&0!==discountNinja_Script_Timer.TimerIntervalId&&clearInterval(discountNinja_Script_Timer.TimerIntervalId),location.reload())}catch(t){discountNinja.Logging.LogError("Timer.Expire",t)}}()}catch(t){discountNinja.Logging.LogError("Timer.UpdateTimer",t)}},Stop:function(){discountNinja_Script_Timer.SetTimerStarted(!1)},ShouldStartOn:function(t,i){return!!(t&&t.TriggeredByTrigger&&t.TriggeredByTrigger.CountdownClock)&&t.TriggeredByTrigger.CountdownClock.Trigger===i},ShouldStartOnDisplay:function(t){return discountNinja_Script_Timer.ShouldStartOn(t,"displayed")},ShouldStartOnAccept:function(t){return discountNinja_Script_Timer.ShouldStartOn(t,"accepted")},ShouldStartOnGoalAchieved:function(t){return discountNinja_Script_Timer.ShouldStartOn(t,"goalachieved")},ShouldNotStart:function(t){return!!(t&&t.TriggeredByTrigger&&t.TriggeredByTrigger.CountdownClock)&&!t.TriggeredByTrigger.CountdownClock.Trigger},IsTimerStarted:function(){return"true"===discountNinja.Cache.SessionGet("timer-started")},SetTimerStarted:function(t){discountNinja.Cache.SessionSet("timer-started",t)}},discountNinja_Script_DrawerCart={TemplateId:"limoniapps-discountninja-drawercart-template",ElementId:"limoniapps-discountninja-drawercart",Classes:{Open:"limoniapps-discountninja-drawercart-open",IsEmpty:"limoniapps-discountninja-drawercart-isempty",Wrapper:"limoniapps-discountninja-drawercart-wrapper",WrapperInner:"limoniapps-discountninja-drawercart-wrapper-inner"},Attributes:{Loading:"data-limoniapps-discountninja-drawercart-loading"},Open:function(){try{var t=discountNinja_Script_DrawerCart,i=document.getElementById(t.ElementId);i&&i.classList.add(t.Classes.Open)}catch(t){discountNinja.Logging.LogError("DrawerCart.Open",t)}},Close:function(){try{var t=discountNinja_Script_DrawerCart,i=document.getElementById(t.ElementId);i&&i.classList.remove(t.Classes.Open)}catch(t){discountNinja.Logging.LogError("DrawerCart.Close",t)}},Template:null,GetTemplate:function(){var t=discountNinja_Script_DrawerCart;return null===t.Template&&(t.Template=discountNinja.Html.GetTemplateById(t.TemplateId)),t.Template},Inject:function(){discountNinja.Html.Append(document.body,discountNinja_Script_DrawerCart.GetTemplate())},SubscribeToEvents:function(){var t=discountNinja_Script_DrawerCart,i=discountNinja.Events;try{var n="customdrawercart:";i.Subscribe(n+"open",(function(){t.Open(),t.Refresh().then((function(){document.dispatchEvent(new CustomEvent("limoniapps:discountninja:customdrawercart:refreshcomplete"))}))})),i.Subscribe(n+"close",(function(){t.Close()}));var e=discountNinja.Html.GetNodes(discountNinja.Environment.Shopify.SelectorCartLink());e&&e.forEach((t=>{t.addEventListener("click",(t=>(t.preventDefault(),t.stopPropagation(),i.Publish("customdrawercart:open"),!1)))}))}catch(t){discountNinja.Logging.LogError("DrawerCart.SubscribeToEvents",t)}},_AfterRefreshCommands:[],RegisterAfterRefresh:function(t){var i=discountNinja_Script_DrawerCart._AfterRefreshCommands;i&&-1===i.findIndex((i=>i.Id===t.Id))&&i.push(t)},AfterRefresh:function(){return new Promise((function(t,i){var n=discountNinja_Script_DrawerCart._AfterRefreshCommands;if(n){var e=[];n.forEach((t=>{e.push(t.Execute(t))})),Promise.all(e).then((function(){t()}))}else t()}))},Refresh:function(t){function i(t,i){discountNinja.Html.GetNodes("#"+t.ElementId+" ."+t.Classes.Wrapper).forEach((t=>{t.setAttribute(discountNinja_Script_DrawerCart.Attributes.Loading,i)}))}try{return new Promise((function(n,e){t||(t=discountNinja.DiscountedCart.DiscountedCart),discountNinja.XmlHttpRequest.Send(discountNinja.Environment.Shopify.RootRoute()+"/cart",{view:"discountninjadrawercart"},null,"get",!1,!0,!1,(function(t){!function(t,n,e){try{if(t){var o=discountNinja_Script_DrawerCart;i(o,!0);var r={Header:{},Checkout:{}};t=discountNinja.TemplateParameter.Replace(t,"SHOWHEADER",r.Header?"":"display:none"),t=discountNinja.TemplateParameter.Replace(t,"SHOWBANNER",r.Banner?"":"display:none"),t=discountNinja.TemplateParameter.Replace(t,"SHOWPROGRESSBAR",r.ProgressBar?"":"display:none"),t=discountNinja.TemplateParameter.Replace(t,"SHOWFOOTER",r.Footer?"":"display:none"),t=discountNinja.TemplateParameter.Replace(t,"SHOWORDERBUMP",r.OrderBump?"":"display:none"),t=discountNinja.TemplateParameter.Replace(t,"SHOWTOS",r.Tos?"":"display:none"),t=discountNinja.TemplateParameter.Replace(t,"SHOWPROMOTIONSUMMARY",r.PromotionSummary?"":"display:none"),t=discountNinja.TemplateParameter.Replace(t,"SHOWPROMOTIONCODEFIELD",r.PromotionCodeField?"":"display:none"),t=discountNinja.TemplateParameter.Replace(t,"SHOWCHECKOUT",r.Checkout?"":"display:none"),t=discountNinja.TemplateParameter.Replace(t,"SHOWPAYMENTMETHODS",r.PaymentMethods?"":"display:none"),discountNinja.Html.ReplaceHtml("#"+o.ElementId+" ."+o.Classes.WrapperInner,t),o.AfterRefresh().then((function(){i(o,!1),n()}))}else e()}catch(t){discountNinja.Logging.LogError("OnSuccess",t),e()}}(t,n,e)}),(function(t){e(t)}),1,1)}))}catch(t){discountNinja.Logging.LogError("DrawerCart.Refresh",t)}}},discountNinja_Script_Cache={_SupportsCacheLocal:null,_SupportsCacheSession:null,_SupportsCacheIndexedDb:null,_SessionId:null,SessionIdCacheKey:"SessionId",Fallback:{},SessionId:function(){if(null===discountNinja_Script_Cache._SessionId){var t=discountNinja_Script_Cache.SessionIdCacheKey;discountNinja_Script_Cache._SessionId=discountNinja_Script_Cache.SessionGet(t),null===discountNinja_Script_Cache._SessionId&&(discountNinja_Script_Cache._SessionId=discountNinja.Utilities.GetRandomNumber().toString(),discountNinja_Script_Cache.SessionSet(t,discountNinja.Cache.SessionId()))}return discountNinja_Script_Cache._SessionId},Prefix:function(t){var i="";if(t)try{void 0===discountNinjaContext.ShopHash&&(discountNinjaContext.ShopHash=discountNinja.Utilities.Hash(discountNinjaContext.Shop.replace(".myshopify.com",""))),i=discountNinjaContext.ShopHash+"-"}catch(t){}return"li-dn-"+i},SupportsCacheIndexedDb:function(){return new Promise((t=>{try{null===discountNinja_Script_Cache._SupportsCacheIndexedDb?discountNinja_Script_Cache.GetIndexedDb().then((function(){discountNinja_Script_Cache._SupportsCacheIndexedDb=null!==discountNinja_Script_Cache.IndexedDb,!1===discountNinja_Script_Cache._SupportsCacheIndexedDb&&discountNinja.Logging.LogWarning("IndexedDb not supported",!0),t(discountNinja_Script_Cache._SupportsCacheIndexedDb)})):t(discountNinja_Script_Cache._SupportsCacheIndexedDb)}catch(i){discountNinja_Script_Cache._SupportsCacheIndexedDb=!1,t(!1)}}))},SupportsCacheLocal:function(){try{return null===discountNinja_Script_Cache._SupportsCacheLocal&&(localStorage.setItem("testSupportsCacheLocal","testSupportsCacheLocal"),localStorage.removeItem("testSupportsCacheLocal"),discountNinja_Script_Cache._SupportsCacheLocal=!0),discountNinja_Script_Cache._SupportsCacheLocal}catch(t){return discountNinja_Script_Cache._SupportsCacheLocal=!1,!1}},SupportsCacheSession:function(){try{return null===discountNinja_Script_Cache._SupportsCacheSession&&(sessionStorage.setItem("testSupportsCacheSession","testSupportsCacheSession"),sessionStorage.removeItem("testSupportsCacheSession"),discountNinja_Script_Cache._SupportsCacheSession=!0),discountNinja_Script_Cache._SupportsCacheSession}catch(t){return discountNinja_Script_Cache._SupportsCacheSession=!1,!1}},IsQuotaExceededError:function(t){try{return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)}catch(t){return!1}},IndexedDb:null,GetIndexedDb:function(){return new Promise((t=>{null===discountNinja_Script_Cache.IndexedDb?discountNinja_Script_Cache.IndexedDbInit().then((function(){t(discountNinja_Script_Cache.IndexedDb)})):t(discountNinja_Script_Cache.IndexedDb)}))},IndexedDbInit:function(){return new Promise((t=>{try{var i=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.shimIndexedDB).open("discountNinja",2);i.onupgradeneeded=function(){try{i.result.createObjectStore("PromotionsStore",{keyPath:"id"})}catch(i){discountNinja.Logging.LogError("Cache.IndexedDbInit",i),discountNinja_Script_Cache.IndexedDb=null,t(!1)}},i.onsuccess=function(){try{discountNinja_Script_Cache.IndexedDb=i.result,t(!0)}catch(i){discountNinja.Logging.LogError("Cache.IndexedDbInit",i),discountNinja_Script_Cache.IndexedDb=null,t(!1)}},i.onerror=function(){discountNinja_Script_Cache.IndexedDb=null,t(!1)}}catch(i){discountNinja.Logging.LogError("Cache.IndexedDbInit",i),discountNinja_Script_Cache.IndexedDb=null,t(!1)}}))},IndexedDbCreateTransaction:function(t){return new Promise((i=>{try{discountNinja_Script_Cache.GetIndexedDb().then((function(n){try{if(null===n)i(null);else{var e=n.transaction(["PromotionsStore"],t?"readwrite":"readonly");i(e.objectStore("PromotionsStore"))}}catch(t){discountNinja.Logging.LogError("Cache.IndexedDbCreateTransaction",t),i(null)}}))}catch(t){discountNinja.Logging.LogError("Cache.IndexedDbCreateTransaction",t),i(null)}}))},IndexedDbClear:function(){return new Promise((t=>{discountNinja_Script_Cache.SupportsCacheIndexedDb().then((function(i){try{i?(discountNinja_Script_Cache.IndexedDbCreateTransaction(!0).then((function(i){try{if(null===i)throw new Error("Could not create IndexedDb transaction");i.clear()}catch(i){discountNinja.Logging.LogError("Cache.IndexedDbClear",i),t(!1)}})),t(!0)):t(!1)}catch(i){discountNinja.Logging.LogError("Cache.IndexedDbClear",i),t(!1)}}))}))},IndexedDbGet:function(t){try{return new Promise((i=>{discountNinja_Script_Cache.SupportsCacheIndexedDb().then((function(n){try{n?discountNinja_Script_Cache.IndexedDbCreateTransaction(!1).then((function(n){try{if(null===n)throw new Error("Could not create IndexedDb transaction");var e=n.get(discountNinja_Script_Cache.Prefix(!0)+t);e.onsuccess=()=>{try{var n=e.result;i(null==n?null:n.value)}catch(n){discountNinja.Logging.LogError("Cache.IndexedDbGet",n),i(JSON.parse(discountNinja_Script_Cache.SessionGet(t)))}},e.onerror=n=>{discountNinja.Logging.LogErrorMessage("Cache","Could not get data from IndexedDb with key: '"+t+"' - Got error '"+n+"'"),i(JSON.parse(discountNinja_Script_Cache.SessionGet(t)))}}catch(n){discountNinja.Logging.LogError("Cache.IndexedDbGet",n),i(JSON.parse(discountNinja_Script_Cache.SessionGet(t)))}})):i(JSON.parse(discountNinja_Script_Cache.SessionGet(t)))}catch(n){discountNinja.Logging.LogError("Cache.IndexedDbGet",n),i(JSON.parse(discountNinja_Script_Cache.SessionGet(t)))}}))}))}catch(i){return discountNinja.Logging.LogError("Cache.IndexedDbGet",i),new Promise((i=>{i(JSON.parse(discountNinja_Script_Cache.SessionGet(t)))}))}},IndexedDbSet:function(t,i){try{return new Promise((n=>{discountNinja_Script_Cache.SupportsCacheIndexedDb().then((function(e){try{e?discountNinja_Script_Cache.IndexedDbCreateTransaction(!0).then((function(e){try{if(null===e)throw new Error("Could not create IndexedDb transaction");var o=e.put({id:discountNinja_Script_Cache.Prefix(!0)+t,value:i});o.onsuccess=()=>{n()},o.onerror=e=>{discountNinja.Logging.LogErrorMessage("Cache","Could not set data in IndexedDb with key: '"+t+"' - Got error '"+e+"'"),discountNinja_Script_Cache.SessionSet(t,JSON.stringify(i)),n()}}catch(e){discountNinja.Logging.LogError("Cache.IndexedDbSet",e),discountNinja_Script_Cache.SessionSet(t,JSON.stringify(i)),n()}})):(discountNinja_Script_Cache.SessionSet(t,JSON.stringify(i)),n())}catch(e){discountNinja.Logging.LogError("Cache.IndexedDbSet",e),discountNinja_Script_Cache.SessionSet(t,JSON.stringify(i)),n()}}))}))}catch(n){return discountNinja_Script_Cache.IsQuotaExceededError(n)||discountNinja.Logging.LogError("Cache.IndexedDbSet",n),new Promise((n=>{discountNinja_Script_Cache.SessionSet(t,JSON.stringify(i)),n()}))}},LocalRemove:function(t){try{discountNinja_Script_Cache.SupportsCacheLocal()?localStorage.removeItem(discountNinja_Script_Cache.Prefix(!0)+t):discountNinja_Script_Cache.SessionRemove(t)}catch(i){discountNinja.Logging.LogError("Cache.LocalRemove",i),discountNinja_Script_Cache.SessionRemove(t)}},LocalGet:function(t){try{return discountNinja_Script_Cache.SupportsCacheLocal()?localStorage.getItem(discountNinja_Script_Cache.Prefix(!0)+t):discountNinja_Script_Cache.SessionGet(t)}catch(i){return discountNinja.Logging.LogError("Cache.LocalGet",i),discountNinja_Script_Cache.SessionGet(t)}},LocalSet:function(t,i){try{discountNinja_Script_Cache.SupportsCacheLocal()?(discountNinja_Script_Cache.LocalRemove(t),localStorage.setItem(discountNinja_Script_Cache.Prefix(!0)+t,i)):discountNinja_Script_Cache.SessionSet(t,i)}catch(n){discountNinja_Script_Cache.IsQuotaExceededError(n)||discountNinja.Logging.LogError("Cache.LocalSet",n),discountNinja_Script_Cache.SessionSet(t,i)}},SessionRemove:function(t){try{discountNinja_Script_Cache.SupportsCacheSession()?sessionStorage.removeItem(discountNinja_Script_Cache.Prefix(!1)+t):discountNinja_Script_Cache.FallbackRemove(t)}catch(i){discountNinja.Logging.LogError("Cache.SessionRemove",i),discountNinja_Script_Cache.FallbackRemove(t)}},SessionGet:function(t){try{return discountNinja_Script_Cache.SupportsCacheSession()?sessionStorage.getItem(discountNinja_Script_Cache.Prefix(!1)+t):discountNinja_Script_Cache.FallbackGet(t)}catch(i){return discountNinja.Logging.LogError("Cache.SessionGet",i),discountNinja_Script_Cache.FallbackGet(t)}},SessionSet:function(t,i){try{discountNinja_Script_Cache.SupportsCacheSession()?(discountNinja_Script_Cache.SessionRemove(t),sessionStorage.setItem(discountNinja_Script_Cache.Prefix(!1)+t,i)):discountNinja_Script_Cache.FallbackSet(t,i)}catch(n){discountNinja_Script_Cache.IsQuotaExceededError(n)||discountNinja.Logging.LogError("Cache.SessionSet",n),discountNinja_Script_Cache.FallbackSet(t,i)}},FallbackRemove:function(t){try{delete discountNinja_Script_Cache.Fallback[t]}catch(t){discountNinja.Logging.LogError("Cache.FallbackRemove",t)}},FallbackGet:function(t){try{return discountNinja_Script_Cache.Fallback.hasOwnProperty(t)?discountNinja_Script_Cache.Fallback[t]:null}catch(t){return discountNinja.Logging.LogError("Cache.FallbackGet",t),null}},FallbackSet:function(t,i){try{discountNinja_Script_Cache.Fallback[t]=String(i)}catch(t){discountNinja.Logging.LogError("Cache.FallbackSet",t)}},FallbackClear:function(){try{discountNinja_Script_Cache.Fallback={}}catch(t){discountNinja.Logging.LogError("Cache.FallbackClear",t)}},LocalClear:function(){try{if(discountNinja_Script_Cache.SupportsCacheLocal())for(var t=discountNinja_Script_Cache.Prefix(!0),i=0;i<localStorage.length;){var n=localStorage.key(i);n.toLowerCase().startsWith(t)?(localStorage.removeItem(n),i=0):i++}}catch(t){discountNinja.Logging.LogError("Cache.LocalClear",t)}},SessionClear:function(){try{if(discountNinja_Script_Cache.SupportsCacheSession())for(var t=discountNinja_Script_Cache.Prefix(!1),i=0;i<sessionStorage.length;){var n=sessionStorage.key(i);n.toLowerCase().startsWith(t)?(sessionStorage.removeItem(n),i=0):i++}}catch(t){discountNinja.Logging.LogError("Cache.SessionClear",t)}},Clear:function(){try{discountNinja_Script_Cache.LocalClear(),discountNinja_Script_Cache.SessionClear(),discountNinja_Script_Cache.FallbackClear()}catch(t){discountNinja.Logging.LogError("Cache.Clear",t)}}},discountNinja_Script_Html={Append:function(t,i){try{t.insertAdjacentHTML("afterend",i)}catch(t){discountNinja.Logging.LogError("Html.Append",t)}},GetElementById:function(t){try{return document.getElementById(t)}catch(t){return discountNinja.Logging.LogError("Html.GetElementById",t),null}},GetNodes:function(t){try{return document.querySelectorAll(t)}catch(t){return discountNinja.Logging.LogError("Html.GetElementById",t),null}},GetTemplateById:function(t){var i=discountNinja_Script_Html.GetElementById(t);return i?i.innerHTML:""},ReplaceHtml:function(t,i){var n=discountNinja_Script_Html.GetNodes(t);if(n)try{n.forEach((t=>{t.innerHTML=i}))}catch(t){discountNinja.Logging.LogError("Html.ReplaceHtml",t)}},RemoveNodes:function(t){var i=discountNinja_Script_Html.GetNodes(t);if(i)try{i.forEach((t=>{t.remove()}))}catch(t){discountNinja.Logging.LogError("Html.RemoveNodes",t)}},RemoveClass:function(t,i){var n=discountNinja_Script_Html.GetNodes(t);if(n)try{n.forEach((t=>{t.classList.remove(i)}))}catch(t){discountNinja.Logging.LogError("Html.RemoveClass",t)}}},discountNinja_Script_Cookie={ShopifyDiscountCodeInCookieCacheKey:"ShopifyDiscountCodeInCookie",GetCookie:function(t){return(document.cookie.match("(^|; )"+t+"=([^;]*)")||0)[2]},GetDiscountCodeCookie:function(){try{var t=discountNinja_Script_Cookie.GetCookie("discount_code");if(null!=t){var i=decodeURIComponent(t).trim();return""!==i?i:null}return null}catch(t){return null}},DiscountCodeCookieIsOwnedByShopify:function(){var t=discountNinja_Script_Cookie.GetDiscountCodeCookie(),i=discountNinja.Cache.SessionGet(discountNinja_Script_Cookie.ShopifyDiscountCodeInCookieCacheKey);return t&&""!==t&&" "!==t&&i===t},BuildDiscountCodeCookie:function(t,i,n){return"discount_code="+t+"; "+(n?"expires=Thu, 01 Jan 1970 00:00:00 UTC; ":"")+"path=/; domain="+i+"; SameSite=Lax"},AppendDiscountCodeToCookie:function(t){discountNinja_Script_Cookie.RemoveDiscountCodesFromCookie();var i=encodeURI(t);document.cookie=discountNinja_Script_Cookie.BuildDiscountCodeCookie(i,location.host,!1),document.cookie=discountNinja_Script_Cookie.BuildDiscountCodeCookie(i,discountNinjaContext.Shop,!1)},RemoveDiscountCodesFromCookie:function(){document.cookie=discountNinja_Script_Cookie.BuildDiscountCodeCookie("",location.host,!0),document.cookie=discountNinja_Script_Cookie.BuildDiscountCodeCookie("",discountNinjaContext.Shop,!0)}},discountNinja_Script_Events={GetFullQualifiedEventName:function(t){return"limoniapps:discountninja:"+t.toLowerCase()},Publish:function(t,i){try{var n=discountNinja_Script_Events.GetFullQualifiedEventName(t);document.dispatchEvent(new CustomEvent(n,{detail:{data:i}}))}catch(t){discountNinja.Logging.LogError("Events.Publish",t)}},Subscribe:function(t,i,n){try{null==n&&(n=!0);var e=discountNinja_Script_Events.GetFullQualifiedEventName(t),o="limoniApps:discountNinja:"+t;if(n&&document.removeEventListener(e,document,!1),document.addEventListener(e,(function(t){i&&i.apply(this,t.detail?t.detail.data:null)})),n)try{discountNinja.Utilities.jQuery()(document).off(o)}catch(t){}try{discountNinja.Utilities.jQuery()(document).on(o,(function(){i&&i.apply(this,arguments)}))}catch(t){}}catch(t){discountNinja.Logging.LogError("Events.Subscribe",t)}},_SupportsPassiveEvents:null,SupportsPassiveEvents:function(){if(null==discountNinja_Script_Events._SupportsPassiveEvents){discountNinja_Script_Events._SupportsPassiveEvents=!1;try{var t=Object.defineProperty({},"passive",{get:function(){discountNinja_Script_Events._SupportsPassiveEvents=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(t){}}return discountNinja_Script_Events._SupportsPassiveEvents},AddEventListener:function(t,i,n,e,o,r,a,c){var u=discountNinja_Script_Events.SupportsPassiveEvents(),s={capture:e,once:r,passive:o,signal:a};t.addEventListener(i,n,u?s:e,c)}},discountNinja_Script_Logging={WriteToConsole:!1,LogTimeElapsed:!1,LogPerformance:!1,LogWarningToServer:!0,LogMessageHeader:"Discount Ninja - ",Tracing:!1,LogErrorMessage:function(t,i){try{message=null==i?t:"Error occurred in "+t+".\r\nError message: '"+i+"'",discountNinja_Script_Logging.LogToConsole("error",message,"red"),discountNinja_Script_Logging.TrackMessage(message,"error")}catch(t){}},LogError:function(t,i,n){try{if("object"!=typeof i)discountNinja_Script_Logging.LogErrorMessage(t,i);else{var e=null==n?"error":n;message="Error occurred in "+t+".\r\nError message: '"+i.message+"'.\r\nStack: '"+i.stack+"'",discountNinja_Script_Logging.LogToConsole(e,message,"red"),discountNinja_Script_Logging.TrackMessage(message,e)}}catch(t){}},LogWarning:function(t,i){try{i&&discountNinja_Script_Logging.LogToConsole("warning",t,"orange"),discountNinja_Script_Logging.TrackMessage(t,"warning")}catch(t){}},LogInformation:function(t){try{discountNinja_Script_Logging.WriteToConsole&&discountNinja_Script_Logging.LogToConsole("information",t,"blue"),discountNinja_Script_Logging.TrackMessage(t,"information")}catch(t){}},LogVerbose:function(t){try{discountNinja_Script_Logging.WriteToConsole&&discountNinja_Script_Logging.LogToConsole("debug","DEBUG - "+t,"gray"),discountNinja_Script_Logging.TrackMessage(t,"verbose")}catch(t){}},TrackMessage:function(t,i){try{"error"===i&&discountNinja.LogSession.LogError(t)}catch(t){}},LogToConsole:function(t,i,n,e,o){try{!discountNinja_Script_Logging.Tracing||"error"!==t&&"critical"!==t&&"warning"!==t||alert(i),o||(i=discountNinja_Script_Logging.LogMessageHeader+i);var r="error"===t||"critical"===t?Function.prototype.bind.call(console.error,console):"warn"===t||"warning"===t?Function.prototype.bind.call(console.warn,console):"debug"===t||"verbose"===t?Function.prototype.bind.call(console.debug,console):Function.prototype.bind.call(console.log,console);n=n||"black";var a="";!0===(e=e||!1)&&(a="font-weight: bold;"),r.apply(console,["%c"+i,"color: "+n+";"+a])}catch(t){try{console&&console.log(i)}catch(t){}}},HandleQueryParameter:function(){var t="discountninja";discountNinja_Script_Logging.Tracing=discountNinja.QueryParameter.GetFlag(t+"tracing",!0,!0,!1,!0),discountNinja_Script_Logging.WriteToConsole=discountNinja.QueryParameter.GetFlag(t+"log",!0,!0,!1,!0),discountNinja_Script_Logging.LogPerformance=discountNinja.QueryParameter.GetFlag(t+"logperformance",!0,!0,!1,!0)}},discountNinja_Script_Currency={ActiveCurrency:function(){try{return void 0!==window.Shopify&&void 0!==window.Shopify.currency&&"string"==typeof window.Shopify.currency.active?window.Shopify.currency.active:discountNinjaContext.PresentmentCurrency}catch(t){return discountNinja.Logging.LogError("Currency.ActiveCurrency",t),"UNKNOWN"}},EscapeDollarSignForRegEx:function(t){try{return t.toString().replace(/\$/g,"$$$")}catch(i){return discountNinja.Logging.LogError("Currency.EscapeDollarSignForRegEx",i),t}},GetCurrencyFormat:function(){try{var t=discountNinja.Settings.Settings.Currency,i=discountNinjaContext.PresentmentCurrency,n=discountNinjaContext.ShopCurrency,e=void 0===t.MoneyFormat||null===t.MoneyFormat||""===t.MoneyFormat.trim()?null:t.MoneyFormat,o=void 0===discountNinjaContext.MoneyFormat||null===discountNinjaContext.MoneyFormat||""===discountNinjaContext.MoneyFormat.trim()?null:discountNinjaContext.MoneyFormat;if(i===n&&null!==e)return'<span class="money">'+e+"</span>";if(i===n&&null!==o)return'<span class="money">'+o+"</span>";var r=!1,a=e||o;return null!==a&&a.indexOf("no_decimals")>-1&&(r=!0),'<span class="money">'+discountNinja_Script_Currency.GetCurrencyFormatForCurrency(i,r)+"</span>"}catch(t){return discountNinja.Logging.LogError("Currency.GetCurrencyFormat",t),""}},GetCurrencyFormatForCurrency:function(t,i){var n=["ARS","BRL","CZK","DKK","EUR","HUF","ILS","PLN","RUB","SEK","CHF","VND"],e=["CZK","EUR","HUF","MAD","PLN","RUB","SAR","SEK","THB","TRY","VND"],o=["SGD","GBP","USD","AUD"];try{var r=discountNinja_Script_Currency.GetCurrencyNumberParts(discountNinja.Environment.Shopify.Locale(),t),a=function(i){try{return null!=i?0===i.findIndex((function(t){return"currency"===t.type})):!(e.indexOf(t)>-1)}catch(t){return discountNinja.Logging.LogError("Currency.SymbolFirst",t),!1}}(r),c=function(i){try{return null!=i?i.findIndex((function(t){return"literal"===t.type&&(" "==t.value||""==t.value)}))>-1?" ":"":o.indexOf(t)>-1?"":" "}catch(t){return discountNinja.Logging.LogError("Currency.Space",t),""}}(r),u=function(i){try{if(null!=i){var e=i.find((function(t){return"group"===t.type}));return e?e.value:""}return n.indexOf(t)>-1?".":","}catch(t){return discountNinja.Logging.LogError("Currency.ThousandSeparator",t),""}}(r),s=function(i){try{if(null!=i){var e=i.find((function(t){return"decimal"===t.type}));return e?e.value:"."}return n.indexOf(t)>-1?",":"."}catch(t){return discountNinja.Logging.LogError("Currency.ThousandSeparator",t),""}}(r),d=function(t,i,n){function e(t){return","===t?"comma":"."===t?"dot":" "===t||""===t?"space":"'"===t?"apostrophe":null}try{var o="amount";n&&(o+="_no_decimals");var r=e(t),a=e(i);return r&&(o+="_with_"+r+"_thousandseparator"),a&&(o+="_with_"+a+"_fractionalseparator"),"{{"+o+"}}"}catch(t){return discountNinja.Logging.LogError("Currency.Format",t),""}}(u,s,i);if(void 0!==discountNinjaContext.PresentmentCurrencyMoney){var l=discountNinjaContext.PresentmentCurrencyMoney,g=l.indexOf("6"),f=l.indexOf("9");if(-1!==g&&-1!==f)return l.substring(0,g)+d+l.substring(f+1)}var p=discountNinja_Script_Currency.GetCurrencySymbol(t);return a?p+c+d:d+c+p}catch(t){return discountNinja.Logging.LogError("Currency.GetCurrencyFormat",t),""}},GetCurrencyNumberParts:function(t,i){try{var n=null;if("object"==typeof Intl){if(null==t)return null;n=new Intl.NumberFormat(t||"en-US",{style:"currency",currency:i||"USD"}).formatToParts(1e3)}return n}catch(t){return discountNinja.Logging.LogError("Currency.GetCurrencyNumberFormat",t),null}},GetCurrencySymbol:function(t){var i=discountNinja_Script_Currency.GetCurrencyNumberParts(discountNinja.Environment.Shopify.Locale(),t);if(null!=i){var n=i.find((function(t){return"currency"===t.type}));return n?n.value:""}var e=t||"";return"GBP"===t?e="£":"EUR"===t?e="€":"CZK"===t?e="Kč":"DKK"===t||"NOK"===t||"SEK"===t?e="kr":"HRK"===t?e="kn":"GEL"===t?e="₾":"HUF"===t?e="ft":"POL"===t?e="zł":"RUB"===t?e="₽":"RON"===t?e="lei":"TRY"===t?e="₺":"CHF"===t?e="fr.":"USD"===t||"CAD"===t||"CLP"===t||"COP"===t||"MXN"===t||"ARS"===t?e="$":"BRL"===t?e="R$":"PEN"===t?e="S/":"AED"===t?e="د.إ":"ILS"===t?e="₪":"KES"===t?e="Ksh":"MAD"===t?e=".د.م":"NGN"===t?e="₦":"ZAR"===t?e="R":"AUD"===t||"NZD"===t||"SGD"===t?e="$":"HKD"===t?e="HK$":"BDT"===t?e="৳":"CNY"===t||"JPY"===t?e="¥":"IDR"===t?e="Rp":"INR"===t?e="₹":"MYR"===t?e="RM":"PHP"===t?e="₱":"PKR"===t||"LKR"===t?e="Rs":"KRW"===t?e="₩":"THB"===t?e="฿":"VND"===t?e="₫":"SAR"===t?e="﷼":"BTC"===t||"XBT"===t?e="₿":"LTC"===t?e="Ł":"ETH"===t&&(e="Ξ"),e},GetConversionRate:function(t){try{var i=null;if(window.Shopify&&window.Shopify.currency&&void 0!==window.Shopify.currency.rate&&null!==window.Shopify.currency.rate&&""!==window.Shopify.currency.rate)try{i=parseFloat(window.Shopify.currency.rate)}catch(t){discountNinja.Logging.LogError("Currency.GetConversionRate",t)}if(null===i){var n=discountNinja.Settings.Settings.Currency;if(void 0!==n.ConversionRates&&Array.isArray(n.ConversionRates))try{void 0===(i=JSON.parse(n.ConversionRates)[t])&&(i=null)}catch(t){discountNinja.Logging.LogError("Currency.GetConversionRate",t)}}return i}catch(t){return discountNinja.Logging.LogError("Currency.GetConversionRate",t),null}},Convert:function(t,i,n){try{return discountNinja_Script_Currency.ConvertTo(t,discountNinja.Settings.Settings.Currency.BaseCurrency,i,n)}catch(i){return discountNinja.Logging.LogError("Currency.Convert",i),t}},ConvertTo:function(t,i,n,e){try{var o=discountNinja.Settings.Settings.Currency.BaseCurrency,r=n;if(i!==o&&n!==o)return t;var a=!1;i!==o&&n==o&&(r=i,a=!0);var c=discountNinja_Script_Currency.GetConversionRate(r);if(null===c)return t;var u=a?t/c:t*c,s=discountNinja.Settings.Settings.Currency,d=e||s.RoundingAlgorithm||discountNinja.Settings.GetFlag("CurrencyConversionRoundingAlgorithm");return"exact"===d?u:"ceiling"===d?Math.ceil(u):"floor"===d?Math.floor(u):"round"===d?Math.round(u):"roundtofive"===d?5*Math.round(u/5):"floortofive"===d?5*Math.floor(u/5):"ceiltofive"===d?5*Math.ceil(u/5):Math.round(u)}catch(i){return discountNinja.Logging.LogError("Currency.ConvertTo",i),t}}},discountNinja_Script_MultiCurrency={UpdateCurrency:function(){try{"object"==typeof window.DoublyGlobalCurrency?function(){try{var t=discountNinja.Settings.Settings.Currency,i=t.BaseCurrency;window.DoublyGlobalCurrency&&void 0!==window.DoublyGlobalCurrency.currentCurrency&&null!==window.DoublyGlobalCurrency.currentCurrency&&""!==window.DoublyGlobalCurrency.currentCurrency&&(i=window.DoublyGlobalCurrency.currentCurrency),window.DoublyGlobalCurrency&&"function"==typeof window.DoublyGlobalCurrency.convertAll&&(i!==t.BaseCurrency&&window.DoublyGlobalCurrency.convertAll(t.BaseCurrency,".money"),window.DoublyGlobalCurrency.convertAll(i,".money"))}catch(t){discountNinja.Logging.LogError("UpdateCurrencyDoubly",t,"warning")}}():"object"==typeof window.Geolizr?function(){try{if("object"==typeof window.Geolizr){var t=discountNinja.Settings.Settings.Currency.BaseCurrency,i=window.Geolizr.getCurrency();window.Geolizr.moneyFormats[t]&&window.Geolizr.moneyFormats[i]&&(window.Geolizr.switchCurrency(t),window.Geolizr.switchCurrency(i))}}catch(t){discountNinja.Logging.LogError("UpdateCurrencyGeolizr",t,"warning")}}():"function"==typeof window.convertCurrencies&&"object"==typeof window.Currency?function(){try{"function"==typeof window.convertCurrencies&&window.convertCurrencies()}catch(t){discountNinja.Logging.LogError("An error occurred outside of Discount Ninja, when the function window.convertCurrencies() is called.",t,"warning")}}():"object"==typeof window.Currency&&"function"==typeof window.Currency.convertAll&&!1!==discountNinja.Settings.GetFlag("AllowCurrencyConversionUsingCurrencyConvertAll")&&function(){try{var t=discountNinja.Settings.Settings.Currency,i=t.BaseCurrency,n=t.BaseCurrency;window.Currency&&void 0!==window.Currency.shopCurrency&&null!==window.Currency.shopCurrency&&""!==window.Currency.shopCurrency&&(i=window.Currency.shopCurrency),window.Shopify&&window.Shopify.currency&&void 0!==window.Shopify.currency.active&&null!==window.Shopify.currency.active&&""!==window.Shopify.currency.active&&(n=window.Shopify.currency.active),window.Currency&&void 0!==window.Currency.currentCurrency&&null!==window.Currency.currentCurrency&&""!==window.Currency.currentCurrency&&(n=window.Currency.currentCurrency),i!==n&&"object"==typeof window.Currency&&"function"==typeof window.Currency.convertAll&&window.Currency.convertAll(i,n,".limoniapps-discountninja-money")}catch(t){discountNinja.Logging.LogError("UpdateCurrencyStandardConvertAll",t,"warning")}}();try{document.dispatchEvent(new CustomEvent("switch-currency")),discountNinja.Events.Publish("convertmoneyfields",[discountNinjaContext.PresentmentCurrency])}catch(t){discountNinja.Logging.LogError("UpdateCurrency Switch currency",t,"warning")}}catch(t){discountNinja.Logging.LogError("UpdateCurrency",t,"warning")}}},discountNinja_Script_QueryParameter={GetQueryParameters:function(t){try{var i=null==t?window.location.href.replace(window.location.hash,""):t;i&&(i=i.indexOf("#")>-1?i.substring(0,i.indexOf("#")):i);for(var n,e=[],o=i.slice(i.indexOf("?")+1).split("&"),r=0;r<o.length;r++)n=o[r].split("="),e.push(n[0]),e[n[0]]=n[1];return e}catch(t){return discountNinja.Logging.LogError("QueryParameter.GetQueryParameters",t),[]}},Get:function(t,i){try{var n=discountNinja_Script_QueryParameter.GetQueryParameters(i)[t];return void 0===n||"undefined"===n||"null"===n||"UNDEFINED"===n||"NULL"===n||null===n?null:n}catch(t){return discountNinja.Logging.LogError("QueryParameter.Get",t),null}},Remove:function(t){function i(t){document.location.search=t}try{var n=discountNinja_Script_QueryParameter.GetQueryParameters(),e=[];for(var o in Object.keys(n)){var r=n[o],a=n[r];null!=r&&null!=a&&r!==t&&e.push(r+"="+a)}var c=e.length<1?"":"?"+e.join("&");if(window.history&&window.history.replaceState)try{window.history.replaceState({},document.title,location.origin+location.pathname+c)}catch(t){discountNinja.Logging.LogError("window.history.replaceState not supported",t),i(c)}else i(c)}catch(t){discountNinja.Logging.LogError("QueryParameter.Remove",t)}},RemoveFromUrl:function(t,i,n){try{var e=t.replace(i+"="+n,""),o=(e=(e=e.replace("?&","?")).replace("&&","&")).slice(-1);return"&"!==o&&"?"!==o||(e=e.slice(0,-1)),e}catch(i){return discountNinja.Logging.LogError("QueryParameter.RemoveFromUrl",i),t}},AppendToUrl:function(t,i,n,e,o){try{n=discountNinja.Utilities.EncodeUriComponentForQueryString(n),i=discountNinja.Utilities.EncodeUriComponentForQueryString(i);var r=discountNinja_Script_QueryParameter.GetQueryParameters(t)[i];if(void 0!==r&&r===n)return t;e&&void 0!==r&&(t=discountNinja_Script_QueryParameter.RemoveFromUrl(t,i,r));return(o?t+(0===t.length?"":"&")+i+"="+n:t.indexOf("?")>0?t+"&"+i+"="+n:t+"?"+i+"="+n).replace("?&","?")}catch(i){return discountNinja.Logging.LogError("QueryParameter.AppendToUrl",i),t}},GetFlag:function(t,i,n,e,o){var r=discountNinja_Script_QueryParameter.Get(t);if(null!==r)return o&&(r=1==r),i&&discountNinja.Cache.SessionSet(t,r),n&&discountNinja_Script_QueryParameter.Remove(t),r;var a=discountNinja.Cache.SessionGet(t);return null!==a?(o&&(a=1==a),a):e}},discountNinja_Script_TextSettings={WrapInColor:function(t,i){return t?'<span style="color:'+t+";fill:"+t+'">'+i+"</span>":i},GetText:function(t,i){function n(t){return t.replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/_{_{/g,"{{").replace(/_}_}/g,"}}")}if(!t)return"";t=function(t){return t&&(t.MobileText&&(t.MobileText=n(t.MobileText)),t.MobileTextAfterGoal&&(t.MobileTextAfterGoal=n(t.MobileTextAfterGoal)),t.MobileTextDuringGoal&&(t.MobileTextDuringGoal=n(t.MobileTextDuringGoal)),t.MobileTextOnCart&&(t.MobileTextOnCart=n(t.MobileTextOnCart)),t.MobileTextOnCartAfterGoal&&(t.MobileTextOnCartAfterGoal=n(t.MobileTextOnCartAfterGoal)),t.MobileTextOnCartDuringGoal&&(t.MobileTextOnCartDuringGoal=n(t.MobileTextOnCartDuringGoal)),t.Text&&(t.Text=n(t.Text)),t.TextAfterGoal&&(t.TextAfterGoal=n(t.TextAfterGoal)),t.TextDuringGoal&&(t.TextDuringGoal=n(t.TextDuringGoal)),t.TextOnCart&&(t.TextOnCart=n(t.TextOnCart)),t.TextOnCartAfterGoal&&(t.TextOnCartAfterGoal=n(t.TextOnCartAfterGoal)),t.TextOnCartDuringGoal&&(t.TextOnCartDuringGoal=n(t.TextOnCartDuringGoal))),t}(t);var e=discountNinja.Environment.Shopify.IsCartPage(),o=discountNinja.Utilities.IsMobilePhone(),r=i&&i.Tiers[0]&&i.Tiers[0].Prerequisite&&(i.Tiers[0].Prerequisite.MaximumItems>0||i.Tiers[0].Prerequisite.MinimumItems>0||i.Tiers[0].Prerequisite.MinimumAmount>0||i.Tiers[0].Prerequisite.MaximumAmount>0),a=null!==i&&("spendx_gety"===i.OfferType||r),c="-",u=null,s=!1;if(a){var d="undefined"==typeof cartValueOverride||null===cartValueOverride?discountNinja.Offer.PrerequisiteItemsCartValue(i):cartValueOverride;u=null===i?0:discountNinja.DiscountTier.GetCurrentDiscountTierNumber(i,d);var l=null===i?0:discountNinja.DiscountTier.GetMaxDiscountTierNumber(i),g=discountNinja.Set.ForTier(i,i.Tiers[0],!0),f=!!discountNinja.DiscountedCart.DiscountedCart&&discountNinja.DiscountedCart.DiscountedCart.AppliedPromotions.findIndex((function(t){return t.OfferToken===i.Token}))>-1;1===u||u===l?u===l?(c="after",g.SupportsMultipleSets&&!1===g.Current.Complete&&g.Current.Remaining>0&&(c=f?"duringandafter":"during")):c=f?"duringandafter":"during":u>0?c=f?"duringandafter":"during":u>-1&&(c="during",1===l&&g.SupportsMultipleSets&&!0===g.Current.Complete&&(c="after")),!f&&g.SupportsMultipleSets&&g.Current.Complete&&(s="2"===discountNinja.Settings.GetFlag("ShortCodeVersion"))}var p,N,j=t.TextOnCartDuringGoal,C=t.TextOnCartAfterGoal,m=t.TextOnCart,S=t.TextDuringGoal,h=t.TextAfterGoal,_=t.Text;o&&(j=t.MobileTextOnCartDuringGoal||j,C=t.MobileTextOnCartAfterGoal||C,m=t.MobileTextOnCart||m,S=t.MobileTextDuringGoal||S,h=t.MobileTextAfterGoal||h,_=t.MobileText||_),e&&(S=j||S,h=C||h,_=m||_);var y=i&&"free_shipping"===i.DiscountCodeType,v=i&&"object"==typeof i.Bogo&&(void 0===i.Bogo.AddToCartAutomatically||!1===i.Bogo.AddToCartAutomatically);if(!v){var P=null===i?null:i.Tiers[0];v=i&&("discount"===i.OfferType||"buyx_gety"===i.OfferType)&&P&&P.Entitlement&&100===P.Entitlement.Percentage}p=S||_||"",N=h||_||"";var T=!0===(y||v)||f||s,L="";return"duringandafter"===c?L=T?N===p?N:N+p:p:"during"===c?L=p:"after"===c?L=T?N:p:(L=_||"",a||""!==L||(L=N)),discountNinja.TextScaling.ReplacePxWithRem(L,.9)},IsEmpty:function(t){try{return"string"!=typeof t||null===t||!(t.indexOf("limoniapps-discountninja-timer")>-1)&&""===t.replace(/<(?:!|\/?[a-zA-Z]+).*?\/?>/g,"").trim()}catch(t){return!1}}},discountNinja_Script_Utilities={jQuery:function(){return LimoniAppsJQuery||jQuery},RegisterCustomJQueryExpressions:function(){try{var t=discountNinja_Script_Utilities.jQuery();t.expr[":"].doesNotHaveParent=t.expr.createPseudo((function(t){return function(i,n,e){return 0===discountNinja_Script_Utilities.jQuery()(i).closest(t).length}}))}catch(t){console.error("RegisterCustomJQueryExpressions failed",t)}},ObjectIsEmpty:function(t){return null==t||0===Object.keys(t).length&&t.constructor===Object},IsLighthouse:function(){try{return navigator.userAgent.indexOf("Chrome-Lighthouse")>-1}catch(t){return!1}},Hash:function(t){try{for(var i,n=-559038737,e=1103547991,o=0;o<t.length;o++)i=t.charCodeAt(o),n=Math.imul(n^i,2654435761),e=Math.imul(e^i,1597334677);return n=Math.imul(n^n>>>16,2246822507)^Math.imul(e^e>>>13,3266489909),4294967296*(2097151&(e=Math.imul(e^e>>>16,2246822507)^Math.imul(n^n>>>13,3266489909)))+(n>>>0)}catch(t){return console.error("Hash failed",t),""}},NewGuid:function(){try{var t=(new Date).getTime(),i=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var e=16*Math.random();return t>0?(e=(t+e)%16|0,t=Math.floor(t/16)):(e=(i+e)%16|0,i=Math.floor(i/16)),("x"===n?e:3&e|8).toString(16)}))}catch(t){return discountNinja.Logging.LogError("Utilities.NewGuid",t),null}},RepeatWithIntervals:function(t,i,n){!function t(e,o){try{o<n&&(o>0?setTimeout((function(){e()}),i):e(),t(e,o+1))}catch(t){discountNinja.Logging.LogError("Utilities.RepeatWithIntervals",t)}}(t,0)},CreateFragment:function(t){try{var i=document.createDocumentFragment(),n=document.createElement("div");for(n.innerHTML=t;n.firstChild;)i.appendChild(n.firstChild);return i}catch(t){return discountNinja.Logging.LogError("Utilities.CreateFragment",t),null}},AddInlineCssToDocument:function(t,i,n){try{var e=document.createElement("style");e.type="text/css",e.id=i,e.setAttribute("data-config",n),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t));var o=document.getElementsByTagName("head")[0];discountNinja.Utilities.jQuery()("#"+i).length>0&&o.removeChild(document.getElementById(i)),o.appendChild(e)}catch(t){discountNinja.Logging.LogError("Utilities.AddInlineCssToDocument",t)}},NumberOfFractionalDigits:function(t){try{if(Math.floor(t).toString()===t.toString())return 0;var i=t.toString().split(".")[1];return void 0===i?0:i.length}catch(i){return discountNinja.Logging.LogError("Utilities.NumberOfFractionalDigits, number was: "+t,i),0}},FixedMultipliedAmount:function(t,i){try{var n=Math.pow(10,i),e=discountNinja_Script_Utilities.NumberOfFractionalDigits(t);return(t*n).toFixed(Math.max(0,e-i))}catch(i){return discountNinja.Logging.LogError("Utilities.FixedMultipliedAmount",i),t}},RoundToNumberOfDigits:function(t,i){try{var n=Math.pow(10,i),e=discountNinja_Script_Utilities.FixedMultipliedAmount(t,i);return 0===n?0:parseFloat(Math.round(e)/n)}catch(i){return discountNinja.Logging.LogError("Utilities.RoundToNumberOfDigits",i),t}},FloorToNumberOfDigits:function(t,i){try{var n=Math.pow(10,i),e=discountNinja_Script_Utilities.FixedMultipliedAmount(t,i);return 0===n?0:parseFloat(Math.floor(e)/n)}catch(i){return discountNinja.Logging.LogError("Utilities.FloorToNumberOfDigits",i),t}},DebounceCallTypes:{},Debounce:function(t,i,n){return(...e)=>{var o=n+"-trailing";clearTimeout(discountNinja_Script_Utilities.DebounceCallTypes[o]),discountNinja_Script_Utilities.DebounceCallTypes[o]=setTimeout((()=>t.apply(this,e)),i)}},EncodeUriComponent:function(t){try{if(!t||"string"!=typeof t)return t;var i=t;try{i=decodeURIComponent(t)}catch(t){}var n=i;try{n=encodeURIComponent(i)}catch(i){discountNinja.Logging.LogWarning("Could not encode: "+t,!0,!1)}return n}catch(i){return discountNinja.Logging.LogWarning("Utilities.EncodeUriComponent - Could not encode: "+t,!0,!1),t}},EncodeUriComponentForQueryString:function(t){try{return t&&"string"==typeof t?(t=t.toString().replace(/\+/g," "),discountNinja_Script_Utilities.EncodeUriComponent(t).replace(/%20/g,"+").replace(/ /g,"+")):t}catch(i){return discountNinja.Logging.LogWarning("Utilities.EncodeUriComponentForQueryString - Could not encode: "+t,!0,!1),t}},GetNumberFromHtmlFragment:function(t){try{return t.match(/\d+/)[0]}catch(i){return t}},GetElementId:function(t){try{if("body"===t)return"body";var i=discountNinja.Utilities.jQuery()(t).attr("id");return i||t}catch(i){return t}},IsInViewport:function(t){try{var i=discountNinja.Utilities.jQuery()(t).offset().top,n=discountNinja.Utilities.jQuery()(t).offset().left,e=i+discountNinja.Utilities.jQuery()(t).outerHeight(),o=n+discountNinja.Utilities.jQuery()(t).outerWidth(),r=discountNinja.Utilities.jQuery()(window).scrollTop(),a=r+discountNinja.Utilities.jQuery()(window).height(),c=discountNinja.Utilities.jQuery()(window).scrollLeft(),u=c+discountNinja.Utilities.jQuery()(window).width();return e>r&&i<a&&n<u&&o>c}catch(t){return discountNinja.Logging.LogError("Utilities.IsInViewport",t),!1}},IsValidEmailAddress:function(t){try{return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t.toLowerCase())}catch(t){return discountNinja.Logging.LogError("Utilities.IsValidEmailAddress",t),!1}},GetMutationObserver:function(){try{var t=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;return void 0===t?discountNinja.Logging.LogWarning("MutationObserver not available, not supporting ListenForDynamicallyAddedElements",!0,!0):t}catch(t){return discountNinja.Logging.LogError("Utilities.GetMutationObserver",t),null}},FormatPercentage:function(t,i){try{return isNaN(t)?t:t.toFixed(i)}catch(i){return discountNinja.Logging.LogError("Utilities.FormatPercentage",i),t}},FormatMoney:function(t,i,n,e,o,r,a){function c(t,i,n){for(var e="_"+i+"separator",o=0;o<n.length;o++){var r=n[o];if(t.indexOf("_with_"+r.text+e)>-1)return r.value}return t.indexOf("with_comma_separator")>-1?"thousand"===i?".":",":"thousand"===i?",":"."}try{if(0===t&&!0===r)return discountNinja.GiftWithPurchase.FreeLabel();e=e||!1,o=o||!1,"string"==typeof t&&(t=t.replace(".",""));var u,s=/\{\{\s*(\w+)\s*\}\}/,d=discountNinja.Currency.GetCurrencyFormat(),l=null===i||-1===i.indexOf("{{amount")?d:i,g=[{text:"comma",separator:","},{text:"dot",separator:"."},{text:"space",separator:" "},{text:"apostrophe",separator:"'"}],f=l.match(s)[1],p=c(f,"thousand",g),N=c(f,"fractional",g);return u=function(t,i,n,o){if(n=n||",",o=o||".",isNaN(t)||null===t)return 0;var r=(t=(t/100).toFixed(i)).split("."),c=r[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+n);if(0===i)return c;var u="";return(r[1]>0||!0!==a)&&(u=e?"<sup>"+(r[1]?r[1]:"")+"</sup>":r[1]?o+r[1]:""),c+u}(t,f.indexOf("no_decimals")>-1?0:n,p,N),l.replace(s,discountNinja.Currency.EscapeDollarSignForRegEx(u))}catch(i){return discountNinja.Logging.LogError("Utilities.FormatMoney",i),t}},GetNoDecimalsCurrencyFormat:function(t){try{return t&&(t=(t=t.replace("{{amount}}","{{amount_no_decimals}}")).replace("{{amount_with_comma_separator}}","{{amount_no_decimals_with_comma_separator}}")),t}catch(t){return discountNinja.Logging.LogError("Utilities.GetNoDecimalsCurrencyFormat",t),""}},GetCurrencyFormatAmountComponent:function(t){try{if(t){var i=t.match(/({{){1}(.)*(}}){1}/);if(null!==i&&i.length>0)return i[0]}return t}catch(t){return discountNinja.Logging.LogError("Utilities.GetCurrencyFormatAmountComponent",t),""}},StringIsIn:function(t,i,n){try{if(null==t||""===t||null==i||""===i)return!1;null==n&&(n=",");for(var e=t.toString().split(n),o=i.toString().split(n),r=0;r<e.length;r++)for(var a=0;a<o.length;a++){var c=e[r],u=o[a];if(null!=c&&""!==c.trim()&&null!=u&&""!==u.trim()&&c.toLowerCase().trim()===u.toLowerCase().trim())return!0}return!1}catch(t){return discountNinja.Logging.LogError("Utilities.StringIsIn",t),!1}},AppendToStyle:function(t,i,n){try{discountNinja.Utilities.jQuery()(t).attr("style",(function(t,e){"string"==typeof e&&null!=e||(e=""),""!==e&&";"!==e.substr(e.length-1)&&(e+=";");var o=new RegExp(i+"([s])*:([^;\n\r])*","g"),r=e.match(o);return null!==r&&r.length>0?e=e.replace(o,i+": "+n):e+i+": "+n+";"}))}catch(t){discountNinja.Logging.LogError("Utilities.AppendToStyle",t)}},IsMobilePhoneCached:null,IsMobilePhone:function(){try{if(null===discountNinja_Script_Utilities.IsMobilePhoneCached){var t=!1;i=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4)))&&(t=!0),discountNinja_Script_Utilities.IsMobilePhoneCached=t}return discountNinja_Script_Utilities.IsMobilePhoneCached}catch(t){return discountNinja.Logging.LogError("Utilities.IsMobilePhone",t),!1}var i},GetReferrer:function(){try{return null!==document.referrer&&""!==document.referrer&&-1===document.referrer.indexOf(document.location.hostname)?discountNinja.Cache.SessionSet("original-referrer",document.referrer):null!==discountNinja.QueryParameter.Get("gclid",document.location.href)&&discountNinja.Cache.SessionSet("original-referrer","google.com"),discountNinja.Cache.SessionGet("original-referrer")}catch(t){return discountNinja.Logging.LogError("Utilities.GetReferrer",t),null}},GetEmoji:function(t){return t>65535?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):String.fromCharCode(t)},GetHandleFromSelector:function(t,i,n){try{var e=t;if(i){var o=discountNinja.Utilities.jQuery()(t).closest(i).first();1===o.length&&(e=o)}var r=n.match(/\[\[HANDLE:[^\[]*\]\]/);if(null===r||1!==r.length)return void discountNinja.Logging.LogErrorMessage("GetHandleFromSelector expects [[HANDLE:some attribute]]");var a=r[0],c=a.replace(/\[/g,"").replace(/\]/g,"").split(":")[1].toLowerCase();n=n.substring(a.length);var u=!1,s="[[SELF]]";0===n.indexOf(s)&&(u=!0,(n=n.substring(s.length)).length>0&&","===n[0]&&(n=n.substring(1)));var d=null;n.length>0&&(d=discountNinja.Utilities.jQuery()(e).find(n),discountNinja.Utilities.jQuery()(d).attr(c)||(d=null)),null===d&&u&&(d=e);var l=discountNinja.Utilities.jQuery()(d).attr(c);if(!l)return discountNinja.Logging.LogWarning("Could not find collection handle tag, looking for "+n+". Missing Dynamic Pricing data tags? The price will not be updated for the product."),!1;if(!(null!==l.match(/\/products\//)))return!1;productHandle=l.substring(l.lastIndexOf("/")+1);var g=productHandle.indexOf("?");return g>-1&&(productHandle=productHandle.substring(0,g)),decodeURIComponent(productHandle)}catch(t){return discountNinja.Logging.LogError("GetHandleFromSelector",t),null}},GetCountryName:function(t,i){try{return"undefined"==typeof Intl||void 0===Intl.DisplayNames||void 0===t||void 0===i||null===t||null===i||""===t||""===i?null:new Intl.DisplayNames([t],{type:"region"}).of(i)}catch(n){return discountNinja.Logging.LogError("GetHandleFromSelector with locale "+t+" and ISO code "+i,n),null}},CancelEventDefaultBehavior:function(t){try{return void 0!==t&&t&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),t.returnValue=!1,!1===t.defaultPrevented&&(t.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})},t.preventDefault())),t}catch(t){discountNinja.Logging.LogError("Events.CancelEventDefaultBehavior",t)}},GetRandomNumber:function(){var t="";try{t=window.crypto&&"function"==typeof window.crypto.getRandomValues?window.crypto.getRandomValues(new Uint32Array(1))[0]:Math.random().toString().slice(2)}catch(i){t=Math.random().toString().slice(2)}return t}},discountNinja_Script_VariantChange={ObservedElements:[],UnRegisterEventHandlerForVariantChange:function(){try{discountNinja.Utilities.jQuery()("body").find("form").find("select").each((function(){discountNinja.Utilities.jQuery()(this).off("change.discountninja")}))}catch(t){discountNinja.Logging.LogError("VariantChange.UnRegisterEventHandlerForVariantChange",t)}},ObserveVariantChangeInForms:function(t){try{var i=discountNinja.Utilities.jQuery()("body").find("form"),n=i.find("select");n.each((function(){!function(t,i,n,e){if(!discountNinja_Script_VariantChange.ObservedElements.includes(t)){var o=Object.getPrototypeOf(t),r=Object.getOwnPropertyDescriptor(o,i).set,a=Object.getOwnPropertyDescriptor(o,i).get,c={get:function(){return a.apply(this,arguments)},set:function(t){var o=this[i],a=r.apply(this,arguments),c=this[i];return setTimeout(n.bind(this,o,c),e),a}};Object.defineProperty(t,i,c),discountNinja_Script_VariantChange.ObservedElements.push(t)}}(this,"value",(function(i,n){t(n)}))})),n.on("change",(function(){t(this.value)})),i.find("variant-radios,variant-selects,input").on("change",(function(){setTimeout((function(){t()}),300)}))}catch(t){discountNinja.Logging.LogError("VariantChange.ObserveVariantChangeInForms",t)}},RegisterEventHandlerForVariantChange:function(){function t(t){try{i=discountNinja.Cache.SessionGet("last-known-variant"),n=discountNinja.Environment.Shopify.VariantData(),e=n?n.Id:null,i!==(o=t||e)&&(discountNinja.Cache.SessionSet("last-known-variant",o),discountNinja.VariantChangedEvent.Handle(null,o?o.toString():null))}catch(t){discountNinja.Logging.LogError("VariantChange.VariantChangeDetected",t)}var i,n,e,o}try{discountNinja_Script_VariantChange.UnRegisterEventHandlerForVariantChange(),discountNinja_Script_VariantChange.ObserveVariantChangeInForms(t),discountNinja.Utilities.jQuery()(document).on("variantChanged",(function(i,n){t()})),discountNinja.Utilities.jQuery()(document).on("limoniApps:discountNinja:VariantChanged",(function(i,n){void 0===n&&void 0!==i.detail&&void 0!==i.detail.data&&(n=i.detail.data),t()})),document.addEventListener(discountNinja.Events.GetFullQualifiedEventName("variant:changed"),(function(i){var n=null;if(void 0!==i.detail&&null!==i.detail&&(void 0!==i.detail.data||void 0!==i.detail.variant)){var e=i.detail.data?i.detail.data:i.detail;n=e&&e.variant?e.variant.id?e.variant.id:e.variant:null}t(n)}))}catch(t){discountNinja.Logging.LogError("VariantChange.RegisterEventHandlerForVariantChange",t)}}},discountNinja_Script_XmlHttpRequest={RequestsHandled:{},LastErrorStatus:0,EnableDebugging:!1,HandleFetch:function(t,i,n){try{if(discountNinja_Script_XmlHttpRequest.EnableDebugging&&console.log("HandleFetch called "+t),!("string"==typeof t&&null!==t&&""!==t)&&"object"==typeof i)try{t=i.href}catch(t){}var e=function(t){try{if(null==t)return null;var i="x-request-id";if(t.headers&&t.headers[i]){var n=t.headers[i];return"string"==typeof n?n:null}return null}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.GetRequestIdHeader",t)}}(i);if(discountNinja_Script_XmlHttpRequest.EnableDebugging&&console.log("Fetch for request id: "+e),!discountNinja_Script_XmlHttpRequest.ShouldHandleRequest(e))return;discountNinja_Script_XmlHttpRequest.HandleNetworkRequest(t,i,n)}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.HandleFetch",t)}},RegisterToAjaxEvents:function(){try{"function"==typeof discountNinja.Utilities.jQuery()(document).ajaxSuccess&&discountNinja.Utilities.jQuery()(document).ajaxSuccess((function(t,i,n){discountNinja_Script_XmlHttpRequest.HandleAjaxSuccess(t,i,n)}))}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.RegisterToAjaxEvents",t)}},HandleAjaxSuccess:function(t,i,n){try{if(null==i)return;if(4===i.readyState){if(discountNinja_Script_XmlHttpRequest.EnableDebugging&&console.log("HandleAjaxSuccess called "),!discountNinja_Script_XmlHttpRequest.CanHandleRequest(i))return;var e=discountNinja_Script_XmlHttpRequest.GetRequestIdHeader(i);if(!discountNinja_Script_XmlHttpRequest.ShouldHandleRequest(e))return;var o=n.url;discountNinja_Script_XmlHttpRequest.HandleNetworkRequest(o,n.data,i.responseText)}}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.HandleAjaxSuccess",t)}},GetRequestIdHeader:function(t){try{var i="x-request-id";if(t.getAllResponseHeaders().indexOf(i)>=0){var n=t.getResponseHeader(i);return"string"==typeof n?n:null}return null}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.GetRequestIdHeader",t)}},CanHandleRequest:function(t){try{var i=t.responseType,n="text"!==i&&""!==i&&"document"!==i&&!function(t){try{return"string"==typeof t.responseText}catch(t){return!1}}(t);return!n}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.HandleAjaxSuccess",t)}},ShouldHandleRequest:function(t){try{var i=discountNinja_Script_XmlHttpRequest;return null===t||!0!==i.RequestsHandled[t]&&(i.RequestsHandled[t]=!0,!0)}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.ShouldHandleRequest",t)}},HandleSend:function(t){try{if(4===this.readyState){if(discountNinja_Script_XmlHttpRequest.EnableDebugging&&console.log("HandleSend (XmlHttp) called "),!discountNinja_Script_XmlHttpRequest.CanHandleRequest(this))return;var i=discountNinja_Script_XmlHttpRequest.GetRequestIdHeader(this);if(!discountNinja_Script_XmlHttpRequest.ShouldHandleRequest(i))return;var n=this.responseURL||this._url,e=""===this.responseType||"text"===this.responseType?this.responseText:null;discountNinja_Script_XmlHttpRequest.HandleNetworkRequest(n,t,e)}}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.HandleSend",t)}},HandleNetworkRequest:function(t,i,n){try{LimoniAppsLoadJQuery((function(){try{LimoniAppsLoadDayJs((function(){try{"object"==typeof t&&"string"==typeof t.url&&(t=t.url),"string"==typeof t&&null!==t?(discountNinja_Script_XmlHttpRequest.EnableDebugging&&console.log("HandleNetworkRequest called for url "+t),!function(t){return t.indexOf("/cart/add")>-1}(t)?!function(t){return t.indexOf("/cart/change")>-1}(t)?!function(t){return t.indexOf("/cart/update")>-1}(t)?function(t){return(t.indexOf("collections")>-1||t.indexOf("search")>-1)&&(t.indexOf("?page=")>-1||t.indexOf("&page=")>-1)}(t)||function(t){return t.indexOf("collections")>-1&&t.indexOf("sort_by")>-1}(t)||function(t){return t.indexOf("collections")>-1&&t.indexOf("view=")>-1}(t)||function(t){return(t.indexOf("collections")>-1||t.indexOf("search")>-1)&&(t.indexOf("?filter")>-1||t.indexOf("&filter")>-1)}(t)?discountNinja.ServerCollectionProductsPageLoadedEvent.Handle(!1):(function(t){return t.indexOf("/search")>-1||t.indexOf("operation=search")>-1}(t)||function(t){return t.indexOf("/recommendations/products")>-1}(t))&&discountNinja.ServerCollectionProductsPageLoadedEvent.Handle(!0):"string"==typeof i&&0===i.indexOf('{"attributes":{"'+discountNinja_Script_OffersAttribute.Id)?discountNinja.ServerCartItemsUpdatedEvent.Handle(t,i,n,!1):discountNinja.ServerCartItemsUpdatedEvent.Handle(t,i,n,!0):discountNinja.ServerCartItemsChangedEvent.Handle(t,i,n,!0):discountNinja.ServerCartItemsAddedEvent.Handle(t,i,n,!0)):discountNinja.Logging.LogWarning("Invalid url in HandleNetworkRequest")}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.HandleNetworkRequest",t)}}))}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.HandleNetworkRequest",t)}}))}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.HandleNetworkRequest",t)}},SendIntercepted:!1,CreateSendInterceptor:function(){function t(){try{return"undefined"!=typeof XMLHttpRequest&&"function"==typeof XMLHttpRequest.prototype.send&&XMLHttpRequest.prototype.send.toString().indexOf("discountNinja")>-1}catch(t){return discountNinja.Logging.LogError("XMLHttpRequest.XmlHttpInterceptIsConnected",t),!1}}if(!t())if("undefined"!=typeof XMLHttpRequest){XMLHttpRequest.prototype.send=function(t,i,n){return function(e){try{this.addEventListener(t,i.bind(this,e))}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.CreateSendInterceptor",t)}return n.apply(this,arguments)}}("readystatechange",discountNinja_Script_XmlHttpRequest.HandleSend,XMLHttpRequest.prototype.send);var i=setInterval((function(){t()||(discountNinja.Logging.LogWarning("[DiscountNinja] XMLHttpRequest interceptor disconnected"),clearInterval(i))}),500)}else discountNinja.Logging.LogErrorMessage("Core","XMLHttpRequest not available")},FetchIntercepted:!1,CreateFetchInterceptor:function(){function t(){try{return void 0!==window.fetch&&window.fetch.toString().indexOf("LimoniAppsDiscountNinjaAsyncWindowFetchHandler")>-1}catch(t){return discountNinja.Logging.LogError("XMLHttpRequest.FetchInterceptIsConnected",t,!0),!0}}try{if(t())return}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.CreateFetchInterceptor",t,!0)}if(discountNinja_Script_XmlHttpRequest.BrowserSupportsFetch()){try{var i="undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]"),n=window.fetch;i&&(window.fetch=function(){var t=n.apply(window,arguments);try{var i=arguments[0],e="object"==typeof i?i.url:i.toString(),o=arguments[1],r="object"==typeof i?i.body:"object"==typeof o?o.body:null;try{t.then((function(t){return t.ok?t.clone().text():null})).then((function(t){try{return JSON.parse(t)}catch(t){return null}})).then((function(t){discountNinja_Script_XmlHttpRequest.HandleFetch(e,r,t)}))}catch(t){discountNinja.Logging.LogToConsole("error",t,"red",!1)}}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.CreateFetchInterceptor",t,!0)}return t})}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.CreateFetchInterceptor",t)}try{var e=setInterval((function(){t()||(discountNinja.Logging.LogWarning("[DiscountNinja] Fetch interceptor disconnected"),clearInterval(e))}),500)}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.CreateFetchInterceptor",t)}}else discountNinja.Logging.LogErrorMessage("Core","Fetch not available")},XmlHttpRequestObject:function(){return"undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},_FlagUseFetch:null,FlagUseFetch:function(){var t=discountNinja_Script_XmlHttpRequest;return null===t._FlagUseFetch&&(t._FlagUseFetch=!0===discountNinja.Settings.GetFlag("UseFetch")),t._FlagUseFetch},BrowserSupportsFetch:function(){return void 0!==window.fetch},UseFetch:function(){return discountNinja_Script_XmlHttpRequest.FlagUseFetch()&&discountNinja_Script_XmlHttpRequest.BrowserSupportsFetch()},Fetch:function(t,i,n,e,o,r,a,c){try{var u={method:i,headers:{"Content-Type":n}};!0===o&&(u.mode="no-cors"),null!==e&&(u.body=e),!0===r&&(u.cache="no-cache"),discountNinja.Logging.Tracing&&alert("Sending to url: "+t),discountNinja.Logging.Tracing&&alert("With request options: "+JSON.stringify(u)),fetch(t,u).then((function(t){if(void 0!==t&&!0===t.ok)return t.json();discountNinja.Logging.LogError("XMLHttpRequest.Fetch - Unexpected result",t)})).then((function(t){a&&a(t)})).catch((function(t){c&&c(t)}))}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.Fetch",t)}},CreateQueryStringFromParameters:function(t,i,n){function e(t,i,n){var e=discountNinja.Utilities.EncodeUriComponentForQueryString;return""===t?t="?":t+="&",t=t+e(i)+"="+e(n)}try{if("object"==typeof t&&null!==t||(t={}),!0===i)t.shop=discountNinjaContext.Shop,t[n?"dnsignature":"signature"]=discountNinjaContext.Signature,t.status=discountNinjaContext.Status;for(var o=Object.getOwnPropertyNames(t),r="",a=0;a<o.length;a++){var c=o[a],u=t[c];if("string"==typeof u&&null!==u&&""!==u)for(var s=u.split(","),d=0;d<s.length;d++)r=e(r,c,s[d]);else r=e(r,c,u)}return r}catch(t){return console.error("CreateQueryStringFromParameters failed",t),""}},Send:function(t,i,n,e,o,r,a,c,u,s,d,l){try{if(null==d&&(d=5),null==s&&(s=1),s>d){if(r){var g="SendHttpRequest failed. Retry iterations ("+d+") exceeded for url "+t;discountNinja.Logging.LogErrorMessage("XMLHttpRequest.Send",g)}return void("function"==typeof u&&null!==u&&u(discountNinja_Script_XmlHttpRequest.LastErrorStatus,g))}!function(t,i,e,o,r,c,u,s,d){function g(l){if(!0!==N.requestOnFailureProcessed){N.requestOnFailureProcessed=!0;var g="Could not "+e+" data from "+p+" on attempt "+s+". Request status: "+l+" - Parameters: "+JSON.stringify(i);r&&discountNinja.Logging.LogWarning(g,!0);var f=Math.pow(2,s)*(400+100*Math.random());401===l?u&&u():setTimeout((function(){discountNinja_Script_XmlHttpRequest.Send(t,i,n,e,o,r,a,c,u,s+1,d)}),f)}}var f=discountNinja_Script_XmlHttpRequest.CreateQueryStringFromParameters(i,a,!0),p=t+f,N=discountNinja_Script_XmlHttpRequest.XmlHttpRequestObject();N.open(e,p,!0);var j=void 0!==discountNinjaContext.Signature;!0===l&&N.setRequestHeader("cache-control","no-cache"),!0===a&&discountNinjaContext.AccessToken&&"4"!==discountNinja.Core.ApiVersion&&!j&&(N.setRequestHeader("X-LimoniApps-AccessToken",discountNinjaContext.AccessToken),N.setRequestHeader("X-LimoniApps-Status",discountNinjaContext.Status));var C=discountNinja.LogSession.GetId();C&&N.setRequestHeader("X-LimoniApps-SessionId",C),N.onreadystatechange=function(){var t;4===N.readyState&&((t=N.status)>=200&&t<=204||t>=300&&t<=304?function(t){var i=null;try{if(null!=t){if("text"!==t.responseType&&""!==t.responseType&&"string"!=typeof t.responseText)return;var n=t.responseText;try{i=o?null==n?null:JSON.parse(n):n}catch(t){}}else discountNinja.Logging.LogWarning("XMLHttpRequest.requestOnSuccess received empty xhr")}catch(t){discountNinja.Logging.LogError("XMLHttpRequest.requestOnSuccess failed",t)}"function"==typeof c&&null!==c&&c(i)}(N):(discountNinja_Script_XmlHttpRequest.LastErrorStatus=t,g(t)))},N.onerror=function(){g(status)},null===n?N.send():(N.setRequestHeader("Content-Type",j&&a?"text/plain":"application/json"),o?N.send(JSON.stringify(n)):N.send(n))}(t,i,e,o,r,c,u,s,d)}catch(i){try{discountNinja.Logging.LogToConsole("error","Error occurred in Send for url "+t+". Error: "+i)}catch(t){}try{"function"==typeof u&&null!==u&&u(500,i)}catch(t){}}}},discountNinja_Script_TextScaling={ReplacePxWithRem:function(t,i){for(var n,e=discountNinja.Utilities.IsMobilePhone()?i:1,o=new RegExp("font-size:(\\s)*(\\d+)(.)?(\\d+)px","g");null!==(n=o.exec(t));){var r=parseFloat(n[0].replace("px","").replace("font-size:","")),a=new RegExp("font-size:(\\s)*"+r+"px","g");t=t.replace(a,"font-size:"+r*e+"[[scaledpixels]]")}return t.replace(/\[\[scaledpixels\]\]/g,"px")}},discountNinja_Script_DateTime={UnixTimestamp:function(){return dayjs().unix()},UtcNow:function(){return dayjs()},GetUtc:function(t){return dayjs(t)},DiffInSeconds:function(t,i){return t.diff(i,"seconds")},GetDuration:function(t,i){function n(t,i,n){return t>0&&null!==i&&(o=o.add(t,i)),e.diff(o,n)}var e=t,o=i,r=n(0,null,"d"),a=n(r,"d","h"),c=n(a,"h","m");return{d:r,h:a,m:c,s:n(c,"m","s")}},FormatDate:function(t,i){try{if(null===i||""===i)return"";var n=dayjs(t);if(i.indexOf("Do")){var e=n.format("DD");i="01"===e||"21"===e||"31"===e?i.replace("Do","D[st]"):"02"===e||"22"===e?i.replace("Do","D[nd]"):"03"===e||"23"===e?i.replace("Do","D[rd]"):i.replace("Do","D[th]")}return n.format(i)}catch(t){return discountNinja.Logging.LogError("DateTime.FormatDate",t),null}}},discountNinja_Script_LeakyBucket={Buckets:{Prefix:"bucket-",ProductLiquid:"product-liquid",ProductApi:"product-api"},Take:function(t){var i=discountNinja.Cache.SessionGet(discountNinja_Script_LeakyBucket.Buckets.Prefix+t),n=null===i||""===i?null:parseInt(i);if(null===n)return discountNinja.Logging.LogErrorMessage("LeakyBucket","Bucket "+t+" is not initialized"),!0;n=n>0?n-1:0,discountNinja.Cache.SessionSet(discountNinja_Script_LeakyBucket.Buckets.Prefix+t,n);var e=n>0;return e},Initialize:function(t,i,n){function e(t,i){discountNinja.Cache.SessionSet(discountNinja_Script_LeakyBucket.Buckets.Prefix+t,i)}e(t,n),setInterval((function(){e(t,n)}),i)}},discountNinja_Script_VariantChangedEvent={CurrentVariant:null,Handle:function(t,i){function n(){discountNinja.DynamicPricing.UpdatePrice(!0,!0),discountNinja.DiscountedProduct.CurrentVariantData&&discountNinja.Events.Publish("variant:priceavailable",{Variant:discountNinja.DiscountedProduct.CurrentVariantData})}try{if(discountNinja_Script_VariantChangedEvent.CurrentVariant==i)return;discountNinja_Script_VariantChangedEvent.CurrentVariant=i?i.toString():null,n(),discountNinja.Settings.GetFlag("VariantPriceUpdateRequiresDelay")&&(setTimeout((function(){n()}),50),setTimeout((function(){n()}),100),setTimeout((function(){n()}),500),setTimeout((function(){n()}),1e3),setTimeout((function(){n()}),1500))}catch(t){discountNinja.Logging.LogError("VariantChangedEvent",t)}},Subscribe:function(){discountNinja.Events.Subscribe("VariantChanged",discountNinja_Script_VariantChangedEvent.Handle),discountNinja.Events.Subscribe("variant:changed",discountNinja_Script_VariantChangedEvent.Handle)}},discountNinja_Script_ServerCartItemsAddedEvent={Handle:function(t,i,n,e){discountNinja.ServerCartItemsChangedEvent.Handle(t,i,n,e)},Subscribe:function(){discountNinja.Events.Subscribe("ServerCartItemsAdded",discountNinja_Script_ServerCartItemsAddedEvent.Handle)}},discountNinja_Script_ServerCartItemsUpdatedEvent={Handle:function(t,i,n,e){discountNinja.ServerCartItemsChangedEvent.Handle(t,i,n,e)},Subscribe:function(){discountNinja.Events.Subscribe("ServerCartItemsUpdated",discountNinja_Script_ServerCartItemsUpdatedEvent.Handle)}},discountNinja_Script_ServerCartItemsChangedEvent={Handle:function(t,i,n,e){try{if(!discountNinja.Cart.Shopify.LockRefreshCart){var o=discountNinja.Cart.Shopify.GetCartObjectFromNetworkResponse(n);o&&discountNinja.Cart.Shopify.UpdateCartFromNetworkResponse(o)?e&&discountNinja.Cart.Shopify.OnUpdateCart():(discountNinja.Cart.Shopify.IsDirty=!0,discountNinja.Cart.Shopify.UpdateCartDebounced((function(){discountNinja.Cart.Shopify.OnUpdateCart()})))}}catch(t){discountNinja.Logging.LogError("ServerCartItemsChangedEvent",t)}},Subscribe:function(){discountNinja.Events.Subscribe("ServerCartItemsChanged",discountNinja_Script_ServerCartItemsChangedEvent.Handle)}},discountNinja_Script_ServerCollectionProductsPageLoadedEvent={Handle:function(t){try{var i=!0===t?"search:productsadded":"collection:productsadded";setTimeout((function(){discountNinja.Events.Publish(i),setTimeout((function(){discountNinja.Events.Publish(i)}),1e3)}),500)}catch(t){discountNinja.Logging.LogError("ServerCollectionProductsPageLoadedEvent",t)}},Subscribe:function(){discountNinja.Events.Subscribe("ServerCollectionProductsPageLoaded",discountNinja_Script_ServerCollectionProductsPageLoadedEvent.Handle)}},discountNinja_Script_LocalCartUpdatedEvent={Handle:function(t,i,n,e){try{if(e)return;n&&discountNinja.DiscountedCart.BuildDiscountedCart(null)}catch(t){discountNinja.Logging.LogError("LocalCartUpdatedEvent",t)}},Subscribe:function(){discountNinja.Events.Subscribe("LocalCartUpdated",discountNinja_Script_LocalCartUpdatedEvent.Handle)}},discountNinja_Script_AccountLogin={AccountCreationDuringCheckoutCacheKey:"AccountCreationDuringCheckout",RedirectToCartParameter:"redirect_to_cart_afterlogin",CheckoutUrlHiddenField:"checkout_url",ReturnToHiddenField:"return_to",CheckRedirect:function(){function t(t,i,n){var e=discountNinja.Html.GetNodes("input[name='"+i+"']");if(e)for(var o=0;o<e.length;o++)e[o].value=n;else!function(t,i,n){var e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name",i),e.setAttribute("value",n),t.appendChild(e)}(t,i,n)}function i(){return Shopify.routes.root+"cart"}try{if(!discountNinja.Environment.Shopify.IsAccountPage())return void discountNinja.Cache.SessionRemove(discountNinja_Script_AccountLogin.AccountCreationDuringCheckoutCacheKey);if(!(!1!==discountNinja.Settings.GetFlag("ApplyPromotionsOnRedirectLoginFromCheckout")))return;!discountNinja.Checkout.Shopify.RequiresAdvancedCheckout()&&!function(){if(null!==discountNinja.Offer.Triggers)for(var t=0;t<discountNinja.Offer.Triggers.length;t++){var i=discountNinja.Offer.Triggers[t];if(!1===i.Triggered&&void 0!==i.Filter.CustomerType)return!0}return!1}()||null===discountNinja.QueryParameter.Get(discountNinja_Script_AccountLogin.CheckoutUrlHiddenField,window.location.href)&&"true"!==discountNinja.Cache.SessionGet(discountNinja_Script_AccountLogin.AccountCreationDuringCheckoutCacheKey)||(discountNinja.Cache.SessionSet(discountNinja_Script_AccountLogin.AccountCreationDuringCheckoutCacheKey,!0),(n=discountNinja.Utilities.jQuery())('form[action*="/account/login"][method="post"]').each((function(){var e=i();t(n(this)[0],discountNinja_Script_AccountLogin.CheckoutUrlHiddenField,e)})),function(){var n=discountNinja.Utilities.jQuery();n('form[action$="/account"][method="post"]').each((function(){var e=i();t(n(this)[0],discountNinja_Script_AccountLogin.ReturnToHiddenField,e)}))}())}catch(t){discountNinja.Logging.LogError("AccountLogin.Register",t)}var n}},discountNinja_Script_OffersAttribute={Id:"__limoniappsdiscountninja",Add:function(t){return new Promise(((i,n)=>{try{!function(){try{discountNinja.Html.RemoveNodes("#"+discountNinja_Script_OffersAttribute.Id)}catch(t){discountNinja.Logging.LogError("OffersAttribute.RemoveFromForm",t)}}(),""!==t&&function(t){try{var i=discountNinja.Checkout.Shopify.GetCheckoutForms(),n=t.replace(/\"/g,"&quot;"),e=discountNinja_Script_OffersAttribute.Id,o='<input id="'+e+'" type="hidden" name="attributes['+e+']" value="'+n+'">';i.prepend(o)}catch(t){discountNinja.Logging.LogError("OffersAttribute.AddToForm",t)}}(t);discountNinja_Script_OffersAttribute.Id;var e=discountNinja_Script_OffersAttribute.Id;if(discountNinja.Cache.SessionGet(e)===t)return void i();discountNinja.Cart.Shopify.SetAttribute(discountNinja_Script_OffersAttribute.Id,t).then((function(){discountNinja.Cache.SessionSet(e,t),i()})).catch((function(){n()}))}catch(t){discountNinja.Logging.LogError("OffersAttribute.AddToCart",t),n()}}))},Remove:function(){discountNinja_Script_OffersAttribute.Add("")}},discountNinja_Script_LogSession={TimeToLoad:null,TimeToComplete:null,Start:function(){try{if(!0!==discountNinja.Settings.Settings.TrackSession)return;if(!discountNinja_Script_LogSession.GetId()){var t=discountNinja.Utilities.NewGuid();discountNinja.Cache.SessionSet("SessionLogId",t),discountNinja.Cache.LocalSet("SessionLogId",t);var i={SessionLogId:t,Context:{Device:discountNinja.DeviceId.Get(),Browser:function(){var t="Unknown browser";try{t=navigator.userAgent}catch(t){}return t}(),OperatingSystem:function(){var t="Unknown OS";try{t=navigator.platform}catch(t){}return t}(),PromotionToken:discountNinja.Token.GetTokenFromQueryParameter(),Host:window.host,Shop:discountNinja.Core.Shop}};discountNinja.XmlHttpRequest.Send(discountNinja.Api.Endpoint("promotionevents","5.1")+"/LogSessionContext",null,i,"post",!0,!1,!0,null,null,1,1)}}catch(t){discountNinja.Logging.LogError("LogSession.Start",t)}},PromotionsApplied:function(t,i,n,e){try{if(!0!==discountNinja.Settings.Settings.TrackSession)return;var o="LogSession-PromotionsApplied";if("true"===discountNinja.Cache.SessionGet(o))return;discountNinja.Cache.SessionSet(o,"true");var r="",a="";if(null!==t)for(var c=0;c<t.length;c++)r=r+t[c].Token+",";if(null!==i)for(c=0;c<i.length;c++)a=a+i[c].Token+",";var u={SessionLogId:discountNinja_Script_LogSession.GetId(),PromotionsApplied:{OfferTokens:r,TriggerTokens:a,Source:n,SourceReason:e}};discountNinja.XmlHttpRequest.Send(discountNinja.Api.Endpoint("promotionevents","5.1")+"/LogPromotionsApplied",null,u,"post",!0,!1,!0,null,null,1,1)}catch(t){discountNinja.Logging.LogError("LogSession.PromotionsApplied",t)}},CheckoutInitiated:function(t){try{if(!0!==discountNinja.Settings.Settings.TrackSession)return;var i={SessionLogId:discountNinja_Script_LogSession.GetId(),CheckoutInitiated:{PayLoad:JSON.stringify(t)}};discountNinja.XmlHttpRequest.Send(discountNinja.Api.Endpoint("promotionevents","5.1")+"/LogCheckoutInitiated",null,i,"post",!0,!1,!0,null,null,1,1)}catch(t){discountNinja.Logging.LogError("LogSession.CheckoutInitiated",t)}},CheckoutRedirect:function(t,i,n){try{if(!0!==discountNinja.Settings.Settings.TrackSession)n&&n();else{var e={SessionLogId:discountNinja_Script_LogSession.GetId(),CheckoutRedirect:{Url:t,DiscountCode:i}};discountNinja.XmlHttpRequest.Send(discountNinja.Api.Endpoint("promotionevents","5.1")+"/LogCheckoutRedirect",null,e,"post",!0,!1,!0,(function(){n&&n()}),(function(){n&&n()}),1,1)}}catch(t){n&&n()}},RegisterTimeToLoad:function(){try{if(null!==discountNinja_Script_LogSession.TimeToLoad)return;if(void 0===window.performance||void 0===window.performance.timing)return;discountNinja_Script_LogSession.TimeToLoad=(new Date).getTime()-window.performance.timing.navigationStart}catch(t){console.error("RegisterTimeToLoad failed",t)}},RegisterTimeToComplete:function(){try{if(null!==discountNinja_Script_LogSession.TimeToComplete)return;if(void 0===window.performance||void 0===window.performance.timing)return;discountNinja_Script_LogSession.TimeToComplete=(new Date).getTime()-window.performance.timing.navigationStart-discountNinja_Script_LogSession.TimeToLoad}catch(t){console.error("RegisterTimeToComplete failed",t)}},PrintPerformance:function(t){try{if(null!==discountNinja_Script_LogSession.TimeToComplete)return;if(void 0===window.performance||void 0===window.performance.timing)return;var i=(new Date).getTime()-window.performance.timing.navigationStart-discountNinja_Script_LogSession.TimeToLoad;discountNinja.Logging.LogPerformance&&console.log("Discount Ninja - PERFORMANCE - Time elapsed until step "+t+": "+i+"ms")}catch(t){console.error("PrintPerformance failed",t)}},LogPerformance:function(){try{if(!0!==discountNinja.Settings.Settings.TrackSession)return;if(null===discountNinja_Script_LogSession.TimeToLoad||null===discountNinja_Script_LogSession.TimeToComplete)return;var t={SessionLogId:discountNinja_Script_LogSession.GetId(),Performance:{PathName:window.location.pathname,TimeToLoad:discountNinja_Script_LogSession.TimeToLoad,TimeToComplete:discountNinja_Script_LogSession.TimeToComplete}};discountNinja.XmlHttpRequest.Send(discountNinja.Api.Endpoint("promotionevents","5.1")+"/LogPerformance",null,t,"post",!0,!1,!0,null,null,1,1),console.info("Discount Ninja performance: loaded after "+discountNinja_Script_LogSession.TimeToLoad+"ms and completed after another "+discountNinja_Script_LogSession.TimeToComplete+"ms")}catch(t){discountNinja.Logging.LogError("LogSession.LogPerformance",t)}},LogError:function(t){try{if(null===discountNinja.Settings.Settings||!0!==discountNinja.Settings.Settings.TrackSession)return;var i=function(){try{var t=discountNinja.Cache.SessionGet("LogError-MessagesSent");return null===t||isNaN(t)?0:parseInt(t)}catch(t){return 0}}();if(i>=5)return;!function(t){discountNinja.Cache.SessionSet("LogError-MessagesSent",t+1)}(i);var n={SessionId:discountNinja_Script_LogSession.GetId(),Exception:"Script error - "+t};discountNinja.XmlHttpRequest.Send(discountNinja.Api.Endpoint("promotionevents","5.1")+"/LogError",null,n,"post",!0,!1,!0,null,null,1,1)}catch(t){console.error("LogSession.LogError",t)}},GetId:function(){return discountNinja.Cache.SessionGet("SessionLogId")}},discountNinja_Script_Checkout_Shopify={RedirectingToCheckout:!1,ProcessingCheckout:!1,SkipProcessingCheckout:!1,LoadingCheckoutPopUpId:"LimoniApps-DiscountNinja-Checkout",LoadingCheckoutPopUpMessageId:"LimoniApps-DiscountNinja-Checkout-Message",LoadingCheckoutPopUpDotsId:"LimoniApps-DiscountNinja-Checkout-Dots",CheckoutDiscountCodesCacheKey:"checkout-discount-codes",FallBackEvent:null,FallbackCallback:null,FallBackTimeoutHandle:null,ProcessingPrepareAdvancedCheckout:!1,CheckoutButton:null,InjectLoadingCheckoutPopUp:function(){var t=discountNinja_Script_Checkout_Shopify;if(null===document.getElementById(t.LoadingCheckoutPopUpId)){var i=discountNinja.Settings.Settings.Checkout,n='<div id="'+t.LoadingCheckoutPopUpId+'" style="display:none;background-color:{{CHECKOUT_OVERLAY_BACKGROUND_COLOR}};" class="limoniapps-popup limoniapps-size-small limoniapps-overlay-5 limoniapps-shape-square limoniapps-align-center limoniapps-content-bottom"><div class="limoniapps-popup-vertical-alignment-helper"><div class="limoniapps-popup-vertical-align-center"><div class="limoniapps-content" style="background-color:{{CHECKOUT_BACKGROUND_COLOR}};"><div id="'+discountNinja_Script_Checkout_Shopify.LoadingCheckoutPopUpMessageId+'" class="limoniapps-body"></div></div></div></div></div>';n=(n=n.replace("{{CHECKOUT_BACKGROUND_COLOR}}",i.PopupBackgroundColor||"white")).replace("{{CHECKOUT_OVERLAY_BACKGROUND_COLOR}}",i.OverlayBackgroundColor||"rgba(0,0,0,0.7)");var e=discountNinja.Utilities.CreateFragment(n);document.body.insertBefore(e,document.body.childNodes[0])}},ShowCheckoutPopUp:function(t,i){try{var n=discountNinja_Script_Checkout_Shopify,e=discountNinja.Settings.Settings.Checkout;if(!0===e.HideCheckoutLoadingOverlay)return;var o=document.getElementById(n.LoadingCheckoutPopUpId);t?(n.SetLoadingCheckoutPopUpMessage(e["LoadingCheckoutMessage"+i]),o&&(o.style.display="")):o&&(o.style.display="none")}catch(t){discountNinja.Logging.LogError("ShowCheckoutPopUp",t)}},GetFirstVisibleCheckoutForm:function(t){var i=discountNinja_Script_Checkout_Shopify,n=i.GetCheckoutForms(t,!t).filter(":visible");if(0===n.length)return i.GetCheckoutForms().filter(":visible").first();if(1===n.length)return n.first();var e=t?".limoniapps-discountninja-drawercart-root":".limoniapps-discountninja-cart-root",o=n.filter(e);if(1===o.length)return o.first();var r=n.parents(e);return 1===r.length?r.find("form").first():n.find(discountNinja.Environment.Shopify.SelectorCheckoutButton()).parents("form").first()},GetCheckoutForms:function(t,i){var n=discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutForm());return!0===t?n.not(".limoniapps-discountninja-cart-root"):!0===i?n.not(".limoniapps-discountninja-drawercart-root"):n},GetCheckoutFormAction:function(){var t=discountNinja_Script_Checkout_Shopify.GetFirstVisibleCheckoutForm();return t.length>0?t.attr("action"):null},DefaultCheckoutLink:function(){return discountNinja.Environment.Shopify.RootRoute()+"/checkout"},BuildClassicCheckoutLink:function(t){function i(t,i){for(var n=0;n<t.length;n++)if(t[n].Key&&t[n].Key.toLowerCase()===i.toLowerCase())return!0}var n=discountNinja_Script_Checkout_Shopify,e=n.DefaultCheckoutLink(),o=[];try{var r=n.GetCheckoutFormAction();"string"==typeof r&&null!==r||(r="");for(var a=r.lastIndexOf("?"),c=r&&a>-1?r.substring(a+1).split("&"):[],u=0;u<c.length;u++)try{var s=c[u].split("=");o.push({Key:s[0],Value:s[1]})}catch(t){discountNinja.Logging.LogErrorMessage("RegisterEventHandlerForCheckout.FallBack","Error occurred in setting classic checkout link - cart action item "+t)}}catch(t){discountNinja.Logging.LogErrorMessage("RegisterEventHandlerForCheckout.FallBack","Error occurred in setting classic checkout link - cart action "+t)}try{if(null!=t&&""!==t)o.push({Key:"discount",Value:t});else if(!i(o,"discount")){var d=discountNinja.DiscountCode.GetFirstActiveDiscountCodeForCheckout(!0);""!==d&&o.push({Key:"discount",Value:d})}}catch(t){discountNinja.Logging.LogErrorMessage("RegisterEventHandlerForCheckout.FallBack","Error occurred in setting classic checkout link - discount "+t)}try{if(!i(o,"locale")){var l=discountNinja.Environment.Shopify.Locale();l&&o.push({Key:"locale",Value:l})}}catch(t){discountNinja.Logging.LogErrorMessage("RegisterEventHandlerForCheckout.FallBack","Error occurred in setting classic checkout link - locale "+t)}for(u=0;u<o.length;u++)e=discountNinja.QueryParameter.AppendToUrl(e,o[u].Key,o[u].Value);return e},FallBack:function(t,i,n){var e=discountNinja_Script_Checkout_Shopify;try{var o="Redirecting to standard checkout, reason: "+t;e.ShowAlert(o),!0===n&&e.ShowCheckoutPopUp(!0,2),function(t,i){var o=discountNinja.Utilities.jQuery();e.ProcessingCheckout=!1;var r=discountNinja.Settings.Settings.Checkout;n||e.SetLoadingCheckoutPopUpMessage(r.LoadingCheckoutMessage3),e.RedirectingToCheckout=!0,e.RegisterOnPageshowPersisted();var a=null,c=e.CheckoutButton?e.CheckoutButton:null;if("true"===discountNinja.Cache.SessionGet("RedirectToCheckoutOnFallBackUsingSubmit")||!0===discountNinja.Settings.GetFlag("RedirectToCheckoutOnFallBackUsingSubmit")){var u=null!==e.FallBackEvent&&void 0!==e.FallBackEvent.originalEvent?e.FallBackEvent.originalEvent:e.FallBackEvent;if(c||(c=u?u.target:null),c){var s=c.tagName.toLowerCase();if("input"!==s&&"button"!==s){var d=o(c).closest("input,button");d.length>0&&(c=d[0])}}if(a=null,c){var l=o(c),g=l.attr("form");a=g?o("#"+g):l.closest(discountNinja.Environment.Shopify.SelectorCheckoutForm())}}if(null!==a&&1===a.length&&"function"==typeof a[0].submit&&null!==c)try{var f=!1;!0===c.disabled&&(c.disabled=!1,f=!0),o(c).click(),f&&(c.disabled=!0,e.CheckoutButton=c)}catch(t){discountNinja.Logging.LogError("RegisterEventHandlerForCheckout.FallBack - Error when programmatically clicking checkout form submit button",t)}else"true"===discountNinja.Cache.SessionGet("RedirectToCheckoutOnFallBack")||!0===discountNinja.Settings.GetFlag("RedirectToCheckoutOnFallBack")?e.RedirectToStandardCheckoutFallback(t):e.FallbackCallback?discountNinja.LogSession.CheckoutRedirect("FallbackCallback",i,(function(){e.FallbackCallback()})):e.RedirectToStandardCheckoutFallback(t)}(e.BuildClassicCheckoutLink(i),i)}catch(t){discountNinja.Logging.LogError("RegisterEventHandlerForCheckout.FallBack",t),e.RedirectToStandardCheckoutFallback(e.DefaultCheckoutLink())}},RedirectToStandardCheckoutFallback:function(t){try{var i=discountNinja_Script_Checkout_Shopify;i.ShowAlert("Redirecting to standard checkout in fallback mode"),i.RedirectingToCheckout=!0,discountNinja.LogSession.CheckoutRedirect(t,null,(function(){i.ShowLoadingCursor(!0),window.location.href=t}))}catch(t){discountNinja.Logging.LogError("RegisterEventHandlerForCheckout.RedirectToStandardCheckoutFallback",t)}},ShowLoadingCursor:function(t){try{var i=discountNinja.Utilities.jQuery();i(discountNinja.Environment.Shopify.SelectorCheckoutButton()).css("cursor",t?"progress":"pointer"),i("body").css("cursor",t?"progress":"unset")}catch(t){discountNinja.Logging.LogError("ShowLoadingCursor",t)}},GetCheckoutDiscountCodes:function(){try{var t=discountNinja_Script_Checkout_Shopify.CheckoutDiscountCodesCacheKey,i=discountNinja.Cache.SessionGet(t);try{i=i?JSON.parse(i):[]}catch(t){i=[]}return i}catch(t){return discountNinja.Logging.LogError("GetCheckoutDiscountCodes",t),[]}},RegisterOnPageshowPersisted:function(){try{window.addEventListener("pageshow",(function(t){try{if(t.persisted){var i=discountNinja_Script_Checkout_Shopify;i.ShowCheckoutPopUp(!1),i.RedirectingToCheckout=!1,i.ProcessingCheckout=!1;var n=i.CheckoutButton;null!==n&&(n.disabled=!1,n=null),i.ShowLoadingCursor(!1)}}catch(t){discountNinja.Logging.LogError("onpageshow",t)}}))}catch(t){discountNinja.Logging.LogError("RegisterOnPageshowPersisted",t)}},RedirectToCheckout:function(t,i,n,e,o,r){function a(){try{discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutForm()).each((function(){if(!discountNinja.Utilities.jQuery()(this).hasClass("discountninja-ignore")){var t=function(t){try{return discountNinja.QueryParameter.RemoveFromUrl(t,"remove_discount_code","1")}catch(t){discountNinja.Logging.LogError("DiscountCode.UndoInstructCheckoutToRemoveDiscountCodeInner",t)}}(discountNinja.Utilities.jQuery()(this).attr("action"));discountNinja.Utilities.jQuery()(this).attr("action",t)}}))}catch(t){return discountNinja.Logging.LogError("UndoInstructCheckoutToRemoveDiscountCode",t),!0}}function c(t){try{discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutForm()).each((function(){if(!discountNinja.Utilities.jQuery()(this).hasClass("discountninja-ignore")){var i=function(t,i){try{return discountNinja.QueryParameter.RemoveFromUrl(t,"discount",i)}catch(t){discountNinja.Logging.LogError("DiscountCode.RemoveDiscountCodeFromFormActionInner",t)}}(discountNinja.Utilities.jQuery()(this).attr("action"),t);discountNinja.Utilities.jQuery()(this).attr("action",i)}}))}catch(t){return discountNinja.Logging.LogError("RemoveDiscountCodeFromFormAction",t),!0}}var u=discountNinja_Script_Checkout_Shopify;try{var s=null!=i&&""!==i,d=null!==r,l=!d&&s&&"standard"===i,g=!d&&!s&&e&&""!==e;if((t+=1)<4)if(s&&!l||g||d){(g||d&&e&&""!==e)&&(discountNinja.Cache.LocalSet("CheckoutDiscountCode",e),discountNinja.Cache.SessionSet("CheckoutDiscountCodeCanceled",!1));var f=discountNinja.Settings.Settings.Checkout;u.SetLoadingCheckoutPopUpMessage(f.LoadingCheckoutMessage3),null!==u.FallBackTimeoutHandle&&(clearTimeout(u.FallBackTimeoutHandle),u.FallBackTimeoutHandle=null),u.RedirectingToCheckout=!0,discountNinja.LogSession.CheckoutRedirect(i,e,(function(){if(g)discountNinja.DiscountCode.InjectDiscountCodesInHtmlElements(e,!1),(n=discountNinja_Script_Checkout_Shopify.GetCheckoutDiscountCodes()).push(e),discountNinja.Cache.SessionSet(discountNinja_Script_Checkout_Shopify.CheckoutDiscountCodesCacheKey,JSON.stringify(n)),discountNinja.Cart.Shopify.AddLocale(discountNinja.Environment.Shopify.Locale()),a(),u.FallBack("Call to checkout api determined a discount code should be used",e,!1);else if(d){u.ShowLoadingCursor(!0);try{var t="";try{t=discountNinja.QueryParameter.Get("discount",discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutForm()).attr("action"))}catch(t){discountNinja.Logging.LogError("Checkout.Shopify.discountCodeInAction",t)}if(""!==t){var n=discountNinja_Script_Checkout_Shopify.GetCheckoutDiscountCodes();("+"===t||n.indexOf(t)>-1)&&(c(t),discountNinja.Html.RemoveNodes("form input.limoniapps-discountninja-discount-attribute"))}a()}catch(t){discountNinja.Logging.LogError("Checkout.Shopify.StripDiscountCode",t)}discountNinja.OffersAttribute.Add(r).then((function(){u.FallBack("Call to checkout api determined Shopify Functions should be used",null,!1)}))}else{u.RegisterOnPageshowPersisted(),!1!==discountNinja.Settings.GetFlag("RepairLinksAtCheckout")&&(i+="&add_links=1",window.discountNinjaContext.Labels.Cart&&(i=i+"&cart_label="+window.discountNinjaContext.Labels.Cart)),u.ShowAlert("Redirecting to DN checkout: "+i),u.ShowLoadingCursor(!0),window.location.href=i}}))}else if(l)!0===n&&discountNinja.DiscountCode.UndoInjectDiscountCodesInHtml(),u.FallBack("Call to checkout api determined the standard checkout should be used",null,!1);else{var p=Math.pow(2,t)*(100+100*Math.random());setTimeout((function(){u.GetCheckoutUrlFromServer(t,u.RedirectToCheckout,!1)}),p)}else l?(!0===n&&discountNinja.DiscountCode.UndoInjectDiscountCodesInHtml(),u.FallBack("Call to checkout api determined the standard checkout should be used",null,!1)):u.FallBack("Attempts exhausted. No valid checkout url received",null,!0)}catch(t){discountNinja.Logging.LogErrorMessage("Checkout.Shopify.RegisterEventHandlerForCheckout.onSuccess","Could not redirect to new checkout url, attempting to redirect to standard url: "+t),u.FallBack("Error in processing onSuccess",null,!0)}},GetCheckoutUrlFromServer:function(t,i,n){function e(e){try{var o=e&&e.InvoiceUrl?e.InvoiceUrl:null,a=e&&e.NoDiscount?e.NoDiscount:null,c=e&&e.DiscountCode?e.DiscountCode:null,u=e&&e.ShippingOfferToken?e.ShippingOfferToken:null,s=e&&e.CacheId?e.CacheId:null,d=e&&e.Offers?e.Offers:null;if(s&&(discountNinja.Cache.LocalSet("CheckoutId",s),discountNinja.Cache.LocalSet("AccessToken",discountNinjaContext.AccessToken),discountNinja.Cache.LocalSet("Signature",discountNinjaContext.Signature),discountNinja.Cache.LocalSet("Status",discountNinjaContext.Status)),d){var l={CheckSum:discountNinja.DiscountedCart.CheckSum(),DiscountCode:c,ShippingOfferToken:u,Attribute:d,CacheId:s};discountNinja.Cache.SessionSet(r.CheckoutData,JSON.stringify(l)),discountNinja.OffersAttribute.Add(d),c&&discountNinja.DiscountCode.InjectDiscountCodesInHtmlElements(c,!1),discountNinja_Script_Checkout_Shopify.ApplyCheckoutDataDiscountCode(l)}else{if(n){l={CheckSum:discountNinja.DiscountedCart.CheckSum(),Prepared:!0};discountNinja.Cache.SessionSet(r.CheckoutData,JSON.stringify(l))}else discountNinja.Cache.SessionRemove(r.CheckoutData);discountNinja.OffersAttribute.Remove()}i&&i(t,o,a,c,s,d)}catch(t){discountNinja.Logging.LogError("Checkout.Shopify.GetCheckoutUrlFromServer.onSuccess",t),r.FallBack("Call to Checkout Api returned invalid data",null,!0)}}function o(t){n||(discountNinja.Logging.LogErrorMessage("Checkout.Shopify.GetCheckoutUrlFromServer.onFailure","Call to checkout api failed, attempting to redirect to standard url: "+t),discountNinja.DiscountCode.RemoveCheckoutDiscountCode(),r.FallBack("Call to Checkout Api failed",null,!0))}var r=discountNinja_Script_Checkout_Shopify,a=function(t){try{var i={m:discountNinja.DeviceId.Get()+"-"+discountNinja.DateTime.UnixTimestamp(),version:discountNinja.Core.Version,prepareOnly:1==t,host:window.location.host,f:"7.4"};return discountNinja.TestMode.TestMode()&&(i.testMode=!0,i.testModeToken=discountNinja.TestMode.TestModeToken()),i}catch(t){return discountNinja.Logging.LogError("BuildGetCheckoutUrlParameters",t),null}}(n),c=r.BuildPayLoad();if(discountNinja.LogSession.CheckoutInitiated(c),c&&c.LineItems&&c.LineItems.length>0){var u=discountNinja.Api.Endpoint("checkout","5.1")+"/url";if(discountNinja.XmlHttpRequest.UseFetch()){var s=discountNinja.XmlHttpRequest.CreateQueryStringFromParameters(a,!0,!0);discountNinja.XmlHttpRequest.Fetch(u+s,"post","text/plain;charset=UTF-8",JSON.stringify(c),!1,!1,e,o)}else discountNinja.XmlHttpRequest.Send(u,a,c,"post",!0,!0,!0,e,o,1,3)}else o(null)},ApplyCheckoutDataDiscountCode:function(t){try{if(t||(t=discountNinja.Checkout.Shopify.GetCheckoutData()),null!==t){var i=discountNinja_Script_Offer.GetOfferByToken(t.ShippingOfferToken);null!==i&&t.DiscountCode&&(i.Tiers[0].DiscountCode.Code=t.DiscountCode),discountNinja.DiscountedCart.DiscountedCart.Shipping&&discountNinja.DiscountedCart.DiscountedCart.Shipping.OfferToken===t.ShippingOfferToken&&(discountNinja.DiscountedCart.DiscountedCart.Shipping.DiscountCode=t.DiscountCode)}}catch(t){discountNinja.Logging.LogError("ApplyCheckoutDataDiscountCode",t)}},ShowAlert:function(t){try{discountNinja.Logging.Tracing&&alert(t)}catch(t){}},SetLoadingCheckoutPopUpMessage:function(t){try{if(void 0!==t){var i=discountNinja_Script_Checkout_Shopify,n='<div id="'+i.LoadingCheckoutPopUpDotsId+'"></div>',e=document.getElementById(i.LoadingCheckoutPopUpMessageId);e&&(e.innerHTML=t+n)}}catch(t){discountNinja.Logging.LogError("SetLoadingCheckoutPopUpMessage",t)}},GetCheckoutData:function(){try{var t=discountNinja.Cache.SessionGet(discountNinja_Script_Checkout_Shopify.CheckoutData);if(null!==t){var i=JSON.parse(t);if(i.CheckSum===discountNinja.DiscountedCart.CheckSum())return i}return null}catch(t){return discountNinja.Logging.LogError("GetCheckoutData",t),null}},GetCheckoutUrl:function(t){var i=discountNinja_Script_Checkout_Shopify,n=i.GetCheckoutData();if(!t||null===n||!0!==n.Prepared&&(void 0===n.Attribute||null===n.Attribute))return t||null===n||void 0===n.Attribute||null===n.Attribute?(discountNinja.Cache.SessionRemove(i.CheckoutData),t||i.ShowCheckoutPopUp(!0,1),i.GetCheckoutUrlFromServer(1,t?null:i.RedirectToCheckout,t)):(discountNinja.Cache.SessionRemove(i.CheckoutData),i.RedirectToCheckout(1,null,!1,n.DiscountCode,n.CacheId,n.Attribute));void 0!==n.Attribute&&null!==n.Attribute&&discountNinja.OffersAttribute.Add(n.Attribute)},RegisterEventHandlerForCheckout:function(){function t(t){try{return!!function(t){try{var i=null===t?null:discountNinja.Utilities.jQuery()(t.currentTarget).parents(discountNinja.Environment.Shopify.SelectorCheckoutForm()).filter(":visible");return null!==i&&0!==i.length||l.GetFirstVisibleCheckoutForm(!discountNinja.Environment.Shopify.IsCartPage(),discountNinja.Environment.Shopify.IsCartPage()),!!(i&&(function(t){var i=discountNinja.Settings.Settings.PriceUpdate.Mode.MandatoryCheckboxes;null!=i&&""!==i||(i=discountNinja.Settings.GetFlag("MandatoryCheckboxes"));i&&""!==i&&discountNinja.Utilities.jQuery()(t).find(i).addClass("limoniapps-discountninja-checkout-checkbox")}(i),discountNinja.Utilities.jQuery()(i).find(discountNinja.Environment.Shopify.SelectorTermsAndConditions()).length>0))&&(discountNinja.Logging.LogWarning("Not processing checkout because required checkbox(es) is/are not checked",!0),!0)}catch(t){return discountNinja.Logging.LogErrorMessage("Checkout.Shopify.TermsAndConditionsCheckboxesNotChecked - Could not verify status",t),!1}}(t)||(!!function(t){try{if("undefined"==typeof Zapiet||"object"!=typeof Zapiet.Widget||"function"!=typeof Zapiet.Widget.checkoutEnabled)return!1;var i=Zapiet.Widget.checkoutEnabled();return i||discountNinja.Logging.LogWarning("Not processing checkout since Zapiet indicates the checkout is not ready. If Zapiet is no longer in use, remove the widget from the theme.liquid file.",!0),!i}catch(t){return discountNinja.Logging.LogErrorMessage("Checkout.Shopify.ZapietNotReady - Failed",t),!1}}()||!!function(){try{if("undefined"==typeof discountNinjaThirdPartyCheckoutReadyCallbacks||!Array.isArray(discountNinjaThirdPartyCheckoutReadyCallbacks))return!1;for(var t=discountNinjaThirdPartyCheckoutReadyCallbacks,i=0;i<t.length;i++){if(!0!==(0,t[i])())return!0}return!1}catch(t){return discountNinja.Logging.LogErrorMessage("Checkout.Shopify.ThirdPartyNotReady - Failed",t),!1}}())}catch(t){return discountNinja.Logging.LogErrorMessage("Checkout.Shopify.MandatoryCheckoutPrerequisitesNotComplete - Could not verify status",t),!1}}function i(i,n,e){try{if(l.ProcessingCheckout)return!1;if(l.ProcessingCheckout=!0,t(i)||l.SkipProcessingCheckout&&!0!==e)return l.ProcessingCheckout=!1,null;l.FallBackEvent=n?null:i,i=discountNinja.Utilities.CancelEventDefaultBehavior(i);try{var o=!0===discountNinja.Settings.GetFlag("RefetchCartBeforeCheckout");null!==discountNinja.Offer.Offers&&o&&(discountNinja.Cart.Shopify.IsDirty=!0),discountNinja.Cart.Shopify.UpdateCart((function(){try{discountNinja.Trigger.EnsureInitialPromotionsTriggered((function(){discountNinja.DiscountedCart.BuildDiscountedCart((function(){!function(t){try{if(l.RequiresAdvancedCheckout()){l.CheckoutButton=null;try{var i=t.target,n=discountNinja.Utilities.jQuery()(t.target).closest("input,button");n.length>0&&(i=n[0]),i.disabled=!0,l.CheckoutButton=i}catch(t){discountNinja.Logging.LogError("RegisterEventHandlerForCheckout.DisableCheckoutButton",t)}l.ShowLoadingCursor(!0),l.FallBackTimeoutHandle=setTimeout((function(){discountNinja.Logging.LogErrorMessage("Checkout.Shopify.RegisterEventHandlerForCheckout.onCheckoutViaButtonInner","Timed out, redirecting to standard checkout"),l.FallBack("Timeout",null,!0)}),3e4),l.GetCheckoutUrl(!1)}else l.FallBack("No advanced checkout required",null,!1)}catch(t){discountNinja.Logging.LogError("Checkout.Shopify.RegisterEventHandlerForCheckout.onCheckoutViaButtonInner",t),l.ProcessingCheckout=!1}}(i)}))}))}catch(t){discountNinja.Logging.LogError("RegisterEventHandlerForCheckout.onCheckoutViaButtonAfterUpdateCart",t),l.ProcessingCheckout=!1,l.FallBack("Build discounted cart failed",null,!0)}}),!0)}catch(t){discountNinja.Logging.LogError("RegisterEventHandlerForCheckout.onCheckoutViaButtonAfterTimeout",t),l.ProcessingCheckout=!1,l.FallBack("UpdateCart failed",null,!0)}return i}catch(t){discountNinja.Logging.LogError("RegisterEventHandlerForCheckout.onCheckoutViaButton",t),l.ProcessingCheckout=!1,l.FallBack("onCheckoutViaButton failed",null,!0)}}function n(t,n,e){try{if(null!==t&&t.currentTarget&&t.currentTarget.classList&&t.currentTarget.classList.contains("limoniapps-discountninja-ignore"))return}catch(t){discountNinja.Logging.LogError("RegisterEventHandlerForCheckout.HandleClickCheckoutButton",t)}if(!l.RedirectingToCheckout&&!1===i(t,n,e))return!1}function e(t,i){try{if(i.hasClass("limoniapps-discountninja-ignore"))return;if(function(t){var i=discountNinja.Environment.Shopify.SelectorCheckoutButton();return discountNinja.Utilities.jQuery()(t).is(i)}(i)&&(l.ShowAlert("Discount Ninja checkout initiated via submit on form (checkout button)"),l.ProcessingCheckout&&!l.RedirectingToCheckout)){if(!0===discountNinja.Settings.GetFlag("AllowCancelCheckoutByForm"))return t=discountNinja.Utilities.CancelEventDefaultBehavior(t),!1;discountNinja.Logging.LogErrorMessage("Checkout","Submit should be stopped, Discount Ninja checkout not processed yet. Set flag AllowCancelCheckoutByForm to true")}}catch(t){}}function o(t){try{for(var i in t)i.startsWith("on")&&null!=t[i]&&(t[i]=null);for(var n=t.limoniAppsDiscountNinjaAllHandlers||[],e=0;e<n.length;e++){var o=n[e];t.removeEventListener(o.typ,o.fn,o.opt)}}catch(t){discountNinja.Logging.LogError("Checkout.RemoveEventsFromElement",t)}}function r(t,i){try{for(var n=t.limoniAppsDiscountNinjaAllHandlers||[],e=0;e<n.length;e++){var o=n[e];!0===o.dn&&o.typ===i&&t.removeEventListener(o.typ,o.fn,o.opt)}}catch(t){discountNinja.Logging.LogError("Checkout.RemoveDiscountNinjaEventListener",t)}}function a(t,i,n){t.setAttribute("data-limoniapps-discountninja-eventhandler-click",!0);for(var e=i.split(" "),o=0;o<e.length;o++){var a=e[o];r(t,a),discountNinja_Script_Events.AddEventListener(t,a,n,!1,!1,!1,void 0,!0)}}function c(t){var i=function(t){var i=function(t){try{return discountNinja.Environment.Shopify.IsProductPage()?(t=discountNinja.Utilities.CancelEventDefaultBehavior(t),!discountNinja.BuyNow.CheckOutSelectedVariant()):(discountNinja.Logging.LogWarning("HandleClickBuyNowButton expects to be executed on a product page",!0),null)}catch(t){discountNinja.Logging.LogError("RegisterEventHandlerForCheckout.HandleClickBuyNowButton",t),l.ProcessingCheckout=!1}}(t);if(!1===i)return!1},n=discountNinja.Utilities.jQuery();t.each((function(t,e){var o=n(e);a(o[0],"click",i),o.attr("data-limoniapps-discountninja-buynowbutton",""),o.attr("data-limoniapps-discountninja-info","original click event handler removed and replaced by Discount Ninja handler")}))}function u(t){if(!1===n(t,!1,!(!0===discountNinja.Settings.GetFlag("AvoidHandlingNonDiscountedCheckout"))))return!1}function s(t){(t.target||t.srcElement).hasAttribute("data-limoniapps-discountninja-checkoutlink")&&n(t,!0,!0)}function d(){try{if(!discountNinja.Settings.Settings)return;if(!0===discountNinja.Settings.GetFlag("HandleSubmitCheckoutForm")){var t=l.GetCheckoutForms().not(".limoniapps-discountninja-ignore");t&&t.length>0&&(t.off(".discountNinja.checkout"),t.each((function(){var t=this;a(this,"click",(function(i){discountNinja.Utilities.jQuery()(t).data("discountninja-clicked",discountNinja.Utilities.jQuery()(event.target))}))})),t.each((function(){var t=this;a(this,"submit",(function(i){if(!1===e(i,discountNinja.Utilities.jQuery()(t).data("discountninja-clicked")))return!1}))})))}if(!(!1===discountNinja.Settings.Settings.Checkout.RedirectBuyNowButtons)&&discountNinja.Environment.Shopify.IsProductPage()){var i=discountNinja.Environment.Shopify.SelectorsBuyNowButton(),r=discountNinja.Utilities.jQuery()(i.join(",")).not(".limoniapps-discountninja-ignore");r&&r.length>0&&(!function(t){try{var i=discountNinja.Utilities.jQuery();t.each((function(t,n){try{void 0===i(n).attr("data-limoniapps-discountninja-buynowbutton")&&o(n)}catch(t){discountNinja.Logging.LogError("Checkout.RemoveClickEventsForBuyNowButtons",t)}}))}catch(t){discountNinja.Logging.LogError("Checkout.RemoveClickEventsForBuyNowButtons",t)}}(r),c(r=discountNinja.Utilities.jQuery()(i.join(",")).not(".limoniapps-discountninja-ignore")),discountNinja.PromotionFlow.ShowBuyNowButtons())}var d=null;i=discountNinja.Environment.Shopify.SelectorCheckoutButton();discountNinja.Utilities.RegisterCustomJQueryExpressions();var g=discountNinja.Utilities.jQuery()(i).not(".limoniapps-discountninja-ignore").filter(":doesNotHaveParent(.limoniapps-discountninja-drawercart-root-custom)");if(0===g.length){try{discountNinja.Environment.Shopify.IsCartPage()&&discountNinjaContext&&discountNinjaContext.Cart&&discountNinjaContext.Cart.items&&discountNinjaContext.Cart.items.length>0&&discountNinja.Logging.LogWarning('Could not find checkout button, check if a submit button with the "name" attribute set to "checkout" exists')}catch(t){discountNinja.Logging.LogError("RegisterEventHandlerForCheckoutInner",t)}C=discountNinja.Environment.Shopify.SelectorCheckoutButtonAlternative(),m=".limoniapps-discountninja-ignore",(d=(S=l.GetFirstVisibleCheckoutForm().find(C).not(m))&&S.length>0?S:discountNinja.Utilities.jQuery()(".limoniapps-discountninja-cart-root, .limoniapps-discountninja-drawercart-root").find(C).not(m)).addClass("limoniapps-discountninja-checkoutbutton")}else d=g;d&&d.length>0&&(N=d,j=discountNinja.Utilities.jQuery()(".hs-site-cart-popup-layout").length>0||!0===discountNinja.Settings.GetFlag("RemoveThirdPartyEventsFromCheckoutButtons"),N.each((function(t,i){try{j&&o(i),a(i,"click",u)}catch(t){discountNinja.Logging.LogError("RegisterHandlersForSubmitButtons",t)}})));var f=discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutLink()).not(".limoniapps-discountninja-ignore");f&&f.length>0&&function(t){var i=function(t){if(!1===n(t,!0,!0))return!1};t.each((function(){a(this,"click",i),this.href&&(this.href="javascript:void(0)"),this.setAttribute("data-limoniapps-discountninja-checkoutlink",""),this.setAttribute("data-limoniapps-discountninja-info","href to checkout replaced by Discount Ninja with click event")})),document.removeEventListener("click",s),discountNinja_Script_Events.AddEventListener(document,"click",s,!1,!1,!1,void 0,!0)}(f);var p=discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutButtonViaOnClick()).not(".limoniapps-discountninja-ignore");p&&p.length>0&&function(t){var i=function(t){if(!1===n(t,!0,!0))return!1};t.each((function(){var t=discountNinja.Utilities.jQuery()(this)[0];t.onclick&&(l.FallbackCallback=t.onclick,t.onclick=null),a(this,"click",i)}))}(p),function(){try{var t=discountNinja_Script_Checkout_Shopify,i=t.GetCheckoutForms(),n=discountNinja.Utilities;n.jQuery()(i).submit((function(i){if(t.ProcessingCheckout)return n.CancelEventDefaultBehavior(i),!1}))}catch(t){discountNinja.Logging.LogError("DisableCheckoutFormSubmit",t)}}()}catch(t){discountNinja.Logging.LogError("RegisterEventHandlerForCheckoutInner",t)}var N,j,C,m,S}var l=discountNinja_Script_Checkout_Shopify;d(),setTimeout((function(){d()}),500),setTimeout((function(){d()}),1500),setTimeout((function(){d()}),3e3),discountNinja.Events.Subscribe("checkout:initiate",(function(){i(null,!0,!0)}))},RequiresAdvancedCheckout:function(){try{return null!==discountNinja.Settings&&null!==discountNinja.Settings.Settings&&(!discountNinja.LiquidData.HasSubscriptionProducts()&&function(t,i){var n=null===t?0:t.length;return!(0===n&&!i||1===n&&!i&&t[0].PriceRuleId>-1)}(discountNinja.DiscountedCart.GetAppliedPromotions(),discountNinja.DiscountedCart.HasFreeShipping()))}catch(t){return discountNinja.Logging.LogError("RequiresAdvancedCheckout",t),!0}},BuildPayLoadLogEvent:function(){try{return function(){try{return{DiscountCodes:discountNinja.DiscountedCart.GetAppliedPromotions(),DeviceId:discountNinja.DeviceId.Get()}}catch(t){return discountNinja.Logging.LogError("BuildPayLoad.BuildPayLoadLogEvent",t),null}}()}catch(t){return discountNinja.Logging.LogError("BuildPayLoadLogEvent",t),null}},BuildPayLoad:function(){function t(t){try{var i=[];if(null!=t)for(var n=0;n<t.length;n++)try{var e=t[n];i.push({Name:e.Name.toString(),Value:e.Value.toString()})}catch(t){discountNinja.Logging.LogError("BuildPayLoad.BuildLineItemProperties",t)}return i}catch(i){return discountNinja.Logging.LogError("BuildPayLoad.BuildLineItemProperties",i),t}}function i(t){try{for(var i=window.discountNinjaContext.Cart.items,n=0;n<i.length;n++)if(i[n].key===t)return n;return 0}catch(t){return discountNinja.Logging.LogError("OrderInCart",t),0}}function n(){try{var n=[],e=discountNinja.DiscountedCart.DiscountedCart&&discountNinja.DiscountedCart.DiscountedCart.items?discountNinja.DiscountedCart.DiscountedCart.items:null;if(e&&e.length>0)for(var o=0;o<e.length;o++){var r=e[o];n.push({Quantity:r.Line.QuantityDiscounted+r.Line.QuantityNotDiscounted,VariantId:parseInt(r.Product.VariantId),ProductHandle:r.Product.ProductHandle,OfferToken:r.OfferToken,TriggerToken:r.TriggerToken,Properties:t(r.Properties),LineItemKey:r.Key,ProductId:parseInt(r.Product.ProductId),ProductTitle:r.Product.Title,ProductTags:r.Product.Tags,ProductCollections:r.Product.Collections,ProductCollectionIds:r.Product.CollectionIds,VariantCompareAtPrice:r.Product.OriginalCompareAtPrice,VariantPrice:r.Product.OriginalPrice,IsSubscriptionProduct:r.IsSubscriptionProduct,Order:i(r.Key)})}return n}catch(t){return null}}function e(t){try{var i=[],n=window.discountNinjaContext&&window.discountNinjaContext.Cart?window.discountNinjaContext.Cart.attributes:null;if(null===n)return null;for(var e in n)i.push({Name:e,Value:n[e]});var o=c.GetFirstVisibleCheckoutForm(t).find('[name^="attributes"]');if(o)for(var r=0;r<o.length;r++){for(var a=o[r],u=discountNinja.Utilities.jQuery()(a).attr("name"),s=u.replace("attributes[","").replace("]",""),d=!1,l=0;l<i.length;l++)if(i[l].Name===s){d=!0;break}var g=null;if(null!==(g="checkbox"===discountNinja.Utilities.jQuery()(a).attr("type")?discountNinja.Utilities.jQuery()('form [name="'+u+'"]:checked').val():discountNinja.Utilities.jQuery()('form [name="'+u+'"]').val()))try{g=g.toString()}catch(t){g=null}if(d){for(l=0;l<i.length;l++)if(i[l].Name===s){i[l].Value=g;break}}else i.push({Name:s,Value:g})}return i}catch(t){return null}}function o(t){try{var i=c.GetCheckoutFormAction(t);"string"==typeof i&&null!==i||(i=""),i=i.replace(/(.)*\/cart\?/,"").replace(/(.)*\/cart/,"");var n=function(){try{var t=[];return t=function(t,i){try{var n=t.split("=");2===n.length&&i.push({Name:n[0],Value:n[1]})}catch(t){}return i}(discountNinja.Cookie.GetCookie("_shopify_ga"),t),t}catch(t){return null}}();if(n&&n.length>0)for(var e=0;e<n.length;e++){var o=n[e];i=discountNinja.QueryParameter.AppendToUrl(i,o.Name,o.Value,!1,!0)}return""===i?null:i}catch(t){return null}}function r(t){try{var i=c.GetFirstVisibleCheckoutForm(t),n=i.find('[name="note"]:visible');if(0===n.length&&(n=i.find('[name="note"]')),n.length>0){var e=n.val();return void 0===e?null:e}return discountNinjaContext.Cart.note}catch(t){return null}}function a(){try{return discountNinjaContext.Cart.token}catch(t){return null}}var c=discountNinja_Script_Checkout_Shopify;try{return function(){try{var t=!discountNinja.Environment.Shopify.IsCartPage();return{LineItems:n(),DiscountCodes:discountNinja.DiscountedCart.GetAppliedPromotions(),NoteAttributes:e(t),DeviceId:discountNinja.DeviceId.Get(),CartAction:o(t),Note:r(t),Currency:discountNinjaContext.PresentmentCurrency,ConversionRate:discountNinja_Script_Currency.GetConversionRate(discountNinjaContext.PresentmentCurrency),Locale:discountNinja.Environment.Shopify.Locale(),Referrer:discountNinja.Cache.SessionGet("OriginalReferrer"),CartToken:a()}}catch(t){return discountNinja.Logging.LogError("BuildPayLoad.BuildOrderDetailsJson",t),null}}()}catch(t){return discountNinja.Logging.LogError("Checkout.BuildPayLoad",t),null}},CheckoutsPreparedCacheKey:"CheckoutsPrepared",CheckoutData:"CheckoutData",PrepareAdvancedCheckoutDebounced:function(){try{var t=discountNinja_Script_Checkout_Shopify;if(t.ProcessingPrepareAdvancedCheckout)return;t.ProcessingPrepareAdvancedCheckout=!0,discountNinja.Cart.Shopify.UpdateCart((function(){discountNinja.Trigger.EnsureInitialPromotionsTriggered((function(){discountNinja.DiscountedCart.BuildDiscountedCart((function(){if(discountNinja.DiscountedCart.HasAppliedPromotions())try{setTimeout((function(){t.GetCheckoutUrl(!0),t.ProcessingPrepareAdvancedCheckout=!1}),500)}catch(i){discountNinja.Logging.LogError("PrepareAdvancedCheckout_Inner",i),t.ProcessingPrepareAdvancedCheckout=!1}else discountNinja.OffersAttribute.Remove()}))}))}))}catch(t){discountNinja.Logging.LogError("PrepareAdvancedCheckoutDebounced",t),discountNinja_Script_Checkout_Shopify.ProcessingPrepareAdvancedCheckout=!1}},PrepareAdvancedCheckout:discountNinja_Script_Utilities.Debounce((function(){discountNinja_Script_Checkout_Shopify.PrepareAdvancedCheckoutDebounced()}),2e3,"PrepareAdvancedCheckout")},discountNinja_Script_Environment_Shopify={MyShopifyDomain:function(t){var i="";try{var n="undefined"!=typeof discountNinjaContext&&discountNinjaContext?discountNinjaContext.Shop:null,e="undefined"!=typeof Shopify&&Shopify?Shopify.shop:null;i=n||e}catch(t){discountNinja.Logging.LogError("Environment.Shopify.MyShopifyDomain",t)}try{return null!=i&&""!==i||(i=window.top.location.hostname,t||(i&&i.endsWith(".myshopify.com")?discountNinja.Logging.LogWarning("GetMyShopifyDomain could not find domain from Shopify.shop or context. Falling back to hostname",!0):discountNinja.Logging.LogErrorMessage("Environment.Shopify.MyShopifyDomain","GetMyShopifyDomain could not retrieve domain from Shopify.shop property or context. URL hostname is "+i+"."))),i}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.MyShopifyDomain",t),i}},SelectorTermsAndConditions:function(){return".limoniapps-discountninja-checkout-checkbox:not(:checked), .my-terms-conditions-fy:not(.limoniapps-discountninja-ignore) input[required]:visible:checkbox:not(:checked), input[required].tos_agree:visible:checkbox:not(:checked), input#agree:visible:checkbox:not(:checked), input#effectiveAppsAgreeCB:visible:checkbox:not(:checked), input#CartTerms:visible:checkbox:not(:checked)"},SelectorMain:function(){return"#MainContent"},SelectorCartLink:function(){var t=discountNinja_Script_Environment_Shopify.Locale(),i=discountNinja_Script_Environment_Shopify.RootRoute();return'a[href="/cart"],a[href="/'+i+'/cart"],a[href="/'+t+'/cart"],a[href^="/'+i+'/cart?"],a[href^="/'+t+'/cart?"]'},SelectorCheckoutLink:function(){var t=discountNinja_Script_Environment_Shopify.Locale();return'a[href^="/checkout"],a[href^="/'+discountNinja_Script_Environment_Shopify.RootRoute()+'/checkout"],a[href^="/'+t+'/checkout"],a[href$="/checkout"],[data-limoniapps-discountninja-checkoutlink]'},SelectorCheckoutButton:function(){return'.limoniapps-discountninja-checkoutbutton, input[type="submit"][name="checkout"], button[type="submit"][name="checkout"], input[type="submit"][value="checkout"], input[type="submit"][value="check out"], input[type="submit"][value="Checkout"], input[type="submit"][value="CheckOut"], input[type="submit"][value="Check Out"], input[type="submit"][value="Check out"], input[type="submit"][value="CHECK OUT"], input[type="submit"][value="CHECKOUT"], button[type="submit"][value="checkout"], button[type="submit"][value="check out"], button[type="submit"][value="Checkout"], button[type="submit"][value="CheckOut"], button[type="submit"][value="Check Out"], button[type="submit"][value="Check out"], button[type="submit"][value="CHECK OUT"], button[type="submit"][value="CHECKOUT"], button[name="icartCheckout"]'},SelectorCheckoutButtonAlternative:function(){return'input[name="checkout"], button[name="checkout"]'},SelectorCheckoutButtonViaOnClick:function(){return'button[onclick*="/checkout"]'},SelectorCheckoutForm:function(){var t=discountNinja_Script_Environment_Shopify.Locale(),i=discountNinja_Script_Environment_Shopify.RootRoute(),n=window.location.protocol+"//"+window.location.hostname;return'form[action^="/cart"]:not([action^="/cart/"]), form[action^="/'+i+'/cart"]:not([action^="/'+i+'/cart/"]), form[action^="/'+t+'/cart"]:not([action^="/'+t+'/cart/"]), form[action^="/checkout"], form[action^="/'+i+'/checkout"], form[action^="/'+t+'/checkout"], form[action^="'+n+'/cart"]:not([action^="'+n+'/cart/"]), form[action^="'+n+"/"+i+'/cart"]:not([action^="'+n+"/"+i+'/cart/"]), form[action^="'+n+"/"+t+'/cart"]:not([action^="'+n+"/"+t+'/cart/"]), form[action^="'+n+'/checkout"], form[action^="'+n+"/"+i+'/checkout"], form[action^="'+n+"/"+t+'/checkout"],.limoniapps-discountninja-checkoutform'},SelectorVariantId:function(){return"[name^='id']"},SelectorAddToCartForm:function(){var t=discountNinja_Script_Environment_Shopify.Locale();return"form[action^='/cart/add'],form[action^='/"+discountNinja_Script_Environment_Shopify.RootRoute()+"/cart/add'],form[action^='/"+t+"/cart/add']"},SelectorAddToCartButton:function(){return':submit[name="add"]'},SelectorQuantity:function(){return'[name="quantity"]'},SelectorsAcceleratedCheckoutButton:function(){return[".additional-checkout-buttons",".additional-checkout-button",'[data-shopify="dynamic-checkout-cart"]',".paypal-buttons",".limoniapps-discountninja-hide","#slidecarthq .additional-buttons"]},SelectorsBuyNowButtonWrapper:function(){return[".shopify-payment-button",'[data-shopify="payment-button"]',".limoniapps-discountninja-buynowbutton"]},SelectorsBuyNowButton:function(){return[".shopify-payment-button",'[data-shopify="payment-button"]',".shopify-payment-button__more-options",".shopify-payment-button button",'[data-shopify="payment-button"] button','.shopify-payment-button [role="button"]','[data-shopify="payment-button"] [role="button"]',".limoniapps-discountninja-buynowbutton"]},IETFLocaleProperCase:function(t){try{var i=t.split("-");return i[0].toLowerCase()+(i.length>1?"-"+i[1].toUpperCase():"")}catch(t){return null}},RootRoute:function(){try{if("object"==typeof Shopify&&"object"==typeof Shopify.routes&&"string"==typeof Shopify.routes.root){var t=Shopify.routes.root;return t.length>0?t.substring(0,t.length-1):""}return""}catch(t){return""}},Locale:function(t){function i(t,i){try{return!0===i?t.toLowerCase():discountNinja_Script_Environment_Shopify.IETFLocaleProperCase(t)}catch(i){return discountNinja.Logging.LogError("Environment.Shopify.returnProperCase",i),t}}try{var n="object"==typeof Shopify?Shopify.locale:null;if(n)return i(n,t);var e=discountNinja.QueryParameter.Get("locale");return e?i(e,t):null}catch(t){return null}},NonPrimaryLocale:function(){try{if("undefined"!=typeof Shopify&&"object"==typeof Shopify.routes&&"string"==typeof Shopify.routes.root)return discountNinja_Script_Environment_Shopify.IETFLocaleProperCase(Shopify.routes.root.replace(/\//g,""));var t=discountNinja_Script_Environment_Shopify.Locale();return t=t===(discountNinjaContext.PrimaryLocale||"en")?"":t,discountNinja_Script_Environment_Shopify.IETFLocaleProperCase(t)}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.NonPrimaryLocale",t),null}},UrlPath:function(){try{return discountNinja_Script_Environment_Shopify.TrimmedPathName().toLowerCase()}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.UrlPath",t),""}},IsSearchPage:function(){try{var t=discountNinja_Script_Environment_Shopify.UrlPath(),i=discountNinja_Script_Environment_Shopify.Locale(!0),n=discountNinja_Script_Environment_Shopify.RootRoute();return"/search"===t||t==="/"+i+"/search"||t==="/"+n+"/search"}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.IsSearchPage",t),!1}},IsAccountPage:function(){try{return null!==discountNinja_Script_Environment_Shopify.UrlPath().match(/\/account[\/]?/)}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.IsAccountPage",t),!1}},IsCartPage:function(){try{var t=discountNinja_Script_Environment_Shopify.UrlPath(),i=discountNinja_Script_Environment_Shopify.Locale(!0),n=discountNinja_Script_Environment_Shopify.RootRoute();return"/cart"===t||t==="/"+i+"/cart"||t==="/"+n+"/cart"}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.IsCartPage",t),!1}},IsProductPage:function(){try{return null!==discountNinja_Script_Environment_Shopify.UrlPath().match(/\/products\//)}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.IsProductPage",t),!1}},IsCollectionPage:function(){try{return null!==discountNinja_Script_Environment_Shopify.UrlPath().match(/(\/collections[\/]?(?!.*\/products\/))/)}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.IsCollectionPage",t),!1}},IsHomePage:function(){try{var t=discountNinja_Script_Environment_Shopify.UrlPath(),i=discountNinja_Script_Environment_Shopify.Locale(!0),n=discountNinja_Script_Environment_Shopify.RootRoute();return""===t||"/"===t||t==="/"+i||t==="/"+n}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.IsHomePage",t),!1}},IsBlogPost:function(){try{return discountNinja_Script_Environment_Shopify.UrlPath().indexOf("/blogs/")>-1}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.IsBlogPost",t),!1}},IsCustomPage:function(){var t=discountNinja_Script_Environment_Shopify;return!(t.IsBlogPost()||t.IsCartPage()||t.IsCatalogPage()||t.IsCollectionPage()||t.IsHomePage()||t.IsProductPage()||t.IsSearchPage())},IsCatalogPage:function(){try{return discountNinja_Script_Environment_Shopify.IsCollectionPage()&&"all"===discountNinja_Script_Environment_Shopify.CollectionHandle().toLowerCase()}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.IsCatalogPage",t),!1}},BlogHandle:function(){try{var t=discountNinja_Script_Environment_Shopify.TrimmedPathName(),i=t.indexOf("/blogs/");if(-1===i)return null;var n=t.indexOf("/",i+1);if(-1===n)return null;var e=t.indexOf("/",n+1);return-1===e?t.substr(n+1):t.substr(n+1,e-n-1)}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.BlogHandle",t),null}},BlogPostHandle:function(){try{var t=discountNinja_Script_Environment_Shopify.TrimmedPathName(),i=t.indexOf("/blogs/");if(-1===i)return null;var n=t.indexOf("/",i+1);if(-1===n)return null;var e=t.indexOf("/",n+1);return-1===e?null:t.substr(e+1)}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.BlogPostHandle",t),null}},CollectionHandle:function(){try{var t=discountNinja_Script_Environment_Shopify.UrlPath();if(t.indexOf("/collections/")<0)return"";var i=(t=t.replace("/collections/","")).indexOf("/");return i<0?t:t.substr(0,i)}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.CollectionHandle",t),""}},PageType:function(){return discountNinja_Script_Environment_Shopify.IsProductPage()?"product":discountNinja_Script_Environment_Shopify.IsCollectionPage()?"collection":discountNinja_Script_Environment_Shopify.IsHomePage()?"home":discountNinja_Script_Environment_Shopify.IsCartPage()?"cart":discountNinja_Script_Environment_Shopify.IsBlogPost()?"blogpost":discountNinja_Script_Environment_Shopify.IsCustomPage()?"custom":void 0},VariantData:function(){try{function t(t,i){try{var n=discountNinja_Script_Environment_Shopify.SelectorAddToCartForm(),e=(t?discountNinja.Utilities.jQuery()(t).find(n).filter(":visible").first():discountNinja.Utilities.jQuery()(n).filter(":visible").first()).find(discountNinja_Script_Environment_Shopify.SelectorVariantId());null!==e&&e.length>0&&(e=e[0]);var o=null,r=null,a=null;if(null!==e&&"object"==typeof e.options&&"number"==typeof e.selectedIndex&&"object"==typeof e.options[e.selectedIndex]){var c=e.options[e.selectedIndex];o=c.value;var u=discountNinja.Utilities.jQuery()(e).find("option[selected]").attr("value");null!=u&&""!==u&&u!==o&&(discountNinja.Logging.LogWarning("Found conflicting information about selected variant in form: option.value is "+o+" option[selected] is "+u,!0),!0===discountNinja.Settings.GetFlag("VerifyVariantUsingSelectedOption")&&(o=u));var s=discountNinja.Settings.GetFlag("QuickViewPriceAttribute");s&&(r=c.getAttribute(s));var d=discountNinja.Settings.GetFlag("QuickViewCompareAtPriceAttribute");d&&(a=c.getAttribute(d))}else null!==e&&"string"==typeof e.value&&(o=e.value);if(null!=o&&""!==o&&0!==o&&!isNaN(o)){var l=discountNinja.Utilities.GetNumberFromHtmlFragment(o),g=discountNinja_Script_LiquidData.VariantInfoFromLiquid(l);if(null!==g||!1===i)return{Id:l,Price:g?g.Price:r,CompareAtPrice:g?g.CompareAtPrice:a,Inventory:g?g.Inventory:null,Available:g?g.Available:null}}return null}catch(e){return discountNinja.Logging.LogError("Environment.Shopify.VariantData.FindInForm",e,!1),null}}function i(){try{var t=discountNinja.QueryParameter.Get("variant");if(null!=t&&""!==t){var i=t,n=discountNinja_Script_LiquidData.VariantInfoFromLiquid(i);if(null!==n)return{Id:i,Price:n.Price,CompareAtPrice:n.CompareAtPrice,Inventory:n.Inventory,Available:n.Available}}return null}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.VariantData.FindInQuery",t,!1),null}}if(discountNinja_Script_Environment_Shopify.IsProductPage()){var n=!0;if(!0===discountNinja.Settings.GetFlag("VerifyVariantUsingQuery")&&(n=!1),r=(n?t()||i():i()||t())||function(){try{var t=discountNinja.LiquidData.ProductDefaultVariantId();if(null!=t&&""!==t){var i=discountNinja_Script_LiquidData.VariantInfoFromLiquid(t);if(null!==i)return{Id:t,Price:i.Price,CompareAtPrice:i.CompareAtPrice,Inventory:i.Inventory,Available:i.Available}}return null}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.VariantData.Fallback",t,!1),null}}())return r;discountNinja.Logging.LogErrorMessage("Environment.Shopify.VariantData","No variant information found on product page")}else{var e=discountNinja_Script_Environment_Shopify.IsCollectionPage(),o=null;if(e&&(o=discountNinja.Utilities.jQuery()("[data-limoniapps-discountninja-product-quickview]:visible")),e&&o&&o.length>0){var r;if(r=t(o,!1))return r;discountNinja.Logging.LogErrorMessage("Environment.Shopify.VariantData","No variant information found on Quick View of collection page")}}return null}catch(a){return discountNinja.Logging.LogError("Environment.Shopify.VariantData",a),null}},TrimmedPathName:function(){try{var t=window.location.pathname;if(null===t||""===t)return t;var i=window.location.pathname.match("(/collections|/products|/search|/pages|/blogs|/account|/cart){1}(.*)");return i&&(t=i[0]),"/"===t.slice(-1)&&(t=t.substr(0,t.length-1)),decodeURIComponent(t).toLowerCase()}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.GetLastPartOfPathName",t),null}},ProductHandle:function(){try{var t=discountNinja_Script_Environment_Shopify.TrimmedPathName();return-1===t.indexOf("/products/")?null:t.substr(t.lastIndexOf("/")+1)}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.ProductHandle",t),null}},CustomPageHandle:function(){try{var t=discountNinja_Script_Environment_Shopify.TrimmedPathName();return-1===t.indexOf("/pages/")?null:t.substr(t.lastIndexOf("/")+1)}catch(t){return discountNinja.Logging.LogError("Environment.Shopify.CustomPageHandle",t),null}},IsCustomer:function(){return void 0!==window.discountNinjaContext&&null!==window.discountNinjaContext.Customer},CustomerTags:function(){return null!==window.discountNinjaContext.Customer&&null!==window.discountNinjaContext.Customer.Tags?window.discountNinjaContext.Customer.Tags:null},CustomerSpend:function(){return null!==window.discountNinjaContext.Customer&&null!==window.discountNinjaContext.Customer.TotalSpent?window.discountNinjaContext.Customer.TotalSpent:null},CustomerNumberOfOrders:function(){return null!==window.discountNinjaContext.Customer&&null!==window.discountNinjaContext.Customer.NumberOfOrders?window.discountNinjaContext.Customer.NumberOfOrders:null},CustomerLastOrderDate:function(){return null!==window.discountNinjaContext.Customer&&null!==window.discountNinjaContext.Customer.LastOrderDate?window.discountNinjaContext.Customer.LastOrderDate:null},IsThemePreview:function(){return window.location.hostname.indexOf(".shopifypreview.com")>-1}},discountNinja_Script_DiscountCode={ClassPrefix:"limoniapps-discountninja-cartdiscountfield",DiscountCodeCacheKey:"discountcode-data",HideFeedbackTimeoutHandle:null,DiscountCodeTemplate:null,Template:null,GetTemplate:function(){if(null===discountNinja_Script_DiscountCode.Template){var t=discountNinja_Script_DiscountCode.ClassPrefix,i=discountNinja.Utilities.jQuery();discountNinja_Script_DiscountCode.Template=i("#"+t+"-template").html()||i("."+t+"-wrapper").html()}return discountNinja_Script_DiscountCode.Template},GetDiscountCodeTemplate:function(){if(null===discountNinja_Script_DiscountCode.DiscountCodeTemplate){var t=discountNinja_Script_DiscountCode.ClassPrefix,i="-discountcode-template",n=discountNinja.Utilities.jQuery();discountNinja_Script_DiscountCode.DiscountCodeTemplate=n("#"+t+i).html()||n("."+t+i).html()}return discountNinja_Script_DiscountCode.DiscountCodeTemplate},InjectDiscountCodesInHtmlElements:function(t,i){function n(t,i){try{return discountNinja.QueryParameter.RemoveFromUrl(t,"discount",i).replace(/attributes\[limoniapps\-discounturl\]\=(.)*(\&)?/g,"")}catch(t){discountNinja.Logging.LogError("DiscountCode.UndoInjectDiscountCodeInUrl",t)}}function e(t,i){try{return discountNinja.QueryParameter.AppendToUrl(t,"discount",i,!0)}catch(t){discountNinja.Logging.LogError("DiscountCode.AppendDiscountCodeToUrl",t)}}try{discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutLink()).each((function(){if(!discountNinja.Utilities.jQuery()(this).hasClass("discountninja-ignore")){var o=discountNinja.Utilities.jQuery()(this).attr("href"),r=i?n(o,t):e(o,t);discountNinja.Utilities.jQuery()(this).attr("href",r)}})),discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutForm()).each((function(){if(!discountNinja.Utilities.jQuery()(this).hasClass("discountninja-ignore")){var o=discountNinja.Utilities.jQuery()(this).attr("action"),r=i?n(o,t):e(o,t);discountNinja.Utilities.jQuery()(this).attr("action",r)}})),discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutButtonViaOnClick()).each((function(){try{if(discountNinja.Utilities.jQuery()(this).hasClass("discountninja-ignore"))return;var o=discountNinja.Utilities.jQuery()(this).attr("onclick"),r=o.match(/(['"]){1}(.)*(['"])/g);if(null!==r&&1===r.length){var a=r[0];if(a.length>2){var c=a.substr(1,a.length-2),u=i?n(c,t):e(c,t);discountNinja.Utilities.jQuery()(this).attr("onclick",o.replace(c,u))}}}catch(t){}})),discountNinja.Checkout.Shopify.GetCheckoutForms().each((function(){if(!discountNinja.Utilities.jQuery()(this).hasClass("discountninja-ignore")){var o=discountNinja.Utilities.jQuery()(this).attr("method");if(o&&"post"===o.toLowerCase()){var r=discountNinja.Utilities.jQuery()(this).attr("action"),a=i?n(r,t):e(r,t);discountNinja.Utilities.jQuery()(this).attr("action",a)}}})),discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutForm()).find(":submit").addClass("saso-ignore hulkapps-ignore"),function(t,i){try{var n=discountNinja.Checkout.Shopify.GetCheckoutForms();if(!i&&null!==n&&n.length>0){var e=0;n.each((function(){if(!discountNinja.Utilities.jQuery()(this).hasClass("discountninja-ignore")){var t=discountNinja.Utilities.jQuery()(this).find('input[name="discount"]');null!==t&&0!==t.length||(discountNinja.Utilities.jQuery()("<input>").attr("type","hidden").attr("name","discount").addClass("limoniapps-discountninja-discount-attribute").attr("id","limoniapps-discountninja-discount-attribute-"+e).appendTo(this),e++)}}))}n.find('input[name="discount"], .limoniapps-discountninja-discount-attribute').each((function(){var n=discountNinja.Utilities.jQuery()(this);n.hasClass("discountninja-ignore")||(i?n.attr("value")==t&&n.attr("value",""):n.attr("value",t))}))}catch(t){discountNinja.Logging.LogError("UpdateFormInputDiscountCode",t)}}(t,i),i?discountNinja.Cookie.DiscountCodeCookieIsOwnedByShopify()||discountNinja.Cookie.RemoveDiscountCodesFromCookie():discountNinja.Cookie.AppendDiscountCodeToCookie(t)}catch(t){discountNinja.Logging.LogError("DiscountCode.InjectDiscountCodesInHtmlElements",t)}},RemoveCheckoutDiscountCode:function(){try{discountNinja.Cache.LocalGet("CheckoutDiscountCode")&&(discountNinja.DiscountCode.InjectDiscountCodesInHtmlElements(" ",!1),function(){try{discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutForm()).each((function(){if(!discountNinja.Utilities.jQuery()(this).hasClass("discountninja-ignore")){var t=function(t){try{return discountNinja.QueryParameter.AppendToUrl(t,"remove_discount_code","1",!0)}catch(t){discountNinja.Logging.LogError("DiscountCode.InstructCheckoutToRemoveDiscountCodeInner",t)}}(discountNinja.Utilities.jQuery()(this).attr("action"));discountNinja.Utilities.jQuery()(this).attr("action",t)}}))}catch(t){return discountNinja.Logging.LogError("DiscountCode.InstructCheckoutToRemoveDiscountCode",t),!0}}())}catch(t){discountNinja.Logging.LogError("DiscountCode.RemoveCheckoutDiscountCode",t)}},UndoInjectDiscountCodesInHtml:function(){try{var t=discountNinja.Offer.Offers;if(!t)return;for(var i=0;i<t.length;i++)discountNinja_Script_DiscountCode.InjectDiscountCodesInHtmlElements(discountNinja_Script_DiscountCode.GetDiscountCode(t[i].Token),!0);discountNinja.Cookie.RemoveDiscountCodesFromCookie()}catch(t){discountNinja.Logging.LogError("DiscountCode.UndoInjectDiscountCodesInHtml",t)}},InjectDiscountCodesInHtml:function(){try{var t=discountNinja_Script_DiscountCode.GetFirstActiveDiscountCodeForCheckout(!1);if(""===t)return;discountNinja_Script_DiscountCode.InjectDiscountCodesInHtmlElements(t,!1),discountNinja.Cookie.AppendDiscountCodeToCookie(t)}catch(t){discountNinja.Logging.LogError("DiscountCode.InjectDiscountCodesInHtml",t)}},GetApplicationCounter:function(){try{var t=discountNinja.Cache.SessionGet("discountcode-applicationcounter");return t?parseInt(t):0}catch(t){return discountNinja.Logging.LogError("DiscountCode.GetApplicationCounter",t),[]}},IncrementApplicationCounter:function(){try{var t=discountNinja_Script_DiscountCode.GetApplicationCounter();discountNinja.Cache.SessionSet("discountcode-applicationcounter",t+1)}catch(t){return discountNinja.Logging.LogError("DiscountCode.GetApplicationCounter",t),[]}},GetFromCache:function(){try{var t=discountNinja_Script_DiscountCode.UseLocalStorage(),i=discountNinja_Script_DiscountCode.DiscountCodeCacheKey,n=discountNinja.Cache.SessionGet(i);if((null===n||""===n&&t)&&null!=(n=discountNinja.Cache.LocalGet(i))&&""!==n){var e=JSON.parse(n);if(null!=e){var o=discountNinja.Settings.Settings.General.PromotionCodesExpiration||1;if(-1===o||Date.now()-e.ExpiresOn<864e5*o)return null===(n=e.Data)?[]:n}}return null===(n="undefined"===n?[]:JSON.parse(n))?[]:n}catch(t){return discountNinja.Logging.LogError("DiscountCode.GetFromCache",t),[]}},UseLocalStorage:function(){try{return!0===discountNinja.Settings.Settings.General.StorePromotionCodes}catch(t){return discountNinja.Logging.LogError("DiscountCode.UseLocalStorage",t),!1}},SaveToCache:function(t){try{var i=discountNinja_Script_DiscountCode.UseLocalStorage(),n=discountNinja_Script_DiscountCode.DiscountCodeCacheKey;discountNinja.Cache.SessionSet(n,JSON.stringify(t)),i?discountNinja.Cache.LocalSet(n,JSON.stringify({Data:t,ExpiresOn:Date.now()})):discountNinja.Cache.LocalRemove(n)}catch(t){discountNinja.Logging.LogError("DiscountCode.SaveToCache",t)}},RemoveFromCache:function(t){try{var i=discountNinja_Script_DiscountCode.GetFromCache();if(!i)return;for(var n=[],e=0;e<i.length;e++)i[e].DiscountCode!==t&&n.push(i[e]);discountNinja_Script_DiscountCode.SaveToCache(n)}catch(t){return discountNinja.Logging.LogError("DiscountCode.RemoveFromCache",t),[]}},GetExternalDiscountCodesFromCache:function(){try{var t=discountNinja.Cache.SessionGet("discountcode-external-data");return null===(t="undefined"===t?[]:JSON.parse(t))?[]:t}catch(t){return discountNinja.Logging.LogError("DiscountCode.GetExternalDiscountCodesFromCache",t),[]}},LockDiscountCodeFieldIfRequired:function(){try{if(!0!==discountNinja.Settings.Settings.Cart.CartDiscountField)return;var t=discountNinja.Utilities.jQuery()("input."+discountNinja_Script_DiscountCode.ClassPrefix+"-input"),i=discountNinja.Utilities.jQuery()("."+discountNinja_Script_DiscountCode.ClassPrefix+"-apply");if(!discountNinja.Settings.Settings.Cart.AllowMultipleDiscountCodes&&!discountNinja.Settings.Settings.Cart.AllowMultipleShopifyDiscountCodes)if(discountNinja.DiscountCodeTrigger.Get().length>0)return void function(t,i){t.prop("disabled",!0),i.addClass("disabled")}(t,i);!function(t,i){t.prop("disabled",!1),i.removeClass("disabled")}(t,i)}catch(t){discountNinja.Logging.LogError("DiscountCode.LockDiscountCodeFieldIfRequired",t)}},UpdateTags:function(){try{if(!0!==discountNinja.PromotionFlow.AllPromotionsEvaluated)return;var t="."+discountNinja_Script_DiscountCode.ClassPrefix+"-",i=discountNinja.Utilities.jQuery()(t+"discountcodes");discountNinja.Utilities.jQuery()(i).empty();var n=discountNinja_Script_DiscountCode.GetDiscountCodeTemplate();if(n){var e=discountNinja.DiscountCodeTrigger.Get();e=e.concat([]);for(var o=0;o<e.length;o++){var r=e[o].discountCode,a=n.replace(/\[\[DISCOUNT_CODE\]\]/g,r.toUpperCase());i.append(a)}}e=discountNinja.DiscountCodeTrigger.Get();var c=discountNinja.DiscountedCart.GetAppliedPromotions(),u=!0;if(e)for(o=0;o<e.length;o++){var s=e[o].discountCode.toUpperCase(),d=!1;if(c)for(var l=0;l<c.length;l++){if(c[l].DiscountCode===s){d=!0;break}if(e[o].trigger&&e[o].trigger.Triggers)for(var g=0;g<e[o].trigger.Triggers.length;g++)if(e[o].trigger.Triggers[g].Token===c[l].TriggerToken){d=!0;break}}if(!d){var f=discountNinja.Utilities.jQuery()(".limoniapps-discountninja-cartdiscountfield-notapplied-reason").html();discountNinja_Script_DiscountCode.AddErrorMessage(f,s),discountNinja_Script_DiscountCode.ShowMessage("notApplied"),u=!1}}u&&discountNinja_Script_DiscountCode.HideMessage("notApplied")}catch(t){discountNinja.Logging.LogError("DiscountCode.UpdateTags",t)}},AddErrorMessage:function(t,i){var n=discountNinja.Utilities.jQuery()(".limoniapps-discountninja-cartdiscountfield-discountcode[data-discountcode='"+i.toUpperCase()+"']");n.addClass("limoniapps-discountninja-discountcode-invalid"),n.attr("limoniapps-discountninja-cartdiscountfield-tooltip",t)},Process:function(){try{discountNinja_Script_DiscountCode.LockDiscountCodeFieldIfRequired(),discountNinja.Offer.LoadApplicableOffers((function(){discountNinja.Offer.ReEvaluate()}))}catch(t){discountNinja.Logging.LogError("DiscountCode.Process",t)}},AddDiscountCodeFromLookup:function(t,i,n){discountNinja_Script_DiscountCode.AddDiscountCode(t,!0,i,n)},GetDiscountDetailsRequests:[],HandleMessages:function(t,i){var n=discountNinja.Utilities.jQuery(),e="."+discountNinja_Script_DiscountCode.ClassPrefix+"-",o=e+"applied",r=e+"notfound",a=e+"notapplied",c=e+"notcombinable",u=n(e+"searching"),s=n(o),d=n(a),l=n(c),g=n(r);i?("searching"===t?u.show():u.hide(),"applied"===t?s.show():s.hide(),"notApplied"===t?d.show():d.hide(),"notFound"===t?g.show():g.hide(),"notCombinable"===t?l.show():l.hide()):t?("searching"===t&&u.hide(),"applied"===t&&s.hide(),"notApplied"===t&&d.hide(),"notFound"===t&&g.hide(),"notCombinable"===t&&l.hide()):(u.hide(),s.hide(),d.hide(),l.hide(),g.hide())},HideMessage:function(t){discountNinja_Script_DiscountCode.HandleMessages(t,!1)},ShowMessage:function(t){discountNinja_Script_DiscountCode.HandleMessages(t,!0)},AddDiscountCode:function(t,i,n,e){function o(){i&&discountNinja_Script_DynamicPricing.UnblockCheckoutButtons(),l.prop("disabled",!1),g.removeClass("disabled")}function r(){o(),discountNinja_Script_DiscountCode.ShowMessage("notFound")}function a(t){var i="DiscountNinja";try{(t.Offers[0].Tiers[0].DiscountCode.PriceRuleId>-1||t.Offers[0].Tiers[0].DiscountCode.PriceRuleAppId>-1)&&(i="Shopify")}catch(t){}return i}function c(r){var c;if(i&&(c=s+"searching",discountNinja.Utilities.jQuery()(c).hide(),o(),l.val("")),r&&"false"!==r)if(discountNinja.DiscountedCart.IsDirty=!0,void 0===r.Offers||null===r.Offers||0===r.Offers.length||void 0===r.Triggers||null===r.Triggers||0===r.Triggers.length)discountNinja_Script_DiscountCode.ShowMessage("notFound");else if(function(t){try{var i=a(t),n=!1,e=!1,o=discountNinja.DiscountedCart.GetAppliedPromotions();if(o&&o.length>0)for(var r=0;r<o.length;r++)if(u=discountNinja.Offer.GetOfferByToken(o[r].OfferToken)){var c="DiscountNinja";if((u.Tiers[0].DiscountCode.PriceRuleId>-1||u.Tiers[0].DiscountCode.PriceRuleAppId>-1)&&(c="Shopify"),"DiscountNinja"===c&&(n=!0),"Shopify"===c&&(e=!0),!1===u.Stacking.CombineWithPromotionCodes&&"DiscountNinja"===i)return!1;if(!1===u.Stacking.CombineWithShopifyDiscountCodes&&"Shopify"===i)return!1}if(t.Offers&&t.Offers.length>0)for(r=0;r<t.Offers.length;r++){var u;if(!1===(u=t.Offers[r]).Stacking.CombineWithPromotionCodes&&"DiscountNinja"===i&&n)return!1;if(!1===u.Stacking.CombineWithShopifyDiscountCodes&&"Shopify"===i&&e)return!1}var s=discountNinja_Script_Offer.GetExclusiveTrigger(discountNinja.Offer.Triggers);if(null!==s){var d=null;if(t.Triggers&&t.Triggers.length>0)for(var l=0;l<t.Triggers.length;l++){var g=t.Triggers[l];d=null===d||d>g.Stacking.Priority?g.Stacking.Priority:d}if(null!==d&&d>=s.Stacking.Priority)return!1}return!0}catch(t){return discountNinja.Logging.LogError("DiscountCode.IsAcceptableCode",t),!0}}(r)){i&&discountNinja_Script_DiscountCode.ShowMessage("applied");var u=a(r),d=discountNinja.Settings.Settings.Cart.AllowMultipleShopifyDiscountCodes;if("Shopify"===u&&!d){for(var g=discountNinja_Script_DiscountCodeTrigger.Get(),f=[],p=0;p<g.length;p++){var N=g[p];"Shopify"!==N.source&&f.push(N)}discountNinja_Script_DiscountCodeTrigger.Save(f)}discountNinja.DiscountCodeTrigger.Add(t,r,u,e),discountNinja.Cache.SessionSet("discountcode-promotiondata-requested-"+t,!0),discountNinja_Script_DiscountCode.Process()}else i&&discountNinja_Script_DiscountCode.ShowMessage("notCombinable");else discountNinja_Script_DiscountCode.ShowMessage("notFound");discountNinja_Script_DiscountCode.LockDiscountCodeFieldIfRequired(),discountNinja_Script_DiscountCode.RemoveSavedDiscountCode(),discountNinja_Script_QueryParameter.Remove("discountcode"),discountNinja.Checkout.Shopify.RegisterEventHandlerForCheckout(),discountNinja_Script_DiscountCode.GetDiscountDetailsRequests[t]=!1,n&&n()}function u(t){i&&r()}var s="."+discountNinja_Script_DiscountCode.ClassPrefix+"-",d=s+"apply",l=discountNinja.Utilities.jQuery()("input"+s+"input"),g=discountNinja.Utilities.jQuery()(d);try{if(!0!==discountNinja.Settings.Settings.Cart.CartDiscountField&&!0!==e)return;if(!t||""===t)return;if(!0===discountNinja_Script_DiscountCode.GetDiscountDetailsRequests[t])return;discountNinja_Script_DiscountCode.GetDiscountDetailsRequests[t]=!0,i&&(i&&discountNinja.DynamicPricing.BlockCheckoutButtonsLookupCode(),l.prop("disabled",!0),g.addClass("disabled"),discountNinja_Script_DiscountCode.ShowMessage("searching"));var f=function(t){try{var i={},n=null===discountNinja.Cache.SessionGet("discountcode-promotiondata-requested-"+t),e=discountNinja.Core.Shop,o=discountNinja.Utilities.GetReferrer();e&&(i.shop=e),t&&(i.discountCode=encodeURIComponent(t)),null!==discountNinja.TestMode.TestMode()&&(i.testMode=discountNinja.TestMode.TestMode(),i.matchByTokenOnly=discountNinja.TestMode.MatchByTokenOnly,discountNinja.TestMode.TestModeToken&&(i.testModeToken=discountNinja.TestMode.TestModeToken())),null!==n&&(i.firstRequest=n),o&&(i.referrer=o),i.status=discountNinjaContext.Status,i.m=discountNinja.DateTime.UnixTimestamp();var r=discountNinja.DeviceId.Get();return i.deviceId=r,i.version=discountNinja.Core.Version,i.f="7.4",i.countryISOCode=discountNinjaContext.CountryISOCode,i}catch(t){return discountNinja.Logging.LogError("Offer.LoadPromotionInfo.BuildParameters",t),null}}(t),p=discountNinja.Api.Endpoint("promotion","5.1")+"/code";if(discountNinja.XmlHttpRequest.UseFetch()){var N=discountNinja.XmlHttpRequest.CreateQueryStringFromParameters(f,!0,!1);discountNinja.XmlHttpRequest.Fetch(p+N,"get","text/plain;charset=UTF-8",null,!1,!1,c,u)}else discountNinja.XmlHttpRequest.Send(p,f,null,"get",!0,!0,!0,c,u)}catch(t){discountNinja.Logging.LogError("DiscountCode.AddDiscountCode",t),i&&r()}},Add:function(t,i,n,e){try{null!==i&&null!==n||discountNinja.Logging.LogWarning("DiscountCode.Add - No discountcode or priceruleid available",!0,!1,!1);for(var o=discountNinja_Script_DiscountCode.GetFromCache(),r=o.length;r--;)o[r]&&o[r].Token===t&&o.splice(r,1);o.push({Token:t,DiscountCode:i,PriceRuleId:n,TargetType:e}),discountNinja_Script_DiscountCode.InjectDiscountCodesInHtml(),discountNinja_Script_DiscountCode.SaveToCache(o)}catch(t){discountNinja.Logging.LogError("DiscountCode.Add",t)}},Clear:function(){discountNinja_Script_DiscountCode.SaveToCache([]);var t=discountNinja.DiscountCodeTrigger.Get();if(t)for(var i=0;i<t.length;i++){var n=t[i].discountCode;n&&discountNinja.DiscountCodeTrigger.Remove(n)}},RemoveFromCacheByToken:function(t){try{for(var i=discountNinja_Script_DiscountCode.GetFromCache(),n=[],e=0;e<i.length;e++)i[e].Token!==t&&n.push(i[e]);discountNinja_Script_DiscountCode.SaveToCache(n)}catch(t){discountNinja.Logging.LogError("DiscountCode.Remove",t)}},Remove:function(t){try{var i=discountNinja_Script_DiscountCode,n=discountNinja.Token;i.UndoInjectDiscountCodesInHtml(),discountNinja.DiscountCodeTrigger.Remove(t),i.RemoveFromCache(t),discountNinja_Script_Cookie.GetDiscountCodeCookie()==t&&discountNinja_Script_Cookie.RemoveDiscountCodesFromCookie();var e=JSON.parse(discountNinja.Cache.SessionGet("triggersfromtoken"));if(null!==e&&null!==e.Offers){for(var o=[],r=[],a=[],c=0;c<e.Offers.length;c++){var u=e.Offers[c];discountNinja.Offer.IsLinkedToDiscountCode(u,t)?a.push(u.Token):o.push(u)}for(c=0;c<e.Triggers.length;c++){for(var s=e.Triggers[c],d=!1,l=0;l<s.Offers.length;l++){for(var g=0;g<a.length;g++){if(s.Offers[l]===a[g]){d=!0;break}if(d)break}if(d)break}d||r.push(s)}e.Offers=o,e.Triggers=r,discountNinja.Cache.SessionSet("triggersfromtoken",JSON.stringify(e))}!function(){try{if(discountNinja.Offer.Triggers)for(var i=0;i<discountNinja.Offer.Triggers.length;i++){var e=discountNinja.Offer.Triggers[i];if(discountNinja.TriggerSource.IsPromotionCodeField(e.Source))for(var o=0;o<e.Offers.length;o++){var r=discountNinja.Offer.GetOfferByToken(e.Offers[o]);if(discountNinja.Offer.IsLinkedToDiscountCode(r,t)&&n.GetNonAutomaticTokenFromCache()===e.Token)return void n.RemoveNonAutomaticTokenFromCache()}}}catch(t){discountNinja.Logging.LogError("DiscountCode.RemoveNonAutomaticTokenFromCache",t)}}(),i.RemoveFromCache(t),i.IncrementApplicationCounter(),i.HideMessage(),i.Process(),i.UpdateTags()}catch(t){discountNinja.Logging.LogError("DiscountCode.Remove",t)}},RemoveTag:function(t){try{var i=discountNinja_Script_DiscountCode,n="."+i.ClassPrefix,e=discountNinja.Utilities.jQuery()(t).parent(n+"-discountcode").attr("data-discountcode");i.Remove(e)}catch(t){discountNinja.Logging.LogError("DiscountCode.RemoveTag",t)}},ToggleLinkOriginalDescriptionStatus:null,ToggleLink:function(t){try{var i="."+discountNinja_Script_DiscountCode.ClassPrefix+"-",n=discountNinja.Utilities.jQuery()(t).closest(i+"placeholder"),e=n.find(i+"inputandbutton"),o=n.find(i+"description"),r=n.find(i+"footer"),a=n.find(i+"inner");if(a.is(":visible")){null===discountNinja_Script_DiscountCode.ToggleLinkOriginalDescriptionStatus&&(discountNinja_Script_DiscountCode.ToggleLinkOriginalDescriptionStatus=o.is(":visible")?"allowhide":"");var c="allowhide"===discountNinja_Script_DiscountCode.ToggleLinkOriginalDescriptionStatus;e.toggle();var u="data-limoniapps-discountninja-cartdiscountfield-",s=u+"showfooter",d=u+"showdescription",l=n.find("["+s+"]").attr(s),g=n.find("["+d+"]").attr(d);"true"===g&&(c=!0),e.is(":visible")?("false"===l?r.hide():r.show(),"false"===g?o.hide():c&&o.show()):(c&&o.hide(),r.hide())}else a.show(),e.show(),o.show(),r.show();n.find(i+"input").focus()}catch(t){discountNinja.Logging.LogError("DiscountCode.ToggleLink",t)}},ShowFooterInstructions:function(t){try{var i="."+discountNinja_Script_DiscountCode.ClassPrefix+"-";discountNinja.Utilities.jQuery()(t).closest(i+"placeholder").find(i+"footer-onhover").show()}catch(t){discountNinja.Logging.LogError("DiscountCode.ShowFooterInstructions",t)}},HideFooterInstructions:function(t){try{var i="."+discountNinja_Script_DiscountCode.ClassPrefix+"-";discountNinja.Utilities.jQuery()(t).closest(i+"placeholder").find(i+"footer-onhover").hide()}catch(t){discountNinja.Logging.LogError("DiscountCode.HideFooterInstructions",t)}},GetFirstActiveDiscountCodeForCheckout:function(t){try{var i=discountNinja.DiscountedCart.GetFirstDiscountCode();return i?t?discountNinja.Utilities.EncodeUriComponentForQueryString(i):i:""}catch(t){return discountNinja.Logging.LogError("DiscountCode.GetFirstActiveDiscountCodeForCheckout",t),""}},GetDiscountCode:function(t){try{for(var i=discountNinja_Script_DiscountCode.GetFromCache(),n=0;n<i.length;n++)if(i[n].Token===t)return i[n].DiscountCode;return null}catch(t){return discountNinja.Logging.LogError("DiscountCode.GetDiscountCode",t),null}},EnableDiscountCodeField:function(){function t(t){var i=discountNinja.Settings.Settings.Cart,n=t?discountNinja.Settings.Settings.DrawerCart:discountNinja.Settings.Settings.Cart;if(!n||!0!==n.CartDiscountField)return!1;var e=i.DisplayOnDevices;if(e){var o=discountNinja.Utilities.IsMobilePhone();if(o&&"desktoponly"===e)return!1;if(!o&&"mobileonly"===e)return!1}return!(!n||n.HideInCart&&!t||n.HideInDrawerCart&&t)}function i(t){var i=discountNinja.Settings.Settings.PriceUpdate.Mode,n=t?i.DrawerCartDiscountField:i.CartDiscountField,e=discountNinja_Script_DynamicPricing.InjectPlaceHolder,o=discountNinja_Script_DiscountCode.ClassPrefix+(t?"-drawercart":"-cart")+"-injected",r=discountNinja_Script_DiscountCode.ClassPrefix+"-placeholder";if(n&&"custom"!==n&&"none"!==n){if("appblock"===n)if(discountNinja.Utilities.jQuery()("."+r+'[data-source="appblock"]').length>0)return void discountNinja.Utilities.jQuery()("."+r).not('[data-source="appblock"]').removeClass(r).addClass(r+"-disabled");if(!(discountNinja.Utilities.jQuery()("."+o).length>0||discountNinja.Utilities.jQuery()("."+r).length>0)){discountNinja.Utilities.jQuery()("."+r).not("."+o).removeClass(r).addClass(r+"-disabled");var a='<div class="'+r+" "+o+'"></div>';e.Inject(n,a,null,!1,t)}}}function n(i){var n=!1,e=discountNinja.Environment.Shopify.IsCartPage();if(i||e){if(t(i)){var o="."+discountNinja_Script_DiscountCode.ClassPrefix+"-",r=o+"wrapper",a=o+"placeholder",c=discountNinja.Utilities.jQuery()(a);if(c.length>0)for(var u=0;u<c.length;u++){var s=discountNinja.Utilities.jQuery()(c[u]);if(i||!(s.parents(".limoniapps-discountninja-drawercart-root").length>0)){if(0===s.find("button."+discountNinja_Script_DiscountCode.ClassPrefix+"-apply:enabled:visible").length){var d=discountNinja_Script_DiscountCode.GetTemplate();s.html(d),n=!0}var l=a+" "+o+"apply",g=o+"input",f=a+" input"+g;discountNinja.Utilities.jQuery()(l).click((function(){var t=discountNinja.Utilities.jQuery()(this).closest(a).find(g).val();discountNinja_Script_DiscountCode.AddDiscountCodeFromLookup(t)})),discountNinja.Utilities.jQuery()(f).keypress((function(t){var i=t.keyCode?t.keyCode:t.which;if("13"===i||13===i){var n=discountNinja.Utilities.jQuery()(this).val();discountNinja_Script_DiscountCode.AddDiscountCodeFromLookup(n),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue=!1}})),s.find(o+"inner").show(),s.find(o+"link").is(":visible")&&(s.find(o+"inputandbutton").hide(),s.find(o+"description").hide(),s.find(o+"footer").hide()),s.find("svg").show(),s.find(r).show()}}}n&&discountNinja_Script_DiscountCode.UpdateTags()}}try{discountNinja.Environment.Shopify.IsCartPage()&&t(!1)&&i(!1),t(!0)&&i(!0),n(!0),n(!1)}catch(t){discountNinja.Logging.LogError("DiscountCode.EnableDiscountCodeField",t)}},RemoveSavedDiscountCode:function(){try{discountNinja.Cache.SessionRemove("saveddiscountcode")}catch(t){return discountNinja.Logging.LogError("DiscountCode.RemoveSavedDiscountCode",t),""}},GetDiscountCodeFromQueryParameter:function(){try{var t=discountNinja.QueryParameter.Get("discountcode");return t||(t=discountNinja.QueryParameter.Get("discount")),t?decodeURIComponent(t).toUpperCase().trim():function(){try{var t=discountNinja.Cache.SessionGet("saveddiscountcode");return t?decodeURIComponent(t).toUpperCase().trim():""}catch(t){return discountNinja.Logging.LogError("DiscountCode.GetSavedDiscountCode",t),""}}()}catch(t){return discountNinja.Logging.LogError("DiscountCode.GetDiscountCodeFromQueryParameter",t),""}},GetPromotionForDiscountCode:function(t){try{var i=discountNinja.Offer.Offers;if(!i)return null;for(var n=0;n<i.length;n++)for(var e=0;e<5;e++)if(i[n].Tiers[e]&&i[n].Tiers[e].DiscountCode.Code===t)return i[n];return null}catch(t){return discountNinja.Logging.LogError("DiscountCode.GetPromotionForDiscountCode",t),null}}},discountNinja_Script_DiscountCodeTrigger={TriggersCacheKey:"triggersfromdiscountcode",UseLocalStorage:function(){try{return!!discountNinja.Settings.Settings&&!0===discountNinja.Settings.Settings.General.StorePromotionCodes}catch(t){return discountNinja.Logging.LogError("DiscountCodeTrigger.UseLocalStorage",t),!1}},Get:function(){try{for(var t=discountNinja_Script_DiscountCodeTrigger.UseLocalStorage(),i=discountNinja_Script_DiscountCodeTrigger.TriggersCacheKey,n=t?discountNinja.Cache.LocalGet(i):discountNinja.Cache.SessionGet(i),e=n?JSON.parse(n):[],o=!0===discountNinja.Settings.Settings.Cart.CartDiscountField,r=[],a=[],c=0;c<e.length;c++){var u=e[c];void 0===u.status||u.status.toString()!==discountNinjaContext.Status.toString()||"Shopify"===u.source&&u.session!==discountNinja.Cache.SessionId()||!o&&!u.addedManually?a.push(u):r.push(u)}if(a.length>0&&(discountNinja_Script_DiscountCodeTrigger.Save(r),void 0!==discountNinja.Settings.Settings&&void 0!==discountNinja.Settings.Settings.Cart))for(var s=0;s<a.length;s++){var d=a[s];!0!==d.revalidated&&(o||d.addedManually)&&(discountNinja.DiscountCode.AddDiscountCode(d.discountCode,!1,null,!0),d.revalidated=!0)}return r}catch(t){return discountNinja.Logging.LogError("DiscountCodeTrigger.Get",t),[]}},Save:function(t){try{var i=discountNinja_Script_DiscountCodeTrigger.UseLocalStorage(),n=discountNinja_Script_DiscountCodeTrigger.TriggersCacheKey;discountNinja.Cache.SessionSet(n,JSON.stringify(t)),i?discountNinja.Cache.LocalSet(n,JSON.stringify(t)):discountNinja.Cache.LocalRemove(n)}catch(t){discountNinja.Logging.LogError("DiscountCodeTrigger.Save",t)}},FindByDiscountCode:function(t,i){try{for(var n=0;n<i.length;n++)if(i[n].discountCode.toLowerCase()===t.toLowerCase())return i[n];return null}catch(t){return discountNinja.Logging.LogError("DiscountCodeTrigger.FindByDiscountCode",t),null}},Add:function(t,i,n,e){try{var o=!1,r=discountNinja.Checkout.Shopify.GetCheckoutDiscountCodes(),a=r&&r.findIndex((function(i){return i===t}))>-1,c=discountNinja_Script_DiscountCodeTrigger.Get();if(!(discountNinja_Script_DiscountCodeTrigger.FindByDiscountCode(t,c)||a)){o=!0;var u=discountNinja.Settings.Settings.Cart.AllowMultipleDiscountCodes,s=discountNinja.Settings.Settings.Cart.AllowMultipleShopifyDiscountCodes,d=0,l=0,g=discountNinja_Script_DiscountCodeTrigger.Get();if(g)for(var f=0;f<g.length;f++){if("Shopify"===g[f].source?l++:d++,!u&&d>0&&"DiscountNinja"===n||!s&&l>0&&"Shopify"===n){o=!1;break}}c.push({discountCode:t,trigger:i,valid:o,errorMessage:"",source:n,status:discountNinjaContext.Status.toString(),session:discountNinja.Cache.SessionId(),addedManually:!0===e}),discountNinja_Script_DiscountCodeTrigger.Save(c)}return o}catch(t){return discountNinja.Logging.LogError("DiscountCodeTrigger.Add",t),!1}},Remove:function(t){try{for(var i=discountNinja_Script_DiscountCodeTrigger.Get(),n=[],e=0;e<i.length;e++){var o=i[e];if(o.discountCode.toLowerCase()!==t.toLowerCase())n.push(o);else{var r=discountNinja_Script_Token.GetNonAutomaticTokenFromCache();if(o.trigger.Triggers)for(var a=0;a<o.trigger.Triggers.length;a++)if(o.trigger.Triggers[a].Token===r){discountNinja.Token.RemoveNonAutomaticTokenFromCache();break}}}discountNinja_Script_DiscountCodeTrigger.Save(n)}catch(t){discountNinja.Logging.LogError("DiscountCodeTrigger.Remove",t)}}},discountNinja_Script_DiscountedCart={Version:1,IsDirty:!1,DiscountedCart:null,SplitRowsInProcess:!1,FreeGiftAdjustmentInProcess:!1,SplitRowPrefix:"DiscountNinja.SplitRow.",LockedRowPrefix:"DiscountNinja.LockedRow.",FreeGiftPrefix:"DiscountNinja.FreeGift.",EntitlementSuffix:".Entitlement",PrerequisiteSuffix:".Prerequisite",Get:function(t){try{var i=discountNinja_Script_DiscountedCart.DiscountedCart;if(!i||!i.items)return null;for(var n=0;n<i.items.length;n++){var e=i.items[n];if(e.Key===t)return e}return null}catch(t){return discountNinja.Logging.LogError("DiscountedCart.Get",t),null}},GetDiscountedAmountForOffer:function(t){try{var i=0,n=discountNinja.DiscountedCart.DiscountedCart;if(n){if(n.items)for(var e=0;e<n.items.length;e++){var o=n.items[e];o.OfferToken===t&&"line_item"===o.TargetType&&(i+=100*o.Line.EffectiveAmount)}if(n.CartLevelDiscounts)for(e=0;e<n.CartLevelDiscounts.length;e++){var r=n.CartLevelDiscounts[e];r.OfferToken===t&&(i+=100*r.Amount)}}return i}catch(t){return discountNinja.Logging.LogError("DiscountedCart.GetDiscountedAmountForOffer",t),0}},BuildDiscountedCart:function(t){var i=discountNinja.Utilities.jQuery().Deferred();function n(t,i,n,o,r,a){var u=discountNinja.LiquidData.CartItemByKeyAndSellingPlanId(t,i),s={Key:t,Product:o,Line:r,OfferToken:n?n.Token:null,TriggerToken:n?discountNinja.Offer.GetTriggerTokenForOffer(n.Token):null,TargetType:n?n.Entitlement?n.Entitlement.TargetType:null:"line_item",DiscountCode:n?discountNinja.Offer.GetPromotionDiscountCode(n):null,PriceRuleId:n?discountNinja.Offer.GetPromotionPriceRuleId(n):null,PriceRuleTitle:n?discountNinja.Offer.GetPromotionPriceRuleTitle(n):null,Properties:e(u),Tier:a,Source:n?n.TriggeredByTrigger.Source:null};s.SellingPlanId=i,s.HasSellingPlan=null!=s.SellingPlanId,s.Id=c(s.Key,s.SellingPlanId),s.IsGift=function(t){try{if(null===t)return!1;for(var i=0;i<t.length;i++)if(t[i].Name.startsWith(discountNinja_Script_DiscountedCart.FreeGiftPrefix))return!0;return!1}catch(t){return discountNinja.Logging.LogError("DiscountedCart.HasGiftProperty",t),!1}}(s.Properties),s.IsSubscriptionProduct=P(s);try{delete s.Product.Key,delete s.Product.OfferToken,delete s.Product.TriggerToken,delete s.Product.DiscountCode,delete s.Line.Key,delete s.Line.OfferToken,delete s.Line.TriggerToken,delete s.Line.DiscountCode}catch(t){}return s}function e(t){try{var i=[],n=t.properties;if(null===n)return null;for(var e in n)i.push({Name:e,Value:n[e]});return i}catch(t){return discountNinja.Logging.LogError("DiscountedCart.BuildProperties",t),[]}}function o(t,i,e,o,r,a,u,s){var d=-1,l=c(t,i);if(e&&e.items)for(var g=0;g<e.items.length;g++)if(e.items[g].Id===l){d=g;break}var f=n(t,i,o,r,a,u);if(-1===d)e.items.push(f);else{var p=e.items[d];if(p.Bogo)return e;var N=void 0===p.TriggerToken||null===p.TriggerToken,j=f.Line.DiscountedPrice<p.Line.DiscountedPrice,C=0===f.Line.DiscountedPrice&&0===p.Line.OriginalPrice&&null!==o,m=0===f.Line.DiscountedPrice&&p.IsGift&&null!==o&&o.Token===function(t){try{var i=t.Properties,n=discountNinja_Script_DiscountedCart.FreeGiftPrefix;if(null!=i)for(var e=0;e<i.length;e++){var o=i[e].Name;if(o.indexOf(n)>-1)return o.replace(n,"")}}catch(t){discountNinja.Logging.LogError("DiscountedCart.GetFreeGiftOfferToken",t)}return null}(p);(s||N||j||C||m)&&(e.items[d]=f)}return e}function r(t,i,n,e,o,r,a,u,s,d,l,g){return{Key:t,VariantId:e,ProductHandle:o,OriginalPrice:discountNinja.Utilities.RoundToNumberOfDigits(u/100,2),OriginalCompareAtPrice:discountNinja.Utilities.RoundToNumberOfDigits(s/100,2),Amount:0,Percentage:0,EffectiveCompareAtPrice:discountNinja.Utilities.RoundToNumberOfDigits(s/100,2),DiscountedPrice:discountNinja.Utilities.RoundToNumberOfDigits(u/100,2),InventoryLeft:d,Collections:l,CollectionIds:g,ProductTags:a,ProductId:n,Title:r,Tier:null,SellingPlanId:i,HasSellingPlan:null!==i,Id:c(t,i)}}function a(t,i,n){return{OriginalPrice:discountNinja.Utilities.RoundToNumberOfDigits(t/100*n,2),OriginalCompareAtPrice:discountNinja.Utilities.RoundToNumberOfDigits(i/100*n,2),Amount:0,Percentage:0,EffectiveAmount:0,EffectivePercentage:0,EffectiveCompareAtPrice:discountNinja.Utilities.RoundToNumberOfDigits(i/100*n,2),DiscountedPrice:discountNinja.Utilities.RoundToNumberOfDigits(t/100*n,2),QuantityDiscounted:0,QuantityNotDiscounted:n,Tier:null}}function c(t,i){return null!==i?t+":"+i:t}function u(t,i,n,e,o,u,s,d,l,g,f,p,N,j,C,m,S,h){try{var _=c(n,e),y=i.items.find((function(t){return t.Id===_}));if(y&&!0===y.IsGift&&!m||y&&!0===y.IsGift&&h||y&&!0!==y.IsGift&&S)return null;y&&!0===y.IsSubscriptionProduct&&(C=!0);var v=!0===discountNinja.Settings.Settings.ExcludeSubscriptionProducts,P=n.split(":")[0],T=discountNinja.Offer.GetOfferForCartItem(t,o,P,g,d,u,s,!1,C),L=u/100,D=null,E=null,I=null,O=T?T.Entitlement:null;if((!C||!v)&&l>0&&T&&O&&"shipping_line"!==O.TargetType&&"each"==O.AllocationMethod){var A=discountNinja.DiscountTier.GetCurrentDiscountTier(T);I=A?A.Level:null;var k=discountNinja.Prerequisite.EntitledQuantityInfo(T,A),b=null===k||!1===k.HasEntitledQuantity?l:k.Entitled.NotAttributed;b=Math.min(b,l);var R=Math.max(0,l-b);if(D=discountNinja.DiscountedProduct.Get(n,P,o,u,s,d,T,null,null,b,R),E=discountNinja.DiscountedProduct.Get(n,P,o,u,s,d,T,l,null,b,R),D&&E&&b>0){T.AttributedQuantity=T.AttributedQuantity+b,"spendx_gety"!==T.OfferType&&discountNinja.Offer.ResetEntitledQuantityDetails(T);var U=E.DiscountedPrice,w=discountNinja.Utilities.RoundToNumberOfDigits(U/l*b,2);w+=discountNinja.Utilities.RoundToNumberOfDigits(L*R,2),E.DiscountedPrice=w;var F=E.OriginalPrice-E.DiscountedPrice,x=discountNinja.Utilities.RoundToNumberOfDigits(F,2);E.EffectiveAmount=x,E.EffectivePercentage=discountNinja.Utilities.RoundToNumberOfDigits(Math.min(0===E.EffectiveCompareAtPrice?0:Math.abs(x/E.EffectiveCompareAtPrice*100),100),2),E.QuantityDiscounted=b,E.QuantityNotDiscounted=R,E.OriginalPrice=L*b,E.OriginalPriceTotal=L*l;try{delete E.VariantId,delete E.ProductHandle,delete E.InventoryLeft}catch(t){}}else T=null,D=r(n,e,N,P,o,j,p,u,s,d,g,f),E=a(u,s,l)}else T=null,D=r(n,e,N,P,o,j,p,u,s,d,g,f),E=a(u,s,l);return D.Collections=g,D.CollectionIds=f,D.Tags=p,D.ProductId=N,D.Title=j,{ProductInfo:D,LineInfo:E,TierNumber:I,ApplicableOffer:T}}catch(t){return discountNinja.Logging.LogError("DiscountedCart.AddDiscountedCartItem",t),null}}function s(){if(discountNinja.Offer.Offers)for(var t=0;t<discountNinja.Offer.Offers.length;t++)discountNinja.Offer.Offers[t].AttributedQuantity=0}function d(){if(discountNinja.Offer.Offers)for(var t=0;t<discountNinja.Offer.Offers.length;t++)discountNinja.Offer.ResetEntitledQuantityDetails(discountNinja.Offer.Offers[t])}function l(t){if(t.items)for(var i=0;i<t.items.length;i++){var n=t.items[i];if(n.OfferToken&&n.Tier){var e=discountNinja.Offer.GetOfferByToken(n.OfferToken);if(e&&!0===e.DisallowDiscountingPrerequisites)for(var o=discountNinja.Set.BOGOSets(e,e.Tiers[n.Tier-1],"collection"),r=0;r<o.LineItems.length;r++){var a=o.LineItems[r];if(a.Entitled>0||a.Prerequisite>0)t.items.find((function(t){return t.Id===a.Id})).Sets=a.Sets}}}return t}function g(t,i,n,e,r){if(!t||0==t.length)return n;for(var a=r?2:1,c=0;c<a;c++){d();for(var s=0;s<i.length;s++){var l=i[s],g=l.key,p=discountNinja.LiquidData.GetSellingPlanId(l),N=r&&0===c,j=r&&1===c,C="object"==typeof l.VariantData?l.VariantData:null,m=null===C?null:C.Price,S=null===C?null:C.CompareAtPrice,h=null===C?null:C.Inventory,_=null===C?null:C.Collections,y=null===C?null:C.CollectionIds,v=null===C?null:C.Tags,P=null===C?null:C.IsSubscription,T=u(t,n,g,p,l.handle,l.original_price||m,S,h,l.quantity,_,y,v,l.product_id,l.product_title,P,e,N,j);T&&(n=f(n=o(g,p,n,T.ApplicableOffer,T.ProductInfo,T.LineInfo,T.TierNumber,!1)))}}return n}function f(t){if(!t)return null;var i=0,n=0,e=0,o=0;if(t.items)for(var r=0;r<t.items.length;r++){var a=t.items[r],c=a.Line;i+=c.OriginalPrice,n+=c.DiscountedPrice,e+=c.OriginalPrice,a.IsGift&&(o+=c.OriginalPrice)}var u=0;if(t.CartLevelDiscounts)for(r=0;r<t.CartLevelDiscounts.length;r++){u+=t.CartLevelDiscounts[r].Amount}t.subtotal_discounted_price=Math.round(100*n)/100,t.subtotal_original_price=Math.round(100*e)/100,t.subtotal_original_price_excluding_gifts=Math.round(100*(e-o))/100;var s=e-n;t.subtotal_discount=Math.round(100*s)/100;var d=e-o-n;t.subtotal_discount_excluding_gifts=Math.round(100*d)/100,t.cartlevel_discount=Math.round(100*u)/100,t.total_original_price=Math.round(100*i)/100,t.total_original_price_excluding_gifts=Math.round(100*(i-o))/100,t.total_discounted_price=Math.max(0,Math.round(100*(n-u))/100);var l=s+u;t.total_discount=Math.round(100*l)/100;var g=d+u;t.total_discount_excluding_gifts=Math.round(100*g)/100;var f=function(t){try{var i=!1,n=!1;t.AppliedPromotions=null;var e=discountNinja_Script_DiscountedCart.GetAppliedPromotions(t);if(e)for(var o=0;o<e.length;o++){var r=discountNinja.Trigger.GetTriggerByToken(e[o].TriggerToken);if(r&&("code-dn"===r.Source&&(i=!0),"code-shopify"===r.Source&&(n=!0)),i&&n)break}return{AppliedPromotions:e,HasPromotionCodes:i,HasShopifyDiscountCodes:n}}catch(t){return discountNinja.Logging.LogError("DiscountedCart.HasPromotionCodesOrShopifyDiscountCodes",t),null}}(t);return t.HasPromotionCodes=f.HasPromotionCodes,t.HasShopifyDiscountCodes=f.HasShopifyDiscountCodes,t.AppliedPromotions=f.AppliedPromotions,t}function p(t){try{var i=1,n=t.Entitlement;return"buyx_gety"===t.OfferType&&"fixed_amount"===n.ValueType&&"across"===n.AllocationMethod&&t.Tiers&&t.Tiers.length>0&&(i=discountNinja.Set.ForTier(t,t.Tiers[0],!0).Completed),i}catch(t){return discountNinja.Logging.LogError("DiscountedCart.GetPrerequisiteUnits",t),1}}function N(t,i){for(var n=[],e=0;e<t.length;e++){var o=t[e];o.Token!==i&&n.push(o)}return n}function j(t){if(0===t.length)return[];if(1===t.length)return[t];for(var i=[],n=0;n<t.length;n++)for(var e=t[n],o=j(N(t,e.Token)),r=0;r<o.length;r++){var a=[e].concat(o[r]);i.push(a)}return i}function C(t,i){if(0===i.length)return t;for(var n=[],e=0;e<t.length;e++)for(var o=0;o<i.length;o++)n.push(t[e].concat(i[o]));return n}function m(t){for(var i=[],n=0;n<t.length;n++){var e=t[n],o=e.Entitlement;if(o&&"line_item"===o.TargetType&&"across"===o.AllocationMethod)if(discountNinja.Offer.OfferIsApplicable(e)&&!discountNinja.Offer.OfferIsExcluded(e))discountNinja.DiscountTier.GetCurrentDiscountTier(e)&&i.push(e)}return i}function S(t,i){if(!t||0==t.length)return i;d();for(var n=[],e=0;e<t.length;e++){var o=t[e],r=o.Entitlement;if(r&&"line_item"===r.TargetType&&"across"===r.AllocationMethod){if(i.CartLevelDiscounts)for(var a=0;a<i.CartLevelDiscounts.length;a++){i.CartLevelDiscounts[a].OfferToken,o.Token}if(discountNinja.Offer.OfferIsApplicable(o)&&!discountNinja.Offer.OfferIsExcluded(o)){var c=discountNinja.DiscountTier.GetCurrentDiscountTier(o);if(c){var u=discountNinja.Offer.EligibleItemsCartValue(o,"discountedcart",!0),s=u/100,l=0;l="percentage"===r.ValueType?Math.floor(u*c.Entitlement.Percentage/100)/100:c.Entitlement.Amount,l*=p(o);var g=Math.min(s,l);if(g>0){var N=discountNinja.Offer.EligibleItems(o,!0),j=[];for(a=0;a<N.length;a++){var C=N[a];j.push({VariantId:C.Product.VariantId,ProductHandle:C.Product.ProductHandle,Collections:C.Product.Collections,IsGift:C.IsGift,Quantity:C.Line.QuantityDiscounted+C.Line.QuantityNotDiscounted})}var m=c.DiscountCode,S=discountNinja.Offer.GetTriggerTokenForOffer(o.Token),_=discountNinja.Trigger.GetTriggerByToken(S);n.push({OfferToken:o.Token,TriggerToken:S,Amount:g,DiscountCode:m.Code,PriceRuleId:m.PriceRuleId,PriceRuleAppId:m.PriceRuleAppId,PriceRuleTitle:m.PriceRuleTitle,TargetType:r.TargetType,Tier:c?c.Level:null,Stacks:!0===_.Stacking.Combine&&!0===o.Stacking.Stack,ValueType:r.ValueType,Percentage:c.Entitlement.Percentage,Source:o.TriggeredByTrigger.Source,LineItems:j}),h(i,n)}}}}}return f(i)}function h(t,i){if(t.CartLevelDiscounts=[],t=f(t),i.length>0){for(var n=[],e=[],o=0;o<i.length;o++){var r=i[o];n.push(r),!0===r.Stacks&&e.push(r)}t.total_discounted_price;var a=null;for(o=0;o<n.length;o++){r=n[o];var c=a?a.Amount:0;r.Amount>c&&(a=r)}var u=a?a.Amount:-1,s=-1;for(o=0;o<e.length;o++){s+=(r=e[o]).Amount}var d=null!==a,l=-1!==s;if(d||l){var g=d&&u>s?"nonstacking":"stacking";if("nonstacking"!=g||d||(g="stacking"),"stacking"!=g||l||(g="nonstacking"),"stacking"==g)for(o=0;o<e.length;o++)t.CartLevelDiscounts.push(e[o]);else"nonstacking"==g&&t.CartLevelDiscounts.push(a)}}t=f(t)}function _(t,i,n,e){//!4
if(function(t){try{for(var i=!0,n=0;n<t.items.length;n++){var e=discountNinja.Offer.GetOfferByToken(t.items[n].OfferToken);if(e&&!1===e.Stacking.CombineWithOrderLevel){i=!1;break}}return i}catch(t){return discountNinja.Logging.LogError("DiscountedCart.CanCombineWithOrderLevelOffers",t),!0}}(e)){var o=JSON.parse(JSON.stringify(e)),r=function(t,i,n){var e=[];for(e.push(j(t)),e.push(j(n)),e.push(j(i));0===e[0].length&&(0!==e[1].length||0!==e[2].length);)e[0]=e[1],e[1]=e[2],e[2]=[];return 0===e[1].length&&0!==e[2].length&&(e[1]=e[2],e[2]=[]),C(C(e[0],e[1]),e[2])}(m(t),m(i),m(n));r.length>24&&(discountNinja.Logging.LogWarning("The amount of permutations of order level offers exceeds the maximum limit",!0),r=r.slice(0,24));for(var a=[],c=0;c<r.length;c++)a.push(S(r[c],e)),e=JSON.parse(JSON.stringify(o)),discountNinja_Script_DiscountedCart.DiscountedCart=e;var u=-1,s=-1;for(c=0;c<a.length;c++){var d=a[c];d.total_discount>u&&(s=c,u=d.total_discount)}s>-1&&(e=S(r[s],e),discountNinja_Script_DiscountedCart.DiscountedCart=e)}return e}function y(t,i){if(i&&i.length>0){d();for(var n=0;n<i.length;n++){var e=i[n];if(t.Shipping&&t.Shipping.PriceRuleId)break;if(discountNinja.Offer.OfferIsApplicable(e)&&!discountNinja.Offer.OfferIsExcluded(e)){var o=discountNinja.DiscountTier.GetCurrentDiscountTier(e);if(o){var r=o.DiscountCode;t.Shipping={OfferToken:e.Token,TriggerToken:discountNinja.Offer.GetTriggerTokenForOffer(e.Token),DiscountCode:r.Code,PriceRuleId:r.PriceRuleId,PriceRuleTitle:r.PriceRuleTitle,PriceRuleAppId:r.PriceRuleAppId,TargetType:e.Entitlement.TargetType,Source:e.TriggeredByTrigger.Source}}}}}return t}function v(t,i){try{return t.Properties&&t.Properties.findIndex((function(t){return t.Name===i}))>-1}catch(t){return discountNinja.Logging.LogError("DiscountedCart.HasProperty",t),!1}}function P(t){try{return v(t,"shipping_interval_frequency")||v(t,"shipping_interval_unit_type")||v(t,"subscription_id")||!0===t.HasSellingPlan}catch(t){return discountNinja.Logging.LogError("DiscountedCart.IsSubscriptionProduct",t),!1}}function T(){try{var e=window.discountNinjaContext?window.discountNinjaContext.Cart:null;if(discountNinja_Script_DiscountedCart.IsDirty=!1,discountNinja_Script_DiscountedCart.DiscountedCart&&(discountNinja_Script_DiscountedCart.DiscountedCart.IsReady=!1),discountNinja_Script_DiscountedCart.ClearCartValueCache(),discountNinja.Offer.ResetTiersUsed(),null!=e&&void 0!==e.items&&null!==e.items){var o={items:[]};o.token=discountNinja.LiquidData.Cart().token;var c=function(t){var i=[];if(t&&t.items){for(var n=0;n<t.items.length;n++)if(t.items[n].properties)for(var e in t.items[n].properties)if(e.indexOf("DiscountNinja.FreeGift")>-1||e.indexOf("DiscountNinja.Discounted")>-1){i.push(t.items[n]);break}for(n=0;n<t.items.length;n++){for(var o=!1,r=0;r<i.length;r++)if(t.items[n].key===i[r].key){o=!0;break}o||i.push(t.items[n])}}return i.sort((function(t,i){var n=!1,e=!1;if(t.properties)for(var o in t.properties)if(o.indexOf("DiscountNinja.SplitRow")>-1){n=!0;break}if(i.properties)for(var o in i.properties)if(o.indexOf("DiscountNinja.SplitRow")>-1){e=!0;break}return t.original_price<i.original_price?-1:t.original_price>i.original_price?1:n&&!e?-1:!n&&e?1:0})),i}(e);c=function(t){for(var i=0;i<t.length;i++){var n=t[i],e=discountNinja.ProductData.GetByProductHandle(n.handle,!1);if(e){var o=discountNinja.ProductData.GetVariantData(n.handle,n.variant_id);null!==o&&(null!==o.Price&&(e.Price=o.Price),null!==o.CompareAtPrice&&(e.CompareAtPrice=o.CompareAtPrice),null!==o.Inventory&&(e.Inventory=o.Inventory)),n.VariantData=e,n.VariantData.IsSubscription=P(n)}}return t}(c),o=function(t,i){for(var e=0;e<t.length;e++){var o=t[e],c=o.handle,u=o.VariantData,s=u?u.CompareAtPrice:0,d=discountNinja.LiquidData.GetSellingPlanId(o);productInfo=r(o.key,d,o.product_id,o.variant_id,c,o.product_title,null,o.original_price,s,u?u.Inventory:0,u?u.Collections:"",u?u.CollectionIds:""),lineInfo=a(o.original_price,s,o.quantity),i.items.push(n(o.key,d,null,productInfo,lineInfo,null))}return f(i),i.AppliedPromotions=null,i}(c,o),o=function(t){try{if(t&&t.items)for(var i=0;i<t.items.length;i++){var n=t.items[i];n.IsSubscriptionProduct=P(n)}return t}catch(i){return discountNinja.Logging.LogError("DiscountedCart.MarkSubscriptionProducts",i),t}}(o),discountNinja_Script_DiscountedCart.DiscountedCart=o;var u=function(t){var i=discountNinja.DiscountCodeTrigger.Get()||[],n=[],e=[],o=[],r=[],a=[],c=[],u=[],s=[],d=[],l=[],g=[],f=[],p=[],N=[],j=[];if(discountNinja.Offer.Offers)for(var C=0;C<discountNinja.Offer.Offers.length;C++){var m=discountNinja.Offer.Offers[C],S=m.Tiers&&m.Tiers.length>0?m.Tiers[0]:null,h=S?S.Prerequisite:null,_=void 0!==h.MinimumAmount,y=void 0!==h.MinimumItems,v=void 0!==m.Bogo;m.TriggeredByTrigger.Source=discountNinja.TriggerSource.GetSource(m.Tiers[0].DiscountCode.Code,m.TriggeredByTrigger.Token,i);var P=discountNinja.TriggerSource.IsPromotionCodeField(m.TriggeredByTrigger.Source),T=m.Entitlement,L=T&&"line_item"===T.TargetType&&"across"===T.AllocationMethod,D=T&&"shipping_line"===T.TargetType,E=!0===m.DisallowDiscountingPrerequisites;D||L||!v?D||L||!E?D||L||E||!_?D||L||E||!y?!D&&L&&_?u.push(m):!D&&L&&y?c.push(m):D?P?p.push(m):d.push(m):L?s.push(m):P?f.push(m):o.push(m):P?l.push(m):n.push(m):P?g.push(m):e.push(m):P?N.push(m):j.push(m):_?a.push(m):r.push(m)}return e.length>0&&e.sort((function(t,i){return t.Tiers[0].Prerequisite.MinimumAmount-i.Tiers[0].Prerequisite.MinimumAmount})),a.length>0&&a.sort((function(t,i){return t.Tiers[0].Prerequisite.MinimumAmount-i.Tiers[0].Prerequisite.MinimumAmount})),g.length>0&&g.sort((function(t,i){return t.Tiers[0].Prerequisite.MinimumAmount-i.Tiers[0].Prerequisite.MinimumAmount})),{LineLevelCartContentBasedOffers:n,LineLevelCartValueBasedOffers:e,LineLevelNoPrerequisiteOffers:o,LineLevelGwpCartValueOffers:a,LineLevelGwpOffers:r,OrderLevelCartContentBasedOffers:c,OrderLevelCartValueBasedOffers:u,OrderLevelNoPrerequisiteOffers:s,ShippingOffers:d,LineLevelCartContentBasedOffersFromPCF:l,LineLevelCartValueBasedOffersFromPCF:g,LineLevelNoPrerequisiteOffersFromPCF:f,ShippingOffersFromPCF:p,BOGOOffersFromPCF:N,BOGOOffers:j}}();o=function(t,i,n){for(var e=!0,o=0,r=!1;e&&o<4;)o+=1,d(),s(),f(i),i.BogoUsed="",i.CartLevelDiscounts=[],i=g(n.BOGOOffers.concat(n.BOGOOffersFromPCF),t,i,r,!1),discountNinja_Script_DiscountedCart.DiscountedCart=i,i=l(i),discountNinja_Script_DiscountedCart.DiscountedCart=i,i=g(n.LineLevelNoPrerequisiteOffers,t,i,r,!1),discountNinja_Script_DiscountedCart.DiscountedCart=i,i=g(n.LineLevelCartContentBasedOffers,t,i,r,!1),discountNinja_Script_DiscountedCart.DiscountedCart=i,i=g(n.LineLevelCartValueBasedOffers,t,i,r,!1),discountNinja_Script_DiscountedCart.DiscountedCart=i,i=g(n.LineLevelNoPrerequisiteOffersFromPCF,t,i,r,!1),discountNinja_Script_DiscountedCart.DiscountedCart=i,i=g(n.LineLevelCartContentBasedOffersFromPCF,t,i,r,!1),discountNinja_Script_DiscountedCart.DiscountedCart=i,i=g(n.LineLevelCartValueBasedOffersFromPCF,t,i,r,!1),discountNinja_Script_DiscountedCart.DiscountedCart=i,i=_(n.OrderLevelNoPrerequisiteOffers,n.OrderLevelCartValueBasedOffers,n.OrderLevelCartContentBasedOffers,i),i=g(n.LineLevelGwpCartValueOffers,t,i,!0,!0),discountNinja_Script_DiscountedCart.DiscountedCart=i,i=g(n.LineLevelGwpOffers,t,i,!0,!0),discountNinja_Script_DiscountedCart.DiscountedCart=i,r=!0,e=1===o&&n.LineLevelGwpOffers.length>0;return i}(c,o,u),o=function(t,i){return t.Shipping=null,t=y(t,i.ShippingOffers),y(t,i.ShippingOffersFromPCF)}(o,u);var p=(new Date).getTime();o.Version=discountNinja_Script_DiscountedCart.Version+"-"+p,discountNinja_Script_DiscountedCart.Version=discountNinja_Script_DiscountedCart.Version+1,o.Currency=discountNinja.Currency.ActiveCurrency(),discountNinja.Cache.SessionRemove("PrerequisiteItemsCartValue"),function(t){try{if(t.items)for(var i=0;i<t.items.length;i++)(n=t.items[i]).OfferToken&&n.Tier&&(e=discountNinja.Offer.GetOfferByToken(n.OfferToken))&&(!e.AppliedTier||1*e.AppliedTier<1*n.Tier)&&(e.AppliedTier=n.Tier);if(t.CartLevelDiscounts)for(i=0;i<t.CartLevelDiscounts.length;i++){var n;(n=t.CartLevelDiscounts[i]).OfferToken&&n.Tier&&(e=discountNinja.Offer.GetOfferByToken(n.OfferToken))&&(!e.AppliedTier||1*e.AppliedTier<1*n.Tier)&&(e.AppliedTier=n.Tier)}var e;discountNinja.Offer.PrimaryOffer&&(e=discountNinja.Offer.GetOfferByToken(discountNinja.Offer.PrimaryOffer.Token))&&(discountNinja.Offer.PrimaryOffer.AppliedTier=e.AppliedTier)}catch(t){discountNinja.Logging.LogError("DiscountedCart.SaveTiersUsed",t)}}(o),function(t){try{discountNinja.Cache.LocalSet("discounted-cart",JSON.stringify(t))}catch(t){discountNinja.Logging.LogError("DiscountedCart.SaveDiscountedCartToCache",t)}}(o),discountNinja_Script_DiscountedCart.DiscountedCart=o,o.AppliedPromotions=discountNinja_Script_DiscountedCart.GetAppliedPromotions(o),discountNinja_Script_DynamicPricing.DrawerCartIsDirty=!0,discountNinja_Script_DynamicPricing.ClassicCartIsDirty=!0}}catch(t){discountNinja.Logging.LogError("DiscountedCart.BuildDiscountedCart",t)}discountNinja.DynamicPricing.UnblockPricesAndButtons();var N=discountNinja_Script_DiscountedCart.GetAppliedPromotions();if(N&&N.length>0)for(var j=0;j<N.length;j++){var C=N[j].TriggerToken;C&&discountNinja.PromotionEvent.AddToQueue(C,2)}else discountNinja.DiscountCode.RemoveCheckoutDiscountCode();null!=t&&"function"==typeof t&&t(),i.resolve()}if(discountNinja_Script_DiscountedCart.IsDirty){var L=discountNinja_Script_DiscountedCart.DiscountedCart;L&&(L.CheckoutLink=null),function(){var t=[],i=window.discountNinjaContext?window.discountNinjaContext.Cart:null;if(i&&i.items)for(var n=0;n<i.items.length;n++){var e=discountNinja.ProductData.GetByProductHandle(i.items[n].handle,!0,!1,null,!1,0,!0,!0);t.push(e)}t.length>0?discountNinja.Utilities.jQuery().when.apply(discountNinja.Utilities.jQuery(),t).then((function(){T()})):T()}()}else discountNinja_Script_DiscountedCart.DiscountedCart||(discountNinja_Script_DiscountedCart.DiscountedCart=discountNinja_Script_DiscountedCart.GetDiscountedCartFromCache()),discountNinja_Script_DiscountedCart.DiscountedCart?"function"==typeof t&&null!==t&&t():discountNinja.Logging.LogWarning("Building discounted cart - Rehydrating from cache - FAILED"),discountNinja.DynamicPricing.UnblockPricesAndButtons();return i.promise()},SplitRows:function(){function t(t){return discountNinja_Script_DiscountedCart.SplitRowPrefix+t}var i=discountNinja_Script_DiscountedCart.DiscountedCart;return!(!i||!i.items)&&function(){for(var n=0;n<i.items.length;n++){var e=i.items[n],o=e.OfferToken,r=e.Line,a=(r.QuantityDiscounted,r.QuantityNotDiscounted,0);if(e.Sets){a=e.Sets.reduce(((t,i)=>t+i.Entitlements),0)||0;var c=0;c=e.Sets.reduce(((t,i)=>t+i.Prerequisites),0)||0}if(r.QuantityDiscounted>0&&r.QuantityNotDiscounted>0){var u=t(o);discountNinja.CartAdjustments.Add("changequantity_setproperty",e.Product.VariantId,r.QuantityDiscounted,u,"",e.Key);var s=discountNinja.LiquidData.CopyPropertiesExceptSplitKeys(e.Key,e.SellingPlanId);discountNinja.CartAdjustments.Add("add",e.Product.VariantId,r.QuantityNotDiscounted,null,null,null,s,e.Product.ProductHandle,e.SellingPlanId)}else{if(e.Properties)for(var d=discountNinja_Script_DiscountedCart,l=0;l<e.Properties.length;l++){var g=e.Properties[l];g.Name.indexOf(d.LockedRowPrefix)>-1&&(void 0===e.Sets||null===e.Sets||-1===g.Name.indexOf("."+e.Sets[0].OfferToken)||g.Name.indexOf(d.EntitlementSuffix)>-1&&0===a||g.Name.indexOf(d.PrerequisiteSuffix)>-1&&0===c)&&(invalidSetPropertiesDetected=!0,discountNinja.CartAdjustments.Add("removeproperty",null,null,g.Name,g.Value,e.Key))}e.Sets}}}()},GetDiscountedCartFromCache:function(){try{var t=discountNinja.Cache.LocalGet("discounted-cart"),i="undefined"===t?null:JSON.parse(t);return i&&!i.CartLevelDiscounts&&(i.CartLevelDiscounts=[]),i&&function(t){try{if(discountNinja.Offer.AllOffers)for(var i=0;i<discountNinja.Offer.AllOffers.length;i++)(n=discountNinja.Offer.AllOffers[i]).AttributedQuantity=0;if(discountNinja.Offer.Offers)for(i=0;i<discountNinja.Offer.Offers.length;i++)(n=discountNinja.Offer.Offers[i]).AttributedQuantity=0;if(t.items)for(i=0;i<t.items.length;i++){var n,e=t.items[i];(n=discountNinja.Offer.GetOfferByToken(e.OfferToken))&&(n.AttributedQuantity+=e.Line.QuantityDiscounted)}}catch(i){return discountNinja.Logging.LogError("DiscountedCart.ApplyAttributedQuantityToOffers",i),t}}(i),i}catch(t){return discountNinja.Logging.LogError("DiscountedCart.GetDiscountedCartFromCache",t),null}},GetCartItemKeys:function(){try{discountNinja_Script_DiscountedCart.DiscountedCart=discountNinja_Script_DiscountedCart.GetDiscountedCartFromCache();var t=discountNinja_Script_DiscountedCart.DiscountedCart;if(t&&t.items){for(var i="",n=0;n<t.items.length;n++)""!==i&&(i+=","),i+=t.items[n].Key;return i}return""}catch(t){discountNinja.Logging.LogError("DiscountedCart.GetCartItemKeys",t)}},ClearCartValueCache:function(){discountNinja.Cache.SessionSet("CartValue",null)},DiscountedCartItemsByDelegate:function(t){try{var i=[],n=discountNinja_Script_DiscountedCart.DiscountedCart;if(!n||!n.items||0===n.items.length)return i;for(var e=n.items,o=0;o<e.length;o++){var r=e[o];t(r)&&i.push(r)}return i}catch(t){return discountNinja.Logging.LogError("DiscountedCart.DiscountedCartItemsByDelegate",t),0}},GetDiscountedLinePriceFromItems:function(t,i){try{var n=0;if(t)for(var e=0;e<t.length;e++){var o=t[e];n+=null!==o.OfferToken&&o.OfferToken===i?100*o.Line.OriginalPrice:100*o.Line.DiscountedPrice}return n}catch(t){return discountNinja.Logging.LogError("DiscountedCart.GetDiscountedLinePriceFromItems",t),0}},ItemIsInCollection:function(t,i){return i.indexOf("%")>-1&&t.Product.OriginalCompareAtPrice>t.Product.OriginalPrice||discountNinja.Utilities.StringIsIn(t.Product.Collections,i)},ItemsInDiscountedCartFromCollections:function(t,i,n){try{return discountNinja_Script_DiscountedCart.DiscountedCartItemsByDelegate((function(e){return discountNinja_Script_DiscountedCart.ItemIsInCollection(e,t)&&(!n||!e.IsGift)&&(!i||!discountNinja_Script_DiscountedCart.ItemIsInCollection(e,i))}))}catch(t){return discountNinja.Logging.LogError("DiscountedCart.ItemsInDiscountedCartFromCollections",t),0}},ItemsInDiscountedCartFromProducts:function(t,i,n){try{return discountNinja_Script_DiscountedCart.DiscountedCartItemsByDelegate((function(e){return discountNinja.Utilities.StringIsIn(t,e.Product.ProductHandle)&&(!n||!e.IsGift)&&(!i||!discountNinja_Script_DiscountedCart.ItemIsInCollection(e,i))}))}catch(t){return discountNinja.Logging.LogError("DiscountedCart.ItemsInDiscountedCartFromProducts",t),0}},ItemsInDiscountedCartFromVariants:function(t,i,n){try{return discountNinja_Script_DiscountedCart.DiscountedCartItemsByDelegate((function(e){return discountNinja.Utilities.StringIsIn(t,e.Product.VariantId)&&(!n||!e.IsGift)&&(!i||!discountNinja_Script_DiscountedCart.ItemIsInCollection(e,i))}))}catch(t){return discountNinja.Logging.LogError("DiscountedCart.ItemsInDiscountedCartFromVariants",t),0}},ItemsInDiscountedCart:function(t,i){try{return discountNinja_Script_DiscountedCart.DiscountedCartItemsByDelegate((function(n){return!(i&&n.IsGift||t&&discountNinja_Script_DiscountedCart.ItemIsInCollection(n,t))}))}catch(t){return discountNinja.Logging.LogError("DiscountedCart.ItemsInDiscountedCart",t),0}},ValueInDiscountedCartFromCollections:function(t,i,n,e){try{var o=discountNinja_Script_DiscountedCart.TotalCartLevelDiscountInCents(null,null,t,i,n,e),r=discountNinja_Script_DiscountedCart.ItemsInDiscountedCartFromCollections(t,i,n),a=discountNinja_Script_DiscountedCart.GetDiscountedLinePriceFromItems(r,e);return Math.max(0,a-o)}catch(t){return discountNinja.Logging.LogError("DiscountedCart.ValueInDiscountedCartFromCollections",t),0}},ValueInDiscountedCartFromProducts:function(t,i,n,e){try{var o=discountNinja_Script_DiscountedCart.TotalCartLevelDiscountInCents(null,t,null,i,n,e),r=discountNinja_Script_DiscountedCart.ItemsInDiscountedCartFromProducts(t,i,n),a=discountNinja_Script_DiscountedCart.GetDiscountedLinePriceFromItems(r,e);return Math.max(0,a-o)}catch(t){return discountNinja.Logging.LogError("DiscountedCart.ValueInDiscountedCartFromProducts",t),0}},ValueInDiscountedCartFromVariants:function(t,i,n,e){try{var o=discountNinja_Script_DiscountedCart.TotalCartLevelDiscountInCents(t,null,null,i,n,e),r=discountNinja_Script_DiscountedCart.ItemsInDiscountedCartFromVariants(t,i,n),a=discountNinja_Script_DiscountedCart.GetDiscountedLinePriceFromItems(r,e);return Math.max(0,a-o)}catch(t){return discountNinja.Logging.LogError("DiscountedCart.ValueInDiscountedCartFromVariants",t),0}},ValueInDiscountedCart:function(t,i,n){try{var e=discountNinja_Script_DiscountedCart.TotalCartLevelDiscountInCents(null,null,null,t,i,n),o=discountNinja_Script_DiscountedCart.ItemsInDiscountedCart(t,i),r=discountNinja_Script_DiscountedCart.GetDiscountedLinePriceFromItems(o,n);return Math.max(0,r-e)}catch(t){return discountNinja.Logging.LogError("DiscountedCart.ValueInDiscountedCart",t),0}},ApplicableCartLevelDiscounts:function(t,i,n,e,o,r){try{var a=[];if(discountNinja.DiscountedCart.DiscountedCart&&discountNinja.DiscountedCart.DiscountedCart.CartLevelDiscounts)for(var c=discountNinja.DiscountedCart.DiscountedCart.CartLevelDiscounts,u=0;u<c.length;u++){var s=c[u];if(void 0!==s.LineItems&&null!==s.LineItems&&s.LineItems.length>0){if(null==r||""===r||s.OfferToken!==r)for(var d=0;d<s.LineItems.length;d++){var l=s.LineItems[d],g=!0;if(null!=t&&(discountNinja.Utilities.StringIsIn(t,l.VariantId)||(g=!1)),null!=i&&(discountNinja.Utilities.StringIsIn(i,l.ProductHandle)||(g=!1)),null!=n&&(discountNinja.Utilities.StringIsIn(n,l.Collections)||(g=!1)),null!=e&&discountNinja.Utilities.StringIsIn(e,l.Collections)&&(g=!1),!0===o&&!0===l.IsGift&&(g=!1),g)a.find((function(t){return t.OfferToken===s.OfferToken}))||a.push(s)}}else discountNinja.Logging.LogError("DiscountedCart.ApplicableCartLevelDiscounts - Missing LineItems info")}return a}catch(t){return discountNinja.Logging.LogError("DiscountedCart.ApplicableCartLevelDiscounts",t),null}},TotalCartLevelDiscountInCents:function(t,i,n,e,o,r){try{var a=discountNinja_Script_DiscountedCart.ApplicableCartLevelDiscounts(t,i,n,e,o,r),c=0;if(null!==a&&a.length>0)for(var u=0;u<a.length;u++)c+=100*a[u].Amount;return c}catch(t){return discountNinja.Logging.LogError("DiscountedCart.TotalCartLevelDiscountInCents",t),null}},GetFirstDiscountCode:function(){try{var t=discountNinja.DiscountedCart.DiscountedCart;if(!t)return!1;if(t.Shipping&&t.Shipping.DiscountCode){if(t.Shipping.PriceRuleId||t.Shipping.PriceRuleAppId)return t.Shipping.DiscountCode;if(t.Shipping.OfferToken)if((e=discountNinja.Offer.GetOfferByToken(t.Shipping.OfferToken))&&"Shopify"===e.DiscountCodeSource)return t.Shipping.DiscountCode}if(t.CartLevelDiscounts)for(var i=0;i<t.CartLevelDiscounts.length;i++){if((n=t.CartLevelDiscounts[i]).DiscountCode){if(n.PriceRuleId||n.PriceRuleAppId)return n.DiscountCode}else if(n.OfferToken)if((e=discountNinja.Offer.GetOfferByToken(n.OfferToken))&&"Shopify"===e.DiscountCodeSource)return n.DiscountCode}if(t.items)for(i=0;i<t.items.length;i++){var n,e;if((n=t.items[i]).DiscountCode){if(n.PriceRuleId||n.PriceRuleAppId)return n.DiscountCode}else if(n.OfferToken)if((e=discountNinja.Offer.GetOfferByToken(n.OfferToken))&&"Shopify"===e.DiscountCodeSource)return n.DiscountCode}return null}catch(t){return discountNinja.Logging.LogError("DiscountedCart.GetFirstDiscountCode",t),null}},HasFreeShipping:function(){try{var t=discountNinja.DiscountedCart.DiscountedCart;return!!t&&!(!t.Shipping||!t.Shipping.OfferToken&&!t.Shipping.DiscountCode)}catch(t){return discountNinja.Logging.LogError("DiscountedCart.HasFreeShipping",t),!1}},CountAppliedPromotions:function(){try{var t=discountNinja_Script_DiscountedCart.GetAppliedPromotions();return null===t?0:t.length}catch(t){return discountNinja.Logging.LogError("DiscountedCart.CountAppliedPromotions",t),!1}},HasAppliedPromotions:function(){try{return discountNinja_Script_DiscountedCart.HasFreeShipping()||discountNinja_Script_DiscountedCart.CountAppliedPromotions()>0}catch(t){return discountNinja.Logging.LogError("DiscountedCart.HasAppliedPromotions",t),!1}},HasActivePromotions:function(){return null!==discountNinja.Offer.Offers&&null!==discountNinja.Offer.PrimaryOffer},GetAppliedPromotions:function(t){try{t=void 0===t?discountNinja.DiscountedCart.DiscountedCart:t;var i=[];if(t&&t.items&&t.items.length>0){for(var n=0;n<t.items.length;n++){var e=(o=t.items[n]).OfferToken;i.push({OfferToken:e,TriggerToken:o.TriggerToken,DiscountCode:o.DiscountCode,PriceRuleId:o.PriceRuleId,PriceRuleTitle:o.PriceRuleTitle,PriceRuleAppId:o.PriceRuleAppId,TargetType:o.TargetType})}if(t.CartLevelDiscounts)for(n=0;n<t.CartLevelDiscounts.length;n++){e=(o=t.CartLevelDiscounts[n]).OfferToken;i.push({OfferToken:e,TriggerToken:o.TriggerToken,DiscountCode:o.DiscountCode,PriceRuleId:o.PriceRuleId,PriceRuleTitle:o.PriceRuleTitle,PriceRuleAppId:o.PriceRuleAppId,TargetType:o.TargetType})}if(t.Shipping){var o;e=(o=t.Shipping).OfferToken;i.push({OfferToken:e,TriggerToken:o.TriggerToken,DiscountCode:o.DiscountCode,PriceRuleId:o.PriceRuleId,PriceRuleTitle:o.PriceRuleTitle,PriceRuleAppId:o.PriceRuleAppId,TargetType:o.TargetType})}}var r=discountNinja.Cookie.ShopifyDiscountCodeInCookieCacheKey,a=discountNinja.Cookie.GetDiscountCodeCookie();if(a){a=decodeURIComponent(a);var c=discountNinja.Cache.SessionGet(r);null!==c&&a===c||(discountNinja.Cache.SessionSet(r,a),i.push({Source:"native",OfferToken:null,TriggerToken:null,DiscountCode:a,PriceRuleId:null,PriceRuleAppId:null,PriceRuleTitle:null,TargetType:null,ShareableLink:"native"}))}var u=function(){try{var t=discountNinja.Checkout.Shopify.GetFirstVisibleCheckoutForm().find('input[name="discount"]').val();return t&&null!==t&&""!==decodeURIComponent(t).trim()?formFietrimmedFormFieldValueldValue:null}catch(t){return null}}();u&&(u=decodeURIComponent(u),i.push({Source:"native",OfferToken:null,TriggerToken:null,DiscountCode:u,PriceRuleId:null,PriceRuleTitle:null,PriceRuleAppId:null,TargetType:null,ShareableLink:"form"}));var s=discountNinja_Script_DiscountCode.GetDiscountCodeFromQueryParameter();if(s&&""!==s){s=s.split(",");for(n=0;n<s.length;n++){var d=decodeURIComponent(s[n]);i.push({Source:"native",OfferToken:null,TriggerToken:null,DiscountCode:d,PriceRuleId:null,PriceRuleTitle:null,PriceRuleAppId:null,TargetType:null,ShareableLink:"queryparameter"})}}var l=discountNinja_Script_DiscountCode.GetExternalDiscountCodesFromCache();if(l)for(var g=0;g<l.length;g++)i.push(l[g]);for(var f=[],p=0;p<i.length;p++){var N=!0;if(i[p]){if(!i[p].DiscountCode){if(!i[p].OfferToken)continue;i[p].DiscountCode=i[p].OfferToken}for(var j=0;j<f.length;j++){var C=f[j];if(f[j].PriceRuleTitle===i[p].PriceRuleTitle){void 0!==C.OfferToken&&null!==C.OfferToken||(C.OfferToken=i[p].OfferToken),void 0!==C.TriggerToken&&null!==C.TriggerToken||(C.TriggerToken=i[p].TriggerToken),void 0!==C.PriceRuleId&&null!==C.PriceRuleId||(C.PriceRuleId=i[p].PriceRuleId),void 0!==C.PriceRuleTitle&&null!==C.PriceRuleTitle||(C.PriceRuleTitle=i[p].PriceRuleTitle),void 0!==C.PriceRuleAppId&&null!==C.PriceRuleAppId||(C.PriceRuleAppId=i[p].PriceRuleAppId),void 0!==C.TargetType&&null!==C.TargetType||(C.TargetType=i[p].TargetType),N=!1;break}}N&&f.push(i[p])}}for(n=0;n<f.length;n++){if((C=f[n]).DiscountCode){var m=discountNinja.Offer.AllOffers;if(m)for(var S=0;S<m.length;S++){var h=m[S];for(g=0;g<h.Tiers.length;g++){var _=h.Tiers[g];if(_.DiscountCode.Code===C.DiscountCode&&(void 0===C.OfferToken||null===C.OfferToken||C.OfferToken===h.Token)){void 0!==C.OfferToken&&null!==C.OfferToken||(C.OfferToken=h.Token),void 0!==C.TriggerToken&&null!==C.TriggerToken||(C.TriggerToken=discountNinja.Offer.GetTriggerTokenForOffer(h.Token)),void 0!==C.PriceRuleId&&null!==C.PriceRuleId||(C.PriceRuleId=_.DiscountCode.PriceRuleId),void 0!==C.PriceRuleTitle&&null!==C.PriceRuleTitle||(C.PriceRuleTitle=_.DiscountCode.PriceRuleTitle),void 0!==C.PriceRuleAppId&&null!==C.PriceRuleAppId||(C.PriceRuleAppId=_.DiscountCode.PriceRuleAppId),void 0!==C.TargetType&&null!==C.TargetType||(C.TargetType=h.Entitlement.TargetType);break}}}}}return f=function(t){var i=[];if(t)for(var n=0;n<t.length;n++){var e=t[n];if("native"===e.ShareableLink||"queryparameter"===e.ShareableLink||"form"===e.ShareableLink){var o=!1;if(discountNinja.Offer.Offers)for(var r=0;r<discountNinja.Offer.Offers.length&&!o;r++)for(var a=discountNinja.Offer.Offers[r],c=0;c<a.Tiers.length;c++)if(a.Tiers[c].DiscountCode.Code===e.DiscountCode){o=!0;break}if(!o){var u="discountcode-lookup-"+e.DiscountCode;null===discountNinja.Cache.SessionGet(u)&&(i.push(e),discountNinja.DiscountCode.AddDiscountCodeFromLookup(e.DiscountCode,(function(){discountNinja.Cache.SessionSet(u,"1")}),!0))}}else i.push(e)}return i}(f),f}catch(t){return discountNinja.Logging.LogError("DiscountedCart.GetAppliedPromotions",t),[]}},CheckSum:function(){try{var t=discountNinja.DiscountedCart.DiscountedCart;if(!t||!t.items)return null;for(var i="",n=0;n<t.items.length;n++)i+="LI::"+(o=t.items[n]).Product.VariantId+"_"+(o.SellingPlanId||"")+"_"+(o.OfferToken||"")+"_"+o.Line.DiscountedPrice+"_"+(o.Line.QuantityDiscounted+o.Line.QuantityNotDiscounted)+"|";if(t.CartLevelDiscounts)for(n=0;n<t.CartLevelDiscounts.length;n++)i+="CLD::"+((e=t.CartLevelDiscounts[n]).OfferToken||"")+"_"+e.Amount+"|";return t.Shipping&&(i+="SH::"+t.Shipping.OfferToken+"|"),i+="TD::"+(t.total_discounted_price||"0")+"|",i+="US::"+discountNinjaContext.Status}catch(t){return discountNinja.Logging.LogError("DiscountedCart.CheckSum",t),null}var e,o}},discountNinja_Script_DiscountedProduct={CurrentVariantIsDiscounted:function(){try{var t=discountNinja_Script_DiscountedProduct.CurrentVariantData;return t?t.DiscountedPrice<t.OriginalPrice:null}catch(t){return discountNinja.Logging.LogError("CurrentVariantIsDiscounted",t),null}},CompareAtPriceMode:!0,Get:function(t,i,n,e,o,r,a,c,u,s,d){function l(t,i,n,o){try{if(null==t)return null;if(i<=0||0===c)return{DiscountedPrice:0,Amount:0,Percentage:0,Units:0};var r=t.Entitlement.Amount||0,a=t.Entitlement.Percentage||0,u={DiscountedPrice:null,Amount:r*c>e*c?e*c:r*c,Percentage:Math.min(a,100),Units:t.Entitlement.Units},l=1;if(g&&void 0!==s&&void 0!==d&&(l=s/(s+d)),"fixed_amount"===p)u.DiscountedPrice=o?i:discountNinja.Utilities.RoundToNumberOfDigits((i-u.Amount)*l,2),n!==i&&(u.Amount=discountNinja.Utilities.RoundToNumberOfDigits(n-u.DiscountedPrice,2)),u.Percentage=Math.min(0===n?0:Math.abs(u.Amount/n*100),100);else if("percentage"===p){var f=o?n:i,N=-1;if("unit"===S){var j=f/c*u.Percentage/100*l,h=discountNinja.Utilities.FloorToNumberOfDigits(j*c,2);u.DiscountedPrice=o?f:discountNinja.Utilities.RoundToNumberOfDigits(f-h,2)}else{j=f*u.Percentage/100*l,r=discountNinja.Utilities.FloorToNumberOfDigits(j,2);N=j,u.AmountRaw=j,u.DiscountedPrice=o?f:discountNinja.Utilities.RoundToNumberOfDigits(f-r,2)}u.Amount=Math.max(discountNinja.Utilities.RoundToNumberOfDigits(n-u.DiscountedPrice,2),0),-1===N&&(N=u.Amount),o||n===i||(u.Percentage=Math.min(0===n?0:Math.abs(N/n*100),100))}else if("fixed_price"===p){var _=u.Amount/u.Units;u.DiscountedPrice=o?i:Math.min(i,discountNinja.Utilities.RoundToNumberOfDigits(_*l,2)),u.Percentage=Math.min(0===i?0:Math.abs((i-u.DiscountedPrice)/i*100),100)}if(u.DiscountedPrice<0&&(u.DiscountedPrice=0),C){var y=100*u.DiscountedPrice;y>0&&(y=100*Math.floor(y/100)+m),u.DiscountedPrice=Math.round(y)/100}return u}catch(t){return discountNinja.Logging.LogError("DiscountedProduct.GetInfoForTier",t),null}}try{var g=!1;c||(c=1,g=!0);var f=null!=u?a.Tiers[u]:discountNinja.DiscountTier.GetCurrentDiscountTier(a),p=a.Entitlement.ValueType,N=!0===discountNinja.Settings.Settings.PriceUpdate.CompareAtPriceMode,j=discountNinja.Settings.Settings.Currency,C=j.RoundPrices,m=j.RoundToCents,S=function(){var t=discountNinja.Settings.Settings.General.PercentageCalculationMode;return void 0===t?discountNinja.Settings.GetFlag("PercentageCalculationMode"):t}(),h={Key:t,VariantId:i,ProductHandle:n,OriginalPrice:e*c/100,OriginalCompareAtPrice:o*c/100,InventoryLeft:r,OfferToken:a.Token,TriggerToken:discountNinja.Offer.GetTriggerTokenForOffer(a.Token),DiscountCode:f?f.DiscountCode.Code:null};(void 0===h.OriginalCompareAtPrice||null===h.OriginalCompareAtPrice||0===h.OriginalCompareAtPrice||isNaN(h.OriginalCompareAtPrice)||h.OriginalCompareAtPrice<h.OriginalPrice)&&(h.OriginalCompareAtPrice=h.OriginalPrice);var _=a.DiscountedInCatalog||!1;h.EffectiveCompareAtPrice=!0===N||_?h.OriginalCompareAtPrice:h.OriginalPrice;var y=h.OriginalPrice,v=h.EffectiveCompareAtPrice;return h.CurrentTier=null===f?null:l(f,y,v,_),h.Tier1=l(a.Tiers[0],y,v,_),h.Tier2=l(a.Tiers[1],y,v,_),h.Tier3=l(a.Tiers[2],y,v,_),h.Tier4=l(a.Tiers[3],y,v,_),h.Tier5=l(a.Tiers[4],y,v,_),_&&(h.OriginalPrice=h.OriginalCompareAtPrice),h.Amount=h.CurrentTier?h.CurrentTier.Amount:0,h.Percentage=h.CurrentTier?h.CurrentTier.Percentage:0,h.DiscountedPrice=h.CurrentTier?h.CurrentTier.DiscountedPrice:0,h.Units=h.CurrentTier?h.CurrentTier.Units:0,h}catch(t){return discountNinja.Logging.LogError("DiscountedProduct.Get",t),null}},GetFromProductPage:function(){try{if(discountNinja.Environment.Shopify.IsProductPage()){var t=discountNinja.Environment.Shopify.ProductHandle(),i=discountNinja.Environment.Shopify.VariantData(),n=i?i.Id:null,e=discountNinja.LiquidData.Price(n);if(null===e)return null;var o=discountNinja.LiquidData.CompareAtPrice(n),r=discountNinja.LiquidData.Inventory(n),a=discountNinja.Offer.GetOfferForProduct(t,n,null,r,e,o,!0,!0);return a?discountNinja_Script_DiscountedProduct.Get(null,n,t,e,o,r,a):null}return null}catch(t){discountNinja.Logging.LogError("DiscountedProduct.GetFromProductPage",t)}}},discountNinja_Script_DiscountTier={ExceedsUpperLimits:function(t,i,n){if(!i)return!1;var e=i.Prerequisite;if(e.MaximumItems>0){var o=discountNinja.Prerequisite.EntitledQuantityInfo(t,i).Prerequisite.Total;if(null!==o&&o>e.MaximumItems)return!0}return!!(e.MaximumAmount&&n>100*e.MaximumAmount)},GetCurrentDiscountTierNumber:function(t,i,n,e){function o(t,i,n,e){try{if(!i||!t)return!1;if(!discountNinja.Offer.IsOfferAccepted(t.Token,t.Frequency))return!1;var o=i.Prerequisite;if(discountNinja_Script_DiscountTier.ExceedsUpperLimits(t,i,n))return!1;if(o.MinimumAmount&&n<100*o.MinimumAmount)return!1;var r=null;return o.MinimumItems>0&&(r=discountNinja.Prerequisite.EntitledQuantityInfo(t,i,e).Prerequisite.Total),!(o.MinimumItems>0&&(null===r||r<o.MinimumItems))}catch(t){return discountNinja.Logging.LogError("DiscountTier.DiscountTierIsApplicable",t),!1}}try{if(!discountNinja.Offer.OfferIsApplicable(t))return null;if(t.AppliedTier&&!0!==n)return t.AppliedTier;for(var r="buyx_gety"===t.OfferType&&"bogo_xsell"!==t.Template,a=t.Tiers.length;a>=0;a--)if(o(t,t.Tiers[a-1],i,r&&e))return a;return i>0?0:-1}catch(t){return discountNinja.Logging.LogError("DiscountTier.GetCurrentDiscountTierNumber",t),-1}},GetMaxDiscountTierNumber:function(t){try{return"object"==typeof t.Tiers[4]?5:"object"==typeof t.Tiers[3]?4:"object"==typeof t.Tiers[2]?3:"object"==typeof t.Tiers[1]?2:1}catch(t){return discountNinja.Logging.LogError("DiscountTier.GetMaxDiscountTierNumber",t),1}},GetCurrentDiscountTier:function(t,i,n,e){try{if(t.AppliedTier&&!0!==i&&t.Tiers)return t.Tiers[t.AppliedTier-1];var o=discountNinja.Offer.PrerequisiteItemsCartValue(t),r=discountNinja_Script_DiscountTier.GetCurrentDiscountTierNumber(t,o,i,n);if(null===r||-1===r)return null;if(0===r){if(!0!==e)return null;r=1}"object"==typeof t.Bogo&&(r=1);var a=discountNinja_Script_DiscountTier.GetMaxDiscountTierNumber(t),c=t.Tiers[r-1];return c.IsMaxTier=a===r,c.Level=r,c}catch(t){return discountNinja.Logging.LogError("DiscountTier.GetCurrentDiscountTier",t),null}},GetGoalDiscountTierNumber:function(t){try{var i=discountNinja.Offer.PrerequisiteItemsCartValue(t);if("object"==typeof t.Bogo)return Math.max(0,discountNinja.Set.ForTier(t,t.Tiers[0]).Completed)+1;var n=discountNinja_Script_DiscountTier.GetCurrentDiscountTierNumber(t,i);if(null===n)return null;for(var e=discountNinja_Script_DiscountTier.GetMaxDiscountTierNumber(t),o=5;o>=0;o--)if(n===o)return e<=o?o:o+1;return 1}catch(t){return discountNinja.Logging.LogError("DiscountTier.GetGoalDiscountTier",t),null}},GetGoalDiscountTier:function(t){try{var i=discountNinja_Script_DiscountTier.GetGoalDiscountTierNumber(t);if(null===i||-1===i)return null;var n=t.Tiers[i-1];return"object"==typeof n?n:t.Tiers[0]}catch(t){return discountNinja.Logging.LogError("DiscountTier.GetGoalDiscountTier",t),null}},GetPercentageAmountFromDiscountTier:function(t){try{return t?{Percentage:t.Entitlement.Percentage,Amount:t.Entitlement.Amount,FixedPrice:t.Entitlement.Amount,Units:t.Entitlement.Units}:null}catch(t){discountNinja.Logging.LogError("DiscountTier.GetPercentageAmountFromDiscountTier",t)}},GoalAchieved:function(t){try{var i=discountNinja.Offer.PrerequisiteItemsCartValue(t),n=discountNinja_Script_DiscountTier.GetCurrentDiscountTierNumber(t,i);return null!==n&&n>0}catch(t){return discountNinja.Logging.LogError("DiscountTier.GoalAchieved",t),!1}}},discountNinja_Script_DynamicPricing_Classes_Prefix="limoniapps-discountninja-",discountNinja_Script_DynamicPricing_Classes_ProductPrice_Prefix=discountNinja_Script_DynamicPricing_Classes_Prefix+"productprice",discountNinja_Script_DynamicPricing_Classes_ProductBanner_Prefix=discountNinja_Script_DynamicPricing_Classes_Prefix+"promotioncard-productpage",discountNinja_Script_DynamicPricing_Attributes_Prefix="data-limoniapps-discountninja-",discountNinja_Script_DynamicPricing={Classes:{Prefix:discountNinja_Script_DynamicPricing_Classes_Prefix,ProductPrice:{OriginalPrice:discountNinja_Script_DynamicPricing_Classes_ProductPrice_Prefix+"-original",ReplacedPrice:discountNinja_Script_DynamicPricing_Classes_ProductPrice_Prefix+"-replaced",ShowAfterReplace:discountNinja_Script_DynamicPricing_Classes_ProductPrice_Prefix+"-showafterreplace",HideAfterReplace:discountNinja_Script_DynamicPricing_Classes_ProductPrice_Prefix+"-hideafterreplace",Wrapper:discountNinja_Script_DynamicPricing_Classes_ProductPrice_Prefix+"-wrapper",Injected:discountNinja_Script_DynamicPricing_Classes_ProductPrice_Prefix+"-injected"},ProductBanner:{Injected:discountNinja_Script_DynamicPricing_Classes_ProductBanner_Prefix+"-injected",Prerequisite:discountNinja_Script_DynamicPricing_Classes_ProductBanner_Prefix+"-prerequisite",Wrapper:discountNinja_Script_DynamicPricing_Classes_ProductBanner_Prefix+"-wrapper"},Cart:{PriceForLevel:discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-[LEVEL]-price",CommentForLevel:discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-[LEVEL]-comment",CommentForProduct:discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-item-product-comment",Root:discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-root",DrawerCartRoot:discountNinja_Script_DynamicPricing_Classes_Prefix+"drawercart-root",ProductPrice:discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-item-product-price",LinePrice:discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-item-line-price",Quantity:discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-item-quantity",Subtotal:discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-subtotal",SubtotalPrice:discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-subtotal-price",SubtotalPriceInjected:discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-subtotal-price-injected",SubtotalInjected:discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-subtotal-injected"},Collection:{FeaturedProduct:discountNinja_Script_DynamicPricing_Classes_Prefix+"featuredproduct"},ProductPrice_Legacy:"limoniapps-discounturl-productprice",Blocking:{BlockLookupCode:discountNinja_Script_DynamicPricing_Classes_Prefix+"block-lookupcode",Block:discountNinja_Script_DynamicPricing_Classes_Prefix+"block",BlockStop:discountNinja_Script_DynamicPricing_Classes_Prefix+"block-stop"}},Attributes:{DiscountNinja:{Token:"data-token",Ignore:discountNinja_Script_DynamicPricing_Attributes_Prefix+"dynamicpricing-ignore",IgnoreSystem:discountNinja_Script_DynamicPricing_Attributes_Prefix+"dynamicpricing-ignore-system",CartLineItemKey:"data-limoniapps-discountninja-cart-key",QuantitySpinnerHide:"limoniapps-discountninja-cart-item-quantity-hide",QuantitySpinnerDisable:"limoniapps-discountninja-cart-item-quantity-disable"}},ProductDiscountedEventsPublished:[],ReplacingPricesInCart:!1,DrawerCartReplacingPricesInCart:[],ProductPriceSelector:function(){return"."+discountNinja_Script_DynamicPricing_Classes_ProductPrice_Prefix+",."+discountNinja_Script_DynamicPricing.Classes.ProductPrice_Legacy},BuildFormattedDiscountedPrice:function(t,i,n,e,o){if(o)return discountNinja.GiftWithPurchase.FreeLabel();var r=t.Format,a=discountNinja.ShortCode.ReplaceAllPlaceHolders(i,r,n);if(t.Animation){var c=t.AnimationIterations>0?' style="animation-iteration-count: '+t.AnimationIterations+' !important;"':"";a='<div class="'+t.Animation+'"'+c+">"+a+"</div>"}e&&n.PriceVaries&&(a='<div class="limoniapps-discountninja-product-label limoniapps-discountninja-label-from">'+window.discountNinjaContext.Labels.From+"</div>"+a);var u="";t.PrefixText&&(u='<div class="limoniapps-discountninja-presuffix prefix '+t.PrefixStyle+'">'+discountNinja.ShortCode.ReplaceAllPlaceHolders(i,t.PrefixText,n)+"</div>");var s="";t.SuffixText&&(s='<div class="limoniapps-discountninja-presuffix suffix '+t.SuffixStyle+'">'+discountNinja.ShortCode.ReplaceAllPlaceHolders(i,t.SuffixText,n)+"</div>");var d="limoniapps-discountninja-discountedprice";!0===t.CustomFormat&&(d=d+" "+d+"-customformat");var l=" limoniapps-layout-"+(t.Layout||"row"),g=" limoniapps-align-"+(t.Alignment||"right");!0===t.CustomFormat&&(d=d+" "+d+"-customformat");var f='<div class="'+d+l+g+'" dir="ltr">'+u+a+s+"</div>",p=discountNinja.Settings.Settings.Currency;return discountNinja_Script_ShortCode.ContainsPlaceHolder(f,"{{CURRENCY}}")&&(f=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(i,null,f,!0,"{{CURRENCY}}","offer","currency",p.BaseCurrency)),discountNinja_Script_ShortCode.ContainsPlaceHolder(f,"{{CURRENCY_SYMBOL}}")&&(f=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(i,null,f,!0,"{{CURRENCY_SYMBOL}}","offer","currency_symbol",p.BaseCurrencySymbol)),f},BuildFormattedPrice:function(t,i,n,e,o,r,a,c,u,s,d){var l=null,g=n?n.Token:"";i=i||{Format:"{{DISCOUNTED_PRICE}} {{ORIGINAL_PRICE,STRIKETHROUGH}}"};var f=discountNinja_Script_DynamicPricing.Classes.ProductPrice.OriginalPrice,p=discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.Token,N=!!discountNinja.Settings.Settings.StructuredData&&discountNinja.Settings.Settings.StructuredData.Microdata,j='<div class="'+f+'" '+p+'="'+g+'" style="display:none;">'+(N?t.replace(/itemprop/,"itemprop-removedbydiscountninja"):t)+"</div>";l=r?'<div class="limoniapps-discountninja-product-label limoniapps-discountninja-label-soldout">'+window.discountNinjaContext.Labels.SoldOut+"</div>":s?discountNinja.GiftWithPurchase.FreeLabel():discountNinja_Script_DynamicPricing.BuildFormattedDiscountedPrice(i,n,e,o);var C=discountNinja_Script_DynamicPricing.Classes.ProductPrice.ReplacedPrice,m=u?"":' style="display:none;"',S=N&&!0!==d?'itemprop="offers" itemscope itemtype="http://schema.org/Offer" ':"",h=N&&!0!==d?'<meta itemprop="priceCurrency" content="'+discountNinja.Settings.Settings.Currency.BaseCurrency+'">':"",_=e?e.DiscountedPrice:"",y="<div "+S+'class="'+C+" limoniapps-discountninja-"+c+'page" data-token="'+g+'"'+m+">"+(N?'<meta itemprop="price" content="'+_+'">':"")+h+(N&&!0!==d?'<meta itemprop="availability" content="http://schema.org/'+(r?"OutOf":"In")+'Stock">':"")+l+"</div>",v=discountNinja.Settings.Settings.Currency;return discountNinja_Script_ShortCode.ContainsPlaceHolder(y,"{{CURRENCY}}")&&(y=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(n,null,y,!0,"{{CURRENCY}}","offer","currency",v.BaseCurrency)),discountNinja_Script_ShortCode.ContainsPlaceHolder(y,"{{CURRENCY_SYMBOL}}")&&(y=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(n,null,y,!0,"{{CURRENCY_SYMBOL}}","offer","currency_symbol",v.BaseCurrencySymbol)),y+j},InjectPlaceHolder:{Inject:function(t,i,n,e,o){var r=discountNinja_Script_DynamicPricing.InjectPlaceHolder,a=discountNinja.Utilities.jQuery();function c(t){return!(a(t).parents("."+discountNinja_Script_DynamicPricing.Classes.ProductPrice.OriginalPrice).length>0)&&!(a(t).parents(".limoniapps-discountninja-buildingblock-injected").length>0)}function u(t,i){return 0===t.indexOf(i)?{Text:t.substring(i.length),KeywordFound:!0}:{Text:t,KeywordFound:!1}}var s=r;if(null!=t)if("underproducttitle"===t)s.UnderProductTitle(r,a,i);else if("aboveatcform"===t)s.AboveATCForm(r,a,i);else if("underatcform"===t)s.UnderATCForm(r,a,i);else if("aboveatcbutton"===t)s.AboveATCButton(r,a,i);else if("underatcbutton"===t)s.UnderATCButton(r,a,i);else if("abovecheckoutbutton"===t)s.AboveCheckoutButton(r,a,i,o);else if("undercheckoutbutton"===t)s.UnderCheckoutButton(r,a,i,o);else if("abovecheckoutform"===t)s.AboveCheckoutForm(r,a,i,o);else if("undercheckoutform"===t)s.UnderCheckoutForm(r,a,i,o);else{var d,l,g,f,p,N,j,C,m,S,h,_,y,v,P,T,L,D=t,E=u(D,"[[REPLACECONTENT]]");d=E.KeywordFound,g=(E=u(E.Text,"[[WRAP]]")).KeywordFound,l=(E=u(E.Text,"[[REPLACE]]")).KeywordFound,f=(E=u(E.Text,"[[BEFORE]]")).KeywordFound,p=(E=u(E.Text,"[[AFTER]]")).KeywordFound,T=(E=u(E.Text,"[[APPEND]]")).KeywordFound,L=(E=u(E.Text,"[[PREPEND]]")).KeywordFound,N=(E=u(E.Text,"[[HIDE]]")).KeywordFound,j=(E=u(E.Text,"[[LEFT]]")).KeywordFound,C=(E=u(E.Text,"[[CENTER]]")).KeywordFound,m=(E=u(E.Text,"[[RIGHT]]")).KeywordFound,S=(E=u(E.Text,"[[LEFT_MOBILE]]")).KeywordFound,h=(E=u(E.Text,"[[CENTER_MOBILE]]")).KeywordFound,_=(E=u(E.Text,"[[RIGHT_MOBILE]]")).KeywordFound,y=(E=u(E.Text,"[[LEFT_DESKTOP]]")).KeywordFound,v=(E=u(E.Text,"[[CENTER_DESKTOP]]")).KeywordFound,P=(E=u(E.Text,"[[RIGHT_DESKTOP]]")).KeywordFound,D=E.Text;var I=n?a(n).find(D):a(D);if(e&&(I=I.first()),I.length>0){var O=discountNinja.Utilities.IsMobilePhone();if(d||l||f||p||g||T||L){var A="limoniapps-discountninja-align-",k=null;(j||S&&O||y&&!O)&&(k=A+"left"),(C||h&&O||v&&!O)&&(k=A+"center"),(m||_&&O||P&&!O)&&(k=A+"right"),k&&(i=a(i).addClass(k))}discountNinja_Script_DynamicPricing.Classes.ProductPrice.OriginalPrice;g?I.each((function(){c(this)&&a(this).wrap(i)})):d?I.each((function(){c(this)&&a(this).html(i)})):l?I.each((function(){c(this)&&a(this).replaceWith(i)})):f?I.each((function(){c(this)&&a(this).before(i)})):p?I.each((function(){c(this)&&a(this).after(i)})):T?I.each((function(){c(this)&&a(this).append(i)})):L&&I.each((function(){c(this)&&a(this).prepend(i)})),N&&I.each((function(){c(this)&&a(this).addClass("limoniapps-discountninja-whenpromotionsincart-hide")}))}}},InjectElement:function(t,i,n){i?t.after(n):t.before(n)},AboveATCForm:function(t,i,n){var e=i(discountNinja.Environment.Shopify.SelectorAddToCartForm()).first();t.InjectElement(e,!1,n)},UnderATCForm:function(t,i,n){var e=i(discountNinja.Environment.Shopify.SelectorAddToCartForm()).first();t.InjectElement(e,!0,n)},UnderProductTitle:function(t,i,n){var e=i("h1").first();0===e.length?t.AboveATCForm(n):t.InjectElement(e,!0,n)},UnderATCButton:function(t,i,n){var e=i(".limoniapps-discountninja-addtocartbutton, "+discountNinja.Environment.Shopify.SelectorAddToCartForm()+" "+discountNinja.Environment.Shopify.SelectorAddToCartButton()).first();0===e.length?t.UnderATCForm(n):t.InjectElement(e,!0,n)},AboveATCButton:function(t,i,n){var e=i(".limoniapps-discountninja-addtocartbutton, "+discountNinja.Environment.Shopify.SelectorAddToCartForm()+" "+discountNinja.Environment.Shopify.SelectorAddToCartButton()).first();0===e.length?t.UnderATCForm(n):t.InjectElement(e,!1,n)},UnderCheckoutForm:function(t,i,n,e){t.InjectElement(t.GetCheckoutForm(t,i,e),!0,n)},AboveCheckoutForm:function(t,i,n,e){t.InjectElement(t.GetCheckoutForm(t,i,e),!1,n)},UnderCheckoutButton:function(t,i,n,e){var o=t.GetCheckoutButton(t,i,e);0===o.length?t.UnderATCForm(n):t.InjectElement(o,!0,n)},AboveCheckoutButton:function(t,i,n,e){var o=t.GetCheckoutButton(t,i,e);0===o.length?t.UnderATCForm(n):t.InjectElement(o,!1,n)},GetCheckoutForm:function(t,i,n){return discountNinja.Checkout.Shopify.GetFirstVisibleCheckoutForm(n)},GetCheckoutButton:function(t,i,n){var e=discountNinja.Checkout.Shopify.GetFirstVisibleCheckoutForm(n),o=i(e).find(".limoniapps-discountninja-checkoutbutton").first();return 0===o.length&&(o=i(e).find(discountNinja.Environment.Shopify.SelectorCheckoutButton()).first()),o}},OnCollectionPageProductsAdded:function(){discountNinja_Script_DynamicPricing.UpdatePrice(!0,!1,!0,!1,!1)},OnSearchPageProductsAdded:function(){discountNinja_Script_DynamicPricing.UpdatePrice(!0,!1,!0,!1,!0)},OnQuickViewProductDisplayed:function(){discountNinja_Script_DynamicPricing.UpdatePrice(!0,!0,!0,!1,!1)},ReplaceInstallmentsPrices:function(t,i){function n(i){try{var n="DISCOUNTED_INSTALLMENT_"+i+"PERIODS";if(t||discountNinja.Environment.Shopify.IsProductPage()){if(t||(t=discountNinjaContext.CurrentProductInfo),!t)return;return discountNinja.ShortCode.ReplaceAllPlaceHolders(null,"{{"+n+"}}",t)}return discountNinja.ShortCode.ReplaceAllPlaceHolders(null,"{{"+n+"_SUBTOTAL}}",null)}catch(t){return discountNinja.Logging.LogError("DynamicPricing.GetInstallmentHtml",t),!1}}function e(){try{var t=discountNinja.Utilities.jQuery()("shopify-payment-terms");if(t&&t.length>0){var i=/installments of (.*) with/;t.each((function(t,e){try{var o=e.shadowRoot;if(o){var r=o.getElementById("shopify-installments-content"),a=r.innerHTML.match(i);if(null!==a&&a.length>1){var c=a[1];r.innerHTML=r.innerHTML.replace(c,n(4))}}}catch(t){discountNinja.Logging.LogError("DynamicPricing.ReplaceInstallmentsPrices.ShopPay",t)}}))}var e=discountNinja.Utilities.jQuery()("shopify-installments-modal");if(e&&e.length>0)try{var o=discountNinja.Utilities.jQuery()("shopify-installments-modal")[0].shadowRoot;if(o){var r=o.querySelectorAll(".price")[0];if(-1===r.innerHTML.indexOf("limoniapps")){var a=r.innerHTML.match(/([^<]*)/);if(null!==a&&a.length>1){var c=a[1];r.innerHTML=r.innerHTML.replace(c,n(4))}}}}catch(t){discountNinja.Logging.LogError("DynamicPricing.ReplaceInstallmentsPrices.ShopPay.Popup",t)}try{discountNinja.Utilities.jQuery()("shopify-installments-modal").find(".tagline__bold").html(n(4))}catch(t){discountNinja.Logging.LogError("DynamicPricing.ReplaceInstallmentsPrices.ShopPay.Popup",t)}}catch(t){return discountNinja.Logging.LogError("DynamicPricing.ReplaceInstallmentsPrices",t),!1}}try{var o=discountNinja.Settings.GetFlag("Selector4Installments"),r='quadpay-widget [slot="qpDisplayAmount"], .afterpay-instalments,.afterpay_instalments,#afterpay-instalments,#afterpay_instalments,.sezzle-payment-amount';o&&(r=r+","+o);var a=i?discountNinja.Utilities.jQuery(i).find(r):discountNinja.Utilities.jQuery()(r);a&&a.length>0&&discountNinja.Utilities.jQuery()(a).html(n(4));var c=discountNinja.Settings.GetFlag("Selector3Installments"),u=".hoolah_product_widget .bold, .hoolah_collection_widget .bold";c&&(u=u+","+c);var s=i?discountNinja.Utilities.jQuery(i).find(u):discountNinja.Utilities.jQuery()(u);s&&s.length>0&&discountNinja.Utilities.jQuery()(s).html(n(3));var d=discountNinja.Utilities.jQuery()("shopify-payment-terms");d&&d.length>0&&(e(),setTimeout((function(){e()}),500),setTimeout((function(){e()}),1e3))}catch(t){return discountNinja.Logging.LogError("DynamicPricing.ReplaceInstallmentsPrices",t),!1}},UpdatePrice:function(t,i,n,e,o){function r(t){var i=discountNinja.Settings.Settings.PriceUpdate.Mode,e=discountNinja.Utilities.IsMobilePhone(),o=t?e&&i.ProductPriceMobile||i.ProductPrice:e&&i.CollectionProductPriceMobile||i.CollectionProductPrice,r=discountNinja_Script_DynamicPricing.InjectPlaceHolder,a=discountNinja_Script_DynamicPricing.Classes.ProductPrice.Injected+(t?"-product":"-collectionproduct");if(o&&"custom"!==o&&"none"!==o&&(n||!(discountNinja.Utilities.jQuery()("."+a).length>0))){var c='<div class="'+discountNinja_Script_DynamicPricing_Classes_ProductPrice_Prefix+" limoniapps-discountninja-buildingblock-injected "+a+'"></div>';r.Inject(o,c,null,t)}}function a(i,c){try{if(isNaN(c)&&(c=1),c>10)return!0;var u=!1;if(discountNinja_Script_DynamicPricing.IsDynamicPricingRequired(i,!1,o)){discountNinja.Utilities.jQuery()(".rc_price__onetime").addClass(discountNinja_Script_DynamicPricing_Classes_ProductPrice_Prefix),discountNinja.Environment.Shopify.IsProductPage()?(r(!0),r(!1)):discountNinja.Environment.Shopify.IsHomePage()?(!function(){var t=discountNinja.Settings.Settings.PriceUpdate.Mode,i=t.FeaturedProductPrice,e=discountNinja_Script_DynamicPricing.InjectPlaceHolder,o=discountNinja_Script_DynamicPricing.Classes.ProductPrice.Injected+"-featuredproduct";if(i&&"custom"!==i&&"none"!==i&&(n||!(discountNinja.Utilities.jQuery()("."+o).length>0))){var r=t.FeaturedProductCard,a=t.FeaturedProductHandle;if(null!==r&&""!==r&&null!==a&&""!==a){var c=i.replace(/\[\[.*\]\]/g,"");discountNinja.Utilities.jQuery()(c).each((function(){var t=discountNinja.Utilities.GetHandleFromSelector(this,r,a);if(t){var n='<div data-limoniapps-discountninja-product-handle="'+t+'" class="'+discountNinja_Script_DynamicPricing_Classes_ProductPrice_Prefix+" "+discountNinja_Script_DynamicPricing.Classes.Collection.FeaturedProduct+" "+o+'"></div>';e.Inject(i,n,null,!0)}}))}}}(),r(!1)):r(!1);var s=discountNinja_Script_DynamicPricing.ProductPriceSelector(),l=discountNinja.Utilities.jQuery()(s+":not(["+discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.Ignore+"])");l.length>0&&(u=!0,l.each((function(t,i){d(i,1)})))}t||discountNinja_Script_DynamicPricing.ReplacePricesInCart(e),discountNinja_Script_DynamicPricing.Show();var g=discountNinja.Settings.GetFlag("ProductsAreLoadedAsynchronously");return!(!u&&g)||(c+=1,setTimeout((function(){a(i,c)}),100))}catch(t){discountNinja.Logging.LogError("DynamicPricing.UpdatePriceInternal",t)}}function c(t,i,n,e,o){var r=!!n&&!discountNinja_Script_ProductData.ProductIsAvailable(n),a=discountNinja.Settings.GetFlag("HideCollectionBadgeForSoldOutProducts"),c=e.CollectionProductBadge||"custom";if((!r||!1===a)&&"none"!==c){if("custom"!==c)t=discountNinja.Utilities.jQuery()(t).find(c);else{var u=discountNinja.Utilities.jQuery()(t).find(".limoniapps-discountninja-collectionbadge");u&&1===u.length&&(t=u)}t&&!discountNinja.Utilities.jQuery()(t).hasClass("limoniapps-discountninja-collectionbadge-ignore")&&discountNinja.Badge.Add(i,n,t,o)}}function u(){return function(t){var i=discountNinja.Settings.Settings.PriceUpdate.Mode,n=(t?i.ProductBanner:i.FeaturedProductBanner)||"custom",e=discountNinja_Script_DynamicPricing.InjectPlaceHolder,o=discountNinja_Script_DynamicPricing.Classes.ProductBanner.Injected,r=discountNinja_Script_DynamicPricing.Classes.ProductBanner.Wrapper,a=discountNinja_Script_DynamicPricing_Classes_ProductBanner_Prefix,c=r;if(n&&"none"!==n){if("appblock"===n&&discountNinja.Utilities.jQuery()("."+c+'[data-source="appblock"]').length>0)return void discountNinja.Utilities.jQuery()("."+c).not('[data-source="appblock"]').removeClass(c).addClass(c+"-disabled");if("custom"!==n){if(!(discountNinja.Utilities.jQuery()("."+o).length>0)){discountNinja.Utilities.jQuery()("."+c).not("."+o).removeClass(c).addClass(c+"-disabled");var u='<div class="'+r+" limoniapps-discountninja-buildingblock-injected "+o+'"></div>';e.Inject(n,u,null,!0)}}else{var s=discountNinja.Utilities.jQuery()("."+a).not("."+o);discountNinja.Utilities.jQuery()(s).each((function(){var t=discountNinja.Utilities.jQuery()(this);0===t.parent("."+r).length&&t.removeClass(a).addClass(r)}))}}}(discountNinja.Environment.Shopify.IsProductPage()),discountNinja.Utilities.jQuery()("."+discountNinja_Script_DynamicPricing.Classes.ProductBanner.Wrapper)}function s(t,i,n){if(t.PromotionCard){var e=u();e&&discountNinja.Utilities.jQuery()(e).each((function(){n&&discountNinja.Utilities.jQuery()(this).addClass(discountNinja_Script_DynamicPricing.Classes.ProductBanner.Prerequisite);var e=n?t.PromotionCard.PrerequisiteProductPageTextColor:t.PromotionCard.ProductPageTextColor,o=n?t.PromotionCard.PrerequisiteProductPageText:t.PromotionCard.ProductPageText,r=discountNinja.TextSettings.GetText(o,t),a=discountNinja.TextSettings.WrapInColor(e,discountNinja.ShortCode.ReplaceAllPlaceHolders(t,r,i));if(a=discountNinja.ShortCode.ReplaceAllPlaceHolders(t,a,i,"item-line"),!discountNinja.TextSettings.IsEmpty(a)){var c='<div class="'+discountNinja_Script_DynamicPricing_Classes_ProductBanner_Prefix+'" data-token="'+t.Token+'">'+a+"</div>";discountNinja.Utilities.jQuery()(this).append(c),discountNinja_Script_Timer.Update()}}))}}function d(t,i){try{var n=0,e=0,o=discountNinja.Settings.Settings.PriceUpdate.Mode,r=discountNinja.Utilities.jQuery()(t),a=discountNinja.Environment.Shopify.IsProductPage(),l=discountNinja.Environment.Shopify.ProductHandle(),g=discountNinja.Environment.Shopify.IsHomePage()&&r.hasClass(discountNinja_Script_DynamicPricing.Classes.Collection.FeaturedProduct),f=o.CollectionProductCard||"custom",p=f&&"custom"!==f&&"none"!==f?","+f:"",N="";if(g){var j=o.FeaturedProductCard||"custom";N=j&&"custom"!==j&&"none"!==j?","+j:""}var C=r.closest(".limoniapps-discountninja-productprice-injected-collectionproduct").length>0,m=r.closest("[data-limoniapps-discountninja-product-handle],[data-limoniapps-discounturl-product-handle]"+p+N);discountNinja.Utilities.jQuery()(m).removeClass("limoniapps-discountninja-hidethirdpartybadges");var S=!1,h=null,_=null,y=!1,v=0,P=null,T=null===m?null:m[0],L=T,D=!!T&&null!==T.getAttribute("data-limoniapps-discountninja-product-quickview");if(null===m||1!==m.length||a&&D){if(C)return!1;if(!a)return 5===i||setTimeout((function(){d(t,i+1)}),500*i),!1;_=discountNinja.LiquidData.ProductCollections(),S=!0;var E="data-limoniapps-discountninja-product-variant",I=r.closest("["+E+"]").attr(E),O=discountNinja.Environment.Shopify.ProductHandle();if(!(P=(w=I?discountNinja.ProductData.GetVariantData(O,I):discountNinja.Environment.Shopify.VariantData())?w.Id||w.VariantId:null))return 5===i||setTimeout((function(){discountNinja.ProductData.GetByProductHandle(O,!0,!1,null,!1,0,!0,!0).then((function(){d(t,i+1)}))}),500*i),!1;if(null===(n=w.Price?w.Price/100:null))return;e=w.CompareAtPrice?w.CompareAtPrice/100:null,h=null,"false"!==w.Available&&!1!==w.Available||(h=0)}else{if(null===(l=discountNinja.ProductData.GetDataFromCollectionAttribute(T,"Handle",null,g)))return D||discountNinja.Logging.LogWarning("Could not find product handle of collection product",!0,!1),5===i||setTimeout((function(){d(t,i+1)}),500*i),!1;discountNinja.ProductData.SaveProductDataUsingDataTags(T);var A=discountNinja.ProductData.GetByProductHandle(l,!1);if(!A)return 5===i||setTimeout((function(){d(t,i+1)}),500*i),!1;n=A.Price,e=A.CompareAtPrice,h=A.Inventory,_=A.Collections,n/=100,e/=100;var k=discountNinja.ProductData.GetDataFromCollectionAttribute(T,"Available",l);"false"!==k&&!1!==k||(h=0);var b=discountNinja.ProductData.GetDataFromCollectionAttribute(T,"PriceVaries",l);if("true"===b||!0===b)discountNinja.Settings.Settings.Label.UseFromLabelCollectionPage&&(v=discountNinja.ProductData.GetDataFromCollectionAttribute(T,"PriceMin",l),y=!0,n=v/100);var R=discountNinja.ProductData.GetDataFromCollectionAttribute(T,"Variant",l);R&&(P=R,n=discountNinja.ProductData.GetDataFromCollectionAttribute(T,"Price",l)/100,e=discountNinja.ProductData.GetDataFromCollectionAttribute(T,"CompareAtPrice",l)/100)}var U=a&&S||g||D;if(!a&&D){var w;E="data-limoniapps-discountninja-product-variant";if(I=r.closest("["+E+"]").attr(E))null===(w=discountNinja.ProductData.GetVariantData(l,I))?discountNinja.ProductData.GetByProductHandle(l,!1,!1,null,!1,1,!0,!1):(P=w&&w.VariantId?w.VariantId:null,w&&w.Price>0&&(n=w.Price/100),w&&w.CompareAtPrice>0&&(e=w.CompareAtPrice/100));else P=(w=discountNinja.Environment.Shopify.VariantData())&&w.Id?w.Id:null,w&&w.Price>0&&(n=w.Price),w&&w.CompareAtPrice>0&&(e=w.CompareAtPrice);discountNinja.VariantChange.ObserveVariantChangeInForms((function(){document.dispatchEvent(new CustomEvent("limoniapps:discountninja:variant:changed"))}))}var F=!a&&!D&&!0===discountNinja.Settings.GetFlag("ApplyOfferInCollectionPageIfPrerequisitesNotAchieved"),x=!0===discountNinja.Settings.GetFlag("AssumeDiscountedVariantsBasedOnFirstVariant"),G=discountNinja.Offer.GetOfferDataForProduct(l,P,_,h,100*n,100*e,!0,a||!y||x,!0,!1,!1,F),H=null===G||null===G.Applicable?null:discountNinja.Offer.GetOfferByToken(G.Applicable),B=!0;if(H?!1===H.UpdatePriceProductPage?B=!1:function(t){var i=discountNinja.Utilities.jQuery()(t),n=i.find("."+discountNinja_Script_DynamicPricing.Classes.ProductPrice.ReplacedPrice);n.removeAttr(discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.IgnoreSystem);var e=i.find("."+discountNinja_Script_DynamicPricing.Classes.ProductPrice.OriginalPrice);e.removeAttr(discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.IgnoreSystem,"")}(t):(U&&function(t,i,n){try{var e=discountNinja.Utilities.jQuery()(t),o={OriginalPrice:i,InventoryLeft:n},r=!discountNinja_Script_ProductData.ProductIsAvailable(o),a=discountNinja.Settings.Settings.Label.UseSoldOutLabelProductPage,c="";if(r&&a)c='<div class="limoniapps-discountninja-product-label limoniapps-discountninja-label-soldout">'+window.discountNinjaContext.Labels.SoldOut+"</div>";else{var u=discountNinja.Settings.GetPriceFormat("standard",!1,!0,!1);c=discountNinja_Script_DynamicPricing.BuildFormattedDiscountedPrice({Format:"{{ORIGINAL_PRICE}}",Layout:u.Layout,Alignment:u.Alignment},null,o,!1)}var s=discountNinja_Script_DynamicPricing.Classes.ProductPrice.OriginalPrice;e.find("."+s).html(c);var d=e.find("."+discountNinja_Script_DynamicPricing.Classes.ProductPrice.ReplacedPrice);d.hide(),d.attr(discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.IgnoreSystem,"");var l=e.find("."+discountNinja_Script_DynamicPricing.Classes.ProductPrice.OriginalPrice);l.show(),l.attr(discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.IgnoreSystem,"")}catch(t){discountNinja.Logging.LogError("DynamicPricing.UpdatePriceForProduct",t)}}(t,n,h),B=!1),H)if(ft=discountNinja.DiscountedProduct.Get(null,P,l,100*n,100*e,h,H,null,G.ApplicableTier))try{for(var M=discountNinja_Script_DynamicPricing.ProductDiscountedEventsPublished,q=!0,Q=!0,V=0;V<M.length;V++){var W=M[V];if(W.ProductHandle===ft.ProductHandle&&W.VariantId===ft.VariantId){q=!1,Q=!1;break}if(W.ProductHandle===ft.ProductHandle){W.VariantId=ft.VariantId,Q=!1;break}}q&&discountNinja.Events.Publish("product:discountapplied",[{OriginalPrice:ft.OriginalPrice,DiscountedPrice:ft.DiscountedPrice,Amount:ft.Amount,Percentage:ft.Percentage,VariantId:ft.VariantId,ProductHandle:ft.ProductHandle,DiscountCode:ft.DiscountCode,OfferToken:ft.OfferToken,TriggerToken:ft.TriggerToken}]),Q&&discountNinja_Script_DynamicPricing.ProductDiscountedEventsPublished.push(ft)}catch(t){discountNinja.Logging.LogError("Publish product:discountapplied",t)}if(a&&S)if(H)discountNinja.DiscountedProduct.CurrentVariantData=ft;else{var K={OriginalPrice:n,DiscountedPrice:n,OriginalCompareAtPrice:e,EffectiveCompareAtPrice:e,InventoryLeft:h,Amount:0,Percentage:0,Key:null,VariantId:P,ProductHandle:l,PriceVaries:null,DiscountCode:null,OfferToken:null,TriggerToken:null};discountNinja.DiscountedProduct.CurrentVariantData=K}var X=r.hasClass("limoniapps-discountninja-productprice-dynamic");if(B){ft.PriceVaries=y;var J=0===r.find(".limoniapps-discountninja-shortcode").length;if(X&&(r.html('<span class="limoniapps-discountninja-productprice limoniapps-discountninja-productprice-dynamic"></span>'),J=!0),J){var z=r.hasClass("limoniapps-discountninja-otherpage"),$=g||D||S&&!z?"product":discountNinja.Environment.Shopify.IsCartPage()?"cart":"other",Y=function(t){try{return t.Tiers.length>1}catch(t){return!1}}(H);!function(t,i,n,e,o,r){try{var a=discountNinja.Utilities.jQuery()(i),c=a.html(),u=discountNinja.Settings.Settings.Label,s=!discountNinja_Script_ProductData.ProductIsAvailable(e),d=n&&u.UseSoldOutLabelProductPage||!n&&u.UseSoldOutLabelCollectionPage,l=s&&u&&d,g=!n&&e.PriceVaries&&u.UseFromLabelCollectionPage&&!0!==r,f=discountNinja.Settings.GetPriceFormat("standard",null,n&&"product"===o,r),p=0===e.DiscountedPrice&&!0===discountNinja.Settings.Settings.PriceUpdate.PriceFormat.HideOriginalPriceForGWPOther,N=a.parents("[itemprop='offers']").length>0,j=discountNinja_Script_DynamicPricing.BuildFormattedPrice(c,f,t,e,g,l,!0,o,!1,p,N);a.html(j)}catch(t){discountNinja.Logging.LogError("DynamicPricing.UpdatePriceForProduct",t)}}(H,t,S,ft,$,Y)}else discountNinja.ShortCode.RefreshResolvedPlaceholders(t,H,ft);(!a||a&&S)&&(discountNinjaContext.CurrentProductInfo=ft),U?discountNinja_Script_DynamicPricing.ReplaceInstallmentsPrices(ft):!a&&L&&discountNinja_Script_DynamicPricing.ReplaceInstallmentsPrices(ft,L)}else X&&r.html(discountNinja.Utilities.FormatMoney(100*n,discountNinja.Currency.GetCurrencyFormat(),2,!1,!1,!1,discountNinja.Settings.Settings.PriceUpdate.HideZeroCents));if(!D){var Z=!1,tt=discountNinja.Offer.GetOfferDataForProduct(l,P,_,h,100*n,100*e,!0,a||!y||x,!1,!0,!1);if(tt&&tt.Applicable){var it=discountNinja.Offer.GetOfferByToken(tt.Applicable),nt=null===discountNinja.DiscountTier.GetCurrentDiscountTier(it)?0:null,et=discountNinja.DiscountedProduct.Get(null,null,l,100*n,100*e,h,it,1,nt);et&&(c(L,it,et,o,!1),Z=!0)}else{var ot=discountNinja.Offer.GetOfferDataForPrerequisiteProduct(l,P,_,h,100*n,100*e,!0,a||!y||x,!0,!1);if(ot&&ot.Applicable){var rt=discountNinja.Offer.GetOfferByToken(ot.Applicable);nt=null===discountNinja.DiscountTier.GetCurrentDiscountTier(rt)?0:null;c(L,rt,discountNinja.DiscountedProduct.Get(null,null,l,100*n,100*e,h,rt,1,nt),o,!0),Z=!0}}Z&&discountNinja.Settings.Settings.Badge&&!0===discountNinja.Settings.Settings.Badge.HideThirdPartyBadges&&discountNinja.Utilities.jQuery()(T).addClass("limoniapps-discountninja-hidethirdpartybadges")}var at=discountNinja.Settings.Settings.ProductPageBanner&&"all"===discountNinja.Settings.Settings.ProductPageBanner.Mode,ct=[];if(U){if(at){var ut=discountNinja.Offer.GetApplicableOffersForBuildingBlock("productbanner",discountNinja.Offer.Offers);for(V=0;V<ut.length;V++){var st,dt,lt=ut[V];if((st=discountNinja.Offer.IsApplicableOffer(lt,l,P,_,h,100*n,100*e,!0,!1,a||!y||x,!0,!1,!0,!1,!1,!0))&&(st.Applicable||st.ApplicableNoTier))ct.push({UsePrerequisiteText:!1,Offer:discountNinja.Offer.GetOfferByToken(st.Token)});else(dt=discountNinja.Offer.IsApplicableOffer(lt,l,P,_,h,100*n,100*e,!0,!1,a||!y||x,!1,!0,!0,!1,!1,!0))&&(dt.Applicable||dt.ApplicableNoTier)&&ct.push({UsePrerequisiteText:!0,Offer:discountNinja.Offer.GetOfferByToken(dt.Token)})}}else if((st=discountNinja.Offer.GetOfferDataForProduct(l,P,_,h,100*n,100*e,!0,a||!y||x,!1,!1,!0))&&(st.Applicable||st.ApplicableNoTier))ct.push({UsePrerequisiteText:!1,Offer:discountNinja.Offer.GetOfferByToken(st.Applicable||st.ApplicableNoTier)});else(dt=discountNinja.Offer.GetOfferDataForPrerequisiteProduct(l,P,_,h,100*n,100*e,!0,a||!y||x,!1,!0))&&(dt.Applicable||dt.ApplicableNoTier)&&ct.push({UsePrerequisiteText:!0,Offer:discountNinja.Offer.GetOfferByToken(dt.Applicable||dt.ApplicableNoTier)});if((Nt=u())&&discountNinja.Utilities.jQuery()(Nt).each((function(){discountNinja.Utilities.jQuery()(this).empty(),discountNinja.Utilities.jQuery()(this).hide()})),ct.length>0){var gt=ct.sort((function(t,i){return t.Offer.PromotionCard.Order-i.Offer.PromotionCard.Order}));for(V=0;V<gt.length;V++){var ft,pt=(H=gt[V]).Offer;nt=null===discountNinja.DiscountTier.GetCurrentDiscountTier(pt)?0:null;(ft=discountNinja.DiscountedProduct.Get(null,null,l,100*n,100*e,h,pt,1,nt))&&s(pt,ft,H.UsePrerequisiteText)}!function(){var t=u();t&&discountNinja.Utilities.jQuery()(t).each((function(){discountNinja.Utilities.jQuery()(this).show()}))}()}}return!0}catch(t){return discountNinja.Logging.LogError("DynamicPricing.UpdatePriceForProductWrapper",t),!1}var Nt}function l(t,i){try{var n=discountNinja_Script_DynamicPricing.ProductPriceSelector(),e=discountNinja.Utilities.jQuery()("[data-limoniapps-discountninja-product-handle]").last().find(n).first();if(e&&1===e.length&&discountNinja.Utilities.jQuery()(e).is(":visible")||100===t)return i.apply(this,arguments);setTimeout((function(){l(t+1,i)}),50)}catch(t){discountNinja.Logging.LogError("DynamicPricing.WaitForProductCards",t)}}try{var g=discountNinja.Settings.Settings;if(discountNinja.Utilities.ObjectIsEmpty(g))return;if(discountNinja.DiscountedCart.SplitRowsInProcess||discountNinja.DiscountedCart.FreeGiftAdjustmentInProcess)return;discountNinja.Cart.Shopify.UpdateCart((function(){discountNinja.Trigger.EnsureInitialPromotionsTriggered((function(){discountNinja.DiscountedCart.BuildDiscountedCart((function(){if(discountNinja.Environment.Shopify.IsCollectionPage()){var t=a.bind(this,g,!0,1);if(!(!0===discountNinja.Settings.GetFlag("WaitForProductCards")))return t.apply(this,arguments);l(1,t)}else a(g,1)}))}))}))}catch(t){discountNinja.Logging.LogError("DynamicPricing.UpdatePriceInternal",t)}},UnblockPricesAndButtons:function(){discountNinja_Script_DynamicPricing.UnblockPrices(),discountNinja_Script_DynamicPricing.UnblockCheckoutButtons()},UnblockPrices:function(){var t=discountNinja_Script_DynamicPricing.Classes.Blocking.BlockStop;discountNinja.Utilities.jQuery()("body").addClass(t)},BlockCheckoutButtonsLookupCode:function(){var t=discountNinja_Script_DynamicPricing.Classes.Blocking.BlockLookupCode,i=discountNinja_Script_DynamicPricing.Classes.Blocking.BlockStop,n=discountNinja.Environment.Shopify.SelectorCheckoutButton();discountNinja.Utilities.jQuery()(n).addClass(t).removeClass(i)},BlockCheckoutButtons:function(){var t=discountNinja_Script_DynamicPricing.Classes.Blocking.Block,i=discountNinja_Script_DynamicPricing.Classes.Blocking.BlockStop,n=discountNinja.Environment.Shopify.SelectorCheckoutButton();discountNinja.Utilities.jQuery()("."+t+","+n).addClass(t).removeClass(i)},UnblockCheckoutButtons:function(){var t=discountNinja_Script_DynamicPricing.Classes.Blocking.BlockLookupCode,i=discountNinja_Script_DynamicPricing.Classes.Blocking.Block,n=discountNinja_Script_DynamicPricing.Classes.Blocking.BlockStop,e=discountNinja.Environment.Shopify.SelectorCheckoutButton();discountNinja.Utilities.jQuery()("."+i+","+e).removeClass(i).removeClass(t).addClass(n)},Show:function(t){function i(t){return function(i,n){try{var e=discountNinja.Utilities.jQuery()(n);t?e.show():0===e.parents(".limoniapps-discountninja-productprice-dynamic").length&&e.hide()}catch(t){discountNinja.Logging.LogError("DynamicPricing.SetDynamicPricingVisibility",t)}}}var n=discountNinja_Script_DynamicPricing,e=n.Classes.ProductPrice,o=n.Attributes.DiscountNinja,r="."+e.ReplacedPrice,a="."+e.Wrapper,c="."+e.ShowAfterReplace,u="."+e.HideAfterReplace,s="["+o.Ignore+"],["+o.IgnoreSystem+"]",d="."+e.OriginalPrice,l=discountNinja.Utilities.jQuery();function g(t,n){var e=n?"[data-token='"+n+"']":"";(p=l(r+e))&&p.length>0&&(p=l(p).not(s)),p.each(i(t)),(p=discountNinja.Environment.Shopify.IsProductPage()?l(c):l(r+e).closest(a).find(c)).each(i(t)),(p=discountNinja.Environment.Shopify.IsProductPage()?l(r+e).closest(a).find(u):l(u)).each(i(!t))}try{var f=void 0===t?discountNinja.Environment.Shopify.IsCartPage()?discountNinja.DiscountedCart.HasAppliedPromotions():discountNinja.DiscountedCart.HasActivePromotions():t;discountNinja.MultiCurrency.UpdateCurrency();var p=l(d).not(s);if(p.each(i(!f)),f){if(discountNinja.Offer.Offers)for(var N=0;N<discountNinja.Offer.Offers.length;N++){g(f,discountNinja.Offer.Offers[N].Token)}g(f,"ALL-TOKENS"),discountNinja.Events.Publish("dynamicpricing:complete",[])}else{g(f,null);var j=discountNinja_Script_DynamicPricing.Classes.ProductPrice.OriginalPrice,C=discountNinja_Script_DynamicPricing.Classes.ProductPrice.ReplacedPrice;discountNinja.Html.RemoveNodes("."+C),discountNinja.Html.RemoveClass("."+j,j)}}catch(t){return discountNinja.Logging.LogError("DynamicPricing.Show",t),!1}},FindElementInCart:function(t,i,n){try{if(!t)return null;var e=discountNinja.Utilities.jQuery()(t).find(i);if(e&&0!==e.length||(e=discountNinja.Utilities.jQuery()(t).parent().find(i)),e&&0!==e.length)return e;if(n)return null}catch(t){discountNinja.Logging.LogError("DynamicPricing.FindElementInCart",t)}},DrawerCartIsDirty:!0,ReplacePricesInDrawerCart:function(t,i){try{if(!(t=t||discountNinja.Settings.Settings))return;discountNinja_Script_DynamicPricing.IsDynamicPricingRequired(t,!0,!1)&&discountNinja_Script_DynamicPricing.ReplacePricesInCartInner(!0,i)}catch(t){discountNinja.Logging.LogError("DynamicPricing.ReplacePricesInDrawerCart",t)}},HandleHeySeniorDrawerCart:function(){var t="limoniapps-discountninja-drawercart-root",i=discountNinja.Utilities.jQuery()(".hs-site-cart-popup-layout");if(i.length>0){var n=discountNinja_Script_DynamicPricing.Classes.Cart,e=discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.CartLineItemKey,o=".hs-item-cart-content",r="data-key";i.not("."+t).addClass(t);var a=i.find(".hs-price-total");a.not("."+n.ProductPrice).addClass(n.ProductPrice),a.each((function(){var t=discountNinja.Utilities.jQuery()(this),i=t.parents(o).find("["+r+"]").attr(r);t.attr(e,i)}));var c=i.find(".hs-item-cart-content-quantity");c.not("."+n.Quantity).addClass(n.Quantity),c.each((function(){var t=discountNinja.Utilities.jQuery()(this),i=t.parents(o).find("["+r+"]").attr(r);t.attr(e,i)})),i.find(".hs-content-product-and-variant-title").each((function(){var t=discountNinja.Utilities.jQuery()(this);if(0===t.find("."+n.CommentForProduct).length){var i=t.parents(o).find("["+r+"]").attr(r);t.append('<div class="'+n.CommentForProduct+'" '+e+'="'+i+'"></div>')}})),i.find(".hs-sub-total-cart").not("."+n.Subtotal).addClass(n.Subtotal),i.find(".hs-mount-sub-total").not("."+n.SubtotalPrice).addClass(n.SubtotalPrice);var u=i.find(".hs-content-total-cart"),s="limoniapps-discountninja-cart-promotionsummary";0===u.find("."+s).length&&u.append('<div class="'+s+'"</div>');var d=i.find(".hs-finalize-purchase"),l="limoniapps-discountninja-cartdiscountfield-placeholder";0===d.find("."+l).length&&d.append('<div class="'+l+'"</div>')}},ClassicCartIsDirty:!0,ReplacePricesInClassicCart:function(t,i){try{if(!discountNinja_Script_DynamicPricing.ClassicCartIsDirty)return;if(discountNinja_Script_DynamicPricing.ClassicCartIsDirty=!1,!(t=t||discountNinja.Settings.Settings))return;(discountNinja.Environment.Shopify.IsCartPage()||discountNinja.Utilities.jQuery()(".limoniapps-discountninja-cart-root").length>0)&&discountNinja_Script_DynamicPricing.IsDynamicPricingRequired(t,!1,!1)&&discountNinja_Script_DynamicPricing.ReplacePricesInCartInner(!1,i)}catch(t){discountNinja.Logging.LogError("DynamicPricing.ReplacePricesInClassicCart",t)}},ReplacePricesInCartInner:function(t,i){function n(t,i,n){try{if(null===discountNinja.DiscountedCart.DiscountedCart)return;var e=100*discountNinja.DiscountedCart.DiscountedCart.total_discount,r=[],a=discountNinja.Settings.Settings.PriceUpdate.Mode,c=(i?a.DrawerCartItemSelector:a.CartItemSelector)||"custom",u=(i?a.DrawerCartItemKeySelector:a.CartItemKeySelector)||"custom";u&&"custom"!==u&&(u=","+u),u&&"custom"===u&&(u="");var s=(i?a.DrawerCartItemKeyAttribute:a.CartItemKeyAttribute)||"custom",d="data-limoniapps-discountninja-cart-key";discountNinja.Utilities.jQuery()(t).find(".limoniapps-discountninja-cart-item-product-price, .limoniapps-discountninja-cart-item-line-price"+u).each((function(t,i){var n=discountNinja.Utilities.jQuery()(i),e=n.attr("data-la-dn-cartitem-key");(e||(e=n.attr(d)),!e&&s&&"custom"!==s&&(e=n.attr(s)),"string"==typeof e&&e.startsWith("updates_")&&(e=e.slice(8)),"custom"!==c)&&n.closest(c).attr(d,e);if(e){for(var o=n.attr("data-la-dn-cartitem-sellingplanid"),a=!0,u=0;u<r.length;u++)if(r[u].Key===e){a=!1;break}a&&r.push({Key:e,SellingPlanId:o})}}));for(var l=0;l<r.length;l++){var g=r[l];o(t,g.Key,g.SellingPlanId,i)}var f=function(t,i){try{var n=i/100,e=t/100,o=Math.round(100*(e-n))/100;return o<0&&(o=0),{OriginalPrice:e,Amount:n,Percentage:n/e*100,DiscountedPrice:o}}catch(t){discountNinja.Logging.LogError("DynamicPricing.BuildProductInfoFromAmount",t)}}(100*discountNinja.DiscountedCart.DiscountedCart.total_original_price,e),p=discountNinja.Settings.Settings.PriceUpdate,N=i?p.Enable.DrawerCart:p.Enable.Cart,j=discountNinja.PromotionSummary.BuildPromotionSummaryLabels(i),C=j,m=discountNinja.Settings.Settings.PromotionSummary;m&&!1===m.ShowComments&&(C=[]),function(t,i){var n=discountNinja.Settings.Settings.PriceUpdate.Mode,e=i?n.DrawerCartSubtotalPrice:n.CartSubtotalPrice,o=discountNinja_Script_DynamicPricing.Classes.Cart.SubtotalPriceInjected;if(e&&"custom"!==e&&"none"!==e&&!(discountNinja.Utilities.jQuery()(t).find("."+o).length>0)){var r=discountNinja_Script_DynamicPricing.Classes.Cart.SubtotalPrice;discountNinja.Utilities.jQuery()(t).find("."+r).not("."+o).removeClass(r).addClass(r+"-disabled"),discountNinja.Utilities.jQuery()(t).find(".limoniapps-discountninja-cart-promotionsummary ."+r+"-disabled").removeClass(r+"-disabled").addClass(r);var a='<span class="'+r+" limoniapps-discountninja-buildingblock-injected "+o+'"></span>',c=e,u=discountNinja.Utilities.jQuery()(t).find(c);u&&u.length>0&&u.length<3&&u.wrapInner(a)}}(t,i),function(t,i,n){var e=discountNinja.Settings.Settings.PriceUpdate.Mode,o=i?e.DrawerCartSubtotal:e.CartSubtotal;o&&"custom"!==o&&"none"!==o||(o=".limoniapps-discountninja-cart-subtotal");var r=discountNinja.Environment.Shopify.IsCartPage(),a=discountNinja.Settings.Settings.PromotionSummary,c=a&&(!0===a.HideSubtotal&&r||!0===a.HideSubtotalDrawerCart&&!r),u=discountNinja.PromotionSummary.PromotionSummaryEnabledOn(i),s=discountNinja.PromotionSummary.DisplayPromotionSummary(a,n);if(c&&u&&s){var d="limoniapps-discountninja-whenpromotionsummaryunavailable-show",l='<div style="display:none" class="'+d+'"></div>',g=o,f=discountNinja.Utilities.jQuery()(t).find(g);f&&f.length>0&&f.length<3&&f.each((function(){0===discountNinja.Utilities.jQuery()(this).closest("."+d).length&&discountNinja.Utilities.jQuery()(this).wrap(l)}))}}(t,i,j),discountNinja.PromotionSummary.RenderPromotionSummary(t,i,j),h(null,null,null,t,!0,N&&e>0,"subtotal",C,f,null,i,!1),discountNinja.DiscountCode.EnableDiscountCodeField(),!1!==n&&discountNinja.DiscountCode.UpdateTags(),discountNinja.DiscountCode.LockDiscountCodeFieldIfRequired(),discountNinja_Script_DynamicPricing.ReplaceInstallmentsPrices(),L(),discountNinja_Script_PromotionFlow.ShowHideElementsWhenPromotionsInCart()}catch(t){discountNinja_Script_DynamicPricing.ReplacingPricesInCart=!1,discountNinja.Logging.LogError("DynamicPricing.ReplacePricesInCartForRoot",t)}}function e(t,i){return discountNinja.LiquidData.ItemHasPropertyWithPrefix(discountNinja.LiquidData.CartItemByKeyAndSellingPlanId(t,i),discountNinja.DiscountedCart.FreeGiftPrefix)}function o(t,i,n,o){try{var r=discountNinja.LiquidData.QuantityFromCartByKey(i,n);if(0===r)return 0;var a=100*discountNinja.LiquidData.PriceFromCartByKey(i,n),c=discountNinja.DiscountedCart.Get(i),u=c?discountNinja.Offer.GetOfferByToken(c.OfferToken):null,s=u&&!1!==u.UpdatePriceCartPage;if(u&&s&&"line_item"===u.Entitlement.TargetType&&"each"===u.Entitlement.AllocationMethod){var d=c.Product,l=c.Line,g=discountNinja.Settings.Settings.PriceUpdate.Enable,f=o?g.DrawerCart:g.Cart,p=u.Cart?o?u.DrawerCart?u.DrawerCart.ProductSavingsLabel:null:u.Cart.ProductSavingsLabel:null,N=u.Cart?o?u.DrawerCart?u.DrawerCart.ProductSavingsTextColor:null:u.Cart.ProductSavingsTextColor:null,j=[];if(p){var m=discountNinja.TextSettings.WrapInColor(N,discountNinja.TextSettings.GetText(p,null));j.push({Offer:u.Token,Label:m,ProductInfo:d,LineInfo:l})}var S=e(i,n);return h(i,n,u,t,!0,f,"item-product",j,d,l,o,S),h(i,n,u,t,!0,f,"item-line",null,l,l,o,S),(a-100*d.DiscountedPrice)*r}return C(i,n,t,"item-product",o),C(i,n,t,"item-line",o),0}catch(t){discountNinja.Logging.LogError("DynamicPricing.ReplacePricesForCartItem",t)}}function r(t){return discountNinja_Script_DynamicPricing.Classes.Cart.PriceForLevel.replace("[LEVEL]",t)}function a(t){return discountNinja_Script_DynamicPricing.Classes.Cart.CommentForLevel.replace("[LEVEL]",t)}function c(t,i){var n=discountNinja.Settings.Settings.PriceUpdate.Mode;return"subtotal"===t?"custom":"item-product"===t?(i?n.DrawerCartProductPrice:n.CartProductPrice)||"custom":"item-line"===t?(i?n.DrawerCartLinePrice:n.CartLinePrice)||"custom":void 0}function u(t,i){var n=c(t,i);return"custom"===n?"."+r(t):n}function s(t,i,n){var e=c(t,n);return"custom"===e?f(t,r(t),i):e?e.replace(/\[\[CARTITEMKEY\]\]/g,i):""}function d(t){var i=discountNinja.Settings.Settings.PriceUpdate.Mode;return(t?i.DrawerCartQuantity:i.CartQuantity)||"custom"}function l(t,i){var n=d(i);return"custom"===n?f("item-line",discountNinja_Script_DynamicPricing.Classes.Cart.Quantity,t):n?n.replace(/\[\[CARTITEMKEY\]\]/g,t):""}function g(t,i){return"."+a(t)}function f(t,i,n){return"."+i+("["+discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.CartLineItemKey+'="'+n+'"]')}function p(t,i,n){return f(0,a(t),i)}function N(t,i){var n=discountNinja.Settings.Settings.PriceUpdate.Mode,e=t?n.DrawerCartProductComment:n.CartProductComment;e&&(e=e.replace(/\[\[CARTITEMKEY\]\]/g,i));var o=discountNinja_Script_DynamicPricing.InjectPlaceHolder,r=discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-item-product-comment-injected",a=r+"-"+i.replace(/:/g,"-");if(e&&"custom"!==e&&"none"!==e&&!(discountNinja.Utilities.jQuery()("."+a).length>0)){var c="limoniapps-discountninja-cart-item-product-comment";discountNinja.Utilities.jQuery()("."+c).not("."+r).removeClass(c).addClass(c+"-disabled");var u='<div class="'+c+" "+r+" limoniapps-discountninja-buildingblock-injected "+a+'" data-limoniapps-discountninja-cart-key="'+i+'"></div>';o.Inject(e,u,null,!1,t)}}function j(t,i,n,e){try{var o=discountNinja.Utilities.jQuery()(t);if(o.attr(n)===i||o.attr(e)===i)return!0;var r=o.parents("["+e+"]");if(r&&r.length>0&&r.attr(e)===i)return!0;var a=o.parents("["+n+"]");return!!(a&&a.length>0&&a.attr(n)===i)}catch(t){return!1}}function C(t,i,n,e,o){try{var r=u(e,o),a=s(e,t,o),c=S(),d=m(),f=null===t?discountNinja.Utilities.jQuery()(n).find(r):discountNinja.Utilities.jQuery()(n).find(a);if(null!==f&&0!==f.length){if(0===discountNinja.Utilities.jQuery()(f).find(".limoniapps-discountninja-shortcode").length)return;if(null===t||j(f,t,d,c)){var N=discountNinja.LiquidData.CartItemByKeyAndSellingPlanId(t,i),C=null;if("item-product"===e&&N?C={OriginalPrice:N.original_price/100}:"item-line"===e&&N&&(C={OriginalPrice:N.original_line_price/100}),null===C&&"subtotal"!==e);else{var h="{{ORIGINAL_PRICE}}";"subtotal"===e&&(h="{{TOTAL_PRICE}}"),price=discountNinja.ShortCode.ReplaceAllPlaceHolders(null,h,C,e),discountNinja.Utilities.jQuery()(f).html(price)}}}var _=g(e),y=p(e,t),v=null===t?discountNinja.Utilities.jQuery()(n).find(_):discountNinja.Utilities.jQuery()(n).find(y);if(null===v||0===v.length)return;if((null===t||j(v,t,d,c))&&discountNinja.Utilities.jQuery()(v).html(""),"subtotal"!==e){var P=l(t,o),T=discountNinja.Utilities.jQuery()(n).find(P);null!==T&&0!==T.length||(T=n),j(T,t,d,c)&&(discountNinja.Utilities.jQuery()(T).removeClass(discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.QuantitySpinnerHide),discountNinja.Utilities.jQuery()(T).removeClass(discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.QuantitySpinnerDisable))}}catch(t){discountNinja.Logging.LogError("DynamicPricing.ResetCartItemLevel",t)}}function m(){return discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.CartLineItemKey}function S(){return discountNinja.Settings.Settings.PriceUpdate.Mode.CartItemKeyAttribute}function h(t,i,n,o,r,a,c,d,f,h,y,v){try{if(C(t,i,o,c,y),r){var P=discountNinja.Settings.GetPriceFormat(c,y),T=S(),L=m();if(a){var D=e(t)&&discountNinja.Settings.Settings.PriceUpdate.PriceFormat.HideOriginalPriceForGWPCart,E=discountNinja_Script_DynamicPricing.BuildFormattedDiscountedPrice(P,n,f,!1,D),I=u(c,y),O=s(c,t,y),A=null===t?discountNinja.Utilities.jQuery()(o).find(I):discountNinja.Utilities.jQuery()(o).find(O);null===A||0===A.length||(null===t||j(A,t,L,T))&&A.each((function(t,i){var e=function(t,i,n){try{var e=discountNinja_Script_DynamicPricing.Classes.ProductPrice.OriginalPrice,o=discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.Token,r=t;if(r){var a=discountNinja_Script_DynamicPricing.FindElementInCart(r,"."+e,!1),c='<span class="'+e+'" '+o+'="'+n+'" style="display:none;">'+r.html()+"</span>";if(null==a)return c;var u=a[0];return(u?discountNinja.Utilities.jQuery()(u).prop("outerHTML"):"")||""}return""}catch(t){return discountNinja.Logging.LogError("DynamicPricing.GetOriginalPriceHtmlFromCartItem",t),null}}(discountNinja.Utilities.jQuery()(i),0,n?n.Token:"ALL-TOKENS");!function(t,i,n,e,o){try{var r=t;if(r){var a='<span class="limoniapps-discountninja-cart-'+i+'-price"><span class="'+discountNinja_Script_DynamicPricing.Classes.ProductPrice.ReplacedPrice+'" '+discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.Token+'="'+o+'" style="display:none;">'+e+"</span></span>";discountNinja.Utilities.jQuery()(r).html(a+n)}}catch(t){return discountNinja.Logging.LogError("ReplacePriceInCart",t),null}}(i,c,e,E,n?n.Token:"ALL-TOKENS")}))}if(d){"subtotal"!==c&&N(y,t);var k=g(c),b=p(c,t),R=null===t?discountNinja.Utilities.jQuery()(o).find(k):discountNinja.Utilities.jQuery()(o).find(b);null===R||0===R.length||(null===t||discountNinja.Utilities.jQuery()(R).attr(L)===t?_(R,d,c,!1):j(R,t,L,T)&&_(R,d,c,!0))}if(v&&"subtotal"!==c){var U=discountNinja.Settings.Settings.Cart.QuantitySpinnerMode,w=!U||"hide"===U,F="disable"===U;if(F||w){N(y,t);var x=l(t,y),G=discountNinja.Utilities.jQuery()(o).find(x);null===G||0===G.length||j(G,t,L,T)&&(w?discountNinja.Utilities.jQuery()(G).addClass(discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.QuantitySpinnerHide):F&&discountNinja.Utilities.jQuery()(G).addClass(discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.QuantitySpinnerDisable))}}}}catch(t){discountNinja.Logging.LogError("DynamicPricing.ReplacePricesForCartItemLevel",t)}}function _(t,i,n,e){try{var o=t;if(i&&i.length>0&&o){for(var r="",a=0;a<i.length;a++){var c=i[a].Label,u=i[a].ProductInfo,s=i[a].Offer,d=discountNinja.Offer.GetOfferByToken(s),l=discountNinja_Script_DynamicPricing.Attributes.DiscountNinja.Token,g="";if("subtotal"===n){var f=discountNinja.ShortCode.ReplaceAllPlaceHolders(d,c,u);g='<div class="'+discountNinja_Script_DynamicPricing.Classes.ProductPrice.ReplacedPrice+'" '+l+'="'+s+'" style="display:none;">'+f+"</div>",r=""===r?g:r+g}else{c=(c=c.replace(/\{\{DISCOUNT_LINE\}\}/g,"{{DISCOUNT_LINE_AMOUNT}}")).replace(/\{\{DISCOUNT\}\}/g,"{{DISCOUNT_LINE_PERCENTAGE}}");f=discountNinja.ShortCode.ReplaceAllPlaceHolders(d,c,u);if(g='<span class="'+discountNinja_Script_DynamicPricing.Classes.ProductPrice.ReplacedPrice+'" '+l+'="'+s+'" style="display:none;">'+f+"</span>",discountNinja.ShortCode.ContainsPlaceHolder(g,"DISCOUNT_LINE_")){var p=discountNinja.Currency.GetCurrencyFormat(),N=discountNinja.Utilities.GetNoDecimalsCurrencyFormat(p),j=discountNinja.Utilities.GetCurrencyFormatAmountComponent(p),C=discountNinja.Utilities.GetCurrencyFormatAmountComponent(N),m=discountNinja.DiscountedCart.DiscountedCart,S=m?m.Currency:"",h=i[a].LineInfo;g=discountNinja.ShortCode.BuildResolvedPlaceHolderAmount(d,null,g,!0,"{{DISCOUNT_LINE_AMOUNT}}","offer","DISCOUNT_LINE_AMOUNT",100*h.EffectiveAmount,S,p,N,j,C,2,!1,null,null,!0),g=discountNinja.ShortCode.BuildResolvedPlaceHolder(d,null,g,!0,"{{DISCOUNT_LINE_PERCENTAGE}}","offer","DISCOUNT_LINE_PERCENTAGE",discountNinja.Utilities.FormatPercentage(h.EffectivePercentage,0)+"%")}r=""===r?g:r+"&nbsp;"+g}}var _="limoniapps-discountninja-cart-"+n+"-comment";""!==r&&(r='<div class="'+_+'">'+r+"</div>"),e?discountNinja.Utilities.jQuery()(o).next().hasClass(_)?discountNinja.Utilities.jQuery()(o).next().html(r):discountNinja.Utilities.jQuery()(o).after(r):discountNinja.Utilities.jQuery()(o).html(r),o.show()}else!i||i.length}catch(t){return discountNinja.Logging.LogError("DynamicPricing.AddCartComment",t),null}}function y(){discountNinja_Script_DynamicPricing.ReplacingPricesInCart=!1}function v(){discountNinja.Utilities.jQuery()(".limoniapps-discountninja-drawercart-root .limoniapps-discountninja-cart-subtotal-comment").hide(),discountNinja.Utilities.jQuery()(".limoniapps-discountninja-drawercart-root .limoniapps-discountninja-cart-subtotal-price .limoniapps-discountninja-shortcode-discounted_price").text("0"),discountNinja.Utilities.jQuery()(".limoniapps-discountninja-drawercart-root .limoniapps-discountninja-cart-subtotal-price .limoniapps-discountninja-shortcode-original_price").hide()}function P(t,i,n,e,o){try{if(discountNinja_Script_DynamicPricing.DrawerCartReplacingPricesInCart)for(var r=0;r<discountNinja_Script_DynamicPricing.DrawerCartReplacingPricesInCart.length;r++)if(discountNinja_Script_DynamicPricing.DrawerCartReplacingPricesInCart[r].Item===e&&discountNinja_Script_DynamicPricing.DrawerCartReplacingPricesInCart[r].Ready)return;var a=discountNinjaContext.Settings.PriceUpdate.Mode.DrawerCartSubtotalPrice;if(a&&(a=a.replace(/\[\[HIDE\]\]/g,"")),(i.find("."+discountNinja_Script_DynamicPricing.Classes.Cart.SubtotalPrice).length>0||i.find("."+discountNinja_Script_DynamicPricing.Classes.Cart.SubtotalPrice+"-disabled").length>0||i.find(a).length>0)&&function(t){var i=!1;return discountNinja.Utilities.jQuery()(t).each((function(){discountNinja.Utilities.jQuery()(this).is(":visible")&&(i=!0)})),i}(i)&&function(t){var i=!1;return discountNinja.Utilities.jQuery()(t).each((function(){discountNinja.Utilities.IsInViewport(this)&&(i=!0)})),i}(i)||200===t)return t<200?(discountNinja_Script_DynamicPricing.DrawerCartReplacingPricesInCart.push({Item:e,Ready:!0}),null!==o&&clearTimeout(o),n.call(this,i,!1)):(discountNinja_Script_DynamicPricing.DrawerCartReplacingPricesInCart.push({Item:e,Ready:!1,Expired:!0}),y());t+=1,o=setTimeout((function(){P(t,i,n,e,o)}),100)}catch(t){discountNinja.Logging.LogError("DynamicPricing.WaitForDrawerCart",t)}}function T(t,i){try{n(t,!0,i),!0===discountNinja.Settings.GetFlag("ReplacePricesInDrawerCartAfterDelay")&&(setTimeout((function(){n(t,!0,i)}),100),setTimeout((function(){n(t,!0,i)}),500))}catch(t){L(),discountNinja.Logging.LogError("DynamicPricing.ReplacePricesInCartForRootAfterWait",t)}}function L(){discountNinja_Script_DynamicPricing.Show(!0),discountNinja_Script_DynamicPricing.ReplacingPricesInCart=!1}function D(t,i){discountNinja.PromotionSummary.RenderPromotionSummary(t,i,[]),discountNinja_Script_DynamicPricing.ReplacingPricesInCart=!1}try{if(null===discountNinja.Settings.Settings)return;if(null===discountNinja.DiscountedCart.DiscountedCart)return;var E=!0;discountNinja.DiscountedCart.HasActivePromotions()||(y(),v(),E=!1),window.discountNinjaContext.Cart&&window.discountNinjaContext.Cart.items&&0!==window.discountNinjaContext.Cart.items.length||(y(),v(),E=!1);var I="limoniapps-discountninja-drawercart-root",O="limoniapps-discountninja-cart-root",A="."+I,k="."+O;discountNinja_Script_DynamicPricing.HandleHeySeniorDrawerCart();var b=t?discountNinja.Utilities.jQuery()(A):discountNinja.Utilities.jQuery()(k);if(void 0===b||0===b.length){if(discountNinja.Environment.Shopify.IsCartPage()&&!t){var R=discountNinja.Settings.Settings.PriceUpdate.Mode.CartRoot;R&&"custom"!==R&&(b=discountNinja.Utilities.jQuery()(R)).addClass(O),void 0!==b&&0!==b.length||void 0!==(b=discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorMain()))&&0!==b.length||(b=discountNinja.Checkout.Shopify.GetCheckoutForms().not(".limoniapps-discountninja-ignore")),b.addClass(O)}else if(t){var U=discountNinja.Settings.Settings.PriceUpdate.Mode.DrawerCartRoot;U&&"custom"!==U&&(b=discountNinja.Utilities.jQuery()(U)).addClass(I),discountNinja.Environment.Shopify.IsCartPage()||void 0!==b&&0!==b.length||(b=discountNinja.Utilities.jQuery()(k))}if(void 0===b||0===b.length)return void y()}if(discountNinja_Script_DynamicPricing.ReplacingPricesInCart=!0,t){discountNinja_Script_DynamicPricing.DrawerCartReplacingPricesInCart=[];var w=1;discountNinja.Utilities.jQuery()(b).each((function(){E?P(1,discountNinja.Utilities.jQuery()(this),T,w,null):D(this,!0),w++}))}else discountNinja.Utilities.jQuery()(b).each((function(){E?n(this,!1,i):D(this,!1)}))}catch(t){discountNinja_Script_DynamicPricing.ReplacingPricesInCart=!1,discountNinja.Logging.LogError("DynamicPricing.ReplacePricesInCartInner",t)}},ReplacePricesInCart:function(t){discountNinja.Cart.Shopify.UpdateCartDebounced((function(){discountNinja.Trigger.EnsureInitialPromotionsTriggered((function(){discountNinja.DiscountedCart.BuildDiscountedCart((function(){!function(){try{var i=discountNinja.Settings.Settings;discountNinja.Environment.Shopify.IsCartPage()||discountNinja.Utilities.jQuery()(".limoniapps-discountninja-cart-root").addClass("limoniapps-discountninja-drawercart-root").removeClass("limoniapps-discountninja-cart-root"),discountNinja_Script_DynamicPricing.ReplacePricesInDrawerCart(i,t),discountNinja_Script_DynamicPricing.ReplacePricesInClassicCart(i,t)}catch(t){discountNinja_Script_DynamicPricing.ReplacingPricesInCart=!1,discountNinja.Logging.LogError("DynamicPricing.ReplacePricesInCart.Inner",t)}}()}))}))}))},IsDynamicPricingRequired:function(t,i,n){var e="",o=t.PriceUpdate.Enable,r=discountNinja.Environment.Shopify;if(i){if(!1!==t.PriceUpdate.Enable.DrawerCart)return!0;e="Dynamic Pricing is not required since the offer configuration specifies not to dynamically replace prices on the drawer cart."}var a="Dynamic Pricing is not required since the offer configuration specifies not to dynamically replace prices on ";return""===e&&r.IsHomePage()&&!1===o.Home&&(e=a+"the home page."),""===e&&r.IsCollectionPage()&&!1===o.Collection&&(e=a+"collection pages."),""===e&&r.IsProductPage()&&!1===o.Product&&(e=a+"product pages."),""===e&&r.IsBlogPost()&&!1===o.Blog&&(e=a+"blog pages."),""===e&&r.IsCustomPage()&&!1===o.Custom&&(e=a+"custom pages."),""===e&&r.IsCartPage()&&!1===o.Cart&&(e=a+"the cart page."),""===e&&(r.IsSearchPage()||n)&&!1===o.Search&&(e=a+"the search page."),discountNinja.PromotionFlow.HandleFlowErrorMessage(e)}},discountNinja_Script_DynamicPricing_Classes_PromotionSummary_Prefix=discountNinja_Script_DynamicPricing_Classes_Prefix+"cart-promotionsummary",discountNinja_Script_PromotionSummary={Template:null,RowTemplate:null,GetTemplate:function(){return null===discountNinja_Script_PromotionSummary.Template&&(discountNinja_Script_PromotionSummary.Template=discountNinja.Utilities.jQuery()("#limoniapps-promotionsummary-template").html()),discountNinja_Script_PromotionSummary.Template},GetRowTemplate:function(){return null===discountNinja_Script_PromotionSummary.RowTemplate&&(discountNinja_Script_PromotionSummary.RowTemplate=discountNinja.Utilities.jQuery()("#limoniapps-promotionsummary-row-template").html()),discountNinja_Script_PromotionSummary.RowTemplate},Classes:{Injected:discountNinja_Script_DynamicPricing_Classes_PromotionSummary_Prefix+"-injected"},PromotionSummaryEnabledOn:function(t){var i=discountNinja.Settings.Settings.PromotionSummary;if(!i)return!1;var n=i.DisplayOnDevices;if(n){var e=discountNinja.Utilities.IsMobilePhone();if(e&&"desktoponly"===n)return!1;if(!e&&"mobileonly"===n)return!1}return!(i.HideInCart&&!t||i.HideInDrawerCart&&t)},DisplayPromotionSummary:function(t,i){var n=discountNinja.DiscountedCart.DiscountedCart;return!!(i&&i.length>0)||(n.total_discount>0||t&&!0===t.AlwaysDisplay)},RenderPromotionSummary:function(t,i,n){function e(t){return discountNinja.ShortCode.ReplaceAllPlaceHolders(null,discountNinja.TextSettings.GetText(t,null),null)}function o(t){var i=discountNinja.DiscountedCart.DiscountedCart,n=i.total_discount>0,e=i.total_discount_excluding_gifts>0,o=i.subtotal_discount>0,r=i.subtotal_discount_excluding_gifts>0,a=i.cartlevel_discount>0;return"discount_line_level"===t?o:"discount_line_level_excluding_gifts"===t?r:"discount_order_level"===t?a:"discount"===t?n:"discount_excluding_gifts"!==t||e}if(discountNinja_Script_PromotionSummary.PromotionSummaryEnabledOn(i)){!function(t,i){var n=discountNinja.Settings.Settings.PriceUpdate.Mode,e=i?n.DrawerCartPromotionSummary:n.CartPromotionSummary,o=discountNinja_Script_DynamicPricing.InjectPlaceHolder,r=discountNinja_Script_PromotionSummary.Classes.Injected,a=discountNinja_Script_DynamicPricing_Classes_PromotionSummary_Prefix;if(e&&"custom"!==e&&"none"!==e){if("appblock"===e)if(discountNinja.Utilities.jQuery()(t).find("."+a+'[data-source="appblock"]').length>0)return void discountNinja.Utilities.jQuery()(t).find("."+a).not('[data-source="appblock"]').removeClass(a).addClass(a+"-disabled");if(!(discountNinja.Utilities.jQuery()(t).find("."+r).length>0||discountNinja.Utilities.jQuery()(t).find("."+a).length>0)){discountNinja.Utilities.jQuery()(t).find("."+a).not("."+r).removeClass(a).addClass(a+"-disabled");var c='<div class="'+a+" "+r+'"></div>';o.Inject(e,c,t,!0,i)}}}(t,i);var r=discountNinja.Utilities.jQuery()(t).find("."+discountNinja_Script_DynamicPricing_Classes_PromotionSummary_Prefix);if(0===r.length&&(r=discountNinja.Utilities.jQuery()(t).find(".limoniapps-discountninja-cart-subtotalcomment")),r.length>0){var a=discountNinja.Settings.Settings.PromotionSummary;if(a&&discountNinja_Script_PromotionSummary.DisplayPromotionSummary(a,n)){var c=discountNinja_Script_PromotionSummary.GetTemplate();if(null==c)return void r.html("");var u=discountNinja_Script_PromotionSummary.GetRowTemplate();c=(c=(c=c.replace("limoniapps-discountninja-productprice-replaced","")).replace('limoniapps-discountninja-whenpromotionsincart-show" style="display:none;"','"')).replace('class="limoniapps-discountninja-subtotalcomment-summary-table" style="display:none;"','class="limoniapps-discountninja-subtotalcomment-summary-table"');var s=discountNinja.TextSettings.WrapInColor(a.HeaderTextColor,e(a.Header)),d=discountNinja.TextSettings.WrapInColor(a.FooterTextColor,e(a.Footer)),l=void 0===a.FooterSubtotalLabel?null:discountNinja.TextSettings.WrapInColor(a.FooterSubtotalLabelTextColor,e(a.FooterSubtotalLabel)),g=void 0===a.FooterSubtotal?null:discountNinja.TextSettings.WrapInColor(a.FooterSubtotalTextColor,e(a.FooterSubtotal)),f=void 0===a.FooterTotalDiscountLabel?null:discountNinja.TextSettings.WrapInColor(a.FooterTotalDiscountLabelTextColor,e(a.FooterTotalDiscountLabel)),p=void 0===a.FooterTotalDiscount?null:discountNinja.TextSettings.WrapInColor(a.FooterTotalDiscountTextColor,e(a.FooterTotalDiscount)),N=void 0===a.FooterTotalLabel?null:discountNinja.TextSettings.WrapInColor(a.FooterTotalLabelTextColor,e(a.FooterTotalLabel)),j=void 0===a.FooterTotal?null:discountNinja.TextSettings.WrapInColor(a.FooterTotalTextColor,e(a.FooterTotal)),C=void 0===a.FooterDiscountedTotalLabel?null:discountNinja.TextSettings.WrapInColor(a.FooterDiscountedTotalLabelTextColor,e(a.FooterDiscountedTotalLabel)),m=void 0===a.FooterDiscountedTotal?null:discountNinja.TextSettings.WrapInColor(a.FooterDiscountedTotalTextColor,e(a.FooterDiscountedTotal));s=discountNinja.ShortCode.ReplaceAllPlaceHolders(discountNinja.Offer.PrimaryOffer,s,null,"subtotal"),d=discountNinja.ShortCode.ReplaceAllPlaceHolders(discountNinja.Offer.PrimaryOffer,d,null,"subtotal"),l=discountNinja.ShortCode.ReplaceAllPlaceHolders(discountNinja.Offer.PrimaryOffer,l,null,"subtotal"),g=discountNinja.ShortCode.ReplaceAllPlaceHolders(discountNinja.Offer.PrimaryOffer,g,null,"subtotal"),f=discountNinja.ShortCode.ReplaceAllPlaceHolders(discountNinja.Offer.PrimaryOffer,f,null,"subtotal"),p=discountNinja.ShortCode.ReplaceAllPlaceHolders(discountNinja.Offer.PrimaryOffer,p,null,"subtotal"),N=discountNinja.ShortCode.ReplaceAllPlaceHolders(discountNinja.Offer.PrimaryOffer,N,null,"subtotal"),j=discountNinja.ShortCode.ReplaceAllPlaceHolders(discountNinja.Offer.PrimaryOffer,j,null,"subtotal"),C=discountNinja.ShortCode.ReplaceAllPlaceHolders(discountNinja.Offer.PrimaryOffer,C,null,"subtotal"),m=discountNinja.ShortCode.ReplaceAllPlaceHolders(discountNinja.Offer.PrimaryOffer,m,null,"subtotal"),d&&(d=d.replace("[[SUBTOTAL PLACEHOLDER - USES (DRAWER) CART SUBTOTAL PRICE FORMAT]]","")),j&&(j=j.replace("[[SUBTOTAL PLACEHOLDER - USES (DRAWER) CART SUBTOTAL PRICE FORMAT]]",""));var S="",h=!1;if(null!=u)for(var _=0;_<n.length;_++){var y=n[_];(a.ShowBody||!0===y.Warning)&&(!0===y.Warning&&(h=!0),S+=discountNinja.TemplateParameter.Replace(u,"ROW",y.Label))}var v=n.length>0,P=discountNinja.DiscountedCart.DiscountedCart.total_discount>0,T=null!==discountNinja.DiscountedCart.DiscountedCart.Shipping,L=o(a.SubtotalRowMode),D=o(a.DiscountRowMode),E=!(void 0===a.FooterTotal)&&!P?"":"display:none",I=!(void 0===a.FooterDiscountedTotal)&&P?"":"display:none",O=(a.NewFooter||a.Footer)&&!0;c=discountNinja.TemplateParameter.Replace(c,"HEADER",s),c=discountNinja.TemplateParameter.Replace(c,"SHOWHEADER",a.Header&&(P||T)?"":"display:none"),c=discountNinja.TemplateParameter.Replace(c,"SHOWBODY",(a.ShowBody||h)&&v?"":"display:none"),c=discountNinja.TemplateParameter.Replace(c,"FOOTER",d),c=discountNinja.TemplateParameter.Replace(c,"SHOWFOOTER",O?"":"display:none"),c=discountNinja.TemplateParameter.Replace(c,"BODY",S),c=discountNinja.TemplateParameter.Replace(c,"SHOWNEWFOOTER",a.NewFooter?"":"display:none"),c=discountNinja.TemplateParameter.Replace(c,"SHOWLEGACYFOOTER",a.NewFooter?"display:none":""),c=discountNinja.TemplateParameter.Replace(c,"SHOWSUBTOTAL",void 0!==a.FooterSubtotal&&L?"":"display:none"),c=discountNinja.TemplateParameter.Replace(c,"SHOWTOTALDISCOUNT",void 0!==a.FooterTotalDiscount&&D?"":"display:none"),c=discountNinja.TemplateParameter.Replace(c,"SHOWTOTAL",E),c=discountNinja.TemplateParameter.Replace(c,"SUBTOTAL_LABEL",l),c=discountNinja.TemplateParameter.Replace(c,"SUBTOTAL",g),c=discountNinja.TemplateParameter.Replace(c,"TOTALDISCOUNT_LABEL",f),c=discountNinja.TemplateParameter.Replace(c,"TOTALDISCOUNT",p),c=discountNinja.TemplateParameter.Replace(c,"SHOWDISCOUNTEDTOTAL",I),c=discountNinja.TemplateParameter.Replace(c,"DISCOUNTED_TOTAL_LABEL",C),c=discountNinja.TemplateParameter.Replace(c,"DISCOUNTED_TOTAL",m),c=discountNinja.TemplateParameter.Replace(c,"TOTAL_LABEL",N),c=discountNinja.TemplateParameter.Replace(c,"TOTAL",j),r.html(c)}else r.html("")}}},BuildPromotionSummaryLabels:function(t){function i(t,i,n,e){for(var o=!1,r=0;r<n.length;r++)if(n[r].Offer===t){o=!0;break}if(!o){var a=discountNinja.Offer.GetOfferByToken(t),c=discountNinja.DiscountTier.GetCurrentDiscountTier(a,!1,!1,!1===e),u=discountNinja.Offer.PrerequisiteItemsCartValue(a);if(!discountNinja.DiscountTier.ExceedsUpperLimits(a,c||a.Tiers[0],u)&&a&&a.Cart){var s=i?a.DrawerCart?a.DrawerCart.SubtotalSavingsLabel:null:a.Cart.SubtotalSavingsLabel,d=i?a.DrawerCart?a.DrawerCart.SubtotalSavingsTextColor:null:a.Cart.SubtotalSavingsTextColor;if(null!==s&&null!==d){var l=discountNinja.TextSettings.WrapInColor(d,function(t,i){return discountNinja.ShortCode.ReplaceAllPlaceHolders(i,discountNinja.TextSettings.GetText(t,i),null)}(s,a));l=discountNinja.ShortCode.ReplaceAllPlaceHolders(null,l,null,"subtotal"),discountNinja.TextSettings.IsEmpty(l)||n.push({Offer:a.Token,Label:l,ProductInfo:null})}}}}for(var n=[],e=[],o=0;o<discountNinja.DiscountedCart.DiscountedCart.items.length;o++){var r=discountNinja.DiscountedCart.DiscountedCart.items[o];r.OfferToken&&(i(r.OfferToken,t,n,!0),e.push(r.OfferToken))}for(o=0;o<discountNinja.DiscountedCart.DiscountedCart.CartLevelDiscounts.length;o++){var a=discountNinja.DiscountedCart.DiscountedCart.CartLevelDiscounts[o];a.OfferToken&&(i(a.OfferToken,t,n,!0),e.push(a.OfferToken))}if(discountNinja.DiscountedCart.DiscountedCart.Shipping&&(i(discountNinja.DiscountedCart.DiscountedCart.Shipping.OfferToken,t,n,!0),e.push(discountNinja.DiscountedCart.DiscountedCart.Shipping.OfferToken)),discountNinja.Offer.Offers)for(var c=0;c<discountNinja.Offer.Offers.length;c++){var u=discountNinja.Offer.Offers[c];if(u&&u.Cart&&u.Cart.SubtotalSavingsLabel&&(u.Cart.SubtotalSavingsLabel.TextAfterGoal||u.Cart.SubtotalSavingsLabel.TextDuringGoal)){for(var s=!1,d=u.Token,l=0;l<e.length;l++)if(e[l]===d){s=!0;break}s||(i(d,t,n,!1),e.push(d))}}if(discountNinja.LiquidData.HasSubscriptionProducts()){var g=discountNinjaContext.Settings.Checkout.SubscriptionProductsMessage;g&&n.push({Offer:null,Label:g,ProductInfo:null,Warning:!0})}return n}},discountNinja_Script_LiquidData={WaitForLiquidAsset:function(t){try{var i=void 0!==window.discountNinjaContext;if(i)t&&t();else{var n=0,e=function(){if(n++,!(i=void 0!==window.discountNinjaContext))return 150===n?discountNinja.Logging.LogErrorMessage("LiquidData.WaitForLiquidAsset","Waiting for liquid asset (limoniapps-discountninja-body/limoniapps-discountninja-context) to be returned timed out. Either the asset does not exist or it is not included in the theme.liquid file. Exiting."):setTimeout(e,100);t&&t()};e()}}catch(t){return discountNinja.Logging.LogError("LiquidData.WaitForLiquidAsset",t),""}},Cart:function(){try{return void 0!==window.discountNinjaContext&&void 0!==window.discountNinjaContext.Cart&&null!==window.discountNinjaContext.Cart&&void 0!==window.discountNinjaContext.Cart.total_price?window.discountNinjaContext.Cart:null}catch(t){discountNinja.Logging.LogError("LiquidData.Cart",t)}},CartValue:function(){try{var t=discountNinja_Script_LiquidData.Cart();return null===t?null:t.total_price}catch(t){discountNinja.Logging.LogError("LiquidData.CartValue",t)}},VariantIdsFromCart:function(){try{var t="",i=discountNinja_Script_LiquidData.Cart();if(i&&"object"==typeof i.items)for(var n=0;n<i.items.length;n++)""!==t&&(t+=","),t+=i.items[n].variant_id;return t.split(",")}catch(t){return discountNinja.Logging.LogError("LiquidData.VariantIdsFromCart",t),null}},ProductCollections:function(){try{return window.discountNinjaContext.Product?window.discountNinjaContext.Product.Collections:null}catch(t){return discountNinja.Logging.LogError("LiquidData.ProductCollections",t),null}},ProductCollectionIds:function(){try{return window.discountNinjaContext.Product?window.discountNinjaContext.Product.CollectionIds:null}catch(t){return discountNinja.Logging.LogError("LiquidData.ProductCollectionIds",t),null}},ProductDefaultVariantId:function(){try{return window.discountNinjaContext.Product?window.discountNinjaContext.Product.VariantId:null}catch(t){return discountNinja.Logging.LogError("LiquidData.ProductDefaultVariantId",t),null}},ProductTags:function(){try{return window.discountNinjaContext.Product?window.discountNinjaContext.Product.Tags:null}catch(t){return discountNinja.Logging.LogError("LiquidData.ProductDefaultVariantId",t),null}},VariantInfoFromLiquid:function(t){try{if(window.discountNinjaContext.ProductVariants)for(var i=0;i<window.discountNinjaContext.ProductVariants.length;i++)if(window.discountNinjaContext.ProductVariants[i].VariantId===parseInt(t))return window.discountNinjaContext.ProductVariants[i];return null}catch(t){return discountNinja.Logging.LogError("LiquidData.VariantInfoFromLiquid",t),null}},CompareAtPrice:function(t){try{var i=discountNinja_Script_LiquidData.VariantInfoFromLiquid(t);return null===i?null:i.CompareAtPrice/100}catch(t){return discountNinja.Logging.LogError("LiquidData.CompareAtPrice",t),null}},Price:function(t){try{var i=discountNinja_Script_LiquidData.VariantInfoFromLiquid(t);return null===i?null:i.Price/100}catch(t){return discountNinja.Logging.LogError("LiquidData.Price",t),null}},Inventory:function(t){try{var i=discountNinja_Script_LiquidData.VariantInfoFromLiquid(t);return null===i||"null"===i.Inventory?null:i.Inventory}catch(t){return discountNinja.Logging.LogError("LiquidData.Inventory",t),null}},ProductAvailable:function(t){try{return window.discountNinjaContext.Product?window.discountNinjaContext.Product.Available:null}catch(t){return discountNinja.Logging.LogError("LiquidData.ProductAvailable",t),null}},CollectionProductByHandle:function(t){try{for(var i=window.discountNinjaContext.CollectionProducts,n=0;n<i.length;n++)if(i[n].Handle===t)return i[n];return null}catch(t){return discountNinja.Logging.LogError("LiquidData.CartItemByProductHandle",t),null}},CartItemByVariantAndProperty:function(t,i,n){function e(t,i,n){try{return t.properties&&t.properties[i]===n}catch(t){return discountNinja.Logging.LogError("LiquidData.HasPropertyWithKeyAndValue",t),!1}}try{for(var o=window.discountNinjaContext.Cart.items,r=0;r<o.length;r++){var a=o[r];if(a.variant_id.toString()===t.toString()&&e(a,i,n))return a}return null}catch(t){return discountNinja.Logging.LogError("LiquidData.CartItemByVariantAndProperty",t),null}},RemovePropertiesByPrefix:function(t,i){try{for(var n in t)n.indexOf(i)>-1&&delete t[n];return t}catch(i){return discountNinja.Logging.LogError("LiquidData.RemovePropertiesByPrefix",i),t}},CartItemPropertiesAsObject:function(t,i){try{var n=discountNinja.LiquidData.CartItemByKeyAndSellingPlanId(t,i);if(null==n||void 0===n.properties)return{};var e=n.properties;if(Array.isArray(e)){for(var o={},r=0;r<e.length;r++)o[e[r].Name]=e[r].Value;return o}return e}catch(t){discountNinja.Logging.LogError("LiquidData.CartItemPropertiesAsObject",t)}},CartItemByDelegate:function(t){try{if("object"!=typeof window.discountNinjaContext||!window.discountNinjaContext.Cart||!window.discountNinjaContext.Cart.items||0===window.discountNinjaContext.Cart.items.length)return null;for(var i=window.discountNinjaContext.Cart.items,n=0;n<i.length;n++){var e=i[n];if(t(e))return e}return null}catch(t){return discountNinja.Logging.LogError("LiquidData.CartItemByDelegate",t),0}},LineNumberByKey:function(t){try{if("object"!=typeof window.discountNinjaContext||!window.discountNinjaContext.Cart||!window.discountNinjaContext.Cart.items||0===window.discountNinjaContext.Cart.items.length)return null;for(var i=window.discountNinjaContext.Cart.items,n=0;n<i.length;n++){if(i[n].key===t)return n+1}return null}catch(t){return discountNinja.Logging.LogError("LiquidData.LineNumberByKey",t),null}},CartItemsByDelegate:function(t){try{var i=[];if("object"!=typeof window.discountNinjaContext||!window.discountNinjaContext.Cart||!window.discountNinjaContext.Cart.items||0===window.discountNinjaContext.Cart.items.length)return[];for(var n=window.discountNinjaContext.Cart.items,e=0;e<n.length;e++){var o=n[e];t(o)&&i.push(o)}return i}catch(t){return discountNinja.Logging.LogError("LiquidData.CartItemsByDelegate",t),[]}},CartItemByKeyAndSellingPlanId:function(t,i){return discountNinja_Script_LiquidData.CartItemByDelegate((function(n){return n.key===t&&(!i||i===n.selling_plan_id||"object"==typeof n.selling_plan_allocation&&"object"==typeof n.selling_plan_allocation.selling_plan&&i===n.selling_plan_allocation.selling_plan.id)}))},CartItemByVariant:function(t){return discountNinja_Script_LiquidData.CartItemByDelegate((function(i){return i.variant_id&&t&&i.variant_id.toString()===t.toString()}))},CartItemByProductHandle:function(t){return discountNinja_Script_LiquidData.CartItemByDelegate((function(i){return i.handle===t}))},CartItemsByVariant:function(t){return discountNinja_Script_LiquidData.CartItemsByDelegate((function(i){return i.variant_id&&t&&i.variant_id.toString()===t.toString()}))},CartItemsByProductHandle:function(t){return discountNinja_Script_LiquidData.CartItemsByDelegate((function(i){return i.handle===t}))},CartItemsByProperty:function(t){return discountNinja_Script_LiquidData.CartItemsByDelegate((function(i){return void 0!==i.properties&&null!=i.properties&&null!=i.properties[t]}))},PriceFromCartByProductHandle:function(t){try{var i=discountNinja_Script_LiquidData.CartItemByProductHandle(t);return null===i?null:i.original_price/100}catch(t){return discountNinja.Logging.LogError("LiquidData.PriceFromCartByProductHandle",t),null}},PriceFromCartByKey:function(t,i){try{var n=discountNinja_Script_LiquidData.CartItemByKeyAndSellingPlanId(t,i);return null===n?null:n.original_price/100}catch(t){return discountNinja.Logging.LogError("LiquidData.PriceFromCartByKey",t),null}},QuantityFromCartByKey:function(t,i){try{var n=discountNinja_Script_LiquidData.CartItemByKeyAndSellingPlanId(t,i);return null===n?null:n.quantity}catch(t){return discountNinja.Logging.LogError("LiquidData.QuantityFromCartByKey",t),null}},PriceFromCart:function(t){try{var i=discountNinja_Script_LiquidData.CartItemByVariant(t);return null===i?null:i.original_price/100}catch(t){return discountNinja.Logging.LogError("LiquidData.PriceFromCart",t),null}},ProductHandleFromCart:function(t){try{var i=discountNinja_Script_LiquidData.CartItemByVariant(t);return null===i?null:i.handle}catch(t){return discountNinja.Logging.LogError("LiquidData.ProductHandleFromCart",t),null}},SubTotalPriceFromCart:function(t){try{return void 0!==window.discountNinjaContext&&"object"==typeof window.discountNinjaContext.Cart?window.discountNinjaContext.Cart.total_price/100:null}catch(t){return discountNinja.Logging.LogError("LiquidData.SubTotalPriceFromCart",t),null}},ItemIsInCollection:function(t,i){var n=discountNinja.ProductData.GetByProductHandle(t.handle);if(n){if(!i)return!1;if(i.indexOf("%")>-1){var e=discountNinja.ProductData.GetVariantData(t.handle,t.variant_id);if(e&&e.CompareAtPrice>t.original_price)return!0}var o=n.Collections;return discountNinja.Utilities.StringIsIn(i,o)}return!1},GetQuantityFromItems:function(t){function i(t){try{var i=discountNinja.DiscountedCart.DiscountedCart.items.find((function(i){return i.Key===t}));return i&&i.Bogo&&i.Bogo.QuantityLocked||0}catch(t){return 0}}try{var n=0;if(t)for(var e=0;e<t.length;e++){var o=t[e];n+=o.quantity,n-=i(o.key)}return n}catch(t){return discountNinja.Logging.LogError("LiquidData.GetQuantityFromItems",t),0}},GetOriginalLinePriceFromItems:function(t){try{var i=0;if(t)for(var n=0;n<t.length;n++)i+=(t[n].original_price||0)*t[n].quantity;return i}catch(t){return discountNinja.Logging.LogError("LiquidData.GetOriginalLinePriceFromItems",t),0}},ItemsInCartFromCollections:function(t,i,n){try{return discountNinja_Script_LiquidData.CartItemsByDelegate((function(e){return discountNinja_Script_LiquidData.ItemIsInCollection(e,t)&&(!n||!discountNinja_Script_LiquidData.ItemIsGift(e))&&(!i||!discountNinja_Script_LiquidData.ItemIsInCollection(e,i))}))}catch(t){return discountNinja.Logging.LogError("LiquidData.ItemsInCartFromCollections",t),0}},ItemsInCartFromProducts:function(t,i,n){try{return discountNinja_Script_LiquidData.CartItemsByDelegate((function(e){return discountNinja.Utilities.StringIsIn(t,e.handle)&&(!n||!discountNinja_Script_LiquidData.ItemIsGift(e))&&(!i||!discountNinja_Script_LiquidData.ItemIsInCollection(e,i))}))}catch(t){return discountNinja.Logging.LogError("LiquidData.ItemsInCartFromProducts",t),0}},ItemsInCartFromVariants:function(t,i,n){try{return discountNinja_Script_LiquidData.CartItemsByDelegate((function(e){return discountNinja.Utilities.StringIsIn(t,e.id)&&(!n||!discountNinja_Script_LiquidData.ItemIsGift(e))&&(!i||!discountNinja_Script_LiquidData.ItemIsInCollection(e,i))}))}catch(t){return discountNinja.Logging.LogError("LiquidData.ItemsInCartFromProducts",t),0}},ItemsInCart:function(t,i){try{return discountNinja_Script_LiquidData.CartItemsByDelegate((function(n){return!(i&&discountNinja_Script_LiquidData.ItemIsGift(n)||t&&discountNinja_Script_LiquidData.ItemIsInCollection(n,t))}))}catch(t){return discountNinja.Logging.LogError("LiquidData.ItemsInCart",t),0}},ItemIsGift:function(t){try{return discountNinja_Script_LiquidData.ItemHasPropertyWithPrefix(t,discountNinja.DiscountedCart.FreeGiftPrefix)}catch(t){return discountNinja.Logging.LogError("LiquidData.ItemIsGift",t),!1}},GiftItemsInCart:function(t){try{return discountNinja_Script_LiquidData.CartItemsByDelegate((function(i){return i.properties&&void 0!==i.properties[discountNinja.DiscountedCart.FreeGiftPrefix+t]}))}catch(t){return discountNinja.Logging.LogError("LiquidData.GiftItemsInCart",t),0}},NumberOfItemsInCart:function(){try{return(window.discountNinjaContext&&window.discountNinjaContext.Cart?window.discountNinjaContext.Cart.items:[]).length}catch(t){return discountNinja.Logging.LogError("LiquidData.NumberOfItemsInCart",t),0}},GetSellingPlanId:function(t){try{var i=null;return"object"==typeof t.selling_plan_allocation&&"object"==typeof t.selling_plan_allocation.selling_plan?i=t.selling_plan_allocation.selling_plan.id:void 0!==t.selling_plan_id&&(i=t.selling_plan_id),i}catch(t){return discountNinja.Logging.LogError("LiquidData.GetSellingPlanId",t),null}},CopyPropertiesExceptSplitKeys:function(t,i){try{if(!(!1!==discountNinja.Settings.GetFlag("CopyAllPropertiesWhenSplitting")))return{};var n=discountNinja_Script_LiquidData.CartItemPropertiesAsObject(t,i),e=JSON.parse(JSON.stringify(n));return e=discountNinja_Script_LiquidData.RemovePropertiesByPrefix(e,discountNinja.DiscountedCart.FreeGiftPrefix),e=discountNinja_Script_LiquidData.RemovePropertiesByPrefix(e,discountNinja.DiscountedCart.SplitRowPrefix),e=discountNinja_Script_LiquidData.RemovePropertiesByPrefix(e,discountNinja.DiscountedCart.LockedRowPrefix)}catch(t){return discountNinja.Logging.LogError("LiquidData.CopyPropertiesExceptSplitKeys",t),{}}},ItemPropertyWithPrefix:function(t,i){try{if(t&&!discountNinja.Utilities.ObjectIsEmpty(t.properties))for(var n in t.properties)if(n.indexOf(i)>-1)return n;return null}catch(t){return discountNinja.Logging.LogError("LiquidData.ItemPropertyWithPrefix",t),null}},ItemHasPropertyWithPrefix:function(t,i){return null!==discountNinja_Script_LiquidData.ItemPropertyWithPrefix(t,i)},ItemHasProperty:function(t,i){return t&&"object"==typeof t.properties&&null!==t.properties&&void 0!==t.properties[i]},ItemHasPropertyWithValue:function(t,i,n){return discountNinja_Script_LiquidData.ItemHasProperty(t,i)&&t.properties[i]===n},ItemsInCartWithoutProperty:function(t,i){try{return discountNinja_Script_LiquidData.CartItemsByDelegate((function(n){return!(discountNinja_Script_LiquidData.ItemHasPropertyWithPrefix(n,t)||i&&discountNinja_Script_LiquidData.ItemIsInCollection(n,i))}))}catch(t){return discountNinja.Logging.LogError("LiquidData.ItemsInCartWithoutProperty",t),0}},QuantityInCartFromCollections:function(t,i,n){var e=discountNinja_Script_LiquidData.ItemsInCartFromCollections(t,i,n);return discountNinja_Script_LiquidData.GetQuantityFromItems(e)},QuantityInCartFromProducts:function(t,i,n){var e=discountNinja_Script_LiquidData.ItemsInCartFromProducts(t,i,n);return discountNinja_Script_LiquidData.GetQuantityFromItems(e)},QuantityInCartFromVariants:function(t,i,n){var e=discountNinja_Script_LiquidData.ItemsInCartFromVariants(t,i,n);return discountNinja_Script_LiquidData.GetQuantityFromItems(e)},QuantityInCart:function(t,i){var n=discountNinja_Script_LiquidData.ItemsInCart(t,i);return discountNinja_Script_LiquidData.GetQuantityFromItems(n)},QuantityInCartExcludingGifts:function(t){var i=discountNinja_Script_LiquidData.ItemsInCartWithoutProperty(discountNinja.DiscountedCart.FreeGiftPrefix,t);return discountNinja_Script_LiquidData.GetQuantityFromItems(i)},ValueInCartFromCollections:function(t,i,n,e){var o=e?0:discountNinja_Script_DiscountedCart.TotalCartLevelDiscountInCents(null,null,t,i,n),r=discountNinja_Script_LiquidData.ItemsInCartFromCollections(t,i,n),a=discountNinja_Script_LiquidData.GetOriginalLinePriceFromItems(r);return Math.max(0,a-o)},ValueInCartFromProducts:function(t,i,n,e){var o=e?0:discountNinja_Script_DiscountedCart.TotalCartLevelDiscountInCents(null,t,null,i,n),r=discountNinja_Script_LiquidData.ItemsInCartFromProducts(t,i,n),a=discountNinja_Script_LiquidData.GetOriginalLinePriceFromItems(r);return Math.max(0,a-o)},ValueInCartFromVariants:function(t,i,n,e){var o=e?0:discountNinja_Script_DiscountedCart.TotalCartLevelDiscountInCents(t,null,null,i,n),r=discountNinja_Script_LiquidData.ItemsInCartFromVariants(t,i,n),a=discountNinja_Script_LiquidData.GetOriginalLinePriceFromItems(r);return Math.max(0,a-o)},ValueInCart:function(t,i,n){var e=n?0:discountNinja_Script_DiscountedCart.TotalCartLevelDiscountInCents(null,null,null,t,i),o=discountNinja_Script_LiquidData.ItemsInCart(t,i),r=discountNinja_Script_LiquidData.GetOriginalLinePriceFromItems(o);return Math.max(0,r-e)},HasSubscriptionProducts:function(){return function(){try{if("object"==typeof BOLD&&"object"==typeof BOLD.recurring_orders){var t=discountNinja.LiquidData.CartItemsByProperty("frequency_num");return t&&t.length>0}return!1}catch(t){return discountNinja.Logging.LogError("HasBoldSubscriptionProducts",t),!1}}()||function(){try{if(!0===discountNinja.Settings.Settings.ExcludeSubscriptionProducts&&discountNinja.DiscountedCart.DiscountedCart&&discountNinja.DiscountedCart.DiscountedCart.items)for(var t=0;t<discountNinja.DiscountedCart.DiscountedCart.items.length;t++)if(discountNinja.DiscountedCart.DiscountedCart.items[t].IsSubscriptionProduct)return!0;return!1}catch(t){return discountNinja.Logging.LogError("HasMarkedSubscriptionProductsInDiscountedCart",t),!1}}()}},discountNinja_Script_Offer={Offers:null,AllOffers:null,Triggers:null,PrimaryOffer:null,Source:null,SourceReason:null,IsLinkedToDiscountCode:function(t,i){if(!t||null===t.Tiers)return!1;for(var n=0;n<t.Tiers.length;n++)if(void 0!==t.Tiers[n].DiscountCode&&null!==t.Tiers[n].DiscountCode&&t.Tiers[n].DiscountCode.Code===i)return!0},GetOfferByToken:function(t){if(null===t)return null;var i=discountNinja_Script_Offer.AllOffers;return i&&i.find((function(i){return i.Token===t}))||null},SetPrimaryOffer:function(){try{if(discountNinja_Script_Offer.PrimaryOffer=null,discountNinja.Environment.Shopify.IsProductPage()){var t=discountNinja.Environment.Shopify.ProductHandle(),i=discountNinja.Environment.Shopify.VariantData(),n=i?i.Id:null,e=discountNinja.LiquidData.Inventory(n),o=discountNinja.LiquidData.Price(n),r=discountNinja.LiquidData.CompareAtPrice(n),a=discountNinja.LiquidData.ProductCollections();discountNinja_Script_Offer.PrimaryOffer=discountNinja_Script_Offer.GetOfferForProduct(t,n,a,e,o,r,!1,!0)}if(null===discountNinja_Script_Offer.PrimaryOffer){var c=discountNinja_Script_Offer.Offers;if(null===c)return;for(var u=[],s=0;s<c.length;s++){var d=c[s];discountNinja_Script_Offer.IsOfferAccepted(d.Token,d.Frequency)&&u.push(d)}if(0===u.length);else if(1===u.length)discountNinja_Script_Offer.PrimaryOffer=u[0];else{for(var l=[],g=0;g<u.length;g++){d=u[g];l.push(d)}if(0===l.length)discountNinja_Script_Offer.PrimaryOffer=u[0];else if(1===l.length)discountNinja_Script_Offer.PrimaryOffer=l[0];else{for(var f=0;f<l.length;f++){var p=l[f];if(!discountNinja_Script_Offer.IsOfferAccepted(p.Token,p.Frequency))return void(discountNinja_Script_Offer.PrimaryOffer=p)}discountNinja_Script_Offer.PrimaryOffer=l[0]}}}}catch(t){discountNinja.Logging.LogError("Offer.SetPrimaryOffer",t)}},CombinePromotionsFromTokenAndDiscountCode:function(t,i){var n=discountNinja.DiscountCodeTrigger.Get();return{Offers:function(t,i){try{t||(t=[]);for(var n=0;n<i.length;n++)if(i[n].valid)for(var e=!1,o=0;o<i[n].trigger.Offers.length;o++){for(var r=0;r<t.length;r++)if(t[r].Token===i[n].trigger.Offers[o].Token){e=!0;break}e||t.push(i[n].trigger.Offers[o])}var a=[];for(o=0;o<t.length;o++){var c=!1,u=t[o];if(u.Token.endsWith("-offer-token")){for(r=0;r<i.length;r++)for(var s=0;s<i[r].trigger.Offers.length;s++)if(i[r].trigger.Offers[s].Token===u.Token){c=!0;break}}else c=!0;c&&a.push(u)}return a}catch(t){return discountNinja.Logging.LogError("Offer.CombineOffersFromTokenAndDiscountCode",t),null}}(t,n),Triggers:function(t,i){try{t||(t=[]);for(var n=0;n<i.length;n++)if(i[n].valid)for(var e=!1,o=0;o<i[n].trigger.Triggers.length;o++){for(var r=0;r<t.length;r++)if(t[r].Token===i[n].trigger.Triggers[o].Token){e=!0;break}if(!e){var a=i[n].trigger.Triggers[o];a.Offers=[];for(r=0;r<i[n].trigger.Offers.length;r++)a.Offers.push(i[n].trigger.Offers[r].Token);t.push(a)}}for(var c=[],u=0;u<t.length;u++){var s=!1,d=t[u];if(d.Token.endsWith("-trigger-token")){for(var l=0;l<i.length;l++)for(var g=0;g<i[l].trigger.Triggers.length;g++)if(i[l].trigger.Triggers[g].Token===d.Token){s=!0;break}}else s=!0;s&&c.push(d)}return c}catch(t){return discountNinja.Logging.LogError("Offer.CombineTriggersFromTokenAndDiscountCode",t),null}}(i,n)}},GetExclusiveTrigger:function(t){try{if(!t)return null;for(var i=null,n=null,e=0;e<t.length;e++){var o=t[e];o.Stacking&&!o.Stacking.Combine&&!0===o.Triggered&&(null===i||i>o.Stacking.Priority)&&(n=o,i=o.Stacking.Priority)}return n}catch(t){return discountNinja.Logging.LogError("Offer.GetExclusiveTrigger",t),null}},FilterPromotions:function(){try{discountNinja_Script_Offer.Triggers=function(t){try{var i=discountNinja_Script_Offer.GetExclusiveTrigger(t);return null!==i?[i]:t}catch(t){return discountNinja.Logging.LogError("Offer.HandleExclusiveTrigger",t),null}}(function(t){try{if(!t)return null;for(var i=[],n=0;n<t.length;n++){var e=t[n];discountNinja_Script_Offer.TriggerIsApplicable(e)&&i.push(e)}return i}catch(t){return discountNinja.Logging.LogError("Offer.FilterTriggers",t),null}}(discountNinja_Script_Offer.Triggers)),discountNinja_Script_Offer.Offers=function(t){try{if(!t)return null;for(var i=[],n=0;n<t.length;n++){var e=t[n];discountNinja_Script_Offer.OfferIsApplicable(e)&&i.push(e)}return i}catch(t){return discountNinja.Logging.LogError("Offer.FilterOffers",t),null}}(discountNinja_Script_Offer.Offers)}catch(t){return discountNinja.Logging.LogError("Offer.FilterPromotions",t),null}},ConvertRates:function(t){try{if(!t)return null;var i=discountNinjaContext.PresentmentCurrency,n=discountNinjaContext.ShopCurrency;if(!i||!n)return t;for(var e=0;e<t.length;e++)for(var o=t[e],r=0;r<o.Tiers.length;r++){var a=o.Tiers[r];a.Prerequisite&&a.Prerequisite.MinimumAmount&&(a.Prerequisite.MinimumAmount=n===i?a.Prerequisite.MinimumAmountBaseCurrency:discountNinja.Currency.Convert(a.Prerequisite.MinimumAmountBaseCurrency,i,"exact")),a.Prerequisite&&a.Prerequisite.MaximumAmount&&(a.Prerequisite.MaximumAmount=n===i?a.Prerequisite.MaximumAmountBaseCurrency:discountNinja.Currency.Convert(a.Prerequisite.MaximumAmountBaseCurrency,i,"exact")),a.Entitlement&&a.Entitlement.Amount&&(a.Entitlement.Amount=n===i?a.Entitlement.AmountBaseCurrency:discountNinja.Currency.Convert(a.Entitlement.AmountBaseCurrency,i,"exact"))}return t}catch(i){return discountNinja.Logging.LogError("Offer.ConvertRates",i),t}},LoadApplicableOffers:function(t,i){try{var n=discountNinja.Token.GetNonAutomaticTokenOrPromotionCode(),e=n.Token,o=n.PromotionCode,r=function(t){return(t?"token-"+t:"anytoken")+"-"+discountNinja_Script_DiscountCode.GetApplicationCounter()+"-"+discountNinjaContext.Status}(e+o);!function(t,i,n,e,o){function r(t,i){return new Promise((e=>{try{discountNinja_Script_Offer.AllOffers=[],discountNinja_Script_Offer.Offers=[],discountNinja_Script_Offer.Triggers=[],discountNinja_Script_Offer.PrimaryOffer=[],discountNinja.Settings.SettingsAreValid(discountNinja.Settings.Settings)||(discountNinja.Logging.LogWarning("Settings invalid",!0,!1),e()),discountNinja_Script_Offer.AllOffers=t.Offers,discountNinja_Script_Offer.Triggers=t.Triggers,discountNinja_Script_Offer.FilterPromotions(),discountNinja_Script_Offer.AllOffers=discountNinja_Script_Offer.ConvertRates(discountNinja_Script_Offer.AllOffers),discountNinja_Script_Offer.AllOffers&&0!==discountNinja_Script_Offer.AllOffers.length||e(),discountNinja_Script_Offer.Triggers&&0!==discountNinja_Script_Offer.Triggers.length||e(),i?e():function(t){try{return new Promise((i=>{var e="offerinfo-"+n;discountNinja.Cache.SessionSet(e+"-valid-in-session",!0),discountNinja.Cache.IndexedDbSet(e,t).then((function(){i()}))}))}catch(t){discountNinja.Logging.LogError("Offer.SavePromotionInfoToCache",t)}}(t).then((function(){discountNinja.DiscountedCart.IsDirty=!0,discountNinja.StickyBar.Clear(),discountNinja.Notification.Clear(),e()}))}catch(t){discountNinja.Logging.LogError("Offer.ProcessPromotionInfo",t),e()}}))}function a(t){return!1!==t&&"false"!==t&&null!=t&&void 0!==t.Offers&&null!==t.Offers&&void 0!==t.Offers&&null!==t.Offers&&void 0!==t.Triggers&&null!==t.Triggers&&0!==t.Offers.length&&0!==t.Triggers.length}function c(c,u,s){try{discountNinja.Cache.SessionSet("offerinfo-requested-"+n,!0),!0===s?(c.Scope="device",discountNinja_Script_Offer.Source="CDN"):!0===u?discountNinja_Script_Offer.Source="Cache":(c.Scope="session",discountNinja_Script_Offer.Source="Server"),a(c)||(c={Scope:"session",Status:discountNinjaContext.Status,Offers:[],Triggers:[]},t===discountNinja.Token.GetNonAutomaticTokenFromCache()&&discountNinja.Token.RemoveNonAutomaticTokenFromCache());var d=discountNinja_Script_Offer.CombinePromotionsFromTokenAndDiscountCode(c.Offers,c.Triggers);c.Offers=d.Offers,c.Triggers=d.Triggers,r(c,u).then((function(){try{discountNinja.Trigger.TrackExitIntent(),null!==t&&""!==t&&discountNinja.Token.SetNonAutomaticTokenToCache(t),null!==i&&""!==i&&discountNinja.Token.SetNonAutomaticPromotionCodeToCache(i),discountNinja.Token.RemoveSavedTokens(),!u&&c.Version&&discountNinja.Cache.SessionSet("offersVersion",c.Version),discountNinja.Events.Publish("promotions:loaded",[discountNinja.Offer.AllOffers]),e&&e(c)}catch(t){return discountNinja.Logging.LogError("Offer.PromotionInfoReady",t),o?o():void 0}}))}catch(t){return discountNinja.Logging.LogError("Offer.PromotionInfoReady",t),o?o():void 0}}function u(t){a(t)?c(t,!1,!0):s()}function s(){try{var e=null===discountNinja.Cache.SessionGet("offerinfo-requested-"+n),r=discountNinja.Core.Shop,a=discountNinja.Utilities.GetReferrer(),u=function(t,i,n,e,o){try{var r={};t&&(r.shop=encodeURIComponent(t)),i&&(r.token=encodeURIComponent(i)),n&&(r.promotionCode=encodeURIComponent(n)),null!==discountNinja.TestMode.TestMode()&&(r.testMode=discountNinja.TestMode.TestMode(),r.matchByTokenOnly=discountNinja.TestMode.MatchByTokenOnly,discountNinja.TestMode.TestModeToken()&&(r.testModeToken=discountNinja.TestMode.TestModeToken())),null!==e&&(r.firstRequest=e),o&&(r.referrer=o),r.version=discountNinja.Core.Version,r.status=discountNinjaContext.Status;var a=discountNinja.DeviceId.Get();return r.deviceId=a,r.m=a+"-"+discountNinja.DateTime.UnixTimestamp(),r.f="7.4",r.countryISOCode=discountNinjaContext.CountryISOCode,r}catch(t){return discountNinja.Logging.LogError("Offer.LoadPromotionInfo.BuildParameters",t),null}}(r,t,i,e,a),s=discountNinja.Api.Endpoint("promotion","5.1")+"/list";if(discountNinja.XmlHttpRequest.UseFetch()){var d=discountNinja.XmlHttpRequest.CreateQueryStringFromParameters(u,!0,!1);discountNinja.XmlHttpRequest.Fetch(s+d,"get","text/plain;charset=UTF-8",null,!1,!1,c,null)}else discountNinja.XmlHttpRequest.Send(s,u,null,"get",!0,!0,!0,c)}catch(t){discountNinja.Logging.LogError("Offer.GetApplicablePromotionsFromServer",t),o()}}try{discountNinja.Cache.SessionRemove(discountNinja.Checkout.Shopify.CheckoutData),new Promise((t=>{try{var i="offerinfo-"+n;!0===discountNinja.TestMode.TestMode()?t(null):discountNinja.Cache.IndexedDbGet(i).then((function(n){var e=null==n?null:n;if(null===e)t(null);else{var o=1*e.Status==1*discountNinjaContext.Status,r=o;r&&"session"===e.Scope&&(r="true"===discountNinja.Cache.SessionGet(i+"-valid-in-session")),r?t(e):o?t(null):discountNinja.Cache.IndexedDbClear().then((function(){t(null)}))}}))}catch(i){discountNinja.Logging.LogError("Offer.GetPromotionInfoFromCache",i),t(null)}})).then((function(i){null!==i?discountNinja.BrowsingContext.GetCountryFromBrowsingContext(!1,(function(){c(i,!0,!1)})):discountNinja.BrowsingContext.GetCountryFromBrowsingContext(!1,(function(){!function(){try{if(!0!==discountNinja.TestMode.TestMode()&&!1!==discountNinja.Settings.GetFlag("UseCDN")){var i=discountNinja.Core.Shop,n=discountNinja.Api.CDN()+"/"+encodeURIComponent(i)+"-"+encodeURIComponent(t)+"-"+discountNinjaContext.Status+".json";discountNinja.XmlHttpRequest.UseFetch()?discountNinja.XmlHttpRequest.Fetch(n,"get","text/plain;charset=UTF-8",null,!1,!1,u,s):discountNinja.XmlHttpRequest.Send(n,null,null,"get",!0,!1,!1,u,s,1,1)}else s()}catch(t){discountNinja.Logging.LogError("Offer.GetApplicablePromotionsFromServer",t),o()}}()}))}))}catch(t){discountNinja.Logging.LogError("Offer.LoadApplicableOffersInner",t),o()}}(e,o,r,t,i)}catch(t){discountNinja.Logging.LogError("Offer.LoadPromotionInfo",t),i()}},TriggerIsApplicable:function(t){return!0},OfferIsApplicable:function(t){try{if(!t)return!1;if(t.Tiers[0]&&t.Tiers[0].Entitlement&&0===t.Tiers[0].Entitlement.Percentage)return!1;var i=!1;if(discountNinja_Script_Offer.Triggers)for(var n=0;n<discountNinja_Script_Offer.Triggers.length;n++){var e=discountNinja_Script_Offer.Triggers[n];if(!0===e.Triggered&&t.TriggeredByTrigger&&t.TriggeredByTrigger.Token===e.Token){i=!0;break}}return!!i&&!!function(t){try{var i=discountNinja.DiscountedCart.DiscountedCart;if(null===i)return!0;if(i.AppliedPromotions)for(var n=0;n<i.AppliedPromotions.length;n++)if(t.TriggeredByTrigger&&i.AppliedPromotions[n].TriggerToken===t.TriggeredByTrigger.Token)return!0;return!(!1===t.Stacking.CombineWithPromotionCodes&&!0===i.HasPromotionCodes||!1===t.Stacking.CombineWithShopifyDiscountCodes&&!0===i.HasShopifyDiscountCodes)}catch(t){return discountNinja.Logging.LogError("Offer.OfferCanBeCombinedWithCart",t),!0}}(t)}catch(t){return discountNinja.Logging.LogError("Offer.PromotionIsApplicable",t),null}},OfferIsExcluded:function(t){if(t.Exclusions){var i=0;t.Exclusions.Collections?i=discountNinja.LiquidData.QuantityInCartFromCollections(t.Exclusions.Collections):"*"===t.Exclusions.Products?i=discountNinjaContext&&discountNinjaContext.Cart?discountNinjaContext.Cart.item_count:0:t.Exclusions.Products&&(i=discountNinja.LiquidData.QuantityInCartFromProducts(t.Exclusions.Products));var n=t.Exclusions.Minimum;if(n&&i&&i>=n)return!0;var e=t.Exclusions.Maximum;if(e&&i&&i<=e)return!0}return!1},GetOfferservedInSession:function(t,i){return discountNinja.Cache.SessionGet("offer-served-session-"+t+"-"+i)},SetOfferservedInSession:function(t,i,n){discountNinja.Cache.SessionSet("offer-served-session-"+t+"-"+i,n)},GetOfferservedOnDevice:function(t,i){return discountNinja.Cache.LocalGet("offer-served-device-"+t+"-"+i)},SetOfferservedOnDevice:function(t,i,n){discountNinja.Cache.LocalSet("offer-served-device-"+t+"-"+i,n)},IsOfferAccepted:function(t,i){return"onceperdevice"===i?"true"===discountNinja.Cache.LocalGet("offer-accepted-"+t):"true"===discountNinja.Cache.SessionGet("offer-accepted-"+t)},SetPromotionAccepted:function(t,i,n){"onceperdevice"===i?discountNinja.Cache.LocalSet("offer-accepted-"+t,n):(discountNinja.Cache.LocalSet("offer-accepted-"+t,""),discountNinja.Cache.SessionSet("offer-accepted-"+t,n))},SetPromotionExpired:function(t,i){discountNinja.Cache.LocalSet("offer-expired-"+t,"true")},ExpireOffersAccepted:function(){if(discountNinja_Script_Offer.AllOffers)for(var t=0;t<discountNinja_Script_Offer.AllOffers.length;t++)discountNinja_Script_Offer.SetPromotionExpired(discountNinja_Script_Offer.AllOffers[t].Token)},GetPromotionPriceRuleId:function(t){t||(t=discountNinja_Script_Offer.PrimaryOffer);var i=t?discountNinja.DiscountTier.GetCurrentDiscountTier(t):null;return i?i.DiscountCode.PriceRuleId:null},GetPromotionPriceRuleTitle:function(t){t||(t=discountNinja_Script_Offer.PrimaryOffer);var i=t?discountNinja.DiscountTier.GetCurrentDiscountTier(t):null;return i?i.DiscountCode.PriceRuleTitle:null},GetPromotionDiscountCode:function(t){t||(t=discountNinja_Script_Offer.PrimaryOffer);var i=t?discountNinja.DiscountTier.GetCurrentDiscountTier(t):null;return i?i.DiscountCode.Code:null},PromotionForProductCacheKey:"OfferForProduct-v3.1",PromotionForCartItemCacheKey:"OfferForCartItem-v3.1",ClearPromotionForProductCache:function(){discountNinja.Cache.SessionSet(discountNinja_Script_Offer.PromotionForProductCacheKey,null),discountNinja.Cache.SessionSet(discountNinja_Script_Offer.PromotionForCartItemCacheKey,null)},GetOfferDataForPrerequisiteProduct:function(t,i,n,e,o,r,a,c,u,s){try{if(null==t)return discountNinja.Logging.LogWarning("No product handle passed",!0,!1),null;var d=discountNinja_Script_Offer.Offers;return d?discountNinja_Script_Offer.GetBestApplicableOfferNumberInternal(d,t,i,n,e,o,r,a,!1,c,!1,!0,!0,!1,u,s,!1,!1,!1,!1,!1):null}catch(t){return discountNinja.Logging.LogError("Offer.GetOfferDataForPrerequisiteProduct",t),null}},GetOfferDataForProduct:function(t,i,n,e,o,r,a,c,u,s,d,l){try{if(null==t)return discountNinja.Logging.LogWarning("No product handle passed",!0,!1),null;var g=discountNinja_Script_Offer.Offers;return g?(applicableOfferData=discountNinja_Script_Offer.GetBestApplicableOfferNumberInternal(g,t,i,n,e,o,r,a,!1,c,!0,!1,!0,u,s,d,!0,!1,!1,!1,l),null===applicableOfferData.Applicable&&null===applicableOfferData.ApplicableNoTier?null:applicableOfferData):null}catch(t){return discountNinja.Logging.LogError("Offer.GetOfferDataForProduct",t),null}},GetOfferForProduct:function(t,i,n,e,o,r,a,c){try{var u=discountNinja_Script_Offer.GetOfferDataForProduct(t,i,n,e,o,r,a,c);return null===u||null===u.Applicable?null:discountNinja_Script_Offer.GetOfferByToken(u.Applicable)}catch(t){return discountNinja.Logging.LogError("Offer.GetOfferForProduct",t),null}},GetOfferForCartItem:function(t,i,n,e,o,r,a,c,u){try{if(!t)return null;var s=discountNinja_Script_Offer.GetBestApplicableOfferNumberInternal(t,i,n,e,o,r,a,!1,!0,!0,!0,!1,!1,c,!1,!1,!0,!1,u,!0,!1);return applicableOfferToken=s?s.Applicable:null,null===applicableOfferToken?null:discountNinja_Script_Offer.GetOfferByToken(applicableOfferToken)}catch(t){return discountNinja.Logging.LogError("Offer.GetOfferForCartItem",t),null}},OfferIsValidForProduct:function(t,i,n,e,o,r,a,c,u,s){try{if("line_item"!==t.Entitlement.TargetType)return!1;if("each"!==t.Entitlement.AllocationMethod&&!0!==s&&(!r||"percentage"!==t.Entitlement.ValueType))return!1;if(a&&t.Entitlement.ExcludeCollectionHandles&&t.Entitlement.ExcludeCollectionHandles.indexOf("%")>-1&&c>u)return!1;if(discountNinja.Utilities.StringIsIn(e,t.Entitlement.ExcludeCollectionHandles))return!1;if("collection"===t.Entitlement.EntitledItemType){if(!discountNinja.Utilities.StringIsIn(e,t.Entitlement.EntitledCollectionHandles))return!1}else if("product"===t.Entitlement.EntitledItemType||"variant"===t.Entitlement.EntitledItemType){if(t.Entitlement.EntitledVariantIds&&i){if(!discountNinja.Utilities.StringIsIn(t.Entitlement.EntitledVariantIds,i))return!1}else if(!discountNinja.Utilities.StringIsIn(t.Entitlement.EntitledProductHandles,n))return!1}else if("site"!==t.Entitlement.EntitledItemType)return discountNinja.Logging.LogErrorMessage("Offer.OfferIsValidForProduct","TargetType unknown"),!1;return!0}catch(t){return discountNinja.Logging.LogError("Offer.OfferIsValidForProduct",t),!1}},GetBestApplicableOfferNumberInternal:function(t,i,n,e,o,r,a,c,u,s,d,l,g,f,p,N,j,C,m,S,h){function _(t,i,n){try{var e=t.Entitlement.ValueType,o=100*i.Amount,r=i.Percentage,a=discountNinja.Settings.Settings.Currency,c=a.RoundPrices,u=a.RoundToCents,s=0;if("fixed_amount"===e?s=n-o:"percentage"===e?s=parseFloat((n-Math.floor(n*r)/100).toFixed(4)):"fixed_price"===e&&(s=o/i.Units),s<0&&(s=0),c){var d=100*s;if(d>0)d=100*Math.floor(d/100)+u;s=Math.round(d)/100}return Math.round(100*s)/100}catch(t){discountNinja.Logging.LogError("Offer.TestDiscountedPrice",t)}}try{for(var y=null,v=null,P=null,T=null,L=0;L<t.length;L++){var D=t[L],E=discountNinja_Script_Offer.IsApplicableOffer(D,i,n,e,o,r,a,c,u,s,d,l,g,f,p,N,j,C,m,S,h);if(null===E)return!1;if(E.Applicable)if(E.MustTestPrice){var I=_(D,discountNinja.DiscountTier.GetPercentageAmountFromDiscountTier(E.Tier),r);(null===P||I<P)&&(y=L,P=I,T=E.Tier.Level-1)}else y=L;else E.ApplicableNoTier&&(v=L)}return{Applicable:null===y?null:t[y].Token,ApplicableNoTier:null===v?null:t[v].Token,ApplicableTier:T}}catch(t){return discountNinja.Logging.LogError("Offer.GetBestApplicableOfferNumberInternal",t),null}},IsApplicableOffer:function(t,i,n,e,o,r,a,c,u,s,d,l,g,f,p,N,j,C,m,S,h){try{var _=!1,y=!1,v=!1,P=null,T=!0===p&&!t.Badge,L=!0===N&&!t.PromotionCard,D=!0===N;if(!T&&!L&&discountNinja_Script_Offer.OfferIsApplicable(t)&&!discountNinja_Script_Offer.OfferIsExcluded(t)&&(!m||!t.Entitlement||void 0===t.Entitlement.ExcludeSubscriptionProducts||!1===t.Entitlement.ExcludeSubscriptionProducts)&&(!f||f&&!1!==t.UpdatePriceProductPage)&&(!d||discountNinja_Script_Offer.OfferIsValidForProduct(t,n,i,e,o,g,s,a,r,D))&&(!l||function(t,i,n,e){try{if(discountNinja.Utilities.StringIsIn(e,t.Prerequisite.PrerequisiteExcludeCollections))return!1;if(t.Prerequisite.PrerequisiteCollections){if(discountNinja.Utilities.StringIsIn(e,t.Prerequisite.PrerequisiteCollections))return!0}else if(t.Prerequisite.PrerequisiteProducts){if(discountNinja.Utilities.StringIsIn(i,t.Prerequisite.PrerequisiteProducts))return!0}else if(t.Prerequisite.PrerequisiteProductVariants&&discountNinja.Utilities.StringIsIn(n,t.Prerequisite.PrerequisiteProductVariants))return!0;return!1}catch(t){return discountNinja.Logging.LogError("Offer.ProductIsPrerequisiteFor",t),!1}}(t,i,n,e))&&discountNinja_Script_Offer.IsOfferAccepted(t.Token,t.Frequency))if(d){if(P=discountNinja.DiscountTier.GetCurrentDiscountTier(t,j,C)){if(function(t,i,n){if(N&&!1!==discountNinja.Settings.GetFlag("HideProductBannerIfOverallocated"))return!0;if(p&&!0===discountNinja.Settings.GetFlag("ShowCollectionBadgeIfOverallocated"))return!0;var e=discountNinja.Prerequisite.EntitledQuantityInfo(t,i),o=discountNinja.Set.ForTier(t,i);return!e.HasEntitledQuantity||o.Current.Complete&&o.Current.Required>0||e.Entitled.DeltaWithCart>0||n&&e.Entitled.NotAttributed>0||e.HasEntitledQuantity&&!e.SupportsMultipleSets&&!e.Entitled.MaximumReached}(t,P,u)&&(_=!0,v=!0),"fixed_price"===t.Entitlement.ValueType){var E=discountNinja.ProductData.GetByProductHandle(i,!1);if(E){var I=E.Price,O=discountNinja.ProductData.GetVariantData(i,n);null!==O&&null!==O.Price&&(I=O.Price),100*(P.Entitlement.Amount/P.Entitlement.Units)>I&&(_=!1)}}}else h||!0===p&&t.Badge&&!0===t.Badge.Announce?(_=!0,h&&(v=!0,P=t.Tiers[0])):!0===p&&t.Badge&&!1===t.Badge.Announce||(y=!0);if(N){var A=t&&t.PromotionCard?discountNinja.TextSettings.GetText(t.PromotionCard.ProductPageText,t):null;discountNinja.TextSettings.IsEmpty(A)&&(_=!1,y=!1)}if(S&&_){var k=discountNinja.Prerequisite.EntitledQuantityInfo(t,P);k.HasEntitledQuantity&&k.Entitled.Attributed+k.Entitled.NotAttributed===0&&(_=!1,y=!0)}}else if(l&&(!0===p&&t.Badge&&!1===t.Badge.Announce||(_=(!0===p&&t.Badge&&t.Badge.Announce,!0)),N)){A=t&&t.PromotionCard?discountNinja.TextSettings.GetText(t.PromotionCard.PrerequisiteProductPageText,t):null;discountNinja.TextSettings.IsEmpty(A)&&(_=!1,y=!1)}return{Applicable:_,MustTestPrice:v,Tier:P,ApplicableNoTier:y,Token:t.Token}}catch(t){return discountNinja.Logging.LogError("Offer.IsApplicableOffer",t),null}},GetApplicableOffersForBuildingBlock:function(t,i,n){try{var e=[];if(null===i)return e;for(var o=0;o<i.length;o++){var r=i[o];("productbanner"!==t||r.PromotionCard)&&(("collectionbadge"!==t||r.Badge)&&discountNinja_Script_Offer.OfferIsApplicable(r)&&!discountNinja_Script_Offer.OfferIsExcluded(r)&&(!n||n&&!1!==r.UpdatePriceProductPage)&&discountNinja_Script_Offer.IsOfferAccepted(r.Token,r.Frequency)&&e.push(r))}return e}catch(t){return discountNinja.Logging.LogError("Offer.GetApplicableOffersForBuildingBlock",t),[]}},GetFromCache:function(t){try{var i=discountNinja.Cache.SessionGet("offer-data-"+t);return"undefined"===i?[]:JSON.parse(i)}catch(t){return discountNinja.Logging.LogError("Offer.GetFromCache",t),null}},SaveToCache:function(t){try{discountNinja.Cache.SessionSet("offer-data-"+t.Token,JSON.stringify(t))}catch(t){discountNinja.Logging.LogError("Offer.SaveToCache",t)}},RemoveFromCache:function(t){try{discountNinja.Cache.SessionRemove("offer-data-"+t)}catch(t){return discountNinja.Logging.LogError("Offer.RemoveFromCache",t),null}},Stop:function(t){try{discountNinja.DiscountCode.RemoveFromCacheByToken(t),discountNinja.Notification.Remove(t),discountNinja.PopUp.Hide(t),discountNinja.StickyBar.Remove(t),discountNinja.DynamicPricing.Show(!1),discountNinja_Script_Offer.SetPromotionExpired(t)}catch(t){discountNinja.Logging.LogError("Offer.Stop",t)}},UnApply:function(t){try{discountNinja.DiscountCode.RemoveFromCacheByToken(t)}catch(t){discountNinja.Logging.LogError("Offer.UnApply",t)}},ReEvaluate:function(){try{discountNinja.DiscountCode.UndoInjectDiscountCodesInHtml(),discountNinja.ShortCode.HideShortcodePlaceholders(),discountNinja.Notification.Clear(),discountNinja.Notification.Hide(!1),discountNinja.StickyBar.Clear(),discountNinja.StickyBar.Hide(!1);var t=discountNinja_Script_Offer.PrimaryOffer;t&&discountNinja.PopUp.Hide(t.Token),discountNinja.Utilities.jQuery()(".limoniapps-discountninja-cart-promotionsummary").html(""),discountNinja.DynamicPricing.Show(!1),discountNinja_Script_Offer.ExpireOffersAccepted(),discountNinja.Cache.SessionRemove(discountNinja.Checkout.Shopify.CheckoutData),discountNinja.DiscountedCart.IsDirty=!0,discountNinja.PromotionFlow.StartFlow(),discountNinja.PromotionFlow.StopFlow()}catch(t){discountNinja.Logging.LogError("Offer.ReEvaluate",t)}},GetTier:function(t,i){try{return t.Tiers.length>i?offers.Tiers[i]:null}catch(t){return discountNinja.Logging.LogError("Offer.GetTier",t),null}},GetTriggerTokenForOffer:function(t){try{if(!discountNinja_Script_Offer.Triggers)return null;for(var i=0;i<discountNinja_Script_Offer.Triggers.length;i++)for(var n=discountNinja_Script_Offer.Triggers[i],e=0;e<n.Offers.length;e++)if(n.Offers[e]===t)return n.Token;return null}catch(t){return discountNinja.Logging.LogError("Offer.GetTriggerTokenForOffer",t),null}},PrerequisiteItemsCartValue:function(t){try{var i=0,n=!0;return t.Prerequisite&&!0===t.Prerequisite.AfterDiscount?"*"===t.Prerequisite.PrerequisiteCollections?i=discountNinja.DiscountedCart.ValueInDiscountedCart(t.Prerequisite.PrerequisiteExcludeCollections,n,t.Token):t.Prerequisite.PrerequisiteCollections?i=discountNinja.DiscountedCart.ValueInDiscountedCartFromCollections(t.Prerequisite.PrerequisiteCollections,t.Prerequisite.PrerequisiteExcludeCollections,n,t.Token):t.Prerequisite.PrerequisiteProducts?i=discountNinja.DiscountedCart.ValueInDiscountedCartFromProducts(t.Prerequisite.PrerequisiteProducts,t.Prerequisite.PrerequisiteExcludeCollections,n,t.Token):t.Prerequisite.PrerequisiteProductVariants&&(i=discountNinja.DiscountedCart.ValueInDiscountedCartFromVariants(t.Prerequisite.PrerequisiteProductVariants,t.Prerequisite.PrerequisiteExcludeCollections,n,t.Token)):t.Prerequisite&&("*"===t.Prerequisite.PrerequisiteCollections?i=discountNinja.LiquidData.ValueInCart(t.Prerequisite.PrerequisiteExcludeCollections,n,!0):t.Prerequisite.PrerequisiteCollections?i=discountNinja.LiquidData.ValueInCartFromCollections(t.Prerequisite.PrerequisiteCollections,t.Prerequisite.PrerequisiteExcludeCollections,n,!0):t.Prerequisite.PrerequisiteProducts?i=discountNinja.LiquidData.ValueInCartFromProducts(t.Prerequisite.PrerequisiteProducts,t.Prerequisite.PrerequisiteExcludeCollections,n,!0):t.Prerequisite.PrerequisiteProductVariants&&(i=discountNinja.LiquidData.ValueInCartFromVariants(t.Prerequisite.PrerequisiteProductVariants,t.Prerequisite.PrerequisiteExcludeCollections,n,!0))),i}catch(t){return discountNinja.Logging.LogError("Offer.PrerequisiteItemsCartValue",t),0}},EligibleItems:function(t,i){try{var n=t.Entitlement,e=n.EntitledItemType;if(void 0===i&&(i=!0),"site"===e&&"*"===n.EntitledProductHandles)return discountNinja.DiscountedCart.ItemsInDiscountedCart(n.ExcludeCollectionHandles,i);if("collection"===e&&n.EntitledCollectionHandles)return discountNinja.DiscountedCart.ItemsInDiscountedCartFromCollections(n.EntitledCollectionHandles,n.ExcludeCollectionHandles,i);if(("product"===e||"variant"===e)&&n.EntitledProductHandles)return n.EntitledVariantIds?discountNinja.DiscountedCart.ItemsInDiscountedCartFromVariants(n.EntitledVariantIds,n.ExcludeCollectionHandles,i):discountNinja.DiscountedCart.ItemsInDiscountedCartFromProducts(n.EntitledProductHandles,n.ExcludeCollectionHandles,i)}catch(t){return discountNinja.Logging.LogError("Offer.EligibleItems",t),[]}},EligibleItemsCartValue:function(t,i,n){try{var e=0,o=t.Entitlement,r=o.EntitledItemType,a="discountedcart"===i;return void 0===n&&(n=!0),"site"===r&&"*"===o.EntitledProductHandles?e=a?discountNinja.DiscountedCart.ValueInDiscountedCart(o.ExcludeCollectionHandles,n,t.Token):discountNinja.LiquidData.ValueInCart(o.ExcludeCollectionHandles,n):"collection"===r&&o.EntitledCollectionHandles?e=a?discountNinja.DiscountedCart.ValueInDiscountedCartFromCollections(o.EntitledCollectionHandles,o.ExcludeCollectionHandles,n,t.Token):discountNinja.LiquidData.ValueInCartFromCollections(o.EntitledCollectionHandles,o.ExcludeCollectionHandles,n):"product"!==r&&"variant"!==r||!o.EntitledProductHandles||(e=o.EntitledVariantIds?a?discountNinja.DiscountedCart.ValueInDiscountedCartFromVariants(o.EntitledVariantIds,o.ExcludeCollectionHandles,n,t.Token):discountNinja.LiquidData.ValueInCartFromVariants(o.EntitledVariantIds,o.ExcludeCollectionHandles,n):a?discountNinja.DiscountedCart.ValueInDiscountedCartFromProducts(o.EntitledProductHandles,o.ExcludeCollectionHandles,n,t.Token):discountNinja.LiquidData.ValueInCartFromProducts(o.EntitledProductHandles,o.ExcludeCollectionHandles,n)),e}catch(t){return discountNinja.Logging.LogError("Offer.EligibleItemsCartValue",t),0}},ResetTiersUsed:function(){try{var t=discountNinja_Script_Offer;if(t.Offers)for(var i=0;i<t.Offers.length;i++)t.Offers[i].AppliedTier=null;t.PrimaryOffer&&(t.PrimaryOffer.AppliedTier=null)}catch(t){discountNinja.Logging.LogError("Offer.ResetTiersUsed",t)}},ResetEntitledQuantityDetails:function(t){for(var i=0;i<t.Tiers.length;i++)t.Tiers[i].EntitledQuantityDetails=null,t.AppliedTier&&(t.AppliedTier.EntitledQuantityDetails=null)},EntitledItemsCannotBePrerequisites:function(t,i){if(null===i)return null;var n="Content"===discountNinja.Prerequisite.PrerequisiteRuleType(i);return n?void 0!==t.PrerequisitesAreEligibleItems?!t.PrerequisitesAreEligibleItems:!(!t.Bogo||!n||discountNinja.Prerequisite.PrerequisiteMatchesEntitlement(t))||!("buyx_gety"!==t.OfferType||!n||"bogo"===t.Template||1!==t.Tiers.length):null},DefaultPrerequisite:function(t){try{if(t&&t.Tiers[0]&&t.Tiers[0].Prerequisite){var i=t.Tiers[0].Prerequisite,n=i;return Array.isArray(i.Rules)&&i.Rules.length>0&&(n=i.Rules[0]),void 0!==t.Prerequisite&&(void 0!==t.Prerequisite.PrerequisiteLinks&&(n.PrerequisiteLinks=t.Prerequisite.PrerequisiteLinks),void 0!==t.Prerequisite.PrerequisiteProducts&&(n.PrerequisiteProducts=t.Prerequisite.PrerequisiteProducts),void 0!==t.Prerequisite.PrerequisiteProductVariants&&(n.PrerequisiteProductVariants=t.Prerequisite.PrerequisiteProductVariants)),n}return null}catch(t){return discountNinja.Logging.LogError("Offer.DefaultPrerequisite",t),null}}},discountNinja_Script_ProductData={CachePrefix:function(){return"productdata-v7.8.19-"},Cache:{},GetCacheKey:function(t,i){return discountNinja_Script_ProductData.CachePrefix()+t+"-"+i},GetStoredInSessionCacheKey:function(t,i){return discountNinja_Script_ProductData.GetCacheKey(t,i)+"-session"},GetCache:function(t,i){try{var n=discountNinja_Script_ProductData.GetCacheKey(t,i),e=discountNinja_Script_ProductData.Cache[n],o=null;return null===(o=e||discountNinja.Cache.SessionGet(n))||"undefined"===o?null:JSON.parse(o)}catch(t){return discountNinja.Logging.LogError("ProductData.GetCache",t),null}},GetCacheStoredInSession:function(t,i){try{var n=discountNinja_Script_ProductData.GetStoredInSessionCacheKey(t,i),e=discountNinja_Script_ProductData.Cache[n];return e?"true"===e:"true"===discountNinja.Cache.SessionGet(n)}catch(t){return discountNinja.Logging.LogError("ProductData.GetCacheStoredInSession",t),!1}},SetCache:function(t,i,n){try{var e=discountNinja_Script_ProductData.GetCacheKey(t,i);n.Currency=t;var o=JSON.stringify(n);discountNinja_Script_ProductData.Cache[e]=o,discountNinja.Cache.SessionSet(e,o)}catch(t){discountNinja.Logging.LogError("ProductData.SetCache",t)}},SetCacheStoredInSessionSet:function(t,i){try{var n=discountNinja_Script_ProductData.GetStoredInSessionCacheKey(t,i);return discountNinja_Script_ProductData.Cache[n]="true",discountNinja.Cache.SessionSet(n,"true")}catch(t){discountNinja.Logging.LogError("ProductData.SetCacheStoredInSessionSet",t)}},DecodeProductHandle:function(t){try{return decodeURIComponent(t)}catch(i){return t}},ProductIsAvailable:function(t){try{return!!t&&(void 0!==t.Available&&null!==t.Available?!0===t.Available:void 0===t.InventoryLeft||(null===t.InventoryLeft||t.InventoryLeft>0))}catch(t){return discountNinja.Logging.LogError("ProductData.ProductIsAvailable",t),!0}},SaveProductDataToCache:function(t,i,n,e,o,r,a,c,u,s,d,l,g){function f(t){try{return(null==t||isNaN(t))&&(t=0),Math.floor(t)}catch(t){return discountNinja.Logging.LogError("ProductData.NormalizePrice",t),0}}function p(t){try{return(void 0===t||isNaN(t))&&(t=null),t}catch(t){return discountNinja.Logging.LogError("ProductData.NormalizeInventory",t),null}}function N(t){return"string"==typeof t?t:null}try{if(null==i||"undefined"===i)return;e=function(t,i){try{return(null==t||isNaN(t)||0===t)&&(t=i),t<i&&(t=i),Math.floor(t)}catch(t){return discountNinja.Logging.LogError("ProductData.NormalizeCompareAtPrice",t),i}}(e,o=f(o)),l=function(t){try{if(null==t)return null;for(var i=0;i<t.length;i++)t[i].Price=f(t[i].Price),t[i].CompareAtPrice=f(t[i].CompareAtPrice,t[i].Price),t[i].Inventory=p(t[i].Inventory);return t}catch(t){return discountNinja.Logging.LogError("ProductData.NormalizeVariants",t),null}}(l),r=N(r),a=N(a),d=N(d),s=function(t){try{return null==t?null:!0===t||"true"===t}catch(t){return discountNinja.Logging.LogError("ProductData.NormalizeInventory",t),null}}(s),i=discountNinja_Script_ProductData.DecodeProductHandle(i);var j={CompareAtPrice:e,Price:o,Available:s,Collections:r,CollectionIds:a,CollectionsComplete:c,Tags:d,Variants:l,Source:g};if("product"===g||"collection"===g){if(discountNinja_Script_ProductData.SetCacheStoredInSessionSet(t,i),"product"===g)return void discountNinja_Script_ProductData.SetCache(t,i,j);if("collection"===g)return(C=discountNinja_Script_ProductData.GetByProductHandle(i,!1,!1,null,!0))?(C.CollectionsComplete&&!j.CollectionsComplete?j.Collections=C.Collections:null===C.Collections&&(j.CollectionsComplete||null!==j.Collections||discountNinja.Environment.Shopify.IsCollectionPage()&&!discountNinja.Environment.Shopify.IsCatalogPage()&&(j.Collections=discountNinja.Environment.Shopify.CollectionHandle(),j.CollectionsComplete=!1)),void discountNinja_Script_ProductData.SetCache(t,i,j)):void discountNinja_Script_ProductData.SetCache(t,i,j)}else{var C;if(!(C=discountNinja_Script_ProductData.GetByProductHandle(i,!1,!1,null,!0)))return void discountNinja_Script_ProductData.SetCache(t,i,j);if("product"!==C.Source||!discountNinja_Script_ProductData.GetCacheStoredInSession(t,i))return"server"===g?void discountNinja_Script_ProductData.SetCache(t,i,j):"product"===C.Source||"collection"===C.Source||"server"===C.Source?void 0:void discountNinja_Script_ProductData.SetCache(t,i,j)}}catch(t){discountNinja.Logging.LogError("ProductData.SaveProductDataToCache",t)}},GetDataFromCollectionAttribute:function(t,i,n,e){try{var o=i.toLowerCase(),r=discountNinja.Utilities.jQuery()(t).attr("data-limoniapps-discountninja-product-"+o);if(r||(r=discountNinja.Utilities.jQuery()(t).attr("data-limoniapps-discounturl-product-"+o)),!r&&n){n=discountNinja_Script_ProductData.DecodeProductHandle(n);var a=discountNinja.LiquidData.CollectionProductByHandle(n);a&&(r=a[i])}if(!r&&void 0!==window.__pageflyProducts&&"Handle"===i){var c=discountNinja.Utilities.jQuery()(t).attr("data-product-id")||discountNinja.Utilities.jQuery()(t).parents("[data-product-id]").attr("data-product-id")||discountNinja.Utilities.jQuery()(t).find("[data-product-id]").attr("data-product-id");if(c){var u=window.__pageflyProducts[c];if(u&&void 0!==u.handle)return u.handle}}if(!r&&"Handle"===i){var s=discountNinja.Settings.Settings.PriceUpdate.Mode,d=e?s.FeaturedProductHandle:s.CollectionProductHandle;if(d&&"custom"!==d){var l=discountNinja.Utilities.GetHandleFromSelector(t,null,d);return!1===l?null:l}}if(r&&"Handle"===i){var g=r.indexOf("?");g>-1&&(r=r.substring(0,g))}return void 0===r?null:r}catch(t){return discountNinja.Logging.LogError("ProductData.GetDataFromCollectionAttribute",t),null}},SaveProductDataUsingDataTags:function(t){try{var i=discountNinja_Script_ProductData,n=i.GetDataFromCollectionAttribute,e=!0,o=discountNinja.Currency.ActiveCurrency(),r=n(t,"Handle"),a=i.GetCache(discountNinja.Currency.ActiveCurrency(),r);if(i.IsComplete(a,o,r,!1))return;var c=n(t,"Price",r),u=n(t,"CompareAtPrice",r),s=n(t,"Collections",r),d=n(t,"CollectionIds",r),l=n(t,"Tags",r),g=n(t,"Available",r),f=n(t,"Available",r);if(s||!discountNinja.Environment.Shopify.IsCollectionPage()||discountNinja.Environment.Shopify.IsCatalogPage()?e=null!=r&&null!=c&&null!=u&&null!=s&&null!=l:(s=discountNinja.Environment.Shopify.CollectionHandle(),e=!1),!e)return null;var p="[[--NONE--]]";l===p&&(l=""),s===p&&(s=""),d===p&&(d=""),i.SaveProductDataToCache(o,r,f,u,c,s,d,e,null,g,l,null,"collection")}catch(t){return discountNinja.Logging.LogError("ProductData.SaveProductDataUsingDataTags",t),null}},Save:function(){try{for(var t=discountNinja.Utilities.jQuery()("[data-limoniapps-discountninja-product-handle]"),i=0;i<t.length;i++)discountNinja.ProductData.SaveProductDataUsingDataTags(t[i]);if(discountNinja.Environment.Shopify.IsProductPage()){var n=window.discountNinjaContext.Product;if(n&&n.Handle){var e=discountNinja.Environment.Shopify.VariantData();e&&discountNinja_Script_ProductData.SaveProductDataToCache(discountNinja.Currency.ActiveCurrency(),n.Handle,n.Id,e.CompareAtPrice,e.Price,n.Collections,n.CollectionIds,!0,e.Inventory,n.Available,n.Tags,window.discountNinjaContext.ProductVariants,"product")}}}catch(t){return void discountNinja.Logging.LogError("ProductData.Save",t)}},SaveOnAddToCart:function(t){try{t=discountNinja_Script_ProductData.DecodeProductHandle(t);var i=100*discountNinja.LiquidData.PriceFromCartByProductHandle(t);discountNinja_Script_ProductData.SaveProductDataToCache(discountNinja.Currency.ActiveCurrency(),t,null,null,i,null,null,!1,null,null,null,null,"addtocart")}catch(t){return discountNinja.Logging.LogError("ProductData.Save",t),null}},IsComplete:function(t,i,n,e){try{if(null===t)return!1;if(!0===e&&(void 0===t.Variants||null===t.Variants))return!1;var o=("server"===t.Source||"product"===t.Source)&&discountNinja_Script_ProductData.GetCacheStoredInSession(i,n);return"collection"===t.Source&&t.CollectionsComplete&&void 0!==t.Price&&null!==t.Price&&void 0!==t.CompareAtPrice&&null!==t.CompareAtPrice||o}catch(t){return discountNinja.Logging.LogError("ProductData.GetByProductHandle.IsComplete",t),!1}},GetProductDataRequests:{},InvalidProduct:"[---INVALID---]",InvalidProducts:[],GetByProductHandle:function(t,i,n,e,o,r,a,c){var u=discountNinja.Utilities.jQuery().Deferred(),s=discountNinja.Currency.ActiveCurrency();function d(t){var i=discountNinja.Utilities.jQuery().Deferred();try{return!1===discountNinja.LeakyBucket.Take(discountNinja.LeakyBucket.Buckets.ProductApi)?i.resolve(null):discountNinja.XmlHttpRequest.Send(discountNinja.Api.Endpoint("product","5.1")+"/data",function(t,i){try{var n={};t&&(n.shop=t),i&&(n.handle=i);var e=discountNinja.DeviceId.Get();return n.m=e+"-"+discountNinja.DateTime.UnixTimestamp(),n.version=discountNinja.Core.Version,n.f="7.4",n}catch(t){return discountNinja.Logging.LogError("ProductData.GetProductDataFromServer.GetProductDataFromServer",t),null}}(discountNinja.Core.Shop,t),null,"get",!0,!0,!0,(function(t){try{t&&void 0!==t.Handle?(s!==discountNinja.Settings.Settings.Currency.BaseCurrency&&(t.Price=discountNinja.Currency.Convert(t.Price,s),t.CompareAtPrice=discountNinja.Currency.Convert(t.CompareAtPrice,s)),discountNinja_Script_ProductData.SaveProductDataToCache(s,t.Handle,t.Id,t.CompareAtPrice,t.Price,t.Collections,t.CollectionIds,!0,null,null,t.Tags,null,"server"),discountNinja_Script_ProductData.SetCacheStoredInSessionSet(s,t.Handle),void 0!==c&&!1!==c||discountNinja.DynamicPricing.UpdatePriceDebouncedAfterServerUpdate(),i.resolve(t)):i.resolve(null)}catch(t){discountNinja.Logging.LogError("ProductData.GetProductDataFromServer.ProductDataReady",t),i.resolve(null)}}),(function(){i.resolve(null)}),1,2),i.promise()}catch(t){discountNinja.Logging.LogError("GetProductDataFromServer",t),i.resolve(null)}}function l(t){var i=discountNinja.Utilities.jQuery().Deferred();try{return!1===discountNinja.LeakyBucket.Take(discountNinja.LeakyBucket.Buckets.ProductLiquid)?i.resolve(null):discountNinja.XmlHttpRequest.Send(discountNinja.Environment.Shopify.RootRoute()+"/products/"+t,{view:"discountninja"},null,"get",!0,!0,!1,(function(t){try{t&&void 0!==t.Handle?(discountNinja_Script_ProductData.SaveProductDataToCache(s,t.Handle,t.Id,t.CompareAtPrice,t.Price,t.Collections,t.CollectionIds,!0,null,t.Available,t.Tags,t.Variants,"server"),discountNinja_Script_ProductData.SetCacheStoredInSessionSet(s,t.Handle),void 0!==c&&!1!==c||discountNinja.DynamicPricing.UpdatePriceDebouncedAfterServerUpdate(),i.resolve(t)):i.resolve(null)}catch(t){discountNinja.Logging.LogError("GetProductDataFromServerLiquid",t),i.resolve(null)}}),(function(t){var n=null;404===t&&(n=discountNinja_Script_ProductData.InvalidProduct),i.resolve(n)}),1,1),i.promise()}catch(t){discountNinja.Logging.LogError("ProductData.GetProductDataFromServerLiquid",t)}}try{null===i&&(i=!1),null==r&&(r=0);if(!t)return discountNinja.Logging.LogErrorMessage("ProductData","Requesting GetProductDataFromServer with empty handle"),i?(u.resolve(null),u.promise()):null;t=discountNinja_Script_ProductData.DecodeProductHandle(t);var g=discountNinja_Script_ProductData.GetCache(s,t),f=discountNinja_Script_ProductData.IsComplete(g,s,t,a);if(!f&&n&&e&&(discountNinja.ProductData.SaveProductDataUsingDataTags(e),g=discountNinja_Script_ProductData.GetCache(s,t),f=discountNinja_Script_ProductData.IsComplete(g,s,t,a)),i){if(f||!0===o)u.resolve(g);else if(discountNinja_Script_ProductData.InvalidProducts.indexOf(t)>-1)u.resolve(null);else if(!0===discountNinja_Script_ProductData.GetProductDataRequests[t]){if(5===r)return null;new Promise((function(t){setTimeout((function(){t()}),250)})).then((function(){discountNinja_Script_ProductData.GetByProductHandle(t,!0,n,e,o,r++,a).then((function(i){null===i&&discountNinja_Script_ProductData.InvalidProducts.push(t),u.resolve(i)}))}))}else discountNinja_Script_ProductData.GetProductDataRequests[t]=!0,l(t).then((function(i){i===discountNinja_Script_ProductData.InvalidProduct?(discountNinja_Script_ProductData.InvalidProducts.push(t),u.resolve(null)):null===i?d(t).then((function(i){discountNinja_Script_ProductData.GetProductDataRequests[t]=!1,null===i&&discountNinja_Script_ProductData.InvalidProducts.push(t),u.resolve(i)})):(discountNinja_Script_ProductData.GetProductDataRequests[t]=!1,u.resolve(i))}));return u.promise()}if(discountNinja_Script_ProductData.InvalidProducts.indexOf(t)>-1)return null;if(!f&&!0!==o)if(!0===discountNinja_Script_ProductData.GetProductDataRequests[t]){if(5===r)return null;new Promise((function(t){setTimeout((function(){t()}),250)})).then((function(){discountNinja_Script_ProductData.GetByProductHandle(t,!0,n,e,o,r++).then((function(i){null===i&&discountNinja_Script_ProductData.InvalidProducts.push(t),u.resolve(i)}))}))}else discountNinja_Script_ProductData.GetProductDataRequests[t]=!0,l(t).then((function(i){null===i?d(t).then((function(){null===i&&discountNinja_Script_ProductData.InvalidProducts.push(t),discountNinja_Script_ProductData.GetProductDataRequests[t]=!1})):discountNinja_Script_ProductData.GetProductDataRequests[t]=!1}));return g}catch(t){return discountNinja.Logging.LogError("ProductData.GetByProductHandle",t),null}},GetVariantData:function(t,i){try{var n=discountNinja_Script_ProductData.GetByProductHandle(t);return null!==n&&null!==n.Variants?(i=function(t){try{return null==t?null:parseInt(t)}catch(t){return discountNinja.Logging.LogError("ProductData.NormalizeVariantId",t),null}}(i),n.Variants.find((function(t){return t.VariantId===i}))||null):null}catch(t){return discountNinja.Logging.LogError("ProductData.GetVariantData",t),null}}},discountNinja_Script_PromotionEvent={Queue:"promotionevent-queue",EventsSent:[],PromotionEventKey:function(t,i,n){return"offerevent-sent-"+t+"-"+i+"-"+n},GetPromotionEventSent:function(t,i,n){var e=discountNinja_Script_PromotionEvent.PromotionEventKey(t,i,n),o=discountNinja_Script_PromotionEvent.EventsSent[e];return o||discountNinja.Cache.SessionGet(e)},SetPromotionEventSent:function(t,i,n,e){var o=discountNinja_Script_PromotionEvent.PromotionEventKey(t,i,n);discountNinja_Script_PromotionEvent.EventsSent[o]=e},SetPromotionEventSentInSession:function(t,i,n,e){var o=discountNinja_Script_PromotionEvent.PromotionEventKey(t,i,n);discountNinja.Cache.SessionSet(o,e)},GetQueue:function(){try{var t=discountNinja.Cache.LocalGet(discountNinja_Script_PromotionEvent.Queue);return JSON.parse(t)}catch(t){return discountNinja.Logging.LogError("PromotionEvent.GetQueue",t),null}},AddToQueue:function(t,i){try{if(discountNinja.TestMode.TestMode())return;var n=discountNinja_Script_PromotionEvent.GetQueue();null===n&&(n=[]),n.push({triggerToken:t,eventType:i,processed:!1}),discountNinja_Script_PromotionEvent.SaveQueue(n),discountNinja_Script_PromotionEvent.ProcessQueue()}catch(t){discountNinja.Logging.LogError("PromotionEvent.AddToQueue",t)}},SaveQueue:function(t){try{for(var i=[],n=0;n<t.length;n++){var e=t[n];e.processed||i.push(e)}discountNinja.Cache.LocalSet(discountNinja_Script_PromotionEvent.Queue,JSON.stringify(i))}catch(t){discountNinja.Logging.LogError("PromotionEvent.SaveQueue",t)}},ProcessQueueDebounced:function(){function t(t){function i(i){try{i?function(t){try{var i=discountNinja_Script_PromotionEvent.GetQueue();null===i&&(i=[]);for(var n=0;n<i.length;n++)for(var e=i[n],o=0;o<t.length;o++){var r=t[o];e.triggerToken===r.triggerToken&&e.eventType===r.eventType&&(e.processed=!0)}for(var a=0;a<t.length;a++)r=t[a],discountNinja_Script_PromotionEvent.SetPromotionEventSentInSession(r.triggerToken,"",r.eventType,"sent");discountNinja.Cache.LocalSet(discountNinja_Script_PromotionEvent.Queue,JSON.stringify(i))}catch(t){discountNinja.Logging.LogError("PromotionEvent.SaveQueue",t)}}(t):discountNinja.Logging.LogErrorMessage("PromotionEvent.LogPromotionEvents.onLogComplete","Could not log events")}catch(t){discountNinja.Logging.LogError("PromotionEvent.LogPromotionEvent.onLogComplete",t)}}function n(t,i,n){try{for(var e=[],o=t.slice(i*n,(i+1)*n),r=0;r<o.length;r++){var a=o[r];e.push({token:a.triggerToken,eventType:a.eventType})}return e}catch(t){return discountNinja.Logging.LogError("PromotionEvent.LogPromotionEvents.BuildPayload",t),null}}try{for(var e=Math.ceil(t.length/10),o=function(){try{var t={},i=discountNinja.DeviceId.Get();return t.deviceId=i,t.shop=discountNinja.Core.Shop,t.f="7.4",t}catch(t){return discountNinja.Logging.LogError("PromotionEvent.LogPromotionEvents.BuildParameters",t),null}}(),r=0;r<e;r++)discountNinja.XmlHttpRequest.Send(discountNinja.Api.Endpoint("promotionevents","5.1")+"/add",o,n(t,r,10),"post",!0,!0,!0,i,null,1,1)}catch(t){discountNinja.Logging.LogError("PromotionEvent.LogPromotionEvents",t)}}function i(t,i){try{return"sent"===discountNinja_Script_PromotionEvent.GetPromotionEventSent(t.triggerToken,"",t.eventType)?(t.processed=!0,i):(discountNinja_Script_PromotionEvent.SetPromotionEventSent(t.triggerToken,"",t.eventType,"sent"),i.push(t),i)}catch(t){return discountNinja.Logging.LogError("PromotionEvent.LogPromotionEvent",t),i}}function n(){try{var n=discountNinja_Script_PromotionEvent.GetQueue();null===n&&(n=[]);for(var e=[],o=0;o<n.length;o++){var r=n[o];r.processed||(e=i(r,e))}var a=[];for(o=0;o<e.length;o++){var c=e[o];0===c.eventType&&a.push(c)}a.length>0&&function(t){try{if(!0===discountNinja.Settings.Settings.TrackFacebookEvent&&"function"==typeof fbq)try{fbq("trackCustom","Discount Ninja - Promotion triggered",{Promotion:t})}catch(t){discountNinja.Logging.LogError("PromotionEventEngine - Facebook integration",t)}if(!0===discountNinja.Settings.Settings.TrackGoogleAnalyticsEvent&&"function"==typeof ga)try{ga("send","event","Discount Ninja","Promotion triggered",t)}catch(t){discountNinja.Logging.LogError("PromotionEventEngine - Google Analytics integration",t)}if(!0===discountNinja.Settings.Settings.TrackGTMEvent)try{var i=window.dataLayer=window.dataLayer||[];i.push({ecommerce:null});for(var n=[],e=0;e<t.length;e++)n.push({id:t[e],name:"Discount Ninja promotion "+t[e]});i.push({ecommerce:{promoView:{promotions:n}}})}catch(t){discountNinja.Logging.LogError("PromotionEventEngine - GTM integration",t)}}catch(t){discountNinja.Logging.LogError("PromotionEvent.LogPixelEvent",t)}}(a),e.length>0&&t(e),discountNinja_Script_PromotionEvent.SaveQueue(n)}catch(t){discountNinja.Logging.LogError("PromotionEvent.ProcessQueue",t)}}"requestIdleCallback"in window?window.requestIdleCallback(n,{timeout:2e3}):n()}},discountNinja_Script_CartAdjustments={ToastId:"LimoniApps-DiscountNinja-RefreshPage-Toast",ToastMessageId:"LimoniApps-DiscountNinja-RefreshPage-Toast-Message",CartAdjustmentsKey:"CartAdjustments",CartAdjustmentIndex:0,StatusKey:"UpdateCart-Status",ContentKey:"UpdateCart-Content",ReloadingPage:!1,UpdatingCart:!1,Get:function(){try{return JSON.parse(discountNinja.Cache.SessionGet(discountNinja_Script_CartAdjustments.CartAdjustmentsKey))||[]}catch(t){return[]}},Save:function(t){return discountNinja.Cache.SessionSet(discountNinja_Script_CartAdjustments.CartAdjustmentsKey,JSON.stringify(t))},Remove:function(t){for(var i=discountNinja_Script_CartAdjustments.Get(),n=[],e=0;e<i.length;e++){var o=i[e];o.Id!==t.Id&&n.push(o)}discountNinja_Script_CartAdjustments.Save(n)},Add:function(t,i,n,e,o,r,a,c,u){function s(t,i,n){discountNinja.LiquidData.ItemHasPropertyWithValue(t,i,n)||(t.properties||(t.properties={}),t.properties[i]=n)}function d(t,i){t&&null!==i&&(t.quantity=i,r=t.key)}discountNinja_Script_CartAdjustments.CartAdjustmentIndex=discountNinja_Script_CartAdjustments.CartAdjustmentIndex+1,n=null===n?null:parseInt(n);var l=null;if("add"!==t&&(l=function(t,i,n){var e=discountNinja.LiquidData.CartItemByKeyAndSellingPlanId(n,u);if(e)return e;var o=discountNinja.LiquidData.CartItemByVariantAndProperty(t,i,"");if(o)return o;var r=discountNinja.LiquidData.CartItemByVariant(t);return r||null}(i,e,r)),"changequantity"===t)d(l,n);else if("add"===t){var g=JSON.parse(JSON.stringify(l?l.properties:a))||{};e&&(g[e]=o);var f=discountNinja_Script_CartAdjustments.FindMatchingLines(window.discountNinjaContext.Cart.items,i,g,l?l.discounts:void 0,null,l?l.key:null),p=f.length>0?f[0]:null;l&&p&&p.key===l.key&&(p=null),null==p?function(t,i,n,e){if(null!==t&&null!==i){r=t+":"+discountNinja_Script_CartAdjustments.CartAdjustmentIndex;var o=discountNinja.ProductData.GetByProductHandle(c),a=o?o.Price:0,u={id:parseInt(t),variant_id:parseInt(t),handle:c,product_id:o?o.Id:null,quantity:i,properties:n,key:r,price:a,original_price:a};e&&(u.selling_plan_id=e),window.discountNinjaContext.Cart.items.push(u)}}(i,n,g,u):d(p,p.quantity+n)}else"removeproperty"===t?function(t,i,n){t&&null!==i&&discountNinja.LiquidData.ItemHasPropertyWithValue(t,i,n)&&(delete t.properties[i],r=t.key)}(l,e,o):"setproperty"===t?function(t,i,n){t&&null!==i&&!discountNinja.LiquidData.ItemHasPropertyWithValue(t,i,n)&&(s(t,i,n),r=t.key)}(l,e,o):"changequantity_setproperty"===t&&function(t,i,n,e){t&&null!==i&&null!==n&&(t.quantity=i,s(t,n,e),r=t.key)}(l,n,e,o);discountNinja.Cache.LocalSet(discountNinja.Cart.Shopify.CacheKey,JSON.stringify(discountNinjaContext.Cart))},FindMatchingLines:function(t,i,n,e,o,r,a,c){function u(t){var i={};if(t)for(var n in t)-1===n.indexOf(discountNinja_Script_DiscountedCart.SplitRowPrefix)&&(i[n]=t[n]);return i}if(!i)return[];var s=[];if(t)for(var d=0;d<t.length;d++){var l=t[d];if((!r||l.key!==r)&&!(l.quantity<1||o&&l.quantity!==o||l.variant_id.toString()!==i.toString())){var g=null;if("object"==typeof l.selling_plan_allocation&&"object"==typeof l.selling_plan_allocation.selling_plan?g=l.selling_plan_allocation.selling_plan.id:void 0!==l.selling_plan_id&&(g=l.selling_plan_id),(!a||g&&a.toString()===g.toString())&&(a||!g)){if(void 0!==n)if(discountNinja.Utilities.ObjectIsEmpty(n)){if(!discountNinja.Utilities.ObjectIsEmpty(l.properties))continue}else{var f=l.properties,p=n;if(!0===c&&(f=u(l.properties),p=u(n)),JSON.stringify(p)!==JSON.stringify(f))continue}if(void 0!==e)if(discountNinja.Utilities.ObjectIsEmpty(e)){if(!discountNinja.Utilities.ObjectIsEmpty(l.discounts))continue}else if(JSON.stringify(e)!==JSON.stringify(l.discounts))continue;s.push(l)}}}return s},RegroupRows:function(){function t(t){if(!t)return null;var i=discountNinja.DiscountedCart.DiscountedCart;if(i)for(var n=0;n<i.items.length;n++){var e=i.items[n];if(e.Key===t.key)return e.OfferToken}return null}function i(t,i){if(t&&i){var n=t,e=i;e.key.length>n.key.length&&(n=i,e=t),n.quantity+=e.quantity,e.quantity=0}else discountNinja.Logging.LogWarning("CartAdjustments.MergeItems found undefined items",!0)}for(var n=discountNinjaContext.Cart.items,e=!1,o=0;o<n.length;o++){if(!((g=n[o]).quantity<1)){var r=null;"object"==typeof g.selling_plan_allocation&&"object"==typeof g.selling_plan_allocation.selling_plan?r=g.selling_plan_allocation.selling_plan.id:void 0!==g.selling_plan_id&&(r=g.selling_plan_id);var a=discountNinja_Script_CartAdjustments.FindMatchingLines(n,g.variant_id,g.properties,g.discounts,null,g.key,r),c=a.length>0?a[0]:null;if(c)i(g,c),e=!0,o=0;else if((a=discountNinja_Script_CartAdjustments.FindMatchingLines(n,g.variant_id,g.properties,g.discounts,null,g.key,r,!0))&&a.length>0)for(var u=t(g),s=null,d=0;d<length;d++)if((s=t(c=a[d]))&&u===s){i(g,c),e=!0,o=0;break}}}var l=[];for(o=0;o<n.length;o++){var g;(g=n[o]).quantity>0?l.push(g):e=!0}return discountNinjaContext.Cart.items=l,e},RequiresUpdateCart:function(t){function i(t,i){if(t)for(var n=0;n<t.length;n++){var e=t[n];if(e.key===i.key)return e}var o=discountNinja_Script_CartAdjustments.FindMatchingLines(t,i.variant_id,i.properties,i.discounts,i.quantity);return o.length>0?o[0]:null}function n(t){try{for(var i=[],n=0;n<t.length;n++){if(void 0!==(a=t[n]).discounts&&null!==a.discounts&&"number"==typeof a.discounts.length&&a.discounts.length>0){var e=discountNinja_Script_CartAdjustments.FindMatchingLines(t,a.variant_id,a.properties,a.discounts,null,a.key),o=e.length>0?e[0]:null;if(null!==o){var r=a.quantity;a.quantity=0,o.quantity+=r}}}for(n=0;n<t.length;n++){var a;(a=t[n]).quantity>0&&(a.discounts=null,i.push(a))}return i}catch(i){return t}}try{if(discountNinjaContext.Cart.items){var e=n(discountNinjaContext.Cart.items);if(t){t=n(t);for(var o=0;o<t.length;o++){var r=t[o],a=i(e,r);if(null===a)return!0;if(a.quantity!==r.quantity)return!0;if((discountNinja.Utilities.ObjectIsEmpty(r.properties)?"":JSON.stringify(r.properties))!==(discountNinja.Utilities.ObjectIsEmpty(a.properties)?"":JSON.stringify(a.properties)))return!0}}for(o=0;o<e.length;o++){var c=e[o];if(!(c.quantity<1))if(null===i(t,c))return!0}}return!1}catch(t){return discountNinja.Logging.LogError("CartAdjustments.RequiresUpdateCart failed",t),!1}},FinishIncompleteUpdateCart:function(){var t=discountNinja.Utilities.jQuery().Deferred();try{if(!0===discountNinja_Script_CartAdjustments.UpdatingCart)t.resolve(!1);else{var i=discountNinja_Script_CartAdjustments.StatusKey,n=discountNinja_Script_CartAdjustments.ContentKey,e=discountNinja.Cache.SessionGet(i);if("start"===e||"cleared"===e||"aborted"===e){var o=JSON.parse(discountNinja.Cache.SessionGet(n));o&&Array.isArray(o)&&o.length>0?(discountNinja.Logging.LogWarning("Finishing incomplete update of cart",!0),discountNinja_Script_XmlHttpRequest.EnableDebugging&&console.log("FinishIncompleteUpdateCart called, status was "+e),discountNinjaContext.Cart.items=o,discountNinja_Script_CartAdjustments.UpdateCart(!0).always((function(){discountNinja.Cache.SessionRemove(i),discountNinja.Cache.SessionRemove(n),t.resolve(!0)}))):(discountNinja.Cache.SessionRemove(i),t.resolve(!1))}else t.resolve(!1)}}catch(i){discountNinja.Logging.LogError("CartAdjustments.FinishIncompleteUpdateCart failed",i),t.resolve(!1)}return t.promise()},UpdateCart:function(t){function i(i){try{if(!0===discountNinja_Script_CartAdjustments.UpdatingCart)i.resolve();else{var n=discountNinja_Script_CartAdjustments.StatusKey,e=discountNinja_Script_CartAdjustments.ContentKey;if(t){var o=JSON.parse(JSON.stringify(discountNinjaContext.Cart.items)).slice().reverse();discountNinja.Cache.SessionSet(n,"start"),discountNinja.Cache.SessionSet(e,JSON.stringify(discountNinjaContext.Cart.items)),discountNinja.Core.Navigating||discountNinja_Script_CartAdjustments.ReloadingPage?(discountNinja.Logging.LogWarning("Canceling update of cart (clear) due to navigation",!0),i.resolve()):(discountNinja_Script_CartAdjustments.UpdatingCart=!0,discountNinja.Cart.Shopify.ClearCart().done((function(){discountNinja.Cache.SessionSet(n,"cleared"),o.length>0?discountNinja.Core.Navigating||discountNinja_Script_CartAdjustments.ReloadingPage?(discountNinja.Logging.LogWarning("Canceling update of cart (add) due to navigation",!0),i.resolve()):discountNinja.Cart.Shopify.AddToCartMultipleLines(o).done((function(t){t||discountNinja.Logging.LogErrorMessage("Cart","Could not refill cart after clearing the cart."),discountNinja.Cache.SessionSet(n,"complete"),discountNinja.Cache.SessionRemove(e),discountNinja_Script_CartAdjustments.UpdatingCart=!1,i.resolve()})).fail((function(t){console.error("AddToCartMultipleLines failed",t),discountNinja.Cache.SessionSet(n,"failed"),discountNinja_Script_CartAdjustments.UpdatingCart=!1,i.reject()})):(discountNinja.Cache.SessionSet(n,"complete"),discountNinja.Cache.SessionRemove(e),discountNinja_Script_CartAdjustments.UpdatingCart=!1,i.resolve())})).fail((function(t){console.error("Clear cart failed",t),discountNinja.Cache.SessionSet(n,"failed"),discountNinja_Script_CartAdjustments.UpdatingCart=!1,i.reject()})))}else i.resolve()}}catch(t){discountNinja.Logging.LogError("CartAdjustments.UpdateCart failed",t),discountNinja_Script_CartAdjustments.UpdatingCart=!1,i.reject()}}var n=discountNinja.Utilities.jQuery().Deferred();return function(t){discountNinja_Script_CartAdjustments.UpdatingCart?setTimeout((function(){i(t)}),150):i(t)}(n),n.promise()},RefreshAfterCartAdjustments:function(){var deferred=discountNinja.Utilities.jQuery().Deferred();function InjectRefreshPageToast(t){var i=discountNinja_Script_CartAdjustments.ToastId,n=document.getElementById(i);if(null===n){var e='<div id="'+i+'" class="limoniapps-discountninja-toast limoniapps-discountninja-toast-bottom"><span id="'+discountNinja_Script_CartAdjustments.ToastMessageId+'">'+t+"</span></div>",o=discountNinja.Utilities.CreateFragment(e);document.body.insertBefore(o,document.body.childNodes[0]),n=document.getElementById(i)}var r="limoniapps-discountninja-toast-show";-1===n.className.indexOf(r)&&(n.className=n.className+" "+r),setTimeout((function(){n.className=n.className.replace(r,"")}),3e3)}function ReloadPageAfterWaitForCartRefill(){var t=discountNinja.Cache.SessionGet(discountNinja_Script_CartAdjustments.StatusKey);null===t||"complete"===t?(discountNinja.Logging.LogWarning("Reloading page to display cart adjustments. This behavior can be changed in the app.",!0),discountNinja_Script_CartAdjustments.ReloadingPage=!0,location.reload()):setTimeout((function(){ReloadPageAfterWaitForCartRefill()}),100)}function ReloadPage(){try{var t=discountNinja.Settings.Settings.GWPSettings;t&&t.PageRefreshText&&InjectRefreshPageToast(t.PageRefreshText),ReloadPageAfterWaitForCartRefill()}catch(t){discountNinja.Logging.LogError("CartAdjustments.ReloadPage",t)}}function ExecuteDrawerCartRefreshMethod(){try{var modeSettings=discountNinja.Settings.Settings.PriceUpdate.Mode,refreshMethod=modeSettings.DrawerCartRefreshMethod;null!=refreshMethod&&""!==refreshMethod||(refreshMethod=discountNinja.Settings.GetFlag("DrawerCartRefreshMethod")),null!=refreshMethod&&""!==refreshMethod&&"custom"!==refreshMethod?(discountNinja.Cart.Shopify.IsDirty=!0,setTimeout((function(){discountNinja.Cart.Shopify.UpdateCart((function(){discountNinja.Trigger.EnsureInitialPromotionsTriggered((function(){discountNinja.DiscountedCart.BuildDiscountedCart((function(){try{eval(refreshMethod),discountNinja_Script_DiscountedCart.SplitRowsInProcess=!1,discountNinja.Events.Publish("drawercartopened"),discountNinja.Events.Publish("drawercart:opened"),deferred.resolve()}catch(t){discountNinja.Logging.LogError("CartAdjustments.ExecuteDrawerCartRefreshMethod.Eval",t)}}))}))}))}),500)):(discountNinja_Script_DiscountedCart.SplitRowsInProcess=!1,discountNinja.Cart.Shopify.UpdateCart((function(){discountNinja.Trigger.EnsureInitialPromotionsTriggered((function(){discountNinja.DiscountedCart.BuildDiscountedCart((function(){try{if(discountNinjaContext.Cart){void 0!==discountNinjaContext.Cart.items&&null!==discountNinjaContext.Cart.items||(discountNinjaContext.Cart.items=[]);for(var t=0;t<discountNinjaContext.Cart.items.length;t++){var i=discountNinjaContext.Cart.items[t];void 0!==i.properties&&null!==i.properties||(i.properties={}),void 0!==i.line_level_discount_allocations&&null!==i.line_level_discount_allocations||(i.line_level_discount_allocations=[]),void 0!==i.discount_allocations&&null!==i.discount_allocations||(i.discount_allocations=[])}void 0!==discountNinjaContext.Cart.cart_level_discount_applications&&null!==discountNinjaContext.Cart.cart_level_discount_applications||(discountNinjaContext.Cart.cart_level_discount_applications=[]),void 0!==discountNinjaContext.Cart.discount_applications&&null!==discountNinjaContext.Cart.discount_applications||(discountNinjaContext.Cart.discount_applications=[])}discountNinja.Events.Publish("refreshdrawercart",[discountNinjaContext.Cart]),discountNinja.Events.Publish("drawercart:refreshed",[discountNinjaContext.Cart])}catch(t){discountNinja.Logging.LogError("CartAdjustments.ExecuteDrawerCartRefreshMethod.PublishEvent",t)}}))}))})),deferred.resolve())}catch(t){discountNinja.Logging.LogError("CartAdjustments.ExecuteDrawerCartRefreshMethod",t)}}var requiresReload=discountNinja_Script_CartAdjustments.ShouldReloadPageAfterCartAdjustments();if(requiresReload){var callback=discountNinja.Settings.GetFlag("CallbackAfterReloadPageAddingFreeGift")||discountNinja.Settings.GetFlag("CallbackAfterReloadPageForCartAdjustments");discountNinja.Cache.SessionSet("CallbackAfterReloadPageAddingFreeGift",callback)}return requiresReload?ReloadPage():ExecuteDrawerCartRefreshMethod(),deferred.promise()},ShouldReloadPageAfterCartAdjustments:function(){var t=discountNinja.Settings.Settings.PriceUpdate.Mode,i=discountNinja.Environment.Shopify.IsCartPage(),n=t.ReloadPageAfterCartAdjustmentsOnCart;n=null==n||""===n||"custom"===n?!0===discountNinja.Settings.GetFlag("ReloadPageAfterAddingFreeGiftOnCart")||!0===discountNinja.Settings.GetFlag("ReloadPageAfterCartAdjustmentsOnCart"):!0===n;var e=i&&n,o=t.ReloadPageAfterCartAdjustments;return o=null==o||""===o||"custom"===o?!0===discountNinja.Settings.GetFlag("ReloadPageAfterAddingFreeGift")||!0===discountNinja.Settings.GetFlag("ReloadPageAfterCartAdjustments"):!0===o,e||!i&&o}},discountNinja_Script_GiftWithPurchase={AdjustmentIntention:"CartAdjustmentIntention",AdjustmentQuantities:"CartAdjustmentQuantities",ToastCacheKey:"ShowGWPToast",ToastId:"LimoniApps-DiscountNinja-GWP-Toast",ToastMessageId:"LimoniApps-DiscountNinja-GWP-Toast-Message",ToastDelay:5e3,FreeLabel:function(){return"<span class='limoniapps-discountninja-label-free'>"+window.discountNinjaContext.Labels.Free+"</span>"},ShowToast:function(){try{var t=discountNinja.Cache.SessionGet(discountNinja_Script_GiftWithPurchase.ToastCacheKey),i=t?JSON.parse(t):null;if(i){setTimeout((function(){discountNinja.Cache.SessionRemove(discountNinja_Script_GiftWithPurchase.ToastCacheKey)}),750);var n=discountNinja.Settings.Settings.GWPSettings;n&&n.FreeGiftAddedText&&function(t,i){var n=discountNinja_Script_GiftWithPurchase.ToastId,e=document.getElementById(n);if(null===e){var o='<div id="'+n+'" class="limoniapps-discountninja-toast limoniapps-discountninja-toast-bottom"><span id="'+discountNinja_Script_GiftWithPurchase.ToastMessageId+'">'+t.FreeGiftAddedText+"</span></div>",r=discountNinja.Utilities.CreateFragment(o);document.body.insertBefore(r,document.body.childNodes[0]),e=document.getElementById(n)}var a="limoniapps-discountninja-toast-show";-1===e.className.indexOf(a)&&(e.className=e.className+" "+a),setTimeout((function(){e.className=e.className.replace(a,"")}),discountNinja_Script_GiftWithPurchase.ToastDelay)}(n)}}catch(t){discountNinja.Logging.LogError("GiftWithPurchase.ShowToast",t)}},AllowAddingManuallyRemovedGifts:function(){var t=discountNinja.Settings.Settings.GWPSettings.AllowAddingManuallyRemovedGifts;return null==t?!0===discountNinja.Settings.GetFlag("AllowAddingManuallyRemovedGifts"):!0===t},AddAdjustments:function(){function t(t){if(null===t)return!1;var i=t.Token,n=t?t.Bogo:null,e=!1;if(n){var o=t.Tiers[0],r=discountNinja.Prerequisite.EntitledQuantityInfo(t,o);if(null==r||!1===r.HasEntitledQuantity)return;var a=r.Entitled.DeltaWithCart,c=r.Entitled.Total;if(0===a);else{var u=t.Entitlement.EntitledVariantIds,s=t.Entitlement.EntitledItemType;if(("variant"===s||"product"===s)&&(null==u||""===u||isNaN(u)))return void discountNinja.Logging.LogErrorMessage("AddAdjustments - Missing or invalid variant id for gift with purchase (handle: '"+t.Entitlement.EntitledProductHandles+"' and token '"+i+"')");var d=null;if(!0!==discountNinja_Script_GiftWithPurchase.AllowAddingManuallyRemovedGifts()){try{synchedProductsCache=function(t){try{for(var i=discountNinja.Cache.SessionGet(discountNinja_Script_GiftWithPurchase.AdjustmentQuantities),n=i?JSON.parse(i):[],e=0;e<n.length;e++){var o=n[e];if(o.Token===t)return o.Quantity}return null}catch(t){return discountNinja.Logging.LogError("GiftWithPurchase.GetLastAdjustmentQuantity",t),null}}(i),d=null===synchedProductsCache?null:parseInt(synchedProductsCache)}catch(t){}isNaN(d)&&(d=null)}if(a<0||null===d||c!==d){var l=discountNinja.DiscountedCart.FreeGiftPrefix+i;if(a<0)for(var g=c,f=0;f<discountNinjaContext.Cart.items.length;f++){var p=discountNinjaContext.Cart.items[f];if(discountNinja.LiquidData.ItemHasProperty(p,discountNinja.DiscountedCart.FreeGiftPrefix+i)){var N=p.quantity;if(n.RemoveFromCartAutomatically){var j=N>g?c:N;g-=j,j!==N&&(discountNinja.CartAdjustments.Add("changequantity_setproperty",null,j,l,"",p.key),e=!0)}else{var C=N-(_=N>g?c:N);if(_>0){if(_!==N&&(discountNinja.CartAdjustments.Add("changequantity_setproperty",null,_,l,"",p.key),e=!0),C>0){var m=discountNinja.LiquidData.CopyPropertiesExceptSplitKeys(p.key,discountNinja.LiquidData.GetSellingPlanId(p));discountNinja.CartAdjustments.Add("add",p.variant_id,C,null,null,null,m,p.handle),e=!0}}else discountNinja.CartAdjustments.Add("removeproperty",null,null,l,"",p.key),e=!0;g-=_}}}else if(a>0&&n.AddToCartAutomatically){var S={};S[l]="",discountNinja.CartAdjustments.Add("add",u,a,l,"",null,S,t.Entitlement.EntitledProductHandles),e=!0;var h={Variant:u,ProductHandle:t.Entitlement.EntitledProductHandles};discountNinja.Cache.SessionSet(discountNinja_Script_GiftWithPurchase.ToastCacheKey,JSON.stringify(h)),discountNinja_Script_GiftWithPurchase.ShowToast()}}else if(a<0)for(l=discountNinja.DiscountedCart.FreeGiftPrefix+i,g=c,f=0;f<discountNinjaContext.Cart.items.length;f++){var _;p=discountNinjaContext.Cart.items[f];if(g>0&&discountNinja.LiquidData.ItemHasProperty(p,discountNinja.DiscountedCart.FreeGiftPrefix+i))discountNinja.CartAdjustments.Add("removeproperty",null,null,l,"",p.key),g-=_=(N=p.quantity)>g?c:N}}var y=discountNinja.Cache.SessionGet(discountNinja_Script_GiftWithPurchase.AdjustmentIntention),v=y?JSON.parse(y):[],P=v.find((function(i){return i.Token===t.Token}));P?P.Quantity=c:v.push({Token:i,Quantity:c}),discountNinja.Cache.SessionSet(discountNinja_Script_GiftWithPurchase.AdjustmentIntention,JSON.stringify(v))}return e}var i=!1;if(discountNinja.Offer.Offers&&discountNinja.Offer.Offers.length>0)for(var n=0;n<discountNinja.Offer.Offers.length;n++)!0===t(discountNinja.Offer.Offers[n])&&(i=!0);return i}},discountNinja_Script_PromotionFlow={HandlingDrawerCartTimeoutHandle:null,HandlingDrawerCartTimeout:!1,AllPromotionsEvaluated:!1,MustRefreshCart:!1,ShowStickyBarAndNotification:function(){function t(t){try{var i="",n=t.StickyBar;return n||(i="Sticky bar disabled for offer "+t.Token),""!==i||"mobileonly"!==n.DisplayOnDevices||discountNinja.Utilities.IsMobilePhone()?""===i&&"desktoponly"===n.DisplayOnDevices&&discountNinja.Utilities.IsMobilePhone()&&(i="Sticky bar is not displayed on mobile phones"):i="Sticky bar is only displayed on mobile phones",""===i&&(i=discountNinja_Script_PromotionFlow.IsBuildingBlockEnabledForPage(n,i,"Sticky bar")),discountNinja_Script_PromotionFlow.HandleFlowErrorMessage(i,!1)}catch(t){return discountNinja.Logging.LogError("PromotionFlow.IsStickyBarRequired",t),!1}}function i(t){var i="",n=t.Notification;return n||(i="Notification disabled for offer "+t.Token),""!==i||"mobileonly"!==n.DisplayOnDevices||discountNinja.Utilities.IsMobilePhone()?""===i&&"desktoponly"===n.DisplayOnDevices&&discountNinja.Utilities.IsMobilePhone()&&(i="Notification is not displayed on mobile phones"):i="Notification is only displayed on mobile phones",""===i&&(i=discountNinja_Script_PromotionFlow.IsBuildingBlockEnabledForPage(n,i,"Notification")),discountNinja_Script_PromotionFlow.HandleFlowErrorMessage(i,!1)}try{var n=null,e=null;null!=n&&0!==n.length&&null!=e&&0!==e.length||function(){try{discountNinja.StickyBar.Clear(),discountNinja.Notification.Clear();var n=discountNinja.Offer.Offers;if(n)for(var e=0;e<n.length;e++){var o=n[e];if(!discountNinja.Offer.IsOfferAccepted(o.Token,o.Frequency)&&o.AutoAccept);else{var r=!0,a=o.Tiers[o.Tiers.length-1],c=a.Prerequisite,u=o.Tiers&&c&&c.MaximumAmount?100*c.MaximumAmount:null,s=o.Tiers&&c&&c.MaximumItems?100*c.MaximumItems:null;if(u&&discountNinja.Offer.PrerequisiteItemsCartValue(o)>u&&(r=!1),s&&discountNinja.Prerequisite.PrerequisiteItemsInCart(o,a)>s&&(r=!1),r){var d=!(!o.StickyBar||!(o.StickyBar.ActionButton1&&"applydiscount"===o.StickyBar.ActionButton1.Action||o.StickyBar.ActionButton2&&"applydiscount"===o.StickyBar.ActionButton2.Action));(discountNinja.Offer.IsOfferAccepted(o.Token,o.Frequency)||d)&&t(o)&&o.StickyBar&&(o.StickyBar.Body||o.StickyBar.TimerFooter)&&discountNinja.StickyBar.Add(o.Token,o.StickyBar.PlacementVertical,o.StickyBar.Order),discountNinja.Offer.IsOfferAccepted(o.Token,o.Frequency)&&i(o)&&o.Notification&&o.Notification.Body&&discountNinja.Notification.Add(o.Token)}}}}catch(t){discountNinja.Logging.LogError("PromotionFlow.BuildStickyBarAndNotificationArrays",t)}}(),discountNinja.StickyBar.Show(),discountNinja.Notification.Show(),n=discountNinja.Notification.GetFromCache(),e=discountNinja.StickyBar.GetFromCache();var o=!1;if(null!=e&&e.length>0)for(var r=0;r<e.length;r++){var a=e[r];if("top_page_sticky"===a.PlacementVertical||"top_page"===a.PlacementVertical){o=!0;break}}o||discountNinja.StickyBar.RemoveStickyBarClasses()}catch(t){discountNinja.Logging.LogError("PromotionFlow.ShowStickyBarAndNotification",t)}},ShowAcceleratedCheckoutButtons:function(){discountNinja_Script_PromotionFlow.SetVisibilityOfElements(discountNinja.Environment.Shopify.SelectorsAcceleratedCheckoutButton(),"acceleratedcheckoutbuttons",!0)},HideAcceleratedCheckoutButtons:function(){discountNinja_Script_PromotionFlow.SetVisibilityOfElements(discountNinja.Environment.Shopify.SelectorsAcceleratedCheckoutButton(),"acceleratedcheckoutbuttons",!1)},SetVisibilityOfElements:function(t,i,n){try{!function(t,i,n,e){try{if(discountNinja.Utilities.jQuery()("#"+t).attr("data-config")!==n.toString()){for(var o="",r=0;r<i.length;r++)o=o+" "+i[r]+" { "+e+" }";discountNinja.Utilities.AddInlineCssToDocument(o,t,n)}}catch(t){discountNinja.Logging.LogError("AddCss",t)}}("limoniapps-"+i+"-style",t,n,n?"visibility: unset !important; opacity: 1;":"visibility: hidden !important; opacity: 0;")}catch(t){discountNinja.Logging.LogError("PromotionFlow.SetVisibilityAcceleratedCheckoutButtons",t)}},ShowBuyNowButtons:function(){discountNinja_Script_PromotionFlow.SetVisibilityOfElements(discountNinja.Environment.Shopify.SelectorsBuyNowButtonWrapper(),"buynowbuttons",!0)},SwitchToCustomCheckoutButton:function(){try{var t=".limoniapps-discountninja-checkoutbutton",i=discountNinja.Utilities.jQuery();i(t+"-hide").hide(),i(t+"-show").show()}catch(t){discountNinja.Logging.LogError("PromotionFlow.SwitchToCustomCheckoutButton",t)}},HandleAcceleratedCheckoutButtons:function(){function t(){var t=discountNinja.DiscountedCart.HasActivePromotions(),i=discountNinja_Script_PromotionFlow;t&&!1!==discountNinja.Settings.Settings.Checkout.HideAdditionalCheckoutButtons&&i.HideAcceleratedCheckoutButtons()}!1!==discountNinja.Settings.Settings.Checkout.HideAdditionalCheckoutButtons&&(t(),setTimeout((function(){t()}),500),setTimeout((function(){t()}),1e3),setTimeout((function(){t()}),2e3),setTimeout((function(){t()}),5e3))},DisplayAppliedOffers:function(t){try{discountNinja.DiscountCode.InjectDiscountCodesInHtml(),discountNinja.DynamicPricing.UpdatePrice(!1,!0,!1,t),discountNinja.DiscountedCart.HasActivePromotions()&&(!0===discountNinja.Settings.GetFlag("KillConflictingApps")?(e=!1,"object"==typeof mamutaTier&&(mamutaTier=null,e=!0),"object"==typeof Spurit&&(Spurit=null,e=!0),"object"==typeof SMARTOFFER&&(SMARTOFFER=null,e=!0),e&&discountNinja.Cache.SessionSet("RedirectToCheckoutOnFallBack","true")):("object"==typeof mamutaTier&&discountNinja.Logging.LogErrorMessage("Conflicting app detected by developer MamutaTier. Consider setting the flag KillConflictingApps to true."),"object"==typeof Spurit&&(Spurit=null,discountNinja.Logging.LogErrorMessage("Conflicting app detected by developer Spurit. Consider setting the flag KillConflictingApps to true.")),"object"==typeof SMARTOFFER&&(SMARTOFFER=null,discountNinja.Logging.LogErrorMessage("Conflicting app detected by developer SmartOffer. Consider setting the flag KillConflictingApps to true."))),!0===discountNinjaContext.Flags.CustomCheckoutButton&&discountNinja_Script_PromotionFlow.SwitchToCustomCheckoutButton()),discountNinja_Script_PromotionFlow.HandleAcceleratedCheckoutButtons(),discountNinja.ShortCode.ShowShortcodePlaceholders(),discountNinja_Script_PromotionFlow.ShowStickyBarAndNotification();var i=discountNinja.Utilities.jQuery()(".limoniapps-poweredby"),n="limoniapps-poweredby-hidden";discountNinja.Settings.Settings.General.ShowPoweredBy?i.removeClass(n):i.addClass(n)}catch(t){discountNinja.Logging.LogError("PromotionFlow.DisplayAppliedOffers",t)}var e},StartFlow:function(){function t(t,i,n,e,o){try{if(!t)return!1;var r=t.nodeName?t.nodeName.toLowerCase():"",a="function"==typeof t.getAttribute?t.getAttribute(n):"";return a||(a=""),r===i&&(a===e||!o&&a.indexOf(e)>-1)}catch(t){return discountNinja.Logging.LogError("PromotionFlow.IsNodeWithAttribute",t),!1}}function i(t,i,n){try{if(t)if(i){if(t.indexOf("<"+i)>-1)return!n||t.indexOf(n)>-1}else if(n)return t.indexOf(n)>-1;return!1}catch(t){return discountNinja.Logging.LogError("PromotionFlow.HtmlContainsNode",t),!1}}function n(){discountNinja.Checkout.Shopify.RegisterEventHandlerForCheckout();var t=function(){discountNinja.Events.Publish("drawercart:opened",[!0])};t(),setTimeout((function(){t()}),500),setTimeout((function(){t()}),1500)}function e(){try{discountNinja.Utilities.jQuery()(".gf-loadmore-btn,#gsloadmore,.limoniapps-discountninja-loadmore-collectionproducts").each((function(){var t=function(){discountNinja.Events.Publish("collection:productsadded"),e()},i=function(i){setTimeout((function(){t()}),250);for(var n=0;n<20;n++)setTimeout((function(){t()}),750*(n+1))};!0!==this.discountNinjaEventBound&&(this.discountNinjaEventBound=!0,this.addEventListener("click",i),this.addEventListener("touch",i))}))}catch(t){discountNinja.Logging.LogError("PromotionFlow.ListenForLoadMoreButtons",t)}}try{if(window.discountNinjaIsReady=!1,discountNinja.DiscountedCart.DiscountedCart&&(discountNinja.DiscountedCart.DiscountedCart.IsReady=!1),!discountNinja.Settings.Settings)return;if(discountNinja.LogSession.PrintPerformance("Start flow"),"true"===discountNinja.Cache.SessionGet("AppIsDisabled"))return;!function(){var t=discountNinja.Offer.Offers;if(t)for(var i=0;i<t.length;i++){var n=t[i];if(discountNinja.Offer.OfferIsApplicable(n)){var e=discountNinja.Offer.PrerequisiteItemsCartValue(n);discountNinja.DiscountTier.GetCurrentDiscountTierNumber(n,e)!==discountNinja.DiscountTier.GetMaxDiscountTierNumber(n)&&discountNinja.Offer.UnApply(t[i].Token)}else discountNinja.Offer.Stop(t[i].Token)}}(),discountNinja.Offer.PrimaryOffer=null,discountNinja.Trigger.Clear(),discountNinja.DiscountCode.EnableDiscountCodeField(!1),discountNinja.Environment.Shopify.IsCartPage()?discountNinja.DiscountedCart.IsDirty=!0:discountNinja.VariantChange.RegisterEventHandlerForVariantChange(),discountNinja.Offer.ClearPromotionForProductCache(),discountNinja.DiscountCode.UndoInjectDiscountCodesInHtml(),discountNinja.Trigger.InitialPromotionsTriggered=!1,discountNinja.Offer.Offers=null,function(){try{new(discountNinja.Utilities.GetMutationObserver())((function(e){try{for(var o=0;o<e.length;o++)for(var r=0;r<e[o].addedNodes.length;r++){var a=e[o].addedNodes[r];if(null!=a&&null!==a.nodeName&&void 0!==a.nodeName&&-1===a.nodeName.indexOf("text")){var c=discountNinja.Utilities.jQuery()(a).html(),u=discountNinja.Utilities.jQuery()("body").css("margin-top");i(c,"form",null)&&(c.indexOf("/cart")>-1||c.indexOf("/cart")>-1||c.indexOf("/checkout")>-1)&&n(),(i(c,"button","submit")||i(c,"input","submit")||i(c,"a","/checkout")||t(a,"div","id","spurit-occ-popup",!0)||t(a,"button","type","submit",!0)||t(a,"input","type","submit",!0)||t(a,"a","href","/checkout",!1))&&n(),t(a,"div","id","shopify-payment-terms-cover",!0)?discountNinja.DynamicPricing.ReplaceInstallmentsPrices():t(a,"div","id","qab_bar",!0)?discountNinja.Utilities.jQuery()("#qab_bar").css("top",u):t(a,"div","id","fsb_background",!0)?discountNinja.Utilities.IsMobilePhone()||discountNinja.Utilities.jQuery()("#fsb_background").css("top",u):t(a,"div","id","spb-information-bar",!0)?discountNinja.Utilities.jQuery()("#spb-information-bar").css("top",u):t(a,"div","class","wheelio_holder",!1)?discountNinja.Utilities.jQuery()(".wheelio_holder .wlo_btn.wlo_copy_code").on("click",(function(t){var i=discountNinja.Utilities.jQuery()(".wheelio_holder .wlo_input_code").val();discountNinja.Core.TriggerPromotionViaToken(i)})):(i(c,null,"limoniapps-discountninja-cart-root")||i(c,null,"limoniapps-discountninja-drawercart-root")||t(a,"button","name","icartCheckout",!0))&&n()}}}catch(t){discountNinja.Logging.LogError("PromotionFlow.ListenForDynamicallyAddedElements.mutationObserver",t)}})).observe(document.body,{attributes:!1,childList:!0,subtree:!0,characterData:!1})}catch(t){discountNinja.Logging.LogError("PromotionFlow.ListenForDynamicallyAddedElements",t)}}(),function(){try{var t=discountNinja.Utilities.jQuery()(".limoniapps-discountninja-drawercart-anchor");t.length>0&&(targetNode=t.get()[0],new MutationObserver((function(){var t=discountNinja.Utilities.jQuery()(targetNode).is(":visible");null!==discountNinja_Script_PromotionFlow.HandlingDrawerCartTimeoutHandle&&clearTimeout(discountNinja_Script_PromotionFlow.HandlingDrawerCartTimeoutHandle),discountNinja_Script_PromotionFlow.HandlingDrawerCartTimeoutHandle=setTimeout((function(){!function(t){try{discountNinja_Script_PromotionFlow.HandlingDrawerCartTimeoutHandle=null,discountNinja_Script_PromotionFlow.HandlingDrawerCartTimeout||(discountNinja_Script_PromotionFlow.HandlingDrawerCartTimeout=!0,t&&(discountNinja.Notification.Minimize(),discountNinja.DiscountCode.InjectDiscountCodesInHtml()),discountNinja_Script_PromotionFlow.HandlingDrawerCartTimeout=!1)}catch(t){discountNinja.Logging.LogError("PromotionFlow.HandleDrawerCartChange",t),discountNinja_Script_PromotionFlow.HandlingDrawerCartTimeoutHandle=null,discountNinja_Script_PromotionFlow.HandlingDrawerCartTimeout=!1}}(t)}),500)})).observe(targetNode,{attributes:!0}))}catch(t){discountNinja.Logging.LogError("PromotionFlow.ListenForDrawerCartChanges",t)}}(),e(),setTimeout((function(){e()}),1e3),discountNinja.Trigger.MarkPageAsVisited(),discountNinja.Trigger.WaitForTriggerConditions(discountNinja.Offer.Triggers),discountNinja.GiftWithPurchase.ShowToast()}catch(t){discountNinja.Logging.LogError("PromotionFlow.StartFlow",t)}},ViewPromotion:function(t){discountNinja.Timer.ShouldStartOnDisplay(t)&&discountNinja.Timer.Start(t),t.TriggeredByTrigger&&discountNinja.PromotionEvent.AddToQueue(t.TriggeredByTrigger.Token,0)},AcceptPromotion:function(t){try{discountNinja.Offer.SetPromotionAccepted(t.Token,t.Frequency,"true"),discountNinja.Offer.SaveToCache(t),discountNinja.Offer.ClearPromotionForProductCache()}catch(t){discountNinja.Logging.LogError("PromotionFlow.AcceptPromotion",t)}},UnAcceptPromotion:function(t){discountNinja.Offer.SetPromotionAccepted(t.Token,t.Frequency,"false")},ShowHideElementsWhenPromotionsInCart:function(){function t(t,i){try{var n=i?t+"show":t+"hide",e=i?t+"hide":t+"show";discountNinja.Utilities.jQuery()(n).show(),discountNinja.Utilities.jQuery()(e).hide()}catch(t){discountNinja.Logging.LogError("PromotionFlow.HideOrShow",t)}}try{var i=".limoniapps-discountninja-when";t(i+"productdiscounted-",discountNinja.Environment.Shopify.IsProductPage()&&!0===discountNinja.DiscountedProduct.CurrentVariantIsDiscounted()),t(i+"activepromotions-",discountNinja.DiscountedCart.HasActivePromotions()),t(i+"promotionsincart-",discountNinja.DiscountedCart.HasAppliedPromotions()),t(i+"cartdiscounted-",discountNinja.DiscountedCart.DiscountedCart&&discountNinja.DiscountedCart.DiscountedCart.total_discount>0),t(i+"cartdiscounted-excludinggifts-",discountNinja.DiscountedCart.DiscountedCart&&discountNinja.DiscountedCart.DiscountedCart.total_discount_excluding_gifts>0),t(i+"orderleveldiscounted-",discountNinja.DiscountedCart.DiscountedCart&&discountNinja.DiscountedCart.DiscountedCart.cartlevel_discount>0),t(i+"lineleveldiscounted-",discountNinja.DiscountedCart.DiscountedCart&&discountNinja.DiscountedCart.DiscountedCart.subtotal_discount>0),t(i+"lineleveldiscounted-excludinggifts-",discountNinja.DiscountedCart.DiscountedCart&&discountNinja.DiscountedCart.DiscountedCart.subtotal_discount_excluding_gifts>0);var n=discountNinja_Script_PromotionSummary.PromotionSummaryEnabledOn(!discountNinja.Environment.Shopify.IsCartPage());t(i+"promotionsummaryavailable-",n),t(i+"promotionsummaryunavailable-",!n)}catch(t){discountNinja.Logging.LogError("PromotionFlow.ShowHideElementsWhenPromotionsInCart",t)}},StopFlow:function(){function t(t,i){return!(t>=3)&&(null===i||!(discountNinja.DiscountedCart.DiscountedCart.total_discount<=i))}function i(t){return t+=1,discountNinja.DiscountedCart.IsDirty=!0,e(t,discountNinja.DiscountedCart.DiscountedCart.total_discount)}function n(t,i,n,e){i.indexOf(t)>-1?(discountNinja.CartAdjustments.Add("changequantity_setproperty",null,0,i,"",n),discountNinja.Cache.SessionSet("cartadjustment-"+e,-1)):discountNinja.CartAdjustments.Add("removeproperty",null,null,i,"",n)}function e(e,r){discountNinja_Script_PromotionFlow.AllPromotionsEvaluated=!1,discountNinja.CartAdjustments.FinishIncompleteUpdateCart().then((function(a){discountNinja.Cart.Shopify.UpdateCart((function(){discountNinja.LogSession.PrintPerformance("Cart updated"),discountNinja.Cart.Shopify.LockRefreshCart=!0,null===o&&(o=JSON.parse(JSON.stringify(window.discountNinjaContext.Cart.items))),discountNinja.Trigger.EnsureInitialPromotionsTriggered2((function(){discountNinja.Offer.Offers=discountNinja.Offer.ConvertRates(discountNinja.Offer.Offers),discountNinja.DiscountedCart.BuildDiscountedCart((function(){try{if(discountNinja.LogSession.PrintPerformance("Discounted cart built"),discountNinja.GiftWithPurchase.AddAdjustments()&&t(e,r))return i(e);!1!==discountNinja.Settings.Settings.PriceUpdate.AllowSplitRows&&discountNinja.DiscountedCart.SplitRows();var c=function(){try{if(!discountNinjaContext.Cart.items)return!1;for(var t=!1,i=discountNinja_Script_DiscountedCart.SplitRowPrefix,e=discountNinja_Script_DiscountedCart.FreeGiftPrefix,o=discountNinja_Script_DiscountedCart.LockedRowPrefix,r=discountNinja_Script_DiscountedCart.EntitlementSuffix,a=discountNinja_Script_DiscountedCart.PrerequisiteSuffix,c=0;c<discountNinjaContext.Cart.items.length;c++){var u=discountNinjaContext.Cart.items[c];if(!discountNinja.Utilities.ObjectIsEmpty(u.properties)){for(var s in u.properties)if(s.indexOf(i)>-1||s.indexOf(e)>-1||s.indexOf(o)>-1){for(var d=s.replace(i,"").replace(e,"").replace(o,"").replace(r,"").replace(a,""),l=!1,g=0;g<discountNinja.DiscountedCart.DiscountedCart.items.length;g++){var f=discountNinja.DiscountedCart.DiscountedCart.items[g];if(f.Key===u.key){f.OfferToken===d||f.Sets&&f.Sets[0].OfferToken===d?l=!0:(n(e,s,u.key,d),t=!0);break}}!l&&u.key.length>20&&(n(e,s,u.key,d),t=!0)}for(var p in u.properties)if(p.indexOf(e)>-1)for(var N in u.properties)(N.indexOf(i)>-1||N.indexOf(o)>-1)&&discountNinja.CartAdjustments.Add("removeproperty",null,null,N,"",u.key)}}return t}catch(t){return discountNinja.Logging.LogError("PromotionFlow.RemoveUnusedProperties",t),null}}(),u=function(){try{if(!discountNinjaContext.Cart.items)return!1;for(var t=!1,i=discountNinja.DiscountedCart.DiscountedCart.items,n=0;n<i.length;n++){var e=i[n],o=discountNinja.Offer.GetOfferByToken(e.OfferToken);if(o&&void 0!==o.Bogo){var r=discountNinja_Script_DiscountedCart.FreeGiftPrefix+o.Token;e.Properties||(e.Properties=[]);for(var a=!1,c=0;c<e.Properties.length;c++)if(e.Properties[c].Name===r){a=!0;break}a||(e.Properties.push({Name:r,Value:""}),t=!0);var u=discountNinja.LiquidData.CartItemByKeyAndSellingPlanId(e.Key,e.SellingPlanId);u&&!u.properties&&(u.properties={}),u&&void 0===u.properties[r]&&(discountNinja.CartAdjustments.Add("setproperty",null,null,r,"",u.key),t=!0)}}return t}catch(t){return discountNinja.Logging.LogError("PromotionFlow.AddMissingProperties",t),null}}();if(discountNinja.CartAdjustments.RegroupRows(),discountNinja_Script_PromotionFlow.MustRefreshCart=discountNinja_Script_PromotionFlow.MustRefreshCart||a||discountNinja.CartAdjustments.RequiresUpdateCart(o),(c||u)&&t(e,r))return i(e);discountNinja.CartAdjustments.UpdateCart(discountNinja_Script_PromotionFlow.MustRefreshCart).then((function(){try{if(function(){try{var t=discountNinja_Script_GiftWithPurchase.AdjustmentQuantities;if(discountNinja_Script_GiftWithPurchase.AllowAddingManuallyRemovedGifts())return void discountNinja.Cache.SessionRemove(t);var i=discountNinja.Cache.SessionGet(t),n=i?JSON.parse(i):[],e=discountNinja.Cache.SessionGet(discountNinja_Script_GiftWithPurchase.AdjustmentIntention);if(e)for(var o=JSON.parse(e),r=0;r<o.length;r++){var a=o[r];try{for(var c=!1,u=0;u<n.length;u++){var s=n[u];s.Token===a.Token&&(c=!0,s.Quantity=a.Quantity)}c||n.push(a)}catch(t){discountNinja.Logging.LogError("PromotionFlow.SaveAdjustedQuantitiesItem",t)}}discountNinja.Cache.SessionRemove(discountNinja_Script_GiftWithPurchase.AdjustmentIntention),discountNinja.Cache.SessionSet(t,JSON.stringify(n))}catch(t){discountNinja.Logging.LogError("PromotionFlow.SaveAdjustedQuantities",t)}}(),discountNinja.LogSession.PrintPerformance("Cart adjustments complete"),discountNinja.Events.Publish("cart:updated",[discountNinja.DiscountedCart.DiscountedCart]),function(){try{var t=discountNinja.Offer.Offers;if(t)for(var i=0;i<t.length;i++){var n=t[i];n&&!discountNinja.Offer.OfferIsApplicable(n)&&discountNinja_Script_PromotionFlow.UnAcceptPromotion(n)}}catch(t){discountNinja.Logging.LogError("PromotionFlow.UnacceptUnapplicableOffers",t)}}(),function(){try{var t=discountNinja.Offer.Offers;if(t)for(var i=0;i<t.length;i++){var n=t[i];n&&n.TriggeredByTrigger&&discountNinja.Offer.IsOfferAccepted(n.Token)&&discountNinja.PromotionEvent.AddToQueue(n.TriggeredByTrigger.Token,1)}}catch(t){discountNinja.Logging.LogError("PromotionFlow.SendEventsForAcceptedPromotions",t)}}(),discountNinja.DynamicPricing.ClassicCartIsDirty=!0,discountNinja.DynamicPricing.DrawerCartIsDirty=!0,discountNinja.PromotionFlow.DisplayAppliedOffers(!1),discountNinja_Script_PromotionFlow.ShowHideElementsWhenPromotionsInCart(),discountNinja_Script_Checkout_Shopify.ApplyCheckoutDataDiscountCode(),discountNinja.DiscountCode.InjectDiscountCodesInHtml(),discountNinja.DiscountedCart.HasAppliedPromotions()){var t=discountNinja.LogSession.GetId();t&&discountNinja.Cache.LocalSet("SessionLogId",t)}else discountNinja.Cache.LocalRemove("SessionLogId");discountNinja.Cart.Shopify.LockRefreshCart=!1,discountNinja_Script_PromotionFlow.MustRefreshCart&&discountNinja.CartAdjustments.RefreshAfterCartAdjustments();var i=!0!==discountNinja_Script_PromotionFlow.MustRefreshCart;discountNinja_Script_PromotionFlow.MustRefreshCart=!1,discountNinja_Script_PromotionFlow.AllPromotionsEvaluated=!0,discountNinja.Checkout.Shopify.ProcessingPrepareAdvancedCheckout||discountNinja.Checkout.Shopify.PrepareAdvancedCheckout(),discountNinja.LogSession.PrintPerformance("Flow complete"),discountNinja.LogSession.RegisterTimeToComplete(),discountNinja.DiscountCode.UpdateTags(),discountNinja.AccountLogin.CheckRedirect(),discountNinja.Checkout.Shopify.SkipProcessingCheckout=!discountNinja.Checkout.Shopify.RequiresAdvancedCheckout(),discountNinja.LogSession.LogPerformance(),setTimeout((function(){discountNinja.Events.Publish("collection:productsadded")}),1500),discountNinja.DiscountedProduct.CurrentVariantData&&discountNinja.Events.Publish("variant:priceavailable",{Variant:discountNinja.DiscountedProduct.CurrentVariantData}),discountNinja.Events.Publish("flow:complete",[]),i&&setTimeout((function(){window.discountNinjaIsReady=!0,discountNinja.DiscountedCart.DiscountedCart&&(discountNinja.DiscountedCart.DiscountedCart.IsReady=!0)}),1e3)}catch(t){discountNinja.Logging.LogError("PromotionFlow.StopFlow.AfterProcessCartAdjustments",t)}}))}catch(t){discountNinja.Logging.LogError("PromotionFlow.StopFlow.AfterBuildDiscountedCart",t)}}))}))}))}))}var o=null;window.discountNinjaIsReady=!1,discountNinja.PromotionFlow.DisplayAppliedOffers(!1),discountNinja_Script_PromotionFlow.ShowHideElementsWhenPromotionsInCart(),e(1,null)},IsBuildingBlockEnabledForPage:function(t,i,n){if(""!==i||t||(i=n+" is disabled"),""===i&&discountNinja.Environment.Shopify.IsProductPage()&&"*"!==t.ShowOn.Products){var e=discountNinja.Environment.Shopify.ProductHandle();discountNinja.Utilities.StringIsIn(t.ShowOn.Products,e)||(i=n+" is not displayed because it is disabled for product pages or not enabled for product "+e+" (limited to: "+t.ShowOn.Products+")")}if(""===i&&discountNinja.Environment.Shopify.IsHomePage()&&!t.ShowOn.HomePage&&(i=n+" is not displayed because it is disabled for the home page"),""===i&&discountNinja.Environment.Shopify.IsBlogPost()&&!t.ShowOn.BlogPosts&&(i=n+" is not displayed because it is disabled for blog posts"),""===i&&discountNinja.Environment.Shopify.IsCollectionPage()&&"*"!==t.ShowOn.Collections){var o=discountNinja.Environment.Shopify.CollectionHandle();discountNinja.Utilities.StringIsIn(t.ShowOn.Collections,o)||(i=n+" is not displayed because it is disabled for collection pages or not enabled for collection "+o+" (limited to: "+t.ShowOn.Collections+")")}return""===i&&discountNinja.Environment.Shopify.IsCustomPage()&&!t.ShowOn.CustomPages&&(i=n+" is not displayed because it is disabled for custom pages"),""===i&&discountNinja.Environment.Shopify.IsCartPage()&&!t.ShowOn.CartPage&&(i=n+" is not displayed because it is disabled for cart page"),""===i&&discountNinja.Environment.Shopify.IsSearchPage()&&!t.ShowOn.SearchPage&&(i=n+" is not displayed because it is disabled for the search page"),i},HandleFlowErrorMessage:function(t){return!t||""===t},HasPopUpBeenShownForLevel:function(t){var i=t.Token;return"shown"===function(t){return discountNinja.Cache.LocalGet("popup-displayed-"+t)}(i)&&"onceperdevice"===t.PopUp.Frequency||"shown"===function(t){return discountNinja.Cache.SessionGet("popup-displayed-"+t)}(i)&&"oncepersession"===t.PopUp.Frequency}},discountNinja_Script_Settings={Settings:null,GetPriceFormat:function(t,i,n,e){var o=function(t,i,n,e){var o=discountNinja_Script_Settings.Settings.PriceUpdate.PriceFormat;return"item-product"===t?i?o.DrawerCartProduct||o.Product:o.CartProduct||o.Product:"item-line"===t?i?o.DrawerCartLine||o.Product:o.CartLine||o.Product:"subtotal"===t?i?o.DrawerCartSubtotal||o.Product:o.CartSubtotal||o.Product:"standard"===t?(null==n&&(n=discountNinja.Environment.Shopify.IsProductPage()),!0===n?o.Product:(!0===e?o.OtherMultiTier:o.Other)||o.Other||o.Product):(discountNinja.Logging.LogWarning("GetPriceFormat - Unexpected level '"+t+"'",!0),o.Product)}(t,i,n,e);return o&&void 0!==o.Format||(o={Format:"{{DISCOUNTED_PRICE}} {{ORIGINAL_PRICE,STRIKETHROUGH}}"}),function(t){try{return null!==t&&(t.Format&&(t.Format=t.Format.replace(/\\{/g,"{").replace(/\\}/g,"}")),t.PrefixText&&(t.PrefixText=t.PrefixText.replace(/\\{/g,"{").replace(/\\}/g,"}")),t.SuffixText&&(t.SuffixText=t.SuffixText.replace(/\\{/g,"{").replace(/\\}/g,"}"))),t}catch(i){return t}}(o)},SettingsAreValid:function(t){try{return null!=t||(discountNinja.Logging.LogWarning("No settings available",!0),!1)}catch(t){discountNinja.Logging.LogError("Settings.SettingsAreValid",t)}},GetFlag:function(t){try{return"object"!=typeof window.discountNinjaContext||"object"!=typeof window.discountNinjaContext.Flags?null:window.discountNinjaContext.Flags[t]}catch(t){return discountNinja.Logging.LogError("Settings.GetFlag",t),null}}},discountNinja_Script_ShortCode_Prefix_ClassName="limoniapps-discountninja-shortcode",discountNinja_Script_ShortCode_Prefix_Attribute="data-limoniapps-discountninja-shortcode",discountNinja_Script_ShortCode_Product_Attribute="data-limoniapps-discountninja-product",discountNinja_Script_ShortCode={Attributes:{Offer:discountNinja_Script_ShortCode_Prefix_Attribute+"-offer",OfferToken:discountNinja_Script_ShortCode_Prefix_Attribute+"-offer-token",Product:discountNinja_Script_ShortCode_Prefix_Attribute+"-product"},Classes:{Placeholder:discountNinja_Script_ShortCode_Prefix_ClassName+"-placeholder"},HideShortcodePlaceholders:function(){try{discountNinja.Utilities.jQuery()("."+discountNinja_Script_ShortCode.Classes.Placeholder).css("display","none")}catch(t){discountNinja.Logging.LogError("ShortCode.HideShortcodePlaceholders",t)}},ShowShortcodePlaceholders:function(){try{var t="."+discountNinja_Script_ShortCode.Classes.Placeholder;discountNinja.Utilities.jQuery()(t).each((function(){discountNinja.Utilities.jQuery()(this).html(discountNinja_Script_ShortCode.ReplaceAllPlaceHolders(discountNinja.Utilities.jQuery()(this).html()))})),discountNinja.Utilities.jQuery()(t).css("display","block")}catch(t){discountNinja.Logging.LogError("ShortCode.ShowShortcodePlaceholders",t)}},RefreshResolvedPlaceholders:function(t,i,n){try{var e=discountNinja_Script_ShortCode.Attributes.Offer,o=discountNinja_Script_ShortCode.Attributes.OfferToken;discountNinja.Utilities.jQuery()(t).find("["+e+"]").each((function(){var t="{{"+discountNinja.Utilities.jQuery()(this).attr(e)+"}}",r=i?i.Token:discountNinja.Utilities.jQuery()(this).attr(o);if(i||(i=discountNinja.Offer.GetOfferByToken(r)),!n){var a=discountNinja.DiscountTier.GetCurrentDiscountTier(i);n=discountNinja.DiscountTier.GetPercentageAmountFromDiscountTier(a)}var c=discountNinja_Script_ShortCode.ReplacePromotionLevelPlaceHolders(i,t,!1);c=discountNinja_Script_ShortCode.ReplaceSettingsLevelPlaceHolders(i,c,!0),discountNinja.Utilities.jQuery()(this).html(c)}));var r=discountNinja_Script_ShortCode.Attributes.Product;discountNinja.Utilities.jQuery()(t).find("["+r+"]").each((function(){var t="{{"+discountNinja.Utilities.jQuery()(this).attr(r)+"}}";if(discountNinja.Utilities.jQuery()(this).attr(discountNinja_Script_ShortCode_Product_Attribute)===n.ProductHandle){var e=discountNinja_Script_ShortCode.ReplaceProductLevelPlaceHolders(t,n,!1);e=discountNinja_Script_ShortCode.ReplaceSettingsLevelPlaceHolders(i,e,!0),discountNinja.Utilities.jQuery()(this).html(e)}})),discountNinja.MultiCurrency.UpdateCurrency()}catch(t){discountNinja.Logging.LogError("ShortCode.RefreshResolvedPlaceholders",t)}},BuildResolvedPlaceHolderLink:function(t,i,n,e,o,r,a,c,u,s,d,l){try{if(discountNinja_Script_ShortCode.ContainsPlaceHolder(n,"{{"+o+"}}"))return discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,i,n,e,"{{"+o+"}}",r,a,c,s,d,l);c="<a class='limoniapps-targetlink' href='"+c+"'>"+n.match(/\{\{([^\0}])*\}\}/)[0].replace(/{/g,"").replace(/}/g,"").match(/\,([^\}])*/)[0].substring(1)+"</a>";return discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,i,n,e,"{{"+o+"}}",r,a,c,s,d,l)}catch(t){return discountNinja.Logging.LogError("ShortCode.BuildResolvedPlaceHolderLink",t),n}},BuildResolvedPlaceHolderAmount:function(t,i,n,e,o,r,a,c,u,s,d,l,g,f,p,N,j,C){function m(t,i,n,e,o,r,a,c,s,d,l,g,f,p,j){var C=function(t,i){return i?"{{"+t.replace("{{","").replace("}}","")+","+i+"}}":t}(o,r);if(discountNinja_Script_ShortCode.ContainsPlaceHolder(n,C)){var m=discountNinja.Settings.Settings.PriceUpdate.HideZeroCents;n=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,i,n,e,C,c,s,discountNinja.Utilities.FormatMoney(d,l,g,f,a,j,m),N,p,!0,a,d,u),a||(n=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,i,n,e,"<del>"+C+"</del>",c,s,discountNinja.Utilities.FormatMoney(d,l,g,f,!0,j,m),N,p,!0,a,d,u)),a||(n=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,i,n,e,"<strike>"+C+"</strike>",c,s,discountNinja.Utilities.FormatMoney(d,l,g,f,!0,j,m),N,p,!0,a,d,u)),a||(n=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,i,n,e,"<s>"+C+"</s>",c,s,discountNinja.Utilities.FormatMoney(d,l,g,f,!0,j,m),N,p,!0,a,d,u))}return n}try{return void 0===c||(c=Math.round(c),discountNinja_Script_ShortCode.ContainsPlaceHolder(n,o)&&(n=m(t,i,n,e,o,"",!1,r,a,c,s,f,p,j,C),n=m(t,i,n,e,o,"NO_DECIMALS",!1,r,a,c,d,f,p,j,C),n=m(t,i,n,e,o,"NO_CURRENCY",!1,r,a,c,l,f,p,j,C),n=m(t,i,n,e,o,"NO_DECIMALS,NO_CURRENCY",!1,r,a,c,g,f,p,j,C),n=m(t,i,n,e,o,"STRIKETHROUGH",!0,r,a,c,s,f,p,j,C),n=m(t,i,n,e,o,"STRIKETHROUGH,NO_DECIMALS",!0,r,a,c,d,f,p,j,C),n=m(t,i,n,e,o,"STRIKETHROUGH,NO_CURRENCY",!0,r,a,c,l,f,p,j,C),n=m(t,i,n,e,o,"STRIKETHROUGH,NO_DECIMALS,NO_CURRENCY",!0,r,a,c,g,f,p,j,C),n=m(t,i,n,e,o,"DIAGONALSTRIKETHROUGH","diagonal",r,a,c,s,f,p,j,C),n=m(t,i,n,e,o,"DIAGONALSTRIKETHROUGH,NO_DECIMALS","diagonal",r,a,c,d,f,p,j,C),n=m(t,i,n,e,o,"DIAGONALSTRIKETHROUGH,NO_CURRENCY","diagonal",r,a,c,l,f,p,j,C),n=m(t,i,n,e,o,"DIAGONALSTRIKETHROUGH,NO_DECIMALS,NO_CURRENCY","diagonal",r,a,c,g,f,p,j,C))),n}catch(t){return discountNinja.Logging.LogError("ShortCode.BuildResolvedPlaceHolderAmount",t),n}},BuildResolvedPlaceHolder:function(t,i,n,e,o,r,a,c,u,s,d,l,g,f){if(void 0===c)return n;var p;c=discountNinja_Script_ShortCode.ReplaceCurrencyPlaceHolders(c);var N=discountNinja.Currency.Convert(g,j),j=discountNinja.Currency.ActiveCurrency(),C=discountNinja.Settings.Settings.Currency.BaseCurrency,m=g;null!=g&&null!=f&&f!==j&&f===C&&(m=discountNinja.Currency.Convert(g,j));var S=!0===discountNinja.Settings.GetFlag("DoNotRenderMoneyClass")?"":"money ",h=d&&c!==discountNinja.GiftWithPurchase.FreeLabel()?'<span class="'+S+'limoniapps-discountninja-money geolizr-currency" data-limoniapps-discountninja-price-cents-basecurrency="'+g+'" data-limoniapps-discountninja-price-cents-presentmentcurrency="'+m+'" data-geolizr-price="'+g+'" doubly-currency="'+C+'" doubly-currency-'+C.toLowerCase()+'="'+N+'" data-currency="'+j+'">'+c+"</span>":c,_=null==a?"":'class="limoniapps-discountninja-shortcode limoniapps-discountninja-shortcode-'+a+(!0===l?" limoniapps-discountninja-strikethrough":"diagonal"===l?" limoniapps-discountninja-strikethrough-diagonal":"")+(null==s?"":" "+s)+'" ',y=discountNinja_Script_ShortCode.Attributes.OfferToken,v=t?" "+y+'="'+t.Token+'" ':"",P="product"===r?" "+discountNinja_Script_ShortCode_Product_Attribute+'="'+i.ProductHandle+'" ':"";return p=e?"<span "+_+discountNinja_Script_ShortCode_Prefix_Attribute+"-"+r+'="'+o.replace("{{","").replace("}}","")+'"'+v+P+">"+h+"</span>":h,n.toString().replace(new RegExp(o,"g"),discountNinja.Currency.EscapeDollarSignForRegEx(p))},ReplacePromotionLevelPlaceHolders:function(t,i,n){try{if("string"!=typeof i||""===i||null===i)return i;var e=discountNinja.Settings.Settings.CountdownClock,o=window.discountNinjaContext.Labels.Here,r=discountNinja.Currency.ActiveCurrency(),a=discountNinja.Currency.GetCurrencyFormat(),c=discountNinja.Utilities.GetNoDecimalsCurrencyFormat(a),u=discountNinja.Utilities.GetCurrencyFormatAmountComponent(a),s=discountNinja.Utilities.GetCurrencyFormatAmountComponent(c),d=discountNinja.DateTime,l=e.FormattingTemplateOnDate,g=e.FormattingTemplateOnTime,f="",p="",N=t.TriggeredByTrigger?t.TriggeredByTrigger.StartsAt:null;if(N){var j=d.GetUtc(N);f=d.FormatDate(j,l),p=d.FormatDate(j,g)}var C="",m="",S=t.TriggeredByTrigger?t.TriggeredByTrigger.Schedule.EndsOnDate:null;if(S){var h=d.GetUtc(S);C=d.FormatDate(h,l),m=d.FormatDate(h,g)}var _="",y="",v=t.TriggeredByTrigger&&t.TriggeredByTrigger.CountdownClock?t.TriggeredByTrigger.CountdownClock.EndsAt:S;if(v){var P=d.GetUtc(v);_=d.FormatDate(P,l),y=d.FormatDate(P,g)}var T=discountNinja.DiscountedCart.DiscountedCart,L=0;T&&T.total_discount&&(L=100*T.total_discount);var D=0,E=0;T&&(E=100*T.total_original_price),L>0&&E>0&&(D=100*Math.min(L/E,100));var I=discountNinja.DiscountedCart.GetDiscountedAmountForOffer(t.Token),O=0;I>0&&E>0&&(O=100*Math.min(I/E,100));var A=discountNinja.DiscountTier.GetCurrentDiscountTier(t);null===A&&(A=t.Tiers[0]);var k=discountNinja.DiscountTier.GetGoalDiscountTier(t);null===k&&(k=t.Tiers[0]);var b=0,R=0,U=0,w=discountNinja.DiscountTier.GetGoalDiscountTierNumber(t),F=t.Entitlement&&t.Entitlement.AllocationLimit>0?Math.min(w,t.Entitlement.AllocationLimit):w,x=k.Entitlement.Mode&&"multiple"===k.Entitlement.Mode?F:1;if(k&&k.Prerequisite&&k.Prerequisite.MaximumAmount>0&&(U=k.Prerequisite.MaximumAmount),k&&k.Prerequisite&&k.Prerequisite.MinimumAmount>0)(b=(100*(R=k.Prerequisite.MinimumAmount*x)-discountNinja.Offer.PrerequisiteItemsCartValue(t))/100)<0&&(b=0);var G=discountNinja.Set.ForTier(t,k,!0),H=G.Current.Remaining,B=G.Current.RemainingTotal,M=G.Current.Required,q=G.Current.RequiredTotal,Q=0;k&&k.Prerequisite&&k.Prerequisite.MaximumItems&&(Q=k.Prerequisite.MaximumItems);var V=discountNinja.Offer.DefaultPrerequisite(t),W=(A&&A.Entitlement&&A.Entitlement.Percentage,A&&A.Entitlement&&A.Entitlement.Amount,t.Tiers[t.Tiers.length-1]),K=W?W.Entitlement:null,X=A&&A.Entitlement?A.Entitlement.EntitledQuantity:null,J=discountNinja.Prerequisite.EntitledQuantityInfo(t,A),z=null===J||!1===J.HasEntitledQuantity||J.Entitled.Total<X?X:J.Entitled.Total,$=null===J||!1===J.HasEntitledQuantity?0:J.Entitled.DeltaWithCart,Y="2"===discountNinja.Settings.GetFlag("ShortCodeVersion");if(discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MAXIMUM_ITEMS")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MAXIMUM_ITEMS}}","offer","maximum_items",t.EntitledQuantity||0)),Y?(discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"ENTITLED_QUANTITY")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{ENTITLED_QUANTITY}}","offer","entitled_quantity",X||0)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"ENTITLED_QUANTITY_TOTAL")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{ENTITLED_QUANTITY_TOTAL}}","offer","entitled_quantity_total",z||0))):discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"ENTITLED_QUANTITY")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{ENTITLED_QUANTITY}}","offer","entitled_quantity",z||0)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"ENTITLED_QUANTITY_REMAINING")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{ENTITLED_QUANTITY_REMAINING}}","offer","entitled_quantity_remaining",$||0)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MINIMUM_CART_VALUE")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{MINIMUM_CART_VALUE}}","offer","minimum_cart_value",100*R,r,a,c,u,s,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MAXIMUM_CART_VALUE")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{MAXIMUM_CART_VALUE}}","offer","maximum_cart_value",100*U,r,a,c,u,s,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"AMOUNT_LEFT_BEFORE_DISCOUNT")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{AMOUNT_LEFT_BEFORE_DISCOUNT}}","offer","amount_left_before_discount",100*b,r,a,c,u,s,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MINIMUM_CART_PRODUCTS")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MINIMUM_CART_PRODUCTS}}","offer","minimum_cart_products",M)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MINIMUM_CART_PRODUCTS_INCLUDING_ENTITLED")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MINIMUM_CART_PRODUCTS_INCLUDING_ENTITLED}}","offer","minimum_cart_products_including_entitled",q)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MAXIMUM_CART_PRODUCTS")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MAXIMUM_CART_PRODUCTS}}","offer","maximum_cart_products",Q)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"PRODUCTS_LEFT_BEFORE_DISCOUNT")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{PRODUCTS_LEFT_BEFORE_DISCOUNT}}","offer","products_left_before_discount",H)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"PRODUCTS_LEFT_BEFORE_DISCOUNT_INCLUDING_ENTITLED")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{PRODUCTS_LEFT_BEFORE_DISCOUNT_INCLUDING_ENTITLED}}","offer","products_left_before_discount_including_entitled",B)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"DISCOUNT_CODE")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_CODE}}","offer","discount_code",discountNinja.Offer.GetPromotionDiscountCode(t))),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"STARTS_AT_DATE")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{STARTS_AT_DATE}}","offer","starts_at_date",f)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"STARTS_AT_TIME")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{STARTS_AT_TIME}}","offer","starts_at_time",p)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"ENDS_AT_DATE")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{ENDS_AT_DATE}}","offer","ends_at_date",C)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"ENDS_AT_TIME")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{ENDS_AT_TIME}}","offer","ends_at_time",m)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"EXPIRES_AT_DATE")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{EXPIRES_AT_DATE}}","offer","expires_at_date",_)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"EXPIRES_AT_TIME")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{EXPIRES_AT_TIME}}","offer","expires_at_time",y)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"OFFER_LINK_HERE")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{OFFER_LINK_HERE}}","offer","offer_link_here","<a class='limoniapps-targetlink' href='"+t.Entitlement.EntitledItemLinks+"'>"+o+"</a>")),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"OFFER_LINK")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderLink(t,null,i,n,"OFFER_LINK","offer","offer_link",t.Entitlement.EntitledItemLinks)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"PREREQUISITE_LINK")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderLink(t,null,i,n,"PREREQUISITE_LINK","offer","prerequisite_link",V?V.PrerequisiteLinks:"")),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"PREREQUISITE_EXCLUSIONS_LINK")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderLink(t,null,i,n,"PREREQUISITE_EXCLUSIONS_LINK","offer","prerequisite_exclusions_link",V?V.PrerequisiteExclusionLinks:"")),Y){var Z=k.Prerequisite?k.Prerequisite.BogoPrerequisiteQuantity:0;"bogo"!==t.Template&&"bogo_multitier"!==t.Template||(Z-=k.Entitlement.EntitledQuantity),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MINIMUM_PREREQUISITE_PRODUCTS")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MINIMUM_PREREQUISITE_PRODUCTS}}","offer","minimum_prerequisite_products",Z))}else discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MINIMUM_PREREQUISITE_PRODUCTS")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MINIMUM_PREREQUISITE_PRODUCTS}}","offer","minimum_prerequisite_products",k.Prerequisite?k.Prerequisite.MinimumItems:0));if(discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"EXCLUSIONS_LINK")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderLink(t,null,i,n,"EXCLUSIONS_LINK","offer","exclusions_link",t.Entitlement.ExcludeCollectionLinks)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MAXIMUM_GIFTS")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MAXIMUM_GIFTS}}","offer","maximum_gifts",t.Entitlement.AllocationLimit)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MAXIMUM_DISCOUNTED_ITEMS")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MAXIMUM_DISCOUNTED_ITEMS}}","offer","maximum_discounted_items",t.Entitlement.AllocationLimit)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"TOTAL_DISCOUNT_CODES")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{TOTAL_DISCOUNT_CODES}}","offer","total_discount_codes",t.UsageLimit?t.UsageLimit.Total:null)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"REMAINING_DISCOUNT_CODES")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{REMAINING_DISCOUNT_CODES}}","offer","remaining_discount_codes",t.UsageLimit?t.UsageLimit.Remaining:null)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"USED_DISCOUNT_CODES")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{USED_DISCOUNT_CODES}}","offer","used_discount_codes",t.UsageLimit&&t.UsageLimit.Total&&t.UsageLimit.Remaining?t.UsageLimit.Total-t.UsageLimit.Remaining:null)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"OFFER_TOTAL_DISCOUNT_AMOUNT")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{OFFER_TOTAL_DISCOUNT_AMOUNT}}","offer","offer_total_discount_amount",I,r,a,c,u,s,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"OFFER_TOTAL_DISCOUNT_PERCENTAGE")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{OFFER_TOTAL_DISCOUNT_PERCENTAGE}}","offer","offer_total_discount_percentage",discountNinja.Utilities.FormatPercentage(O,0)+"%")),t&&t.Entitlement&&"percentage"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"DISCOUNT_PERCENTAGE_TIER1")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE_TIER1}}","offer","discount_percentage_tier1",discountNinja.Utilities.FormatPercentage(t.Tiers[0]?t.Tiers[0].Entitlement.Percentage:0,0)+"%")),t&&t.Entitlement&&"percentage"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"DISCOUNT_PERCENTAGE_TIER2")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE_TIER2}}","offer","discount_percentage_tier2",discountNinja.Utilities.FormatPercentage(t.Tiers[1]?t.Tiers[1].Entitlement.Percentage:0,0)+"%")),t&&t.Entitlement&&"percentage"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"DISCOUNT_PERCENTAGE_TIER3")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE_TIER3}}","offer","discount_percentage_tier3",discountNinja.Utilities.FormatPercentage(t.Tiers[2]?t.Tiers[2].Entitlement.Percentage:0,0)+"%")),t&&t.Entitlement&&"percentage"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"DISCOUNT_PERCENTAGE_TIER4")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE_TIER4}}","offer","discount_percentage_tier4",discountNinja.Utilities.FormatPercentage(t.Tiers[3]?t.Tiers[3].Entitlement.Percentage:0,0)+"%")),t&&t.Entitlement&&"percentage"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"DISCOUNT_PERCENTAGE_TIER5")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE_TIER5}}","offer","discount_percentage_tier5",discountNinja.Utilities.FormatPercentage(t.Tiers[4]?t.Tiers[4].Entitlement.Percentage:0,0)+"%")),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MINIMUM_PREREQUISITE_PRODUCTS_TIER1")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MINIMUM_PREREQUISITE_PRODUCTS_TIER1}}","offer","minimum_prerequisite_products_tier1",t.Tiers[0]&&t.Tiers[0].Prerequisite?t.Tiers[0].Prerequisite.MinimumItems:0)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MINIMUM_PREREQUISITE_PRODUCTS_TIER2")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MINIMUM_PREREQUISITE_PRODUCTS_TIER2}}","offer","minimum_prerequisite_products_tier2",t.Tiers[1]&&t.Tiers[1].Prerequisite?t.Tiers[1].Prerequisite.MinimumItems:0)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MINIMUM_PREREQUISITE_PRODUCTS_TIER3")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MINIMUM_PREREQUISITE_PRODUCTS_TIER3}}","offer","minimum_prerequisite_products_tier3",t.Tiers[2]&&t.Tiers[2].Prerequisite?t.Tiers[2].Prerequisite.MinimumItems:0)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MINIMUM_PREREQUISITE_PRODUCTS_TIER4")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MINIMUM_PREREQUISITE_PRODUCTS_TIER4}}","offer","minimum_prerequisite_products_tier4",t.Tiers[3]&&t.Tiers[3].Prerequisite?t.Tiers[3].Prerequisite.MinimumItems:0)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MINIMUM_PREREQUISITE_PRODUCTS_TIER5")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MINIMUM_PREREQUISITE_PRODUCTS_TIER5}}","offer","minimum_prerequisite_products_tier5",t.Tiers[4]&&t.Tiers[4].Prerequisite?t.Tiers[4].Prerequisite.MinimumItems:0)),i=discountNinja_Script_ShortCode.ReplaceLocalePlaceHolders(i),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"TOTAL_DISCOUNT_AMOUNT")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{TOTAL_DISCOUNT_AMOUNT}}","offer","total_discount_amount",L,r,a,c,u,s,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"TOTAL_DISCOUNT_PERCENTAGE")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{TOTAL_DISCOUNT_PERCENTAGE}}","offer","total_discount_percentage",discountNinja.Utilities.FormatPercentage(D,0)+"%")),A){var tt=function(t,i){try{var n=1;return"buyx_gety"===t.OfferType&&"fixed_amount"===t.Entitlement.ValueType&&"across"===t.Entitlement.AllocationMethod&&i&&(n=discountNinja.Set.ForTier(t,i,!0).Completed),n}catch(t){return discountNinja.Logging.LogError("DiscountedCart.GetPrerequisiteUnits",t),1}}(t,A);0===tt&&(tt=1),t&&t.Entitlement&&"percentage"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"DISCOUNT_PERCENTAGE")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE}}","offer","discount_percentage",discountNinja.Utilities.FormatPercentage(A.Entitlement.Percentage,0)+"%")),t&&t.Entitlement&&"fixed_amount"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"DISCOUNT_AMOUNT")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{DISCOUNT_AMOUNT}}","offer","discount_amount",100*A.Entitlement.Amount*tt,r,a,c,u,s,2,!1,null,null,!0)),t&&t.Entitlement&&"fixed_amount"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"DISCOUNT_PERCENTAGE")&&A.Entitlement.Percentage>0&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE}}","offer","discount_percentage",discountNinja.Utilities.FormatPercentage(A.Entitlement.Percentage,0)+"%")),t&&t.Entitlement&&"percentage"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"DISCOUNT_AMOUNT")&&A.Entitlement.Amount>0&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{DISCOUNT_AMOUNT}}","offer","discount_amount",100*A.Entitlement.Amount,r,a,c,u,s,2,!1,null,null,!0)),t&&t.Entitlement&&"percentage"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"DISCOUNT")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT}}","offer","discount",discountNinja.Utilities.FormatPercentage(A.Entitlement.Percentage,0)+"%")),t&&t.Entitlement&&"fixed_amount"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"DISCOUNT")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{DISCOUNT}}","offer","discount",100*A.Entitlement.Amount*tt,r,a,c,u,s,2,!1,null,null,!0)),t&&t.Entitlement&&"fixed_price"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"FIXED_PRICE")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{FIXED_PRICE}}","offer","fixed_price",100*A.Entitlement.Amount*tt,r,a,c,u,s,2,!1,null,null,!0)),t&&t.Entitlement&&"fixed_price"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"FIXED_PRICE_UNITS")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{FIXED_PRICE_UNITS}}","offer","fixed_price_units",A.Entitlement.Units))}if(k){var it="across"===t.Entitlement.AllocationMethod?1:k.Entitlement.EntitledQuantity||1,nt=100*k.Entitlement.Amount*it,et=discountNinja.Utilities.FormatPercentage(k.Entitlement.Percentage,0)+"%";t&&t.Entitlement&&"percentage"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"NEXT_GOAL_DISCOUNT_PERCENTAGE")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{NEXT_GOAL_DISCOUNT_PERCENTAGE}}","offer","next_goal_discount_percentage",et)),t&&t.Entitlement&&"fixed_amount"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"NEXT_GOAL_DISCOUNT_AMOUNT")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{NEXT_GOAL_DISCOUNT_AMOUNT}}","offer","next_goal_discount_amount",nt,r,a,c,u,s,2,!1,null,null,!0)),t&&t.Entitlement&&"percentage"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"NEXT_GOAL_DISCOUNT")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{NEXT_GOAL_DISCOUNT}}","offer","next_goal_discount",et)),t&&t.Entitlement&&"fixed_amount"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"NEXT_GOAL_DISCOUNT")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{NEXT_GOAL_DISCOUNT}}","offer","next_goal_discount",nt,a,c,u,s,2,!1,null,null,!0))}return t&&t.Entitlement&&"percentage"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MAXIMUM_DISCOUNT")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{MAXIMUM_DISCOUNT}}","offer","maximum_discount",discountNinja.Utilities.FormatPercentage(K?K.Percentage:0,0)+"%")),t&&t.Entitlement&&"fixed_amount"===t.Entitlement.ValueType&&discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"MAXIMUM_DISCOUNT")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{MAXIMUM_DISCOUNT}}","offer","maximum_discount",100*(K?K.Amount:0),r,a,c,u,s,2,!1,null,null,!0)),i=(i=(i=(i=(i=(i=i.replace(/{{TIMER}}/g,'<span class="limoniapps-discountninja-timer" data-style="1"></span>')).replace(/{{TIMER,STYLE1}}/g,'<span class="limoniapps-discountninja-timer" data-style="1"></span>')).replace(/{{TIMER,STYLE2}}/g,'<span class="limoniapps-discountninja-timer" data-style="2"></span>')).replace(/{{TIMER,STYLE3}}/g,'<span class="limoniapps-discountninja-timer" data-style="3"></span>')).replace(/{{TIMER,STYLE4}}/g,'<span class="limoniapps-discountninja-timer" data-style="4"></span>')).replace(/{{TIMER,STYLE5}}/g,'<span class="limoniapps-discountninja-timer" data-style="5"></span>')}catch(t){return discountNinja.Logging.LogError("ShortCode.ReplacePromotionLevelPlaceHolders",t),i}},ReplaceProductLevelPlaceHolders:function(t,i,n,e){function o(t,i,n){return' style="'+(t?"color: "+t+" !important;":"")+(i?"font-size: "+i+"px !important;":"")+(n?"font-weight: "+n+" !important;":"")+'" '}function r(t,i){return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(new RegExp("{{"+i+"}}","g"),"")).replace(new RegExp("{{"+i+",NO_DECIMALS}}","g"),"")).replace(new RegExp("{{"+i+",NO_CURRENCY}}","g"),"")).replace(new RegExp("{{"+i+",NO_DECIMALS,NO_CURRENCY}}","g"),"")).replace(new RegExp("{{"+i+",STRIKETHROUGH}}","g"),"")).replace(new RegExp("{{"+i+",STRIKETHROUGH,NO_DECIMALS}}","g"),"")).replace(new RegExp("{{"+i+",STRIKETHROUGH,NO_CURRENCY}}","g"),"")).replace(new RegExp("{{"+i+",STRIKETHROUGH,NO_DECIMALS,NO_CURRENCY}}","g"),"")).replace(new RegExp("{{"+i+",DIAGONALSTRIKETHROUGH}}","g"),"")).replace(new RegExp("{{"+i+",DIAGONALSTRIKETHROUGH,NO_DECIMALS}}","g"),"")).replace(new RegExp("{{"+i+",DIAGONALSTRIKETHROUGH,NO_CURRENCY}}","g"),"")).replace(new RegExp("{{"+i+",DIAGONALSTRIKETHROUGH,NO_DECIMALS,NO_CURRENCY}}","g"),"")}try{if("string"!=typeof t||""===t||null===t)return t;e||(e="standard");var a=i.Currency,c=discountNinja.Currency.GetCurrencyFormat(),u=discountNinja.Utilities.GetNoDecimalsCurrencyFormat(c),s=discountNinja.Utilities.GetCurrencyFormatAmountComponent(c),d=discountNinja.Utilities.GetCurrencyFormatAmountComponent(u),l=i&&i.OriginalPriceTotal?i.OriginalPriceTotal:i?i.OriginalPrice:void 0,g=i.EffectiveCompareAtPrice>l?i.Amount+i.EffectiveCompareAtPrice-l:i.Amount,f=0===i.EffectiveCompareAtPrice?0:g/i.EffectiveCompareAtPrice*100,p=function(t){return o(discountNinja.Settings.GetPriceFormat(t).DiscountedPriceColor,discountNinja.Settings.GetPriceFormat(t).DiscountedPriceFontSize,discountNinja.Settings.GetPriceFormat(t).DiscountedPriceFontWeight,discountNinja.Settings.GetPriceFormat(t).DiscountedPriceCustomCssClass)}(e),N=function(t){return o(discountNinja.Settings.GetPriceFormat(t).OriginalPriceColor,discountNinja.Settings.GetPriceFormat(t).OriginalPriceFontSize,discountNinja.Settings.GetPriceFormat(t).OriginalPriceFontWeight,discountNinja.Settings.GetPriceFormat(t).OriginalPriceCustomCssClass)}(e),j=discountNinja.Settings.GetPriceFormat(e).DiscountedPriceCustomCssClass,C=discountNinja.Settings.GetPriceFormat(e).OriginalPriceCustomCssClass;!0===discountNinja.Settings.Settings.PriceUpdate.CompareAtPriceMode&&(t=(t=(t=(t=(t=(t=t.replace(/{{ORIGINAL_PRICE}}/g,"{{ORIGINAL_COMPAREAT_PRICE}}")).replace(/{{DISCOUNT_AMOUNT}}/g,"{{DISCOUNT_AMOUNT_COMPAREAT}}")).replace(/{{DISCOUNT_PERCENTAGE}}/g,"{{DISCOUNT_PERCENTAGE_COMPAREAT}}")).replace(/{{ORIGINAL_PRICE,/g,"{{ORIGINAL_COMPAREAT_PRICE,")).replace(/{{DISCOUNT_AMOUNT,/g,"{{DISCOUNT_AMOUNT_COMPAREAT,")).replace(/{{DISCOUNT_PERCENTAGE,/g,"{{DISCOUNT_PERCENTAGE_COMPAREAT,"));for(var m=null,S=0;S<5;S++){var h=i["Tier"+(S+1)];h&&(m=h)}var _=m?m.DiscountedPrice:null,y=m?m.Amount:null,v=m?m.Percentage:null;return i&&void 0!==i.CompareAtAmount&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"AMOUNT_COMPAREAT")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{AMOUNT_COMPAREAT}}","product","amount_compareat",100*i.CompareAtAmount,a,c,u,s,d,2,!1,null,null,!0)),i&&void 0!==i.DiscountedPrice&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNTED_PRICE")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNTED_PRICE}}","product","discounted_price",100*i.DiscountedPrice,a,c,u,s,d,2,!1,p,j,!0)),void 0!==l&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"ORIGINAL_PRICE")&&(t=void 0===i.DiscountedPrice||l>i.DiscountedPrice?discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{ORIGINAL_PRICE}}","product","original_price",100*l,a,c,u,s,d,2,!1,N,C,!0):r(t,"ORIGINAL_PRICE")),i&&void 0!==i.OriginalCompareAtPrice&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"ORIGINAL_COMPAREAT_PRICE")&&(t=void 0===i.DiscountedPrice||i.OriginalCompareAtPrice>i.DiscountedPrice?discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{ORIGINAL_COMPAREAT_PRICE}}","original_compareat_price","original_price",100*i.OriginalCompareAtPrice,a,c,u,s,d,2,!1,N,C,!0):r(t,"ORIGINAL_COMPAREAT_PRICE")),i&&void 0!==i.DiscountedPrice&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNTED_INSTALLMENT_4PERIODS")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNTED_INSTALLMENT_4PERIODS}}","product","discounted_price_installment_4periods",100*i.DiscountedPrice/4,a,c,u,s,d,2,!1,p,j,!0)),i&&void 0!==i.DiscountedPrice&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNTED_INSTALLMENT_3PERIODS")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNTED_INSTALLMENT_3PERIODS}}","product","discounted_price_installment_3periods",100*i.DiscountedPrice/3,a,c,u,s,d,2,!1,p,j,!0)),i&&void 0!==i.Amount&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNT_AMOUNT")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNT_AMOUNT}}","product","discount_amount",100*i.Amount,a,c,u,s,d,2,!1,null,null,!0)),i&&void 0!==i.Percentage&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNT_PERCENTAGE")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(null,i,t,n,"{{DISCOUNT_PERCENTAGE}}","product","discount_percentage",discountNinja.Utilities.FormatPercentage(i.Percentage,0)+"%")),i&&void 0!==i.Percentage&&i.Percentage>0&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNT")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(null,i,t,n,"{{DISCOUNT}}","product","discount",discountNinja.Utilities.FormatPercentage(i.Percentage,0)+"%")),i&&void 0!==i.Amount&&i.Amount>0&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNT")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNT}}","product","discount",100*i.Amount,a,c,u,s,d,2,!1,null,null,!0)),i&&void 0!==i.Amount&&i.Amount>0&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"FIXED_PRICE")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{FIXED_PRICE}}","product","fixed_price",100*i.Amount,a,c,u,s,d,2,!1,null,null,!0)),i&&void 0!==i.Amount&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNT_AMOUNT_COMPAREAT")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNT_AMOUNT_COMPAREAT}}","product","discount_amount_compareat",100*g,a,c,u,s,d,2,!1,null,null,!0)),i&&void 0!==i.Percentage&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNT_PERCENTAGE_COMPAREAT")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(null,i,t,n,"{{DISCOUNT_PERCENTAGE_COMPAREAT}}","product","discount_percentage_compareat",discountNinja.Utilities.FormatPercentage(f,0)+"%")),i&&void 0!==i.Tier1&&null!==i.Tier1&&void 0!==i.Tier1.DiscountedPrice&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNTED_PRICE_TIER1")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNTED_PRICE_TIER1}}","product","discounted_price_tier1",100*i.Tier1.DiscountedPrice,a,c,u,s,d,2,!1,p,j,!0)),i&&void 0!==i.Tier2&&null!==i.Tier2&&void 0!==i.Tier2.DiscountedPrice&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNTED_PRICE_TIER2")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNTED_PRICE_TIER2}}","product","discounted_price_tier2",100*i.Tier2.DiscountedPrice,a,c,u,s,d,2,!1,p,j,!0)),i&&void 0!==i.Tier3&&null!==i.Tier3&&void 0!==i.Tier3.DiscountedPrice&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNTED_PRICE_TIER3")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNTED_PRICE_TIER3}}","product","discounted_price_tier3",100*i.Tier3.DiscountedPrice,a,c,u,s,d,2,!1,p,j,!0)),i&&void 0!==i.Tier4&&null!==i.Tier4&&void 0!==i.Tier4.DiscountedPrice&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNTED_PRICE_TIER4")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNTED_PRICE_TIER4}}","product","discounted_price_tier4",100*i.Tier4.DiscountedPrice,a,c,u,s,d,2,!1,p,j,!0)),i&&void 0!==i.Tier5&&null!==i.Tier5&&void 0!==i.Tier5.DiscountedPrice&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNTED_PRICE_TIER5")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNTED_PRICE_TIER5}}","product","discounted_price_tier5",100*i.Tier5.DiscountedPrice,a,c,u,s,d,2,!1,p,j,!0)),null!==_&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNTED_PRICE_HIGHEST_TIER")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNTED_PRICE_HIGHEST_TIER}}","product","discounted_price_highest_tier",100*_,a,c,u,s,d,2,!1,p,j,!0)),null!==y&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNT_AMOUNT_HIGHEST_TIER")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(null,i,t,n,"{{DISCOUNT_AMOUNT_HIGHEST_TIER}}","product","discount_amount_highest_tier",100*y,a,c,u,s,d,2,!1,null,null,!0)),null!==v&&discountNinja_Script_ShortCode.ContainsPlaceHolder(t,"DISCOUNT_PERCENTAGE_HIGHEST_TIER")&&(t=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(null,i,t,n,"{{DISCOUNT_PERCENTAGE_HIGHEST_TIER}}","product","discount_percentage_highest_tier",discountNinja.Utilities.FormatPercentage(v,0)+"%")),t}catch(t){discountNinja.Logging.LogError("ShortCode.ReplaceProductLevelPlaceHolders",t)}},ContainsPlaceHolder:function(t,i){try{return""!==t&&null!==t&&"string"==typeof t&&t.indexOf(i.replace("{{","").replace("}}",""))>-1}catch(t){return!1}},ReplaceSettingsLevelPlaceHolders:function(t,i,n){try{if(""===i||null===i||"string"!=typeof i)return i;var e=discountNinja.Currency.GetCurrencyFormat(),o=discountNinja.Utilities.GetNoDecimalsCurrencyFormat(e),r=discountNinja.Utilities.GetCurrencyFormatAmountComponent(e),a=discountNinja.Utilities.GetCurrencyFormatAmountComponent(o),c=discountNinja.DiscountedCart.DiscountedCart,u=c?c.Currency:"",s=0;c&&(s=100*c.subtotal_original_price);var d=0;c&&(d=100*c.subtotal_original_price_excluding_gifts);var l=0;c&&(l=100*c.subtotal_discounted_price);var g=c&&0!==s&&s!==l?s:"",f=c&&0!==d&&d!==l?d:"",p=0;c&&(p=100*c.subtotal_discount);var N=0;c&&(N=100*c.subtotal_discount_excluding_gifts);var j=0;c&&(j=100*c.total_original_price);var C=0;c&&(C=100*c.total_original_price_excluding_gifts);var m=0;c&&(m=100*c.total_discounted_price);var S=c&&0!==j&&j!==m?j:"",h=c&&0!==C&&C!==m?C:"",_=0;c&&(_=100*c.total_discount);var y=0;c&&(y=100*c.total_discount_excluding_gifts);var v=0;_>0&&j>0&&(v=100*Math.min(_/j,100));var P=0;y>0&&j>0&&(P=100*Math.min(y/j,100));var T=0;p>0&&s>0&&(T=100*Math.min(p/s,100));var L=0;N>0&&s>0&&(L=100*Math.min(N/d,100));var D=0;c&&(D=100*c.cartlevel_discount);var E=0;D>0&&l>0&&(E=100*Math.min(D/l,100)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{TOTAL_PRICE}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{TOTAL_PRICE}}","offer","total_price",j,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{TOTAL}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{TOTAL}}","offer","total",j,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{TOTAL_EXCLUDING_GIFTS}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{TOTAL_EXCLUDING_GIFTS}}","offer","total_excluding_gifts",C,e,u,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{TOTAL_IF_DIFFERENT}}")&&(i=""===S?i.replace(/{{TOTAL_IF_DIFFERENT([^}])*}}/g,""):discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{TOTAL_IF_DIFFERENT}}","offer","total_if_different",S,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{TOTAL_EXCLUDING_GIFTS_IF_DIFFERENT}}")&&(i=""===h?i.replace(/{{TOTAL_EXCLUDING_GIFTS_IF_DIFFERENT([^}])*}}/g,""):discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{TOTAL_EXCLUDING_GIFTS_IF_DIFFERENT}}","offer","total_excluding_gifts_if_different",h,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{SUBTOTAL}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{SUBTOTAL}}","offer","subtotal",s,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{SUBTOTAL_EXCLUDING_GIFTS}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{SUBTOTAL_EXCLUDING_GIFTS}}","offer","subtotal_excluding_gifts",d,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{SUBTOTAL_IF_DIFFERENT}}")&&(i=""===g?i.replace(/{{SUBTOTAL_IF_DIFFERENT([^}])*}}/g,""):discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{SUBTOTAL_IF_DIFFERENT}}","offer","subtotal_if_different",g,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{SUBTOTAL_EXCLUDING_GIFTS_IF_DIFFERENT}}")&&(i=""===f?i.replace(/{{SUBTOTAL_EXCLUDING_GIFTS_IF_DIFFERENT([^}])*}}/g,""):discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{SUBTOTAL_EXCLUDING_GIFTS_IF_DIFFERENT}}","offer","subtotal_excluding_gifts_if_different",f,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{DISCOUNTED_TOTAL}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{DISCOUNTED_TOTAL}}","offer","discounted_total",m,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{DISCOUNTED_SUBTOTAL}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{DISCOUNTED_SUBTOTAL}}","offer","discounted_subtotal",l,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{TOTAL_DISCOUNT}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{TOTAL_DISCOUNT}}","offer","total_discount",_,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{TOTAL_DISCOUNT_EXCLUDING_GIFTS}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{TOTAL_DISCOUNT_EXCLUDING_GIFTS}}","offer","total_discount_excluding_gifts",y,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{LINELEVEL_DISCOUNT}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{LINELEVEL_DISCOUNT}}","offer","linelevel_discount",p,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{LINELEVEL_DISCOUNT_EXCLUDING_GIFTS}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{LINELEVEL_DISCOUNT_EXCLUDING_GIFTS}}","offer","linelevel_discount_excluding_gifts",N,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{ORDERLEVEL_DISCOUNT}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{ORDERLEVEL_DISCOUNT}}","offer","orderlevel_discount",D,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{DISCOUNT_PERCENTAGE_SUBTOTAL}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE_SUBTOTAL}}","offer","discount_percentage_subtotal",discountNinja.Utilities.FormatPercentage(T,0)+"%")),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{DISCOUNT_PERCENTAGE_LINELEVEL}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE_LINELEVEL}}","offer","discount_percentage_linelevel",discountNinja.Utilities.FormatPercentage(T,0)+"%")),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{DISCOUNT_PERCENTAGE_LINELEVEL_EXCLUDING_GIFTS}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE_LINELEVEL_EXCLUDING_GIFTS}}","offer","discount_percentage_linelevel_excluding_gifts",discountNinja.Utilities.FormatPercentage(L,0)+"%")),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{DISCOUNT_PERCENTAGE_TOTAL}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE_TOTAL}}","offer","discount_percentage_total",discountNinja.Utilities.FormatPercentage(v,0)+"%")),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{DISCOUNT_PERCENTAGE_TOTAL_EXCLUDING_GIFTS}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE_TOTAL_EXCLUDING_GIFTS}}","offer","discount_percentage_total_excluding_gifts",discountNinja.Utilities.FormatPercentage(P,0)+"%")),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{DISCOUNT_PERCENTAGE_ORDERLEVEL}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{DISCOUNT_PERCENTAGE_ORDERLEVEL}}","offer","discount_percentage_orderlevel",discountNinja.Utilities.FormatPercentage(E,0)+"%")),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{DISCOUNTED_INSTALLMENT_4PERIODS_SUBTOTAL}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{DISCOUNTED_INSTALLMENT_4PERIODS_SUBTOTAL}}","offer","discounted_installment_4periods_subtotal",m/4,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{DISCOUNTED_INSTALLMENT_3PERIODS_SUBTOTAL}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{DISCOUNTED_INSTALLMENT_3PERIODS_SUBTOTAL}}","offer","discounted_installment_3periods_subtotal",m/3,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{DISCOUNTED_INSTALLMENT_4PERIODS_TOTAL}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{DISCOUNTED_INSTALLMENT_4PERIODS_TOTAL}}","offer","discounted_installment_4periods_total",m/4,u,e,o,r,a,2,!1,null,null,!1)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{DISCOUNTED_INSTALLMENT_3PERIODS_TOTAL}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolderAmount(t,null,i,n,"{{DISCOUNTED_INSTALLMENT_3PERIODS_TOTAL}}","offer","discounted_installment_3periods_total",m/3,u,e,o,r,a,2,!1,null,null,!1));var I=discountNinja.Utilities.GetCountryName(discountNinja.Environment.Shopify.Locale(),discountNinjaContext.CountryISOCode)||discountNinjaContext.CountryName;if(discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{COUNTRY}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{COUNTRY}}","offer","country",I)),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{COUNTRY,UPPERCASE}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{COUNTRY,UPPERCASE}}","offer","country_uppercase",I?I.toUpperCase():"")),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{COUNTRY_ISOCODE}}")&&(i=discountNinja_Script_ShortCode.BuildResolvedPlaceHolder(t,null,i,n,"{{COUNTRY_ISOCODE}}","offer","country_isocode",discountNinjaContext.CountryISOCode)),i=(i=i.replace(/{{NEW_LINE}}/g,"<br>")).replace(/{{DISCOUNT_ICON}}/g,'<svg class="limoniapps-discountninja-icon-discount" aria-hidden="true" focusable="false"> <use xlink:href="#tags-filled">#shadow-root (closed)<svg id="tags-filled"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18"><path d="M17.78 3.09C17.45 2.443 16.778 2 16 2h-5.165c-.535 0-1.046.214-1.422.593l-6.82 6.89c0 .002 0 .003-.002.003-.245.253-.413.554-.5.874L.738 8.055c-.56-.953-.24-2.178.712-2.737L9.823.425C10.284.155 10.834.08 11.35.22l4.99 1.337c.755.203 1.293.814 1.44 1.533z" fill-opacity=".55"></path><path d="M10.835 2H16c1.105 0 2 .895 2 2v5.172c0 .53-.21 1.04-.586 1.414l-6.818 6.818c-.777.778-2.036.782-2.82.01l-5.166-5.1c-.786-.775-.794-2.04-.02-2.828.002 0 .003 0 .003-.002l6.82-6.89C9.79 2.214 10.3 2 10.835 2zM13.5 8c.828 0 1.5-.672 1.5-1.5S14.328 5 13.5 5 12 5.672 12 6.5 12.672 8 13.5 8z"></path></svg></svg></use></svg>'),i=(i=void 0!==String.fromCodePoint?(i=i.replace(/{{SHIPPING_ICON}}/g,String.fromCodePoint("0x1f69a"))).replace(/{{GIFT_ICON}}/g,String.fromCodePoint("0x1f381")):(i=i.replace(/{{SHIPPING_ICON}}/g,"")).replace(/{{GIFT_ICON}}/g,"")).replace(/{{DISCOUNT_PERCENTAGE_ICON}}/g,'<svg class="limoniapps-discountninja-icon-coupon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><defs><style>.a{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>icon-coupon</title><line class="a" x1="6.75" y1="17.25" x2="17.25" y2="6.75"></line><circle class="a" cx="8.25" cy="8.25" r="1.5"></circle><circle class="a" cx="15.75" cy="15.75" r="1.5"></circle><path class="a" d="M.75,3.75V2.25A1.5,1.5,0,0,1,2.25.75h1.5"></path><path class="a" d="M3.75,23.25H2.25a1.5,1.5,0,0,1-1.5-1.5v-1.5"></path><line class="a" x1="0.75" y1="7.5" x2="0.75" y2="10.5"></line><line class="a" x1="0.75" y1="13.5" x2="0.75" y2="16.5"></line><line class="a" x1="23.25" y1="7.5" x2="23.25" y2="10.5"></line><line class="a" x1="7.5" y1="0.75" x2="10.5" y2="0.75"></line><path class="a" d="M23.25,20.25v1.5a1.5,1.5,0,0,1-1.5,1.5h-1.5"></path><line class="a" x1="23.25" y1="16.5" x2="23.25" y2="13.5"></line><line class="a" x1="16.5" y1="23.25" x2="13.5" y2="23.25"></line><line class="a" x1="13.5" y1="0.75" x2="16.5" y2="0.75"></line><path class="a" d="M20.25.75h1.5a1.5,1.5,0,0,1,1.5,1.5v1.5"></path><line class="a" x1="10.5" y1="23.25" x2="7.5" y2="23.25"></line></svg>'),discountNinja_Script_ShortCode.ContainsPlaceHolder(i,"{{OFFER_COUNT}}")){var O=discountNinja.Notification.GetFromCache()||[];i=i.replace(/{{OFFER_COUNT}}/g,O.length)}return i=discountNinja_Script_ShortCode.ReplaceCurrencyPlaceHolders(i)}catch(t){return discountNinja.Logging.LogError("ShortCode.ReplaceSettingsLevelPlaceHolders",t),i}},ReplaceCurrencyPlaceHolders:function(t){try{if(""===t||null===t||"string"!=typeof t)return t;var i=discountNinja.Settings.Settings.Currency,n=i.BaseCurrency,e=i.BaseCurrencySymbol;return window.Shopify&&window.Shopify.currency&&void 0!==window.Shopify.currency.active&&null!==window.Shopify.currency.active&&""!==window.Shopify.currency.active&&(n=window.Shopify.currency.active,e=discountNinja_Script_Currency.GetCurrencySymbol(n)),t=(t=(t=(t=t.replace(/{{ACTIVE_CURRENCY}}/g,n)).replace(/{{ACTIVE_CURRENCY_SYMBOL}}/g,e)).replace(/{{CURRENCY}}/g,i.BaseCurrency)).replace(/{{CURRENCY_SYMBOL}}/g,i.BaseCurrencySymbol)}catch(i){return discountNinja.Logging.LogError("ShortCode.ReplaceCurrencyPlaceHolders",i),t}},ReplaceLocalePlaceHolders:function(t){try{if(""===t||null===t||"string"!=typeof t)return t;var i=discountNinja.Environment.Shopify.NonPrimaryLocale()||"";return t=(t=t.replace(/{{LOCALE_ISO_CODE}}\//g,""===i||null===i?"/":"/"+i+"/")).replace(/{{LOCALE_ISO_CODE}}/g,discountNinja.Environment.Shopify.Locale())}catch(i){return discountNinja.Logging.LogError("ShortCode.ReplaceLocalePlaceHolders",i),t}},ReplaceAllPlaceHolders:function(t,i,n,e){return i=discountNinja_Script_ShortCode.ReplaceSettingsLevelPlaceHolders(t,i,!0),t&&(i=discountNinja_Script_ShortCode.ReplacePromotionLevelPlaceHolders(t,i,!0)),n&&(i=discountNinja_Script_ShortCode.ReplaceProductLevelPlaceHolders(i,n,!0,e)),i}},discountNinja_Script_TestMode={TestModeDynamicStylesAdded:!1,TestModeCacheKey:"discountninjatestmode",TestModeTokenCacheKey:"discountninjatestmodetoken",TestMode:function(){return"true"===discountNinja.Cache.SessionGet(discountNinja_Script_TestMode.TestModeCacheKey)},TestModeToken:function(){return discountNinja.Cache.SessionGet(discountNinja_Script_TestMode.TestModeTokenCacheKey)},MatchByTokenOnly:!1,HandleQueryParameter:function(){var t="discountninja";discountNinja_Script_TestMode.MatchByTokenOnly=discountNinja.QueryParameter.GetFlag(t+"tokenonly",!0,!0,!1,!0),discountNinja.QueryParameter.GetFlag(t+"testmode",!0,!0,!1,!0),discountNinja.QueryParameter.GetFlag(t+"testmodetoken",!0,!0,null,!1)}},discountNinja_Script_Token={TokenNonAutomaticSession:"token-non-automatic-session",PromotionCodeNonAutomaticSession:"promotioncode-non-automatic-session",SavedPromotionCodeKey:"savedpromotioncode",SavedTokenKey:"savedtoken",RemoveSavedTokens:function(){try{discountNinja.Cache.SessionRemove(discountNinja_Script_Token.SavedTokenKey),discountNinja.Cache.SessionRemove(discountNinja_Script_Token.SavedPromotionCodeKey)}catch(t){return discountNinja.Logging.LogError("Token.RemoveSavedToken",t),""}},GetTokenFromQueryParameter:function(){try{var t=discountNinja.QueryParameter.Get("token");return t?t.toUpperCase():function(){try{var t=discountNinja.Cache.SessionGet(discountNinja_Script_Token.SavedTokenKey);return t?t.toUpperCase():""}catch(t){return discountNinja.Logging.LogError("Token.GetSavedToken",t),""}}()}catch(t){return discountNinja.Logging.LogError("Token.GetTokenFromQueryParameter",t),""}},GetTokenFromPromotionOrQueryParameter:function(t){try{var i=null;return t&&(i=t?t.Token:null),null===i&&(i=discountNinja_Script_Token.GetTokenFromQueryParameter()),i?i.toUpperCase():""}catch(t){return discountNinja.Logging.LogError("Token.GetTokenFromPromotionOrQueryParameter ",t,!1),""}},GetPromotionCodeFromQueryParameter:function(){try{var t=discountNinja.QueryParameter.Get("promotionCode");return t?t.toUpperCase():function(){try{var t=discountNinja.Cache.SessionGet(discountNinja_Script_Token.SavedPromotionCodeKey);return t?t.toUpperCase():""}catch(t){return discountNinja.Logging.LogError("Token.GetSavedPromotionCode",t),""}}()}catch(t){return discountNinja.Logging.LogError("Token.GetPromotionCodeFromQueryParameter",t),""}},GetNonAutomaticTokenOrPromotionCode:function(){try{var t=discountNinja_Script_Token.GetTokenFromPromotionOrQueryParameter(),i=discountNinja_Script_Token.GetPromotionCodeFromQueryParameter();return null!==t&&""!==t||null!==i&&""!==i||null!==(t=discountNinja_Script_Token.GetNonAutomaticTokenFromCache())&&""!==t||(i=discountNinja_Script_Token.GetNonAutomaticPromotionCodeFromCache()),{Token:t=t?t.toUpperCase():"",PromotionCode:i=i?i.toUpperCase():""}}catch(t){return discountNinja.Logging.LogError("Token.GetNonAutomaticTokenOrPromotionCode ",t,!1),""}},GetNonAutomaticToken:function(){try{var t=discountNinja_Script_Token.GetTokenFromPromotionOrQueryParameter();return null!==t&&""!==t||(t=discountNinja_Script_Token.GetNonAutomaticTokenFromCache()),t?t.toUpperCase():""}catch(t){return discountNinja.Logging.LogError("Token.GetNonAutomaticToken ",t,!1),""}},GetNonAutomaticPromotionCode:function(){try{var t=discountNinja_Script_Token.GetPromotionCodeFromQueryParameter();return null!==t&&""!==t||(t=discountNinja_Script_Token.GetNonAutomaticPromotionCodeFromCache()),t?t.toUpperCase():""}catch(t){return discountNinja.Logging.LogError("Token.GetNonAutomaticPromotionCode ",t,!1),""}},GetToken:function(t){try{var i=discountNinja_Script_Token.GetTokenFromPromotionOrQueryParameter(t);return null!==i&&""!==i||(i=discountNinja_Script_Token.GetTokenFromLocalStorage()),i?i.toUpperCase():""}catch(t){return discountNinja.Logging.LogError("Token.GetToken ",t,!1),""}},GetTokenFromLocalStorage:function(){return discountNinja.Cache.LocalGet("token-device")},SetTokenInLocalStorage:function(t){discountNinja.Cache.LocalSet("token-device",t)},RemoveCartTokenFromLocalStorage:function(){discountNinja.Cache.LocalRemove("token-cart-device")},GetNonAutomaticTokenFromCache:function(){try{var t=discountNinja_Script_Token.TokenNonAutomaticSession,i=discountNinja.Cache.SessionGet(t),n=discountNinja_Script_Token.UseLocalStorageForNonAutomaticToken();if((null===i||""===i)&&n){var e=discountNinja.Cache.LocalGet(t);if(null!=e&&""!==e){var o=null;if(-1===e.indexOf("{")?(discountNinja_Script_Token.SetNonAutomaticTokenToCache(e),o={Token:e,ExpiresOn:Date.now()}):o=JSON.parse(e),null!=o){var r=discountNinja.Settings.Settings.General.ShareableLinksExpiration||1;(-1===r||Date.now()-o.ExpiresOn<864e5*r)&&(i=o.Token)}}}return i}catch(t){return discountNinja.Logging.LogError("Token.GetNonAutomaticTokenFromCache ",t,!1),null}},UseLocalStorageForNonAutomaticToken:function(){try{return discountNinja.Settings.Settings&&!0===discountNinja.Settings.Settings.General.StoreShareableLinks}catch(t){return discountNinja.Logging.LogError("Token.UseLocalStorageForNonAutomaticToken",t),!1}},SetNonAutomaticTokenToCache:function(t){try{var i=discountNinja_Script_Token.TokenNonAutomaticSession;discountNinja.Cache.SessionSet(i,t);var n=discountNinja_Script_Token.UseLocalStorageForNonAutomaticToken();n&&"CHECKOUTTEST"!==t&&"DPTEST"!==t&&!0!==discountNinja.TestMode.TestMode()&&discountNinja.Cache.LocalSet(i,JSON.stringify({Token:t,ExpiresOn:Date.now()})),n||discountNinja.Cache.LocalRemove(i)}catch(t){discountNinja.Logging.LogError("Token.SetNonAutomaticTokenToCache ",t,!1)}},RemoveNonAutomaticTokenFromCache:function(){try{var t=discountNinja_Script_Token.TokenNonAutomaticSession;discountNinja.Cache.SessionRemove(t),discountNinja.Cache.LocalRemove(t)}catch(t){discountNinja.Logging.LogError("Token.RemoveNonAutomaticTokenFromCache ",t,!1)}},GetNonAutomaticPromotionCodeFromCache:function(){try{var t=discountNinja_Script_Token.PromotionCodeNonAutomaticSession,i=discountNinja.Cache.SessionGet(t);return null!==i&&""!==i||(i=discountNinja.Cache.LocalGet(t)),i}catch(t){discountNinja.Logging.LogError("Token.GetNonAutomaticPromotionCodeFromCache ",t,!1)}},SetNonAutomaticPromotionCodeToCache:function(t){try{var i=discountNinja_Script_Token.PromotionCodeNonAutomaticSession;discountNinja.Cache.SessionSet(i,t),discountNinja.Settings.Settings&&!0===discountNinja.Settings.Settings.General.StoreShareableLinks?discountNinja.Cache.LocalSet(i,t):discountNinja.Cache.LocalRemove(i)}catch(t){discountNinja.Logging.LogError("Token.SetNonAutomaticPromotionCodeToCache ",t,!1)}}},discountNinja_Script_Trigger={OffersToTrigger:[],Clear:function(){try{var t=discountNinja.Offer.Triggers;if(!t)return;for(var i=0;i<t.length;i++)t[i].Triggered=!1}catch(t){discountNinja.Logging.LogError("Trigger.Clear",t)}},TriggerOffers:function(t){discountNinja_Script_Trigger.OffersToTrigger||(discountNinja_Script_Trigger.OffersToTrigger=[]),t&&(discountNinja_Script_Trigger.OffersToTrigger=discountNinja_Script_Trigger.OffersToTrigger.concat(t)),discountNinja_Script_Trigger.ProcessOffersToTrigger()},GetTriggerByToken:function(t){var i=discountNinja_Script_Offer.Triggers;return i&&i.find((function(i){return i.Token===t}))||null},EnsureInitialPromotionsTriggered2:function(t){!function i(){if(discountNinja_Script_Trigger.InitialPromotionsTriggered)return t();setTimeout((function(){i()}),50)}()},EnsureInitialPromotionsTriggered:function(t){return t()},InitialPromotionsTriggered:!1,ProcessOffersToTriggerDebounced:function(){var t=discountNinja_Script_Trigger.OffersToTrigger;if(null!==t){discountNinja_Script_Trigger.OffersToTrigger=null;for(var i=[],n=!0,e=0;e<t.length;e++){if(u=discountNinja.Offer.GetOfferByToken(t[e].offerToken)){u.TriggeredByTrigger=t[e].trigger;var o=u.Tiers[0].DiscountCode.Code;"link"===u.TriggeredByTrigger.Source&&o!==u.Token&&i.push(o),discountNinja.Offer.Offers||(discountNinja.Offer.Offers=[]);for(var r=!1,a=0;a<discountNinja.Offer.Offers.length;a++)if(discountNinja.Offer.Offers[a].Token===u.Token){r=!0;break}r||discountNinja.Offer.Offers.push(u),discountNinja.PromotionFlow.ViewPromotion(u),(u.AutoAccept||discountNinja.Offer.IsOfferAccepted(u.Token,u.Frequency))&&discountNinja.PromotionFlow.AcceptPromotion(u),discountNinja.Timer.ShouldNotStart(u)&&(n=!1)}}if(n||discountNinja.Timer.Stop(),discountNinja.Offer.FilterPromotions(),function(){if(discountNinja.Offer.SetPrimaryOffer(),null===discountNinja.Offer.PrimaryOffer)discountNinja.PromotionFlow.StopFlow()}(),i.length>0)for(e=0;e<i.length;e++){o=i[e];var c={Offers:[],Triggers:[]};for(a=0;a<discountNinja.Offer.Offers.length;a++){var u=discountNinja.Offer.Offers[a];discountNinja.Offer.IsLinkedToDiscountCode(u,o)&&(c.Offers.push(u),0===c.Triggers.length&&c.Triggers.push(u.TriggeredByTrigger))}discountNinja.DiscountCodeTrigger.Add(o,c,"code-dn")}discountNinja_Script_Trigger.InitialPromotionsTriggered=!0,discountNinja.LogSession.PromotionsApplied(discountNinja.Offer.Offers,discountNinja.Offer.Triggers,discountNinja.Offer.Source,discountNinja.Offer.SourceReason),discountNinja.DiscountedCart.IsDirty=!0,discountNinja_Script_PromotionFlow.StopFlow()}},IntializeTimeOnPageCounter:function(){try{discountNinja.Cache.SessionSet("trigger-time-on-page",0),null!==discountNinja_Script_Trigger.TimeOnPageCounterIntervalId&&0!==discountNinja_Script_Trigger.TimeOnPageCounterIntervalId&&clearInterval(discountNinja_Script_Trigger.TimeOnPageCounterIntervalId),discountNinja_Script_Trigger.TimeOnPageCounterIntervalId=window.setInterval((function(){var t=discountNinja.Cache.SessionGet("trigger-time-on-page");t=!t||isNaN(t)?0:parseInt(t),discountNinja.Cache.SessionSet("trigger-time-on-page",t+1)}),1e3)}catch(t){discountNinja.Logging.LogError("Trigger.IntializeTimeOnPageCounter",t)}},TrackExitIntent:function(){try{discountNinja.Cache.SessionSet("trigger-exit-intent","false");var t=discountNinja.Settings.Settings.General.ExitIntentMode;t||(t="default");ouibounce(!1,{aggressive:!0,timer:"aggressive"===t?0:1e3,delay:"aggressive"===t?150:0,sensitivity:"aggressive"===t?80:20,callback:function(){discountNinja.Cache.SessionSet("trigger-exit-intent","true")}})}catch(t){discountNinja.Logging.LogError("Trigger.TrackExitIntent",t)}},TrackScrollPercentage:function(){function t(){try{var t=discountNinja.Cache.SessionGet("trigger-scroll-percentage");if(100===t)return;var i=discountNinja.Utilities.jQuery()(window).height(),n=discountNinja.Utilities.jQuery()(document).height(),e=discountNinja.Utilities.jQuery()(window).scrollTop(),o=n-i,r=Math.floor(e/o*100);r>t&&discountNinja.Cache.SessionSet("trigger-scroll-percentage",r)}catch(t){return 0}}try{discountNinja.Cache.SessionSet("trigger-scroll-percentage",0),discountNinja.Utilities.jQuery()(window).on("scroll",(function(){t()})),t()}catch(t){discountNinja.Logging.LogError("Trigger.TrackScrollPercentage",t)}},MarkPageAsVisited:function(){try{var t=discountNinja.Cache.SessionGet("trigger-pages-visited-list");t=null===t?[]:t.split(","),-1===discountNinja.Utilities.jQuery().inArray(window.location.pathname,t)&&t.push(window.location.pathname);var i=t.length;discountNinja.Cache.SessionSet("trigger-pages-visited-list",t),discountNinja.Cache.SessionSet("trigger-pages-visited",i)}catch(t){discountNinja.Logging.LogError("Trigger.MarkPageAsVisited",t)}},ValidForPage:function(t){try{var i=discountNinja.Settings.Settings.PopUp;if(!t.PopUp||!t.PopUp.Enabled)return!0;var n=discountNinja.PromotionFlow.IsBuildingBlockEnabledForPage(i,"","Pop-up");if(!discountNinja.PromotionFlow.HandleFlowErrorMessage(n))return!1;var e=i.ShowOn,o=t.Trigger;return discountNinja.Environment.Shopify.IsCustomPage()&&t.PopUp.Enabled?!!e.ShowOnCustomPages&&!("custom"===o.CustomPagesIncluded&&!discountNinja.Utilities.StringIsIn(o.CustomPageContains,discountNinja.Environment.Shopify.CustomPageHandle())):discountNinja.Environment.Shopify.IsBlogPost()&&t.PopUp.Enabled?!!e.ShowOnBlogPosts&&(!("blogequals"===o.BlogPostsIncluded&&!discountNinja.Utilities.StringIsIn(o.BlogEquals,discountNinja.Environment.Shopify.BlogHandle()))&&(!("postcontains"===o.BlogPostsIncluded&&!discountNinja.Utilities.StringIsIn(o.BlogPostHandleContains,discountNinja.Environment.Shopify.BlogPostHandle()))&&!("blogandpostcontains"===o.BlogPostsIncluded&&!discountNinja.Utilities.StringIsIn(o.BlogPostHandleContains,discountNinja.Environment.Shopify.BlogPostHandle())&&!discountNinja.Utilities.StringIsIn(o.BlogEquals,discountNinja.Environment.Shopify.BlogHandle())))):!discountNinja.Environment.Shopify.IsCollectionPage()||!t.PopUp.Enabled||!!e.ShowOnCollectionPages&&(!("overrideinclude"===o.TargetCollectionHandleMode&&!discountNinja.Utilities.StringIsIn(o.OverrideCollectionHandles,discountNinja.Environment.Shopify.CollectionHandle()))&&("overrideexclude"!==o.TargetCollectionHandleMode||!discountNinja.Utilities.StringIsIn(o.OverrideCollectionHandles,discountNinja.Environment.Shopify.CollectionHandle())))}catch(t){discountNinja.Logging.LogError("Trigger.PromotionTriggersOnPage",t)}},FilterConditionsAreMet:function(t){var i=t.Filter;return function(t){var i=discountNinja.DateTime,n=!0===discountNinja.TestMode.TestMode()&&t.Token===discountNinja.Token.GetNonAutomaticTokenFromCache();return!(null!==t.StartsAt&&void 0!==t.StartsAt&&""!==t.StartsAt&&i.DiffInSeconds(i.UtcNow(),i.GetUtc(t.StartsAt))<0&&!n)&&!(void 0!==t.EndsAt&&null!==t.EndsAt&&""!==t.EndsAt&&i.DiffInSeconds(i.UtcNow(),i.GetUtc(t.EndsAt))>=0)}(t)&&function(i){var n=!0===discountNinja.TestMode.TestMode()&&t.Token===discountNinja.Token.GetTokenFromQueryParameter(),e=("guests"===i.CustomerType||i.CustomerType,"signedin"===i.CustomerType||"all"===i.CustomerType);if("none"===i.CustomerType&&!n)return!1;if(i.CustomerType&&"signedin"===i.CustomerType&&!discountNinja.Environment.Shopify.IsCustomer()){if(!n)return!1}else if("guests"===i.CustomerType&&discountNinja.Environment.Shopify.IsCustomer()&&!n)return!1;if(e&&"all"!==i.CustomerTagType){var o=discountNinja.Environment.Shopify.CustomerTags(),r=!1;if(o&&i.CustomerTags)for(var a=i.CustomerTags.split(","),c=0;c<o.length;c++){for(var u=0;u<a.length;u++)if(o[c].toLowerCase().trim()===a[u].toLowerCase().trim()){r=!0;break}if(r)break}if("include"===i.CustomerTagType&&!1===r&&!n)return!1;if("exclude"===i.CustomerTagType&&!0===r&&!n)return!1}var s=discountNinja.Environment.Shopify;return!(e&&void 0!==i.MinimumOrders&&null!==i.MinimumOrders&&s.CustomerNumberOfOrders()<i.MinimumOrders)&&!(e&&void 0!==i.MaximumOrders&&null!==i.MaximumOrders&&s.CustomerNumberOfOrders()>i.MaximumOrders)}(i)&&!0},VisitorBehaviorConditionsAreMet:function(t){try{if("true"===discountNinja.Cache.SessionGet("trigger-conditions-met-"+t.Token))return!0;if(discountNinja.PromotionFlow.HasPopUpBeenShownForLevel(t))return!0;var i=t.Trigger;if(!i||"none"===i.Type)return!0;var n=null!==i.ScrollPercentage&&void 0!==i.ScrollPercentage&&!1!==i.ScrollPercentage,e=null!==i.PagesVisited&&void 0!==i.PagesVisited&&!1!==i.PagesVisited,o=null!==i.OnExitIntent&&void 0!==i.OnExitIntent&&!1!==i.OnExitIntent,r=null!==i.TimeOnPageInSeconds&&void 0!==i.TimeOnPageInSeconds&&!1!==i.TimeOnPageInSeconds;if(!(n||e||o||r))return!0;var a=!0,c=!0,u=!0,s=!0;r&&!function(t){var i=t.Trigger.TimeOnPageInSeconds,n=discountNinja.Cache.SessionGet("trigger-time-on-page");if(n&&!isNaN(n))return n>=i}(t)&&(a=!1),n&&!function(t){var i=t.Trigger.ScrollPercentage,n=discountNinja.Cache.SessionGet("trigger-scroll-percentage");if(n&&!isNaN(n))return n>=i}(t)&&(c=!1),e&&!function(t){var i=t.Trigger.PagesVisited,n=discountNinja.Cache.SessionGet("trigger-pages-visited");if(n&&!isNaN(n))return n>=i}(t)&&(u=!1),o&&!discountNinja.Utilities.IsMobilePhone()&&"true"!==discountNinja.Cache.SessionGet("trigger-exit-intent")&&(s=!1);var d="or"===i.Type?a||c||u||s:a&&c&&u&&s;return discountNinja.Cache.SessionSet("trigger-conditions-met-"+t.Token,d),d}catch(t){discountNinja.Logging.LogError("Trigger.PromotionTriggerConditionsMet",t)}},WaitForTriggerConditions:function(t){function i(t,i){for(var n=0;n<i.length;n++)if(i[n]===t)return!0;return!1}function n(t,e){if(c=t.Token,!("onceperdevice"==="oncepersession"?"false"===discountNinja.Cache.LocalGet("trigger-accepted-"+c):"false"===discountNinja.Cache.SessionGet("trigger-accepted-"+c))&&!function(t){if(void 0===t.CountdownClock||null===t.CountdownClock||void 0===t.CountdownClock.EndsAt||null===t.CountdownClock.EndsAt)return!1;var i=discountNinja.DateTime;return i.DiffInSeconds(i.GetUtc(t.CountdownClock.EndsAt),i.UtcNow())<=0}(t)&&discountNinja_Script_Trigger.FilterConditionsAreMet(t)&&discountNinja_Script_Trigger.ValidForPage(t)){for(var o=0;o<t.Offers.length;o++)e.push(t.Offers[o]);if(discountNinja_Script_Trigger.VisitorBehaviorConditionsAreMet(t)){t.Triggered=!0;var r=[];for(o=0;o<t.Offers.length;o++)r.push({trigger:t,offerToken:t.Offers[o]});return discountNinja_Script_Trigger.TriggerOffers(r),!0}return waitForTriggerConditionsTimeoutHandle=setTimeout((function(){n(t,e)}),500),!0}for(o=0;o<t.Offers.length;o++){var a=discountNinja.Offer.GetOfferByToken(t.Offers[o]);a&&!i(a.Token,e)&&discountNinja.PromotionFlow.UnAcceptPromotion(a)}return!1;var c}if(!t||0===t.length)return discountNinja_Script_Trigger.InitialPromotionsTriggered=!0,discountNinja.PromotionFlow.StopFlow();for(var e=[],o=!1,r=0;r<t.length;r++){var a=t[r];if(!0!==a.Triggered)n(a,e)&&(o=!0)}o||(discountNinja_Script_Trigger.InitialPromotionsTriggered=!0),discountNinja_Script_Trigger.ProcessOffersToTriggerDebounced()}},discountNinja_Script_TriggerSource={IsPromotionCodeField:function(t){return"code-dn"===t||"code-shopify"===t},GetSource:function(t,i,n){try{var e=discountNinja.Trigger.GetTriggerByToken(i);if(e){var o=!1,r=!1;if(n)for(var a=0;a<n.length;a++)n[a].discountCode.toLowerCase()===t.toLowerCase()&&(o=!0,r="Shopify"===n[a].source);return o?r?"code-shopify":"code-dn":e.IsAutomatic?"automatic":"link"}return null}catch(t){return discountNinja.Logging.LogError("TriggerSource.GetSource",t),null}}},discountNinja_Script_Cart_Shopify={IsDirty:!1,ProcessingCartUpdate:!1,LockRefreshCart:!1,AddToCartButtonId:"LimoniAppsDiscountNinjaAddToCartButton",CacheKey:"cached-cart-v7.8",RegisteringAddToCart:!1,UseCartJSApiSetting:null,UseCartJSApi:function(){try{if("object"!=typeof CartJS)return!1;var t=discountNinja_Script_Cart_Shopify;return null===t.UseCartJSApiSetting&&(t.UseCartJSApiSetting=!0===discountNinja.Settings.GetFlag("UseCartJSApi")),t.UseCartJSApiSetting}catch(t){return discountNinja.Logging.LogError("Cart.UseCartJSApi",t),!0}},AddLocale:function(t){try{discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutForm()).each((function(){if(!discountNinja.Utilities.jQuery()(this).hasClass("discountninja-ignore")){var i=function(t,i){try{return discountNinja.QueryParameter.AppendToUrl(t,"locale",i,!0)}catch(t){discountNinja.Logging.LogError("DiscountCode.AppendLocaleToUrl",t)}}(discountNinja.Utilities.jQuery()(this).attr("action"),t);discountNinja.Utilities.jQuery()(this).attr("action",i)}}))}catch(t){return discountNinja.Logging.LogError("Cart.AddLocale",t),!0}},SubscribeDrawerCartOpened:function(){function t(){"undefined"!=typeof SATCB&&void 0!==SATCB.Widgets&&void 0!==SATCB.Widgets.CartSlider&&"function"==typeof SATCB.Widgets.CartSlider.openSlider&&void 0===SATCB.Widgets.CartSlider.openSliderBeforeDiscountNinja&&(SATCB.Widgets.CartSlider.openSliderBeforeDiscountNinja=SATCB.Widgets.CartSlider.openSlider,SATCB.Widgets.CartSlider.openSlider=function(){SATCB.Widgets.CartSlider.openSliderBeforeDiscountNinja(),discountNinja.Events.Publish("drawercart:opened"),setTimeout((function(){discountNinja.Events.Publish("drawercart:opened")}),500)})}try{discountNinja.Events.Subscribe("DrawerCartOpened",discountNinja_Script_Cart_Shopify.OnDrawerCartOpened),discountNinja.Events.Subscribe("drawercart:opened",discountNinja_Script_Cart_Shopify.OnDrawerCartOpened);var i=[];i.push({Event:"afterCartLoad.ajaxCart",Timeout:!0}),i.push({Event:"ajaxCart.afterCartLoad",Timeout:!0}),i.push({Event:"drawerOpen.CartDrawer"}),i.push({Event:"drawerOpen.NavDrawer"}),i.push({Event:"drawer_open_done"}),i.push({Event:"search:close"}),i.push({Event:"theme:loading:end"}),i.push({Event:"cart:rerendered"}),i.push({Event:"cart:refresh"}),i.push({Event:"cart:updated"}),i.push({Event:"cart_update_done"}),t(),setTimeout((function(){t()}),500),setTimeout((function(){t()}),1500),setTimeout((function(){t()}),2500);try{var n=discountNinja.Settings.GetFlag("DrawerCartRedrawnEvents");if(null!=n&&""!==n)for(var e=0;e++;e<n.length)i.push({Event:n[0]})}catch(t){discountNinja.Logging.LogError("Cart.SubscribeDrawerCartOpened.CustomEvents",t)}for(e=0;e<i.length;e++){var o=i[e];discountNinja.Utilities.jQuery()(document).on(o.Event,{markCartAsDirty:!0},discountNinja_Script_Cart_Shopify.OnDrawerCartOpened),o.Timeout&&setTimeout((function(){discountNinja.Utilities.jQuery()(document).on(o.Event,{markCartAsDirty:!1},discountNinja_Script_Cart_Shopify.OnDrawerCartOpened)}),500)}}catch(t){discountNinja.Logging.LogError("Cart.SubscribeDrawerCartOpened",t)}},OnDrawerCartOpenedDebounced:function(t){try{if(discountNinja.Checkout.Shopify.RegisterEventHandlerForCheckout(),discountNinja.DiscountedCart.SplitRowsInProcess||discountNinja.DiscountedCart.FreeGiftAdjustmentInProcess||discountNinja_Script_Cart_Shopify.LockRefreshCart)return;var i=!(!t||1!==t.length)&&!0===t[0];discountNinja_Script_XmlHttpRequest.EnableDebugging&&console.log("OnDrawerCartOpenedDebounced called - Results in cart marked as dirty: "+i),!0===i&&(discountNinja.Cart.Shopify.IsDirty=!0,discountNinja.DiscountedCart.IsDirty=!0),discountNinja.DynamicPricing.ClassicCartIsDirty=!0,discountNinja.DynamicPricing.DrawerCartIsDirty=!0,discountNinja.DynamicPricing.UpdatePrice(!1,!0),discountNinja.DiscountCode.EnableDiscountCodeField(),discountNinja.DiscountCode.UpdateTags(),discountNinja.DiscountCode.LockDiscountCodeFieldIfRequired()}catch(t){discountNinja.Logging.LogError("Cart.OnDrawerCartOpenedDebounced",t)}},StoreUpdatedCart:function(t){try{if(!t)return;"object"==typeof window.discountNinjaContext&&(window.discountNinjaContext.Cart=t),discountNinja.Cache.LocalSet(discountNinja_Script_Cart_Shopify.CacheKey,JSON.stringify(t))}catch(t){discountNinja.Logging.LogError("Cart.StoreUpdatedCart",t)}},UpdateCart:function(t,i){function n(t,i,n){if(!0!==discountNinja.Settings.GetFlag("SkipProcessQuantityChangesBeforeCheckout"))try{var o=discountNinja.Utilities.jQuery()(discountNinja.Environment.Shopify.SelectorCheckoutForm()),r=o.first();if(o.length>1)if(discountNinja.Environment.Shopify.IsCartPage()){var a=o.filter(".limoniapps-discountninja-cart-root");a&&a.length>0&&(r=a.first())}else{var c=o.filter(".limoniapps-discountninja-drawercart-root");c&&c.length>0&&(r=c.first())}discountNinja.Utilities.jQuery()(r).find('[name="updates[]"]').each((function(t,i){try{var n=parseInt(discountNinja.Utilities.jQuery()(i).val());if(!isNaN(n)){var e=function(t){var i=null;return discountNinja.Utilities.jQuery().each(t.attributes,(function(){if("string"==typeof this.value&&this.value.indexOf(":")>-1){if(i=this.value,this.value.indexOf("_")){var t=this.value.split("_");i=t[t.length-1]}return!1}})),i}(i),o=discountNinja.LiquidData.CartItemByKeyAndSellingPlanId(e,null);o&&n!==o.quantity&&(o.quantity=n,discountNinja.DiscountedCart.IsDirty=!0)}}catch(t){discountNinja.Logging.LogError("Cart.ProcessLocalQuantityChanges.1",t)}}))}catch(t){discountNinja.Logging.LogError("Cart.ProcessLocalQuantityChanges.2",t)}e(t,i,n)}function e(t,i,n){return discountNinja.Offer.ClearPromotionForProductCache(),discountNinja_Script_Cart_Shopify.StoreUpdatedCart(t),discountNinja.DiscountedCart.IsDirty=!0,discountNinja.LocalCartUpdatedEvent.Handle(null,t,i,null!==n),discountNinja_Script_Cart_Shopify.ProcessingCartUpdate=!1,null!=n&&"function"==typeof n?n():null}function o(t,i){try{for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(Object.prototype.hasOwnProperty.call(i,n)&&"object"==typeof t[n]&&null!==t[n]&&null!==i[n]?o(t[n],i[n]):i[n]=JSON.parse(JSON.stringify(t[n])))}catch(t){discountNinja.Logging.LogError("Cart.CopyProperties",t)}}function r(t){try{var i=JSON.parse(JSON.stringify(t));if(o(i,CartJS.cart),CartJS.cart.items){void 0!==CartJS.cart.items&&null!==CartJS.cart.items||(CartJS.cart.items=[]);for(var n=0;n<CartJS.cart.items.length;n++){var e=CartJS.cart.items[n];null===e?e=i.items[n]:(void 0!==e.properties&&null!==e.properties||(e.properties={}),void 0!==e.line_level_discount_allocations&&null!==e.line_level_discount_allocations||(e.line_level_discount_allocations=[]),void 0!==e.discount_allocations&&null!==e.discount_allocations||(e.discount_allocations=[]))}"object"==typeof discountNinjaContext&&(void 0!==discountNinjaContext.Cart.cart_level_discount_applications&&null!==discountNinjaContext.Cart.cart_level_discount_applications||(discountNinjaContext.Cart.cart_level_discount_applications=[]),void 0!==discountNinjaContext.Cart.discount_applications&&null!==discountNinjaContext.Cart.discount_applications||(discountNinjaContext.Cart.discount_applications=[]))}}catch(t){discountNinja.Logging.LogError("Cart.UpdateCartJSCart",t)}}function a(t,i){if(discountNinja_Script_Cart_Shopify.LockRefreshCart||discountNinja_Script_Cart_Shopify.ProcessingCartUpdate)return null!=t&&"function"==typeof t?t():null;var o=discountNinja.DeviceId.Get();discountNinja.XmlHttpRequest.Send(discountNinja.Environment.Shopify.RootRoute()+"/cart.json?m="+o+"-"+discountNinja.DateTime.UnixTimestamp(),null,null,"get",!0,!0,!1,(function(o){discountNinja_Script_Cart_Shopify.IsDirty=!1,function(t,i,o){!0===o?n(t,!0,i):e(t,!0,i)}(o,t,i),discountNinja_Script_Cart_Shopify.UseCartJSApi()&&r(o)}),null,null,null,!0)}try{if(discountNinja.Offer.ResetTiersUsed(),null==i&&(i=!1),"object"==typeof discountNinjaContext&&discountNinjaContext.Cart&&discountNinjaContext.Cart.currency!==discountNinja.Currency.ActiveCurrency()&&(discountNinja_Script_Cart_Shopify.IsDirty=!0),discountNinja_Script_Cart_Shopify.IsDirty)a(t,i);else{var c=function(){try{var t=discountNinja.Cache.LocalGet(discountNinja_Script_Cart_Shopify.CacheKey),i="undefined"===t?null:JSON.parse(t);return i&&!i.items&&(i.items=[]),i}catch(t){return discountNinja.Logging.LogError("Cart.GetCartFromCache",t),null}}();!function(t){var i=discountNinja.LiquidData.Cart();if(!i||!t)return!0;if(i.total_price!==t.total_price)return!0;if(i.items.length!==t.items.length)return!0;for(var n=0;n<t.items.length;n++){if(i.items[n].key!==t.items[n].key)return!0;if(i.items[n].quantity!==t.items[n].quantity)return!0}return!1}(c)?!function(t){var i=discountNinja_Script_DiscountedCart.DiscountedCart;if(i||(i=discountNinja_Script_DiscountedCart.GetDiscountedCartFromCache()),!i)return!1;if(Math.round(100*i.total_original_price)!==t.original_total_price)return!1;if(i.items.length!==t.items.length)return!1;for(var n=0;n<i.items.length;n++)if(i.items[n].Key.length<20)return!1;return!0}(c)?(discountNinja.DiscountedCart.IsDirty=!0,i?n(c,!0,t):e(c,!0,t)):i?n(c,!1,t):e(c,!1,t):a(t,i)}}catch(t){discountNinja.Logging.LogError("Cart.Shopify.UpdateCart",t)}},ClearCart:function(){try{var t=discountNinja.Utilities.jQuery().Deferred();return discountNinja_Script_Cart_Shopify.UseCartJSApi()&&"function"==typeof CartJS.clear?CartJS.clear({success:function(i,n,e){t.resolve()},error:function(i,n,e){discountNinja.Logging.LogErrorMessage("CartJs.clear failed - "+e),t.reject()}}):discountNinja.XmlHttpRequest.Send("/cart/clear.js",null,null,"post",!0,!0,!1,(function(){t.resolve()}),(function(){discountNinja.Logging.LogErrorMessage("cart/clear.js failed"),t.reject()})),t.promise()}catch(t){discountNinja.Logging.LogError("Cart.Shopify.ClearCart",t)}},AddToCartMultipleLines:function(t){function i(t,n,e){let o=t.shift();0===t.length?discountNinja_Script_Cart_Shopify.AddToCart(o.id,o.quantity,o.properties,o.selling_plan,o.key).fail((function(){e=!0})).always((function(){n.resolve(e)})):discountNinja_Script_Cart_Shopify.AddToCart(o.id,o.quantity,o.properties,o.selling_plan,o.key).fail((function(){e=!0})).always((function(){i(t,n,e)}))}function n(t){var n=discountNinja.Utilities.jQuery().Deferred();return i(t,n,!1),n.promise()}var e=discountNinja.Utilities.jQuery().Deferred();try{if(null===t||0===t.length)return void e.resolve(!1);for(var o=[],r=0;r<t.length;r++){var a=t[r],c={id:a.variant_id,quantity:a.quantity,properties:a.properties};"object"==typeof a.selling_plan_allocation&&"object"==typeof a.selling_plan_allocation.selling_plan?c.selling_plan=a.selling_plan_allocation.selling_plan.id:void 0!==a.selling_plan_id&&(c.selling_plan=a.selling_plan_id),o.push(c)}if(discountNinja_Script_Cart_Shopify.UseCartJSApi()&&"function"==typeof CartJS.addItems)CartJS.addItems(o,{success:function(t,i,n){e.resolve(!0)},error:function(t,i,r){discountNinja.Logging.LogErrorMessage("Cart","CartJs.addItems failed - "+r),n(o).then((function(){e.resolve(!1)}))}},1,1);else{var u={items:o};discountNinja.XmlHttpRequest.Send("/cart/add.js",null,u,"post",!0,!0,!1,(function(){e.resolve(!0)}),(function(t){n(o).then((function(i){i&&discountNinja.Logging.LogErrorMessage("AddToCartMultipleLines","Call to bulk cart/add.js failed with error code "+t+" this is likely an issue with stock levels. Workaround failed."),e.resolve(!i)}))}),1,1)}return e.promise()}catch(t){discountNinja.Logging.LogError("Cart.Shopify.AddToCartMultipleLines",t),e.resolve(!1)}},AddToCart:function(t,i,n,e,o){try{var r=discountNinja.Utilities.jQuery().Deferred();if(i<=0||null==t||""===t)discountNinja.Logging.LogErrorMessage("AddToCart","Cannot add a quantity of "+i+' of variant "'+t+'" to the cart'),r.resolve();else if(discountNinja_Script_Cart_Shopify.UseCartJSApi()&&"function"==typeof CartJS.addItem)CartJS.addItem(t,i,n,{success:function(t,i,n){r.resolve()},error:function(t,i,n){discountNinja.Logging.LogErrorMessage("CartJs.addItem failed - "+n),r.reject()}});else{var a={quantity:i,id:t,properties:n};e&&(a.selling_plan=e),discountNinja.XmlHttpRequest.Send("/cart/add.js",null,a,"post",!0,!0,!1,(function(t){var i=discountNinja.LiquidData.CartItemByKeyAndSellingPlanId(o,null);i&&(i.key=t.key),r.resolve(t)}),(function(){discountNinja.Logging.LogErrorMessage("AddToCart","Cannot add a quantity of "+i+' of variant "'+t+'" to the cart'),r.reject()}),1,1)}return r.promise()}catch(t){discountNinja.Logging.LogError("Cart.Shopify.AddToCart",t)}},GetCartObjectFromNetworkResponse:function(t){try{if(!t)return null;var i="object"==typeof t?t:JSON.parse(t);return i&&i.token&&i.items?i:null}catch(t){return discountNinja.Logging.LogError("Cart.Shopify.GetCartObjectFromNetworkResponse",t),null}},UpdateCartFromNetworkResponse:function(t){try{return t?(discountNinja_Script_Cart_Shopify.StoreUpdatedCart(t),discountNinja_Script_Cart_Shopify.IsDirty=!1,discountNinja.DiscountedCart.IsDirty=!0,!0):null}catch(t){return discountNinja.Logging.LogError("Cart.Shopify.UpdateCartFromNetworkResponse",t),!1}},OnUpdateCart:function(){try{discountNinja.DiscountedCart.BuildDiscountedCart((function(){discountNinja.PromotionFlow.StopFlow(),setTimeout((function(){discountNinja.PromotionFlow.StopFlow()}),1500)}))}catch(t){discountNinja.Logging.LogError("Cart.Shopify.OnUpdateCart",t)}},SetAttribute:function(t,i){return new Promise(((n,e)=>{try{var o='{"attributes":{"'+t+'":"'+i.replace(/\"/g,'\\"')+'"}}',r=JSON.parse(o);discountNinja.XmlHttpRequest.Send("/cart/update.js",null,r,"post",!0,!0,!1,(function(){n()}),(function(){e()}),1,1)}catch(t){discountNinja.Logging.LogError("Cart.Shopify.SetAttribute",t),e()}}))},RegisterEventHandlerForAddToCart:function(){try{var t=discountNinja.Environment.Shopify.SelectorAddToCartForm(),i=discountNinja.Html.GetNodes(t);i&&function(t,i,n){for(var e=0,o=t.length;e<o;e++)t[e].addEventListener(i,n,!1)}(i,"submit",(function(t){discountNinja.ServerCartItemsAddedEvent.Handle(null,null,null,!0)}))}catch(t){discountNinja.Logging.LogError("Cart.Shopify.RegisterEventHandlerForSubmit",t)}}},discountNinja_Script_TemplateParameterEngine={Replace:function(t,i,n){try{if(!t||!i)return t;var e=new RegExp("\\[\\["+i+"\\]\\]","g");return t=t.replace(e,discountNinja.Currency.EscapeDollarSignForRegEx(n||"")),e=new RegExp("\\[\\["+i.toLowerCase()+"\\]\\]","g"),t.replace(e,discountNinja.Currency.EscapeDollarSignForRegEx(n||""))}catch(i){return discountNinja.Logging.LogError("TemplateParameterEngine.GetHtml",i),t}}},discountNinja_Script_ActionButton={HideIfNecessary:function(t,i,n){try{var e=!1;"applydiscount"===t.Action&&discountNinja.Offer.IsOfferAccepted(i.Token,i.Frequency)&&(e=!0);var o="hasaction"+n,r=discountNinja.StickyBar.GetWrapperElement().find(".limoniapps-sticky-bar");e?r.removeClass(o):r.addClass(o)}catch(t){return discountNinja.Logging.LogError("ActionButton.HandleAction",t),""}},HandleAction:function(t,i,n){try{if("redirect"===t.Action){var e=t.OpenInNewTab?"_blank":"_self";window.open(t.RedirectUrl,e)}else"applydiscount"===t.Action&&(discountNinja.PromotionFlow.AcceptPromotion(i,n),discountNinja.PromotionFlow.StopFlow())}catch(t){return discountNinja.Logging.LogError("ActionButton.HandleAction",t),""}},ReplacePlaceHoldersForButton:function(t,i,n,e,o){try{if(!o)return t;var r=discountNinja.ShortCode.ReplaceAllPlaceHolders(i,discountNinja.TextSettings.GetText(o.Text,i),n),a=discountNinja.TextSettings.WrapInColor(o.TextColor,r),c="ACTIONBUTTON"+e;return t=discountNinja.TemplateParameter.Replace(t,c+"_STYLE",o.Style?o.Style:""),t=discountNinja.TemplateParameter.Replace(t,c+"_SIZE",o.Size?o.Size:""),t=discountNinja.TemplateParameter.Replace(t,c+"_LABEL",a),t=discountNinja.TemplateParameter.Replace(t,c+"_ACTION",o.Action?o.Action:"")}catch(i){return discountNinja.Logging.LogError("ActionButton.ReplacePlaceHoldersForButton",i),t}}},discountNinja_Script_Prerequisite={PrerequisiteItemsInCart:function(t,i,n){null==n&&(n=!0);var e=discountNinja_Script_Prerequisite.PrerequisiteRuleType(i);return function(){if("Content"===e){if("*"===t.Prerequisite.PrerequisiteCollections)return discountNinja.LiquidData.QuantityInCart(t.Prerequisite.PrerequisiteExcludeCollections,n);if(t.Prerequisite.PrerequisiteCollections)return discountNinja.LiquidData.QuantityInCartFromCollections(t.Prerequisite.PrerequisiteCollections,t.Prerequisite.PrerequisiteExcludeCollections,n);if(t.Prerequisite.PrerequisiteProducts)return discountNinja.LiquidData.QuantityInCartFromProducts(t.Prerequisite.PrerequisiteProducts,t.Prerequisite.PrerequisiteExcludeCollections,n);if(t.Prerequisite.PrerequisiteProductVariants)return discountNinja.LiquidData.QuantityInCartFromVariants(t.Prerequisite.PrerequisiteProductVariants,t.Prerequisite.PrerequisiteExcludeCollections,n)}return null}()||function(){if("Value"===e){var n=discountNinja.Offer.PrerequisiteItemsCartValue(t);return i.Prerequisite.MaximumAmount&&n>100*i.Prerequisite.MaximumAmount?null:Math.floor(0===i.Prerequisite.MinimumAmount?1:n/100/i.Prerequisite.MinimumAmount)}return null}()||0},PrerequisiteRuleType:function(t){return null!==t&&t.Prerequisite&&void 0!==t.Prerequisite.MinimumAmount?"Value":null!==t&&t.Prerequisite&&void 0!==t.Prerequisite.MinimumItems?"Content":"None"},PrerequisiteMatchesEntitlement:function(t){function i(){try{return void 0===e.ExcludeCollectionHandles&&void 0===n.PrerequisiteExcludeCollections||e.ExcludeCollectionHandles===n.PrerequisiteExcludeCollections}catch(t){return discountNinja.Logging.LogError("Prerequisite.ExclusionsMatch",t),!1}}try{var n=t.Prerequisite,e=t.Entitlement;if("line_item"!==e.TargetType)return!1;var o=e.EntitledItemType;return"site"===o?void 0===n.PrerequisiteCollections&&void 0===n.PrerequisiteProducts&&i():"collection"===o?void 0!==n.PrerequisiteCollections&&n.PrerequisiteCollections===e.EntitledCollectionHandles&&i():"product"===o?void 0!==n.PrerequisiteProducts&&n.PrerequisiteProducts===e.EntitledProductHandles&&i():"variant"===o&&(void 0!==n.PrerequisiteProductVariants&&n.PrerequisiteProductVariants===e.EntitledVariantIds&&i())}catch(t){return discountNinja.Logging.LogError("Prerequisite.MatchesEntitlement",t),!1}},EntitledQuantityInfo:function(t,i,n){function e(t,i,n,e){return null!==i&&(!(!e&&discountNinja_Script_LiquidData.ItemHasPropertyWithPrefix(n,discountNinja.DiscountedCart.FreeGiftPrefix))&&("*"===t.Prerequisite.PrerequisiteCollections?!discountNinja.LiquidData.ItemIsInCollection(n,t.Prerequisite.PrerequisiteExcludeCollections):t.Prerequisite.PrerequisiteCollections?discountNinja.LiquidData.ItemIsInCollection(n,t.Prerequisite.PrerequisiteCollections)&&!discountNinja.LiquidData.ItemIsInCollection(n,t.Prerequisite.PrerequisiteExcludeCollections):t.Prerequisite.PrerequisiteProducts?discountNinja.Utilities.StringIsIn(t.Prerequisite.PrerequisiteProducts,n.handle):!!t.Prerequisite.PrerequisiteProductVariants&&discountNinja.Utilities.StringIsIn(t.Prerequisite.PrerequisiteProductVariants,n.id)))}function o(t,i){try{var n=i.handle,e=i.id,o=discountNinja.ProductData.GetByProductHandle(n,!1),r=discountNinja_Script_Offer.OfferIsValidForProduct(t,e,n,o.Collections,null,!0);if(r&&t.Bogo&&discountNinja.DiscountedCart.DiscountedCart&&discountNinja.DiscountedCart.DiscountedCart.items)if(!0===discountNinja.Settings.GetFlag("DiscountedProductsCannotBeGifts"))for(var a=0;a<discountNinja.DiscountedCart.DiscountedCart.items.length;a++){var c=discountNinja.DiscountedCart.DiscountedCart.items[a];if(c&&c.Key===i.key&&c.Line.QuantityDiscounted>0)return!1}return r&&t.Bogo&&("product"===t.Entitlement.EntitledItemType||"variant"===t.Entitlement.EntitledItemType)&&t.Entitlement.EntitledVariantIds?parseInt(t.Entitlement.EntitledVariantIds)===i.id:r}catch(t){return!1}}function r(t,i){if(discountNinja.DiscountedCart.DiscountedCart&&discountNinja.DiscountedCart.DiscountedCart.items){var n=discountNinja.DiscountedCart.DiscountedCart.items.find((function(i){return i.Key===t}));if(n&&n.Product){var e=100*n.Product.DiscountedPrice,o=discountNinja_Script_DiscountedCart.ApplicableCartLevelDiscounts(n.Product.VariantId,null,null,null,!0,null);if(null!==o&&o.length>0)for(var r=0;r<o.length;r++){var a=o[r];if(a.Amount>0)if((a.LineItems?a.LineItems.length:0)>0){for(var c=0,u=0;u<a.LineItems.length;u++)c+=a.LineItems[u].Quantity;c>0&&(e-=a.Amount/c*100)}}return Math.round(Math.max(0,e))}}return i}var a=[];function c(t,i,n){var r=a.find((function(t){return t.Key===n.key}));return void 0!==r&&r.OfferToken===t.Token&&r.Tier===i.Level||(r={Key:n.key,OfferToken:t.Token,Tier:i.Level,Prerequisite:!!e(t,i,n,!1),Entitled:!!o(t,n)},a.push(r)),r}function u(t,i,n,e,o,r,a,c){for(var u=0;u<n.length;u++){var s=n[u];if((!s.PrerequisiteCandidate||!t)&&(o?!s.EntitledCandidate||s.Prerequisite||s.Entitled||(s.Entitled=!0,s.Set=i,r++):s.EntitledCandidate&&!s.Entitled&&(s.Entitled=!0,s.Set=i,r++),!a&&r==c||a&&r==e))break}return r}function s(t,i,n){return"all"===t||("product"===t?(void 0===i.Product&&(i.Product=n.product),n.product===i.Product):"variant"===t&&(void 0===i.Variant&&(i.Variant=n.variant_id),n.variant_id===i.Variant))}function d(t,i,n,e,o,r,a,c,u){for(var d=!1,l={},g=0;g<n.length;g++){var f=n[g],p=a?f.DiscountedAmount:f.Amount;if(f.PrerequisiteCandidate&&(t||!f.EntitledCandidate)&&!f.Prerequisite&&!f.Entitled&&(!e||e&&p>0)&&s(r,l,f))if(f.Prerequisite=!0,f.PrerequisiteUsedCandidate=!0,f.Set=i,e){var N=e?f.Amount:Math.min(f.Amount,100*o);f.Amount-=N,f.Amount<0&&(f.Amount=0);var j=e?f.DiscountedAmount:Math.min(f.DiscountedAmount,100*o);f.DiscountedAmount-=j,f.DiscountedAmount<0&&(f.DiscountedAmount=0),c+=(a?j:N)/100}else c++;if(!e&&u&&c>=o){d=!0;break}}return{PrerequisitesMarked:c,PrerequisiteSetsMarked:Math.floor(c/o),AllPrerequisitesMarked:e||!u?c>=o:d}}function l(i,n,e,o,r,a,c,u){var s=0,l=0,g=!1,f=function(t,i){return t?i.Prerequisite.MinimumAmount:i.Prerequisite.MinimumItems||0}(o,n);if(0===f)return{PrerequisitesMarked:null,AllPrerequisitesMarked:!0};var p=discountNinja_Script_Prerequisite.PrerequisiteItemsInCart(t,n,!0),N=0===p?{PrerequisitesMarked:0,PrerequisiteSetsMarked:0,AllPrerequisitesMarked:!1}:d(!1,i,e,o,f,r,a,s,c);return s=N.PrerequisitesMarked,l=N.PrerequisiteSetsMarked,g=N.AllPrerequisitesMarked,0===p||g||(l=(N=d(!0,i,e,o,f,r,a,s,c)).PrerequisiteSetsMarked,g=N.AllPrerequisitesMarked),{PrerequisitesMarked:l,AllPrerequisitesMarked:g}}function g(t,i,n,e,o,r,a,c,s,d,g,f){var p=l(t,n,e,o,c,s,g),N=p.PrerequisitesMarked,j=p.AllPrerequisitesMarked,C=o||!g,m=0,S=!(n.Entitlement.EntitledQuantity>-1)&&"fixed_amount"===i.DiscountCodeType,h=function(t,i){var n=t.Entitlement.AllocationLimit>-1?t.Entitlement.AllocationLimit:null,e=i.Entitlement.EntitledQuantity>-1?i.Entitlement.EntitledQuantity:null;return null==e?n:null==n?e:Math.min(e,n)}(i,n),_=function(t,i,n,e,o){var r=null;return n&&(r=null==o?null==i?e?1:null:i:null==i?e?1:null:e?o:i*o),t>-1&&null!=r&&(r=Math.min(r,t)),r}(f,h,C,S,N),y=C?_:S?1:h;return j&&(m=function(t,i,n,e,o,r,a,c){if(r)return e||0;var s=u(!0,t,n,e,o,0,a,c);return!a&&s==c||a&&s==e?s:s=u(!1,t,n,e,o,s,a,c)}(t,0,e,y,r,a,g,h)),function(t,i){for(var n=0;n<t.length;n++){var e=t[n];i>0?!0===e.PrerequisiteUsedCandidate&&(e.PrerequisiteUsed=!0,e.PrerequisiteUsedCandidate=!1):e.PrerequisiteUsedCandidate=!1}}(e,m),{MarkedEntitledAmountSets:a?m:0,MissingEntitled:j&&null!==y&&m<y?Math.max(y-m,0):0,Continue:g&&(N>0||m>0)}}function f(t){for(var i=0,n=0;n<t.length;n++)t[n].Prerequisite&&i++;return i}function p(t){for(var i=0,n=0;n<t.length;n++)t[n].PrerequisiteUsed&&i++;return i}function N(t,i,n,e){return!!t&&!(i&&n.Entitlement.AllocationLimit<=e.Entitlement.EntitledQuantity)}try{if(null==i)return null;if(void 0!==i.EntitledQuantityDetails&&null!==i.EntitledQuantityDetails)return i.EntitledQuantityDetails;var j=function(){try{var n=t.Entitlement.AllocationLimit>-1,e=t.Tiers[0],a=null!==e&&e.Entitlement&&e.Entitlement.EntitledQuantity>-1,u=t&&t.Tiers[0]&&t.Tiers[0].Prerequisite&&(t.Tiers[0].Prerequisite.MaximumItems>0||t.Tiers[0].Prerequisite.MinimumItems>0||t.Tiers[0].Prerequisite.MinimumAmount>0||t.Tiers[0].Prerequisite.MaximumAmount>0);if(null===i||!n&&!a&&!u)return function(t,i,n){return{HasEntitledQuantity:!1,Entitled:null,EntitledNotAttributed:null,InCart:null,DeltaWithCart:null,InCartAttributed:null,InCartNotAttributed:null,Prerequisites:!0?discountNinja_Script_Prerequisite.PrerequisiteItemsInCart(i,n):null,PrerequisitesNotAttributed:null,SupportsMultipleSets:!1}}(0,t,i);var s=0,d=0,l=0,j=0,C=null,m=null!==e&&e.Entitlement&&"multiple"===e.Entitlement.Mode;if(m||u){(C=t.Entitlement.AllocationLimit||null)&&i.Entitlement.EntitledQuantity>0&&(C/=i.Entitlement.EntitledQuantity);var S="Value"===discountNinja_Script_Prerequisite.PrerequisiteRuleType(i),h=!0===discountNinja.Offer.EntitledItemsCannotBePrerequisites(t,i),_=function(){var t=[];if("object"!=typeof window.discountNinjaContext||!window.discountNinjaContext.Cart||!window.discountNinjaContext.Cart.items)return t;for(var i=window.discountNinjaContext.Cart.items,n=0;n<i.length;n++){var e=JSON.parse(JSON.stringify(i[n]));e.Prerequisite=!1,e.Entitled=!1,e.PrerequisiteCandidate=!1,e.PrerequisiteUsed=!1,e.PrerequisiteUsedCandidate=!1,e.EntitledCandidate=!1,e.Set=null,e.Amount=e.original_price,e.DiscountedAmount=r(e.key,e.original_price);for(var o=0;o<e.quantity;o++)t.push(JSON.parse(JSON.stringify(e)))}return t.sort((function(t,i){return t.original_price-i.original_price}))}();!function(t,i,n){for(var e=0;e<n.length;e++){var o=n[e],r=c(t,i,o);o.PrerequisiteCandidate=r.Prerequisite,o.EntitledCandidate=r.Entitled}}(t,i,_);var y=function(t,i,n,e,o,r,a,c,u,s,d){var l=1,N=0,j=0;do{var C=g(l,i,n,e,o,r,a,c,u,0,s,d);N+=C.MissingEntitled,j+=C.MarkedEntitledAmountSets,l++}while((null===t||l<=t)&&C.Continue);var m=a?j:function(t){for(var i=0,n=0;n<t.length;n++)t[n].Entitled&&i++;return i}(e);return{MarkedEntitled:m,UnmarkedEntitled:Math.max(0,N),UsedPrerequisites:p(e),MarkedPrerequisites:f(e)}}(C,t,i,_,S,h,"across"===t.Entitlement.AllocationMethod,t.Prerequisite.MatchingMode||"all",!0===t.Prerequisite.AfterDiscount,m,t.Entitlement.AllocationLimit);s=Math.max(function(t,i){for(var n=0,e=0;e<t.length;e++){var o=t[e];o.properties&&void 0!==o.properties[discountNinja.DiscountedCart.FreeGiftPrefix+i]&&n++}return n}(_,t.Token),y.MarkedEntitled),d=y.UsedPrerequisites,j=y.MarkedPrerequisites,l=y.MarkedEntitled+y.UnmarkedEntitled}else n&&(C=t.Entitlement.AllocationLimit||null,_=function(){var t=[];if("object"!=typeof window.discountNinjaContext||!window.discountNinjaContext.Cart||!window.discountNinjaContext.Cart.items)return t;for(var i=window.discountNinjaContext.Cart.items,n=0;n<i.length;n++){var e=JSON.parse(JSON.stringify(i[n]));e.Prerequisite=0,e.Entitled=0,t.push(e)}return t.sort((function(t,i){return t.price-i.price}))}(),d=discountNinja_Script_Prerequisite.PrerequisiteItemsInCart(t,i),s=function(t,i,n){for(var e=n,r=0,a=0;a<i.length;a++){var c=i[a];if(0===c.Entitled&&o(t,c)){var u=Math.max(0,c.quantity-c.Entitled);if(c.Entitled+=u,r+=u,0==(e-=u))break}}return r}(t,_,l=C||1));var v=Math.max(0,d);return{HasEntitledQuantity:!0,MaximumEntitledReached:null!==C&&l>=C,Entitled:l,InCart:s,Prerequisites:v,PrerequisitesNotAttributed:j-v,SupportsMultipleSets:N(m,n,t,e)}}catch(t){return discountNinja.Logging.LogError("Prerequisite.EntitledQuantityInfoInner",t),null}}();if(null==j)return null;var C=Math.max(0,j.PrerequisitesNotAttributed||0),m=j.Entitled||0,S=t.AttributedQuantity||0,h=j.InCart||0,_=Math.min(m,h),y={HasEntitledQuantity:j.HasEntitledQuantity,SupportsMultipleSets:j.SupportsMultipleSets,Entitled:{Total:m,DeltaWithCart:m-h,Attributed:Math.min(_,S),NotAttributed:Math.max(0,_-S),MaximumReached:!!j.HasEntitledQuantity&&j.MaximumEntitledReached},Prerequisite:{Total:j.Prerequisites+C,Used:j.Prerequisites,NotUsed:C}};return i.EntitledQuantityDetails=y,y}catch(t){return discountNinja.Logging.LogError("Prerequisite.EntitledQuantityInfo",t),null}}},discountNinja_Script_DeviceId={Get:function(){function t(){var t="limoniapps.deviceid.v2",i=discountNinja.Cache.LocalGet(t);return null===i&&(i="_"+(new Date).getTime()+"_"+discountNinja.Utilities.GetRandomNumber(),discountNinja.Cache.LocalSet(t,i)),i.toString()}return"undefined"!=typeof discountNinjaContext&&discountNinjaContext.Customer?discountNinjaContext.Customer.Id?discountNinjaContext.Customer.Id.toString():discountNinjaContext.Customer.Email?discountNinjaContext.Customer.Email.toString():t():t()}},discountNinja_Script_BuyNow={CheckOut:function(t){try{discountNinja.Cart.Shopify.ClearCart().then((function(){return discountNinja.Cart.Shopify.AddToCartMultipleLines(t)})).then((function(){discountNinja.Events.Publish("checkout:initiate")}))}catch(t){discountNinja.Logging.LogError("BuyNow.CheckOut",t)}},CheckOutSelectedVariant:function(t){try{if(!discountNinja.Environment.Shopify.IsProductPage())return discountNinja.Logging.LogWarning("CheckOutSelectedVariant expects to be executed on a product page",!0),!1;var i=discountNinja.Environment.Shopify.VariantData(),n=i?i.Id:null,e=t>0?t:function(){try{var t=discountNinja.Environment.Shopify,i=discountNinja.Utilities.jQuery()(t.SelectorAddToCartForm()).find(t.SelectorQuantity()).val();return isNaN(i)?1:parseInt(i)}catch(t){return discountNinja.Logging.LogError("BuyNow.GetQuantityFromForm",t),1}}();return discountNinja_Script_BuyNow.CheckOut([{variant_id:n,quantity:e}]),!0}catch(t){discountNinja.Logging.LogError("BuyNow.CheckOutSelectedVariant",t)}}},discountNinja_Script_SetEngine={ForTier:function(t,i){try{var n=discountNinja.Prerequisite.EntitledQuantityInfo(t,i,!1),e=i.Entitlement&&i.Entitlement.EntitledQuantity?i.Entitlement.EntitledQuantity:1;return function(n,e,o,r,a,c,u){var s=e>0?Math.floor(n/e):0,d=null!==c&&s>=c,l=d?0:Math.max(0,r-a),g=l,f=r,p=!!d||o&&r-a==0,N=p;return!("2"===discountNinja.Settings.GetFlag("ShortCodeVersion"))||"bogo"!==t.Template&&"bogo_multitier"!==t.Template||(g=Math.max(0,l-i.Entitlement.EntitledQuantity),f=Math.max(0,f-i.Entitlement.EntitledQuantity),N=!!d||o&&f-a==0),{SupportsMultipleSets:u,Completed:s,Current:{Added:d?0:a,Required:d?0:f,RequiredTotal:d?0:r,Remaining:g,RemainingTotal:l,Complete:N,CompleteTotal:p}}}(n.Entitled.Total,e,n.Entitled.NotAttributed+n.Entitled.DeltaWithCart<=0,i.Prerequisite&&i.Prerequisite.BogoPrerequisiteQuantity?i.Prerequisite.BogoPrerequisiteQuantity:i.Prerequisite&&i.Prerequisite.MinimumItems?i.Prerequisite.MinimumItems:1,n.Prerequisite.NotUsed,t.Entitlement.AllocationLimit||null,n.SupportsMultipleSets)}catch(t){return discountNinja.Logging.LogError("Set.ForTier",t),null}},BOGOSets:function(t,i,n){function e(t,i,n){return"variant"===i?t.VariantId===n:"product"===i?t.Handle===n:"collection"===i&&discountNinja.Utilities.StringIsIn(t.Collections,n)}function o(t,i,n){var e=t.find((function(t){return t.MatchOn===i}));return e?e.Count=e.Count+n:t.push({MatchOn:i,Count:n}),t}function r(t,i,n){return{MatchType:t,MatchOn:i,Prerequisites:[],Entitlements:[],Number:n}}function a(t){for(var i=0;i<t.length;i++){var n=t[i];n.MarkedAsEntitlementInThisSet=0,n.MarkedAsPrerequisiteInThisSet=0}return t}function c(t,i,n,o){var r=t.Quantity-t.MarkedAsPrerequisite-t.MarkedAsEntitlement;if(r>0&&e(t,i,n)){var a=o.Prerequisites.reduce(((t,i)=>t+i.Quantity),0)||0,c=g-a,u=Math.min(r,c);t.MarkedAsPrerequisite=t.MarkedAsPrerequisite+u,t.MarkedAsPrerequisiteInThisSet=t.MarkedAsPrerequisiteInThisSet+u;var s=o.Prerequisites.find((function(i){return i.Id===t.Id}));if(s?s.Quantity=s.Quantity+u:o.Prerequisites.push({Id:t.Id,Quantity:u}),(a=o.Prerequisites.reduce(((t,i)=>t+i.Quantity),0)||0)===g)return!0}return!1}function u(t,i,n,o,r){var a=t.Quantity-t.MarkedAsPrerequisite-t.MarkedAsEntitlement;if(a>0&&e(t,i,n)){var c=r.Entitlements.reduce(((t,i)=>t+i.Quantity),0)||0,u=o-c,s=Math.min(a,u);t.MarkedAsEntitlement=t.MarkedAsEntitlement+s,t.MarkedAsEntitlementInThisSet=t.MarkedAsEntitlementInThisSet+s;var d=r.Entitlements.find((function(i){return i.Id===t.Id}));if(d?d.Quantity=d.Quantity+s:r.Entitlements.push({Id:t.Id,Quantity:s}),(c=r.Entitlements.reduce(((t,i)=>t+i.Quantity),0)||0)===o)return!0}return!1}try{if(null===t||"bogo"!==t.Template||null===i||null===discountNinja.DiscountedCart.DiscountedCart)return[];var s=discountNinja.DiscountedCart.DiscountedCart.items;s=function(t,i){for(var n=0;n<i.length;n++)i[n].PotentialSetItem=!0;return i}(0,s);var d=[],l=i.Entitlement.EntitledQuantity,g=(i.Prerequisite.BogoPrerequisiteQuantity||0)-l,f=function(t,i,n){for(var e=[],r=0;r<i.length;r++){var a=i[r],c=a.Line.QuantityDiscounted+a.Line.QuantityNotDiscounted;if(!0===a.PotentialSetItem)if("variant"===t&&a.Product.VariantId)e=o(e,a.Product.VariantId,c);else if("product"===t&&a.Product.ProductHandle)e=o(e,a.Product.ProductHandle,c);else if("collection"===t&&a.Product.CollectionIds)for(var u=a.Product.CollectionIds.split(","),s=0;s<u.length;s++){var d=e.length;if((e=o(e,u[s],c)).length>d)break}}for(var l=[],g=0;g<e.length;g++){var f=e[g];f.Count>=n&&l.push(f)}return l}(n,s,g+l);if(null===f)return[];for(var p=function(t,i){for(var n=[],e=0;e<t.length;e++){var o=t[e];!0===o.PotentialSetItem&&n.push({Id:o.Id,OriginalPrice:o.Product.OriginalPrice,VariantId:o.Product.VariantId,Handle:o.Product.ProductHandle,Collections:o.Product.CollectionIds,Quantity:o.Line.QuantityDiscounted+o.Line.QuantityNotDiscounted,MarkedAsEntitlement:0,MarkedAsPrerequisite:0,MarkedAsEntitlementInThisSet:0,MarkedAsPrerequisiteInThisSet:0,PreviouslyEntitled:o.OfferToken===i&&0===o.Line.QuantityNotDiscounted,Sets:[]})}return n}(s,t.Token),N=0;N<f.length;N++)for(var j=f[N].MatchOn,C=r(n,j,d.length),m=!0;m;){m=!1,p=(p=a(p)).sort((function(t,i){var n=i.Quantity-t.Quantity;return 0===n?i.OriginalPrice-t.OriginalPrice:n}));for(var S=0;S<p.length;S++){for(var h=p[S],_=!1,y=0;y<2&&(1!==y&&(0!==y||h.PreviouslyEntitled)||!(_=c(h,n,j,C)));y++);if(_)break}if((C.Prerequisites.reduce(((t,i)=>t+i.Quantity),0)||0)===g){p=p.sort((function(t,i){var n=i.Quantity-t.Quantity;return 0===n?i.OriginalPrice-t.OriginalPrice:n}));for(var v=p.length-1;v>-1;v--){h=p[v];for(var P=!1,T=0;T<2&&(!(1===T||0===T&&h.PreviouslyEntitled)||!(P=u(h,n,j,l,C)));T++);if(P)break}if((C.Entitlements.reduce(((t,i)=>t+i.Quantity),0)||0)===l){d.push(JSON.parse(JSON.stringify(C)));for(var L=0;L<d.length;L++){C=d[L];for(var D=0;D<C.Entitlements.length;D++){var E=C.Entitlements[D];(O=(h=p.find((function(t){return t.Id===E.Id}))).Sets.find((function(t){return t.Number===C.Number})))?O.Entitlements=E.Quantity:h.Sets.push({Number:C.Number,Entitlements:E.Quantity,OfferToken:t.Token,DisallowDiscountingPrerequisites:!0===t.DisallowDiscountingPrerequisites})}for(var I=0;I<C.Prerequisites.length;I++){var O,A=C.Prerequisites[I];(O=(h=p.find((function(t){return t.Id===A.Id}))).Sets.find((function(t){return t.Number===C.Number})))?O.Prerequisites=A.Quantity:h.Sets.push({Number:C.Number,Prerequisites:A.Quantity,OfferToken:t.Token,DisallowDiscountingPrerequisites:!0===t.DisallowDiscountingPrerequisites})}}m=!0,C=r(n,j,d.length)}else for(T=p.length-1;T>-1;T--){(h=p[T]).MarkedAsPrerequisite=h.MarkedAsPrerequisite-h.MarkedAsPrerequisiteInThisSet,h.MarkedAsEntitlement=h.MarkedAsEntitlement-h.MarkedAsEntitlementInThisSet}}else for(T=p.length-1;T>-1;T--){(h=p[T]).MarkedAsPrerequisite=h.MarkedAsPrerequisite-h.MarkedAsPrerequisiteInThisSet}}var k=[];for(T=0;T<p.length;T++){var b=p[T];k.push({Id:b.Id,Entitled:b.MarkedAsEntitlement,Prerequisite:b.MarkedAsPrerequisite,Quantity:b.Quantity,Sets:b.Sets})}return{Sets:d,LineItems:k}}catch(y){return discountNinja.Logging.LogError("Set.BOGOSets",y),[]}}},discountNinja_Script_BrowsingContext_Shopify={CacheKey:"CountryInfoFromBrowsingContext",GetCountryFromBrowsingContext:function(t,i){try{var n=function(){try{var t=void 0!==discountNinjaContext.CountryISOCode&&null!==discountNinjaContext.CountryISOCode,i=void 0!==discountNinjaContext.CountryName&&null!==discountNinjaContext.CountryName;if(t&&i)return!0;var n=discountNinja.Cache.SessionGet(discountNinja_Script_BrowsingContext_Shopify.CacheKey),e=null==n?null:JSON.parse(n);return null!==e&&(discountNinjaContext.CountryISOCode=e.ISOCode,discountNinjaContext.CountryName=e.Name),void 0!==discountNinjaContext.CountryISOCode&&null!==discountNinjaContext.CountryISOCode}catch(t){return discountNinja.Logging.LogError("BrowsingContext.GetBrowsingContextFromCache",t),discountNinjaContext.CountryISOCode=null,!1}}();if(!t&&n)return i&&i(),discountNinjaContext.CountryISOCode;discountNinja.XmlHttpRequest.Send("/browsing_context_suggestions.json",null,null,"get",!0,!0,!1,(function(t){return function(t,i){try{var n={Name:t.detected_values.country.name,ISOCode:t.detected_values.country.handle};discountNinjaContext.CountryISOCode=n.ISOCode,discountNinjaContext.CountryName=n.Name,discountNinja.Cache.SessionSet(i,JSON.stringify(n))}catch(t){discountNinja.Logging.LogError("BrowsingContext.ParseBrowsingContext",t),discountNinjaContext.CountryISOCode=null}}(t,discountNinja_Script_BrowsingContext_Shopify.CacheKey),i&&i(),discountNinjaContext.CountryISOCode}),(function(){return i&&i(),null}))}catch(t){return discountNinja.Logging.LogError("BrowsingContext.GetCountryFromBrowsingContext",t),i&&i(),null}}};if(void 0===discountNinja)var discountNinja={Badge:discountNinja_Script_Badge,Cache:discountNinja_Script_Cache,Cart:{Shopify:discountNinja_Script_Cart_Shopify},CartAdjustments:discountNinja_Script_CartAdjustments,Checkout:{Shopify:discountNinja_Script_Checkout_Shopify},Cookie:discountNinja_Script_Cookie,Html:discountNinja_Script_Html,OffersAttribute:discountNinja_Script_OffersAttribute,Core:discountNinja_Script_Core,DateTime:discountNinja_Script_DateTime,DiscountCode:discountNinja_Script_DiscountCode,DiscountCodeTrigger:discountNinja_Script_DiscountCodeTrigger,DiscountedCart:discountNinja_Script_DiscountedCart,DiscountedProduct:discountNinja_Script_DiscountedProduct,DiscountTier:discountNinja_Script_DiscountTier,DynamicPricing:discountNinja_Script_DynamicPricing,Environment:{Shopify:discountNinja_Script_Environment_Shopify},LeakyBucket:discountNinja_Script_LeakyBucket,GiftWithPurchase:discountNinja_Script_GiftWithPurchase,LiquidData:discountNinja_Script_LiquidData,Logging:discountNinja_Script_Logging,MultiCurrency:discountNinja_Script_MultiCurrency,Notification:discountNinja_Script_Notification,PopUp:discountNinja_Script_PopUp,PromotionSummary:discountNinja_Script_PromotionSummary,ProductData:discountNinja_Script_ProductData,Offer:discountNinja_Script_Offer,PromotionEvent:discountNinja_Script_PromotionEvent,PromotionFlow:discountNinja_Script_PromotionFlow,QueryParameter:discountNinja_Script_QueryParameter,Settings:discountNinja_Script_Settings,ShortCode:discountNinja_Script_ShortCode,StickyBar:discountNinja_Script_StickyBar,TestMode:discountNinja_Script_TestMode,TextSettings:discountNinja_Script_TextSettings,Timer:discountNinja_Script_Timer,Token:discountNinja_Script_Token,Trigger:discountNinja_Script_Trigger,TriggerSource:discountNinja_Script_TriggerSource,Utilities:discountNinja_Script_Utilities,TextScaling:discountNinja_Script_TextScaling,TemplateParameter:discountNinja_Script_TemplateParameterEngine,VariantChange:discountNinja_Script_VariantChange,XmlHttpRequest:discountNinja_Script_XmlHttpRequest,Events:discountNinja_Script_Events,VariantChangedEvent:discountNinja_Script_VariantChangedEvent,ServerCartItemsAddedEvent:discountNinja_Script_ServerCartItemsAddedEvent,ServerCartItemsChangedEvent:discountNinja_Script_ServerCartItemsChangedEvent,ServerCartItemsUpdatedEvent:discountNinja_Script_ServerCartItemsUpdatedEvent,ServerCollectionProductsPageLoadedEvent:discountNinja_Script_ServerCollectionProductsPageLoadedEvent,LocalCartUpdatedEvent:discountNinja_Script_LocalCartUpdatedEvent,ActionButton:discountNinja_Script_ActionButton,Prerequisite:discountNinja_Script_Prerequisite,DeviceId:discountNinja_Script_DeviceId,Currency:discountNinja_Script_Currency,LogSession:discountNinja_Script_LogSession,AccountLogin:discountNinja_Script_AccountLogin,Polyfill:discountNinja_Script_Polyfill,BuyNow:discountNinja_Script_BuyNow,Set:discountNinja_Script_SetEngine,DrawerCart:discountNinja_Script_DrawerCart,Api:discountNinja_Script_Api,BrowsingContext:discountNinja_Script_BrowsingContext_Shopify};var originalPushStateBeforeLimoniAppsDiscountNinjaOverride=history.pushState,originalReplaceStateBeforeLimoniAppsDiscountNinjaOverride=history.replaceState;history.pushState=function(){try{originalPushStateBeforeLimoniAppsDiscountNinjaOverride.apply(history,arguments)}catch(t){}window.dispatchEvent(new Event("pushState")),window.dispatchEvent(new CustomEvent("limoniapps.discountninja.locationchange"))},history.replaceState=function(){try{originalReplaceStateBeforeLimoniAppsDiscountNinjaOverride.apply(history,arguments)}catch(t){}window.dispatchEvent(new Event("replaceState")),window.dispatchEvent(new CustomEvent("limoniapps.discountninja.locationchange"))},window.addEventListener("popstate",(function(){window.dispatchEvent(new CustomEvent("limoniapps.discountninja.locationchange"))})),window.addEventListener("limoniapps.discountninja.locationchange",(function(){var t=discountNinja.QueryParameter.RemoveFromUrl(window.location.href,"discountninjatestmode",1);t=discountNinja.QueryParameter.RemoveFromUrl(t,"discountninjalog",1);var i=discountNinja.QueryParameter.Get("variant",t),n=discountNinja.QueryParameter.Get("page",t);t!==discountNinja.Core.CurrentLocation&&i?discountNinja.VariantChangedEvent.Handle(null,i):(discountNinja.Environment.Shopify.IsCollectionPage()||discountNinja.Environment.Shopify.IsSearchPage())&&null!==n&&discountNinja.ServerCollectionProductsPageLoadedEvent.Handle(),discountNinja.Core.CurrentLocation=t})),discountNinja.DynamicPricing.UpdatePriceDebouncedAfterInject=discountNinja.Utilities.Debounce((function(){discountNinja.DynamicPricing.UpdatePrice(!1,!0)}),250,"UpdatePriceAfterInject"),discountNinja.DynamicPricing.UpdatePriceDebouncedAfterServerUpdate=discountNinja.Utilities.Debounce((function(){discountNinja.DynamicPricing.UpdatePrice(!1,!1)}),500,"UpdatePriceAfterServerUpdate"),discountNinja.PromotionEvent.ProcessQueue=discountNinja.Utilities.Debounce((function(){discountNinja.PromotionEvent.ProcessQueueDebounced()}),250,"ProcessQueue"),discountNinja.Trigger.ProcessOffersToTrigger=discountNinja.Utilities.Debounce((function(){discountNinja.Trigger.ProcessOffersToTriggerDebounced()}),100,"ProcessOffersToTrigger"),discountNinja.Cart.Shopify.OnDrawerCartOpened=discountNinja.Utilities.Debounce((function(t){discountNinja.Cart.Shopify.OnDrawerCartOpenedDebounced(t)}),250,"OnDrawerCartOpened"),discountNinja.Cart.Shopify.UpdateCartDebounced=discountNinja.Utilities.Debounce((function(t,i){discountNinja.Cart.Shopify.UpdateCart(t,i)}),350,"UpdateCart"),void 0!==window.discountNinjaScriptStarted&&!0===window.discountNinjaScriptStarted||(window.discountNinjaScriptStarted=!0,discountNinja.DOMHasLoaded=!1,discountNinja.Core.ExecuteOnLoadCallback(),discountNinja.Core.Start(!0))}